{"custom_metrics": {"episode_L1_reward_sum_mean": -430.54102406704, "episode_L1_reward_sum_min": -610.5439577996731, "episode_L1_reward_sum_max": -165.67662993073463, "episode_L2_reward_sum_mean": -181.55572044263994, "episode_L2_reward_sum_min": -222.35250659286976, "episode_L2_reward_sum_max": -117.2408994808793}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.4275429392040417, "policy_loss": 0.2493003013279335, "vf_loss": 1.782426361874217, "vf_explained_var": 0.31406545504130456, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 14000, "num_env_steps_trained": 14000, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 14000}, "sampler_results": {"episode_reward_max": -56.85297628317067, "episode_reward_min": -266.05421063184366, "episode_reward_mean": -171.78960656224294, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -430.54102406704, "episode_L1_reward_sum_min": -610.5439577996731, "episode_L1_reward_sum_max": -165.67662993073463, "episode_L2_reward_sum_mean": -181.55572044263994, "episode_L2_reward_sum_min": -222.35250659286976, "episode_L2_reward_sum_max": -117.2408994808793}, "hist_stats": {"episode_reward": [-242.28190906980367, -167.17357994086552, -223.72630828897852, -81.00624238132673, -266.05421063184366, -56.85297628317067, -213.83724509819402, -227.61473654957328, -136.37220970765642, -122.08775775856645, -175.25152489771335, -244.23881113847844, -92.17026250358917, -156.38671762164145], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.736589623668045, "mean_inference_ms": 5.296417594007034, "mean_action_processing_ms": 0.20639260451157732, "mean_env_wait_ms": 1.3782121288941425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -56.85297628317067, "episode_reward_min": -266.05421063184366, "episode_reward_mean": -171.78960656224294, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-242.28190906980367, -167.17357994086552, -223.72630828897852, -81.00624238132673, -266.05421063184366, -56.85297628317067, -213.83724509819402, -227.61473654957328, -136.37220970765642, -122.08775775856645, -175.25152489771335, -244.23881113847844, -92.17026250358917, -156.38671762164145], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.736589623668045, "mean_inference_ms": 5.296417594007034, "mean_action_processing_ms": 0.20639260451157732, "mean_env_wait_ms": 1.3782121288941425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 14000, "num_env_steps_sampled": 14000, "num_env_steps_trained": 14000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 14000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 14000, "timers": {"training_iteration_time_ms": 76490.284, "load_time_ms": 33.908, "load_throughput": 412877.445, "learn_time_ms": 68468.683, "learn_throughput": 204.473, "synch_weights_time_ms": 10.971}, "counters": {"num_env_steps_sampled": 14000, "num_env_steps_trained": 14000, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 14000}, "done": false, "episodes_total": 14, "training_iteration": 1, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_12-55-14", "timestamp": 1693050914, "time_this_iter_s": 76.49826264381409, "time_total_s": 76.49826264381409, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014F11940>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014F03BE0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 76.49826264381409, "timesteps_since_restore": 0, "iterations_since_restore": 1, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 29.111926605504586, "ram_util_percent": 68.27247706422015}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -422.269096280049, "episode_L1_reward_sum_min": -610.5439577996731, "episode_L1_reward_sum_max": -159.76743730902672, "episode_L2_reward_sum_mean": -179.31834578647144, "episode_L2_reward_sum_min": -222.35250659286976, "episode_L2_reward_sum_max": -115.87849966436625}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.4035009072468345, "policy_loss": 0.2423492531894458, "vf_loss": 1.6115164888737252, "vf_explained_var": 0.5415192503068182, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": -48.36804821363313, "episode_reward_min": -267.38960395030597, "episode_reward_mean": -170.20233673661787, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -422.269096280049, "episode_L1_reward_sum_min": -610.5439577996731, "episode_L1_reward_sum_max": -159.76743730902672, "episode_L2_reward_sum_mean": -179.31834578647144, "episode_L2_reward_sum_min": -222.35250659286976, "episode_L2_reward_sum_max": -115.87849966436625}, "hist_stats": {"episode_reward": [-242.28190906980367, -167.17357994086552, -223.72630828897852, -81.00624238132673, -266.05421063184366, -56.85297628317067, -213.83724509819402, -227.61473654957328, -136.37220970765642, -122.08775775856645, -175.25152489771335, -244.23881113847844, -92.17026250358917, -156.38671762164145, -83.70893122068232, -267.38960395030597, -245.8139569994247, -74.16517534440055, -266.7396968373112, -238.49462248160003, -83.4165346262838, -215.36999056881302, -235.80711886378845, -84.71643483612867, -200.73811351394778, -113.31341794510294, -48.36804821363313, -202.56929135247708], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7098326519500014, "mean_inference_ms": 5.333070118587945, "mean_action_processing_ms": 0.2052665181178806, "mean_env_wait_ms": 1.385666683853337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -48.36804821363313, "episode_reward_min": -267.38960395030597, "episode_reward_mean": -170.20233673661787, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-242.28190906980367, -167.17357994086552, -223.72630828897852, -81.00624238132673, -266.05421063184366, -56.85297628317067, -213.83724509819402, -227.61473654957328, -136.37220970765642, -122.08775775856645, -175.25152489771335, -244.23881113847844, -92.17026250358917, -156.38671762164145, -83.70893122068232, -267.38960395030597, -245.8139569994247, -74.16517534440055, -266.7396968373112, -238.49462248160003, -83.4165346262838, -215.36999056881302, -235.80711886378845, -84.71643483612867, -200.73811351394778, -113.31341794510294, -48.36804821363313, -202.56929135247708], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7098326519500014, "mean_inference_ms": 5.333070118587945, "mean_action_processing_ms": 0.2052665181178806, "mean_env_wait_ms": 1.385666683853337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 28000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 77818.234, "load_time_ms": 32.911, "load_throughput": 425384.26, "learn_time_ms": 69801.749, "learn_throughput": 200.568, "synch_weights_time_ms": 13.963}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 28, "training_iteration": 2, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_12-56-34", "timestamp": 1693050994, "time_this_iter_s": 79.15415811538696, "time_total_s": 155.65242075920105, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150AA040>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014F64B20>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 155.65242075920105, "timesteps_since_restore": 0, "iterations_since_restore": 2, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 27.24285714285714, "ram_util_percent": 70.95535714285714}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -389.2385648364822, "episode_L1_reward_sum_min": -613.6664418578148, "episode_L1_reward_sum_max": -159.76743730902672, "episode_L2_reward_sum_mean": -172.01426142152576, "episode_L2_reward_sum_min": -228.2811508178711, "episode_L2_reward_sum_max": -115.87849966436625}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.3108920229694141, "policy_loss": 0.21519632602240812, "vf_loss": 0.9569569759787941, "vf_explained_var": 0.6209950781898734, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000}, "sampler_results": {"episode_reward_max": -46.32460588879141, "episode_reward_min": -267.38960395030597, "episode_reward_mean": -147.12346785573084, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -389.2385648364822, "episode_L1_reward_sum_min": -613.6664418578148, "episode_L1_reward_sum_max": -159.76743730902672, "episode_L2_reward_sum_mean": -172.01426142152576, "episode_L2_reward_sum_min": -228.2811508178711, "episode_L2_reward_sum_max": -115.87849966436625}, "hist_stats": {"episode_reward": [-242.28190906980367, -167.17357994086552, -223.72630828897852, -81.00624238132673, -266.05421063184366, -56.85297628317067, -213.83724509819402, -227.61473654957328, -136.37220970765642, -122.08775775856645, -175.25152489771335, -244.23881113847844, -92.17026250358917, -156.38671762164145, -83.70893122068232, -267.38960395030597, -245.8139569994247, -74.16517534440055, -266.7396968373112, -238.49462248160003, -83.4165346262838, -215.36999056881302, -235.80711886378845, -84.71643483612867, -200.73811351394778, -113.31341794510294, -48.36804821363313, -202.56929135247708, -52.52685688113133, -48.71503502965906, -91.13452443179396, -127.0915145117528, -240.7783252246184, -142.5533460231618, -103.5292949128537, -93.3350974745271, -136.13731473271486, -137.84112480530246, -56.354308451167114, -85.7304793579532, -46.32460588879141, -51.468393589966], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6866201858838166, "mean_inference_ms": 5.298863381467282, "mean_action_processing_ms": 0.2020285206338621, "mean_env_wait_ms": 1.3750527576685247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -46.32460588879141, "episode_reward_min": -267.38960395030597, "episode_reward_mean": -147.12346785573084, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-242.28190906980367, -167.17357994086552, -223.72630828897852, -81.00624238132673, -266.05421063184366, -56.85297628317067, -213.83724509819402, -227.61473654957328, -136.37220970765642, -122.08775775856645, -175.25152489771335, -244.23881113847844, -92.17026250358917, -156.38671762164145, -83.70893122068232, -267.38960395030597, -245.8139569994247, -74.16517534440055, -266.7396968373112, -238.49462248160003, -83.4165346262838, -215.36999056881302, -235.80711886378845, -84.71643483612867, -200.73811351394778, -113.31341794510294, -48.36804821363313, -202.56929135247708, -52.52685688113133, -48.71503502965906, -91.13452443179396, -127.0915145117528, -240.7783252246184, -142.5533460231618, -103.5292949128537, -93.3350974745271, -136.13731473271486, -137.84112480530246, -56.354308451167114, -85.7304793579532, -46.32460588879141, -51.468393589966], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6866201858838166, "mean_inference_ms": 5.298863381467282, "mean_action_processing_ms": 0.2020285206338621, "mean_env_wait_ms": 1.3750527576685247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000, "num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 42000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 42000, "timers": {"training_iteration_time_ms": 77986.221, "load_time_ms": 31.914, "load_throughput": 438673.546, "learn_time_ms": 70212.046, "learn_throughput": 199.396, "synch_weights_time_ms": 12.633}, "counters": {"num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000}, "done": false, "episodes_total": 42, "training_iteration": 3, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_12-57-52", "timestamp": 1693051072, "time_this_iter_s": 78.32917404174805, "time_total_s": 233.9815948009491, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150E8BB0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150A2B50>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 233.9815948009491, "timesteps_since_restore": 0, "iterations_since_restore": 3, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 24.65625, "ram_util_percent": 71.05357142857144}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -398.0285608832325, "episode_L1_reward_sum_min": -613.6664418578148, "episode_L1_reward_sum_max": -159.76743730902672, "episode_L2_reward_sum_mean": -174.20443169400096, "episode_L2_reward_sum_min": -228.2811508178711, "episode_L2_reward_sum_max": -115.87849966436625}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.3350474862627534, "policy_loss": 0.20049990492023972, "vf_loss": 1.3454757917953466, "vf_explained_var": 0.6721479796762329, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": -46.32460588879141, "episode_reward_min": -267.38960395030597, "episode_reward_mean": -150.28283514204924, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -398.0285608832325, "episode_L1_reward_sum_min": -613.6664418578148, "episode_L1_reward_sum_max": -159.76743730902672, "episode_L2_reward_sum_mean": -174.20443169400096, "episode_L2_reward_sum_min": -228.2811508178711, "episode_L2_reward_sum_max": -115.87849966436625}, "hist_stats": {"episode_reward": [-242.28190906980367, -167.17357994086552, -223.72630828897852, -81.00624238132673, -266.05421063184366, -56.85297628317067, -213.83724509819402, -227.61473654957328, -136.37220970765642, -122.08775775856645, -175.25152489771335, -244.23881113847844, -92.17026250358917, -156.38671762164145, -83.70893122068232, -267.38960395030597, -245.8139569994247, -74.16517534440055, -266.7396968373112, -238.49462248160003, -83.4165346262838, -215.36999056881302, -235.80711886378845, -84.71643483612867, -200.73811351394778, -113.31341794510294, -48.36804821363313, -202.56929135247708, -52.52685688113133, -48.71503502965906, -91.13452443179396, -127.0915145117528, -240.7783252246184, -142.5533460231618, -103.5292949128537, -93.3350974745271, -136.13731473271486, -137.84112480530246, -56.354308451167114, -85.7304793579532, -46.32460588879141, -51.468393589966, -124.15337349818041, -203.18539124017855, -201.29964602701762, -81.09527204687286, -158.6853062471412, -61.84988912636283, -53.59742773755943, -172.0546626945011, -235.9287424382384, -201.68506843838676, -193.53801211519195, -105.09021143386708, -240.18454009060525, -204.30557487996052], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6708887853502802, "mean_inference_ms": 5.268901043912844, "mean_action_processing_ms": 0.20029759067212996, "mean_env_wait_ms": 1.3663683743056805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -46.32460588879141, "episode_reward_min": -267.38960395030597, "episode_reward_mean": -150.28283514204924, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-242.28190906980367, -167.17357994086552, -223.72630828897852, -81.00624238132673, -266.05421063184366, -56.85297628317067, -213.83724509819402, -227.61473654957328, -136.37220970765642, -122.08775775856645, -175.25152489771335, -244.23881113847844, -92.17026250358917, -156.38671762164145, -83.70893122068232, -267.38960395030597, -245.8139569994247, -74.16517534440055, -266.7396968373112, -238.49462248160003, -83.4165346262838, -215.36999056881302, -235.80711886378845, -84.71643483612867, -200.73811351394778, -113.31341794510294, -48.36804821363313, -202.56929135247708, -52.52685688113133, -48.71503502965906, -91.13452443179396, -127.0915145117528, -240.7783252246184, -142.5533460231618, -103.5292949128537, -93.3350974745271, -136.13731473271486, -137.84112480530246, -56.354308451167114, -85.7304793579532, -46.32460588879141, -51.468393589966, -124.15337349818041, -203.18539124017855, -201.29964602701762, -81.09527204687286, -158.6853062471412, -61.84988912636283, -53.59742773755943, -172.0546626945011, -235.9287424382384, -201.68506843838676, -193.53801211519195, -105.09021143386708, -240.18454009060525, -204.30557487996052], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6708887853502802, "mean_inference_ms": 5.268901043912844, "mean_action_processing_ms": 0.20029759067212996, "mean_env_wait_ms": 1.3663683743056805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 56000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 77821.55, "load_time_ms": 31.166, "load_throughput": 449201.21, "learn_time_ms": 70165.537, "learn_throughput": 199.528, "synch_weights_time_ms": 12.467}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 56, "training_iteration": 4, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_12-59-09", "timestamp": 1693051149, "time_this_iter_s": 77.33451461791992, "time_total_s": 311.316109418869, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015078460>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270129C6820>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 311.316109418869, "timesteps_since_restore": 0, "iterations_since_restore": 4, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 23.754128440366966, "ram_util_percent": 71.09633027522938}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -411.200096719712, "episode_L1_reward_sum_min": -613.6664418578148, "episode_L1_reward_sum_max": -159.76743730902672, "episode_L2_reward_sum_mean": -177.24845084909882, "episode_L2_reward_sum_min": -228.2811508178711, "episode_L2_reward_sum_max": -115.87849966436625}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.3408850731999129, "policy_loss": 0.20476998068684993, "vf_loss": 1.3611509267561666, "vf_explained_var": 0.8142890005445285, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 70000, "num_env_steps_trained": 70000, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 70000}, "sampler_results": {"episode_reward_max": -46.32460588879141, "episode_reward_min": -267.38960395030597, "episode_reward_mean": -155.49167400197393, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -411.200096719712, "episode_L1_reward_sum_min": -613.6664418578148, "episode_L1_reward_sum_max": -159.76743730902672, "episode_L2_reward_sum_mean": -177.24845084909882, "episode_L2_reward_sum_min": -228.2811508178711, "episode_L2_reward_sum_max": -115.87849966436625}, "hist_stats": {"episode_reward": [-242.28190906980367, -167.17357994086552, -223.72630828897852, -81.00624238132673, -266.05421063184366, -56.85297628317067, -213.83724509819402, -227.61473654957328, -136.37220970765642, -122.08775775856645, -175.25152489771335, -244.23881113847844, -92.17026250358917, -156.38671762164145, -83.70893122068232, -267.38960395030597, -245.8139569994247, -74.16517534440055, -266.7396968373112, -238.49462248160003, -83.4165346262838, -215.36999056881302, -235.80711886378845, -84.71643483612867, -200.73811351394778, -113.31341794510294, -48.36804821363313, -202.56929135247708, -52.52685688113133, -48.71503502965906, -91.13452443179396, -127.0915145117528, -240.7783252246184, -142.5533460231618, -103.5292949128537, -93.3350974745271, -136.13731473271486, -137.84112480530246, -56.354308451167114, -85.7304793579532, -46.32460588879141, -51.468393589966, -124.15337349818041, -203.18539124017855, -201.29964602701762, -81.09527204687286, -158.6853062471412, -61.84988912636283, -53.59742773755943, -172.0546626945011, -235.9287424382384, -201.68506843838676, -193.53801211519195, -105.09021143386708, -240.18454009060525, -204.30557487996052, -73.80198181890201, -81.56471199165509, -148.2971429434773, -236.3650673679474, -181.43077611982272, -215.33431179126976, -220.39110277321296, -123.30280022718571, -236.81224245449386, -154.18441034361254, -111.62608247685404, -262.2645576616276, -202.41495979564252, -220.78826441771307], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6593158024020424, "mean_inference_ms": 5.247460647619961, "mean_action_processing_ms": 0.19913727566391054, "mean_env_wait_ms": 1.3585693488078847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -46.32460588879141, "episode_reward_min": -267.38960395030597, "episode_reward_mean": -155.49167400197393, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-242.28190906980367, -167.17357994086552, -223.72630828897852, -81.00624238132673, -266.05421063184366, -56.85297628317067, -213.83724509819402, -227.61473654957328, -136.37220970765642, -122.08775775856645, -175.25152489771335, -244.23881113847844, -92.17026250358917, -156.38671762164145, -83.70893122068232, -267.38960395030597, -245.8139569994247, -74.16517534440055, -266.7396968373112, -238.49462248160003, -83.4165346262838, -215.36999056881302, -235.80711886378845, -84.71643483612867, -200.73811351394778, -113.31341794510294, -48.36804821363313, -202.56929135247708, -52.52685688113133, -48.71503502965906, -91.13452443179396, -127.0915145117528, -240.7783252246184, -142.5533460231618, -103.5292949128537, -93.3350974745271, -136.13731473271486, -137.84112480530246, -56.354308451167114, -85.7304793579532, -46.32460588879141, -51.468393589966, -124.15337349818041, -203.18539124017855, -201.29964602701762, -81.09527204687286, -158.6853062471412, -61.84988912636283, -53.59742773755943, -172.0546626945011, -235.9287424382384, -201.68506843838676, -193.53801211519195, -105.09021143386708, -240.18454009060525, -204.30557487996052, -73.80198181890201, -81.56471199165509, -148.2971429434773, -236.3650673679474, -181.43077611982272, -215.33431179126976, -220.39110277321296, -123.30280022718571, -236.81224245449386, -154.18441034361254, -111.62608247685404, -262.2645576616276, -202.41495979564252, -220.78826441771307], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6593158024020424, "mean_inference_ms": 5.247460647619961, "mean_action_processing_ms": 0.19913727566391054, "mean_env_wait_ms": 1.3585693488078847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 70000, "num_env_steps_sampled": 70000, "num_env_steps_trained": 70000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 70000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 70000, "timers": {"training_iteration_time_ms": 78127.677, "load_time_ms": 30.718, "load_throughput": 455764.605, "learn_time_ms": 70508.055, "learn_throughput": 198.559, "synch_weights_time_ms": 13.963}, "counters": {"num_env_steps_sampled": 70000, "num_env_steps_trained": 70000, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 70000}, "done": false, "episodes_total": 70, "training_iteration": 5, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-00-29", "timestamp": 1693051229, "time_this_iter_s": 79.36368298530579, "time_total_s": 390.6797924041748, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701516F220>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014F1B7C0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 390.6797924041748, "timesteps_since_restore": 0, "iterations_since_restore": 5, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 26.797345132743363, "ram_util_percent": 70.99115044247789}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -415.34451983869076, "episode_L1_reward_sum_min": -634.9591215252876, "episode_L1_reward_sum_max": -159.76743730902672, "episode_L2_reward_sum_mean": -178.28840124367602, "episode_L2_reward_sum_min": -231.00740206241608, "episode_L2_reward_sum_max": -115.87849966436625}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.3237482591198894, "policy_loss": 0.19056644005923237, "vf_loss": 1.33181818055568, "vf_explained_var": 0.7104854193121317, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": -41.02270529033929, "episode_reward_min": -267.38960395030597, "episode_reward_mean": -156.25171182454966, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -415.34451983869076, "episode_L1_reward_sum_min": -634.9591215252876, "episode_L1_reward_sum_max": -159.76743730902672, "episode_L2_reward_sum_mean": -178.28840124367602, "episode_L2_reward_sum_min": -231.00740206241608, "episode_L2_reward_sum_max": -115.87849966436625}, "hist_stats": {"episode_reward": [-242.28190906980367, -167.17357994086552, -223.72630828897852, -81.00624238132673, -266.05421063184366, -56.85297628317067, -213.83724509819402, -227.61473654957328, -136.37220970765642, -122.08775775856645, -175.25152489771335, -244.23881113847844, -92.17026250358917, -156.38671762164145, -83.70893122068232, -267.38960395030597, -245.8139569994247, -74.16517534440055, -266.7396968373112, -238.49462248160003, -83.4165346262838, -215.36999056881302, -235.80711886378845, -84.71643483612867, -200.73811351394778, -113.31341794510294, -48.36804821363313, -202.56929135247708, -52.52685688113133, -48.71503502965906, -91.13452443179396, -127.0915145117528, -240.7783252246184, -142.5533460231618, -103.5292949128537, -93.3350974745271, -136.13731473271486, -137.84112480530246, -56.354308451167114, -85.7304793579532, -46.32460588879141, -51.468393589966, -124.15337349818041, -203.18539124017855, -201.29964602701762, -81.09527204687286, -158.6853062471412, -61.84988912636283, -53.59742773755943, -172.0546626945011, -235.9287424382384, -201.68506843838676, -193.53801211519195, -105.09021143386708, -240.18454009060525, -204.30557487996052, -73.80198181890201, -81.56471199165509, -148.2971429434773, -236.3650673679474, -181.43077611982272, -215.33431179126976, -220.39110277321296, -123.30280022718571, -236.81224245449386, -154.18441034361254, -111.62608247685404, -262.2645576616276, -202.41495979564252, -220.78826441771307, -174.12040694125167, -177.3170927179732, -81.40414059350859, -241.24543088181414, -87.93840698222401, -236.17085435205024, -192.40105001799898, -212.84421545177528, -69.98163671447482, -185.7713014497619, -41.02270529033929, -212.89477158797152, -113.90729579793727, -213.70730434491657], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6550172124353278, "mean_inference_ms": 5.252302405974589, "mean_action_processing_ms": 0.19898915715508814, "mean_env_wait_ms": 1.358539320983613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -41.02270529033929, "episode_reward_min": -267.38960395030597, "episode_reward_mean": -156.25171182454966, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-242.28190906980367, -167.17357994086552, -223.72630828897852, -81.00624238132673, -266.05421063184366, -56.85297628317067, -213.83724509819402, -227.61473654957328, -136.37220970765642, -122.08775775856645, -175.25152489771335, -244.23881113847844, -92.17026250358917, -156.38671762164145, -83.70893122068232, -267.38960395030597, -245.8139569994247, -74.16517534440055, -266.7396968373112, -238.49462248160003, -83.4165346262838, -215.36999056881302, -235.80711886378845, -84.71643483612867, -200.73811351394778, -113.31341794510294, -48.36804821363313, -202.56929135247708, -52.52685688113133, -48.71503502965906, -91.13452443179396, -127.0915145117528, -240.7783252246184, -142.5533460231618, -103.5292949128537, -93.3350974745271, -136.13731473271486, -137.84112480530246, -56.354308451167114, -85.7304793579532, -46.32460588879141, -51.468393589966, -124.15337349818041, -203.18539124017855, -201.29964602701762, -81.09527204687286, -158.6853062471412, -61.84988912636283, -53.59742773755943, -172.0546626945011, -235.9287424382384, -201.68506843838676, -193.53801211519195, -105.09021143386708, -240.18454009060525, -204.30557487996052, -73.80198181890201, -81.56471199165509, -148.2971429434773, -236.3650673679474, -181.43077611982272, -215.33431179126976, -220.39110277321296, -123.30280022718571, -236.81224245449386, -154.18441034361254, -111.62608247685404, -262.2645576616276, -202.41495979564252, -220.78826441771307, -174.12040694125167, -177.3170927179732, -81.40414059350859, -241.24543088181414, -87.93840698222401, -236.17085435205024, -192.40105001799898, -212.84421545177528, -69.98163671447482, -185.7713014497619, -41.02270529033929, -212.89477158797152, -113.90729579793727, -213.70730434491657], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6550172124353278, "mean_inference_ms": 5.252302405974589, "mean_action_processing_ms": 0.19898915715508814, "mean_env_wait_ms": 1.358539320983613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 84000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 78629.272, "load_time_ms": 30.253, "load_throughput": 462767.472, "learn_time_ms": 70846.129, "learn_throughput": 197.611, "synch_weights_time_ms": 13.464}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 84, "training_iteration": 6, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-01-50", "timestamp": 1693051310, "time_this_iter_s": 81.14222884178162, "time_total_s": 471.8220212459564, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015171130>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015199D60>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 471.8220212459564, "timesteps_since_restore": 0, "iterations_since_restore": 6, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 28.733333333333327, "ram_util_percent": 70.76140350877192}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -409.15209933651647, "episode_L1_reward_sum_min": -634.9591215252876, "episode_L1_reward_sum_max": -159.76743730902672, "episode_L2_reward_sum_mean": -176.8919913476067, "episode_L2_reward_sum_min": -231.00740206241608, "episode_L2_reward_sum_max": -115.87849966436625}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.28141546158963865, "policy_loss": 0.19192578432958865, "vf_loss": 0.8948967597411785, "vf_explained_var": 0.7220255711073738, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 98000, "num_env_steps_trained": 98000, "num_agent_steps_sampled": 98000, "num_agent_steps_trained": 98000}, "sampler_results": {"episode_reward_max": -41.02270529033929, "episode_reward_min": -267.38960395030597, "episode_reward_mean": -151.6408317018724, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -409.15209933651647, "episode_L1_reward_sum_min": -634.9591215252876, "episode_L1_reward_sum_max": -159.76743730902672, "episode_L2_reward_sum_mean": -176.8919913476067, "episode_L2_reward_sum_min": -231.00740206241608, "episode_L2_reward_sum_max": -115.87849966436625}, "hist_stats": {"episode_reward": [-242.28190906980367, -167.17357994086552, -223.72630828897852, -81.00624238132673, -266.05421063184366, -56.85297628317067, -213.83724509819402, -227.61473654957328, -136.37220970765642, -122.08775775856645, -175.25152489771335, -244.23881113847844, -92.17026250358917, -156.38671762164145, -83.70893122068232, -267.38960395030597, -245.8139569994247, -74.16517534440055, -266.7396968373112, -238.49462248160003, -83.4165346262838, -215.36999056881302, -235.80711886378845, -84.71643483612867, -200.73811351394778, -113.31341794510294, -48.36804821363313, -202.56929135247708, -52.52685688113133, -48.71503502965906, -91.13452443179396, -127.0915145117528, -240.7783252246184, -142.5533460231618, -103.5292949128537, -93.3350974745271, -136.13731473271486, -137.84112480530246, -56.354308451167114, -85.7304793579532, -46.32460588879141, -51.468393589966, -124.15337349818041, -203.18539124017855, -201.29964602701762, -81.09527204687286, -158.6853062471412, -61.84988912636283, -53.59742773755943, -172.0546626945011, -235.9287424382384, -201.68506843838676, -193.53801211519195, -105.09021143386708, -240.18454009060525, -204.30557487996052, -73.80198181890201, -81.56471199165509, -148.2971429434773, -236.3650673679474, -181.43077611982272, -215.33431179126976, -220.39110277321296, -123.30280022718571, -236.81224245449386, -154.18441034361254, -111.62608247685404, -262.2645576616276, -202.41495979564252, -220.78826441771307, -174.12040694125167, -177.3170927179732, -81.40414059350859, -241.24543088181414, -87.93840698222401, -236.17085435205024, -192.40105001799898, -212.84421545177528, -69.98163671447482, -185.7713014497619, -41.02270529033929, -212.89477158797152, -113.90729579793727, -213.70730434491657, -172.7806465390558, -62.49973897824755, -169.41575756237222, -113.22888081962179, -103.05588144148767, -173.00709650753024, -57.672452647186915, -141.2893577265659, -160.76012995505778, -71.2592340971741, -168.00154960646333, -45.967363724724166, -74.83886160054449, -221.88076231529053], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6534148620086104, "mean_inference_ms": 5.270890599923586, "mean_action_processing_ms": 0.19936598247007456, "mean_env_wait_ms": 1.3628567466160026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -41.02270529033929, "episode_reward_min": -267.38960395030597, "episode_reward_mean": -151.6408317018724, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-242.28190906980367, -167.17357994086552, -223.72630828897852, -81.00624238132673, -266.05421063184366, -56.85297628317067, -213.83724509819402, -227.61473654957328, -136.37220970765642, -122.08775775856645, -175.25152489771335, -244.23881113847844, -92.17026250358917, -156.38671762164145, -83.70893122068232, -267.38960395030597, -245.8139569994247, -74.16517534440055, -266.7396968373112, -238.49462248160003, -83.4165346262838, -215.36999056881302, -235.80711886378845, -84.71643483612867, -200.73811351394778, -113.31341794510294, -48.36804821363313, -202.56929135247708, -52.52685688113133, -48.71503502965906, -91.13452443179396, -127.0915145117528, -240.7783252246184, -142.5533460231618, -103.5292949128537, -93.3350974745271, -136.13731473271486, -137.84112480530246, -56.354308451167114, -85.7304793579532, -46.32460588879141, -51.468393589966, -124.15337349818041, -203.18539124017855, -201.29964602701762, -81.09527204687286, -158.6853062471412, -61.84988912636283, -53.59742773755943, -172.0546626945011, -235.9287424382384, -201.68506843838676, -193.53801211519195, -105.09021143386708, -240.18454009060525, -204.30557487996052, -73.80198181890201, -81.56471199165509, -148.2971429434773, -236.3650673679474, -181.43077611982272, -215.33431179126976, -220.39110277321296, -123.30280022718571, -236.81224245449386, -154.18441034361254, -111.62608247685404, -262.2645576616276, -202.41495979564252, -220.78826441771307, -174.12040694125167, -177.3170927179732, -81.40414059350859, -241.24543088181414, -87.93840698222401, -236.17085435205024, -192.40105001799898, -212.84421545177528, -69.98163671447482, -185.7713014497619, -41.02270529033929, -212.89477158797152, -113.90729579793727, -213.70730434491657, -172.7806465390558, -62.49973897824755, -169.41575756237222, -113.22888081962179, -103.05588144148767, -173.00709650753024, -57.672452647186915, -141.2893577265659, -160.76012995505778, -71.2592340971741, -168.00154960646333, -45.967363724724166, -74.83886160054449, -221.88076231529053], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6534148620086104, "mean_inference_ms": 5.270890599923586, "mean_action_processing_ms": 0.19936598247007456, "mean_env_wait_ms": 1.3628567466160026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 98000, "num_agent_steps_trained": 98000, "num_env_steps_sampled": 98000, "num_env_steps_trained": 98000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 98000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 98000, "timers": {"training_iteration_time_ms": 79204.66, "load_time_ms": 29.493, "load_throughput": 474690.145, "learn_time_ms": 71272.768, "learn_throughput": 196.428, "synch_weights_time_ms": 13.108}, "counters": {"num_env_steps_sampled": 98000, "num_env_steps_trained": 98000, "num_agent_steps_sampled": 98000, "num_agent_steps_trained": 98000}, "done": false, "episodes_total": 98, "training_iteration": 7, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-03-13", "timestamp": 1693051393, "time_this_iter_s": 82.66297507286072, "time_total_s": 554.4849963188171, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270152043D0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270151E6700>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 554.4849963188171, "timesteps_since_restore": 0, "iterations_since_restore": 7, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 30.05084745762711, "ram_util_percent": 70.99067796610169}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -400.72792492963373, "episode_L1_reward_sum_min": -634.9591215252876, "episode_L1_reward_sum_max": -159.76743730902672, "episode_L2_reward_sum_mean": -174.93437351167202, "episode_L2_reward_sum_min": -231.00740206241608, "episode_L2_reward_sum_max": -115.87849966436625}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.29130480951059795, "policy_loss": 0.194454601289989, "vf_loss": 0.9685020777330312, "vf_explained_var": 0.7635782407635033, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": -41.02270529033929, "episode_reward_min": -267.38960395030597, "episode_reward_mean": -145.41120984273928, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -400.72792492963373, "episode_L1_reward_sum_min": -634.9591215252876, "episode_L1_reward_sum_max": -159.76743730902672, "episode_L2_reward_sum_mean": -174.93437351167202, "episode_L2_reward_sum_min": -231.00740206241608, "episode_L2_reward_sum_max": -115.87849966436625}, "hist_stats": {"episode_reward": [-92.17026250358917, -156.38671762164145, -83.70893122068232, -267.38960395030597, -245.8139569994247, -74.16517534440055, -266.7396968373112, -238.49462248160003, -83.4165346262838, -215.36999056881302, -235.80711886378845, -84.71643483612867, -200.73811351394778, -113.31341794510294, -48.36804821363313, -202.56929135247708, -52.52685688113133, -48.71503502965906, -91.13452443179396, -127.0915145117528, -240.7783252246184, -142.5533460231618, -103.5292949128537, -93.3350974745271, -136.13731473271486, -137.84112480530246, -56.354308451167114, -85.7304793579532, -46.32460588879141, -51.468393589966, -124.15337349818041, -203.18539124017855, -201.29964602701762, -81.09527204687286, -158.6853062471412, -61.84988912636283, -53.59742773755943, -172.0546626945011, -235.9287424382384, -201.68506843838676, -193.53801211519195, -105.09021143386708, -240.18454009060525, -204.30557487996052, -73.80198181890201, -81.56471199165509, -148.2971429434773, -236.3650673679474, -181.43077611982272, -215.33431179126976, -220.39110277321296, -123.30280022718571, -236.81224245449386, -154.18441034361254, -111.62608247685404, -262.2645576616276, -202.41495979564252, -220.78826441771307, -174.12040694125167, -177.3170927179732, -81.40414059350859, -241.24543088181414, -87.93840698222401, -236.17085435205024, -192.40105001799898, -212.84421545177528, -69.98163671447482, -185.7713014497619, -41.02270529033929, -212.89477158797152, -113.90729579793727, -213.70730434491657, -172.7806465390558, -62.49973897824755, -169.41575756237222, -113.22888081962179, -103.05588144148767, -173.00709650753024, -57.672452647186915, -141.2893577265659, -160.76012995505778, -71.2592340971741, -168.00154960646333, -45.967363724724166, -74.83886160054449, -221.88076231529053, -76.90905836210962, -86.70825033804022, -72.21159418824755, -96.74306770913665, -198.93283211109735, -178.70860671605544, -61.86859596111253, -251.6873480395046, -87.48773613211063, -94.80317469263076, -203.42052476738667, -196.38666653149326, -184.83379255155972, -46.11574113611963], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6417374828506331, "mean_inference_ms": 5.285855650655543, "mean_action_processing_ms": 0.19915731959109023, "mean_env_wait_ms": 1.3656225300259246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -41.02270529033929, "episode_reward_min": -267.38960395030597, "episode_reward_mean": -145.41120984273928, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-92.17026250358917, -156.38671762164145, -83.70893122068232, -267.38960395030597, -245.8139569994247, -74.16517534440055, -266.7396968373112, -238.49462248160003, -83.4165346262838, -215.36999056881302, -235.80711886378845, -84.71643483612867, -200.73811351394778, -113.31341794510294, -48.36804821363313, -202.56929135247708, -52.52685688113133, -48.71503502965906, -91.13452443179396, -127.0915145117528, -240.7783252246184, -142.5533460231618, -103.5292949128537, -93.3350974745271, -136.13731473271486, -137.84112480530246, -56.354308451167114, -85.7304793579532, -46.32460588879141, -51.468393589966, -124.15337349818041, -203.18539124017855, -201.29964602701762, -81.09527204687286, -158.6853062471412, -61.84988912636283, -53.59742773755943, -172.0546626945011, -235.9287424382384, -201.68506843838676, -193.53801211519195, -105.09021143386708, -240.18454009060525, -204.30557487996052, -73.80198181890201, -81.56471199165509, -148.2971429434773, -236.3650673679474, -181.43077611982272, -215.33431179126976, -220.39110277321296, -123.30280022718571, -236.81224245449386, -154.18441034361254, -111.62608247685404, -262.2645576616276, -202.41495979564252, -220.78826441771307, -174.12040694125167, -177.3170927179732, -81.40414059350859, -241.24543088181414, -87.93840698222401, -236.17085435205024, -192.40105001799898, -212.84421545177528, -69.98163671447482, -185.7713014497619, -41.02270529033929, -212.89477158797152, -113.90729579793727, -213.70730434491657, -172.7806465390558, -62.49973897824755, -169.41575756237222, -113.22888081962179, -103.05588144148767, -173.00709650753024, -57.672452647186915, -141.2893577265659, -160.76012995505778, -71.2592340971741, -168.00154960646333, -45.967363724724166, -74.83886160054449, -221.88076231529053, -76.90905836210962, -86.70825033804022, -72.21159418824755, -96.74306770913665, -198.93283211109735, -178.70860671605544, -61.86859596111253, -251.6873480395046, -87.48773613211063, -94.80317469263076, -203.42052476738667, -196.38666653149326, -184.83379255155972, -46.11574113611963], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6417374828506331, "mean_inference_ms": 5.285855650655543, "mean_action_processing_ms": 0.19915731959109023, "mean_env_wait_ms": 1.3656225300259246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 112000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 79381.608, "load_time_ms": 30.419, "load_throughput": 460239.689, "learn_time_ms": 71431.771, "learn_throughput": 195.991, "synch_weights_time_ms": 13.09}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 112, "training_iteration": 8, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-04-34", "timestamp": 1693051474, "time_this_iter_s": 80.62522959709167, "time_total_s": 635.1102259159088, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150A2E80>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150AAD90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 635.1102259159088, "timesteps_since_restore": 0, "iterations_since_restore": 8, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 26.906194690265483, "ram_util_percent": 70.90707964601768}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -398.80626911506056, "episode_L1_reward_sum_min": -634.9591215252876, "episode_L1_reward_sum_max": -159.76743730902672, "episode_L2_reward_sum_mean": -174.5603099965304, "episode_L2_reward_sum_min": -231.00740206241608, "episode_L2_reward_sum_max": -115.87849966436625}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.3084510097975011, "policy_loss": 0.205225573304596, "vf_loss": 1.0322543642795223, "vf_explained_var": 0.6461445023248225, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "sampler_results": {"episode_reward_max": -41.02270529033929, "episode_reward_min": -262.2645576616276, "episode_reward_mean": -141.83874038224042, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -398.80626911506056, "episode_L1_reward_sum_min": -634.9591215252876, "episode_L1_reward_sum_max": -159.76743730902672, "episode_L2_reward_sum_mean": -174.5603099965304, "episode_L2_reward_sum_min": -231.00740206241608, "episode_L2_reward_sum_max": -115.87849966436625}, "hist_stats": {"episode_reward": [-48.36804821363313, -202.56929135247708, -52.52685688113133, -48.71503502965906, -91.13452443179396, -127.0915145117528, -240.7783252246184, -142.5533460231618, -103.5292949128537, -93.3350974745271, -136.13731473271486, -137.84112480530246, -56.354308451167114, -85.7304793579532, -46.32460588879141, -51.468393589966, -124.15337349818041, -203.18539124017855, -201.29964602701762, -81.09527204687286, -158.6853062471412, -61.84988912636283, -53.59742773755943, -172.0546626945011, -235.9287424382384, -201.68506843838676, -193.53801211519195, -105.09021143386708, -240.18454009060525, -204.30557487996052, -73.80198181890201, -81.56471199165509, -148.2971429434773, -236.3650673679474, -181.43077611982272, -215.33431179126976, -220.39110277321296, -123.30280022718571, -236.81224245449386, -154.18441034361254, -111.62608247685404, -262.2645576616276, -202.41495979564252, -220.78826441771307, -174.12040694125167, -177.3170927179732, -81.40414059350859, -241.24543088181414, -87.93840698222401, -236.17085435205024, -192.40105001799898, -212.84421545177528, -69.98163671447482, -185.7713014497619, -41.02270529033929, -212.89477158797152, -113.90729579793727, -213.70730434491657, -172.7806465390558, -62.49973897824755, -169.41575756237222, -113.22888081962179, -103.05588144148767, -173.00709650753024, -57.672452647186915, -141.2893577265659, -160.76012995505778, -71.2592340971741, -168.00154960646333, -45.967363724724166, -74.83886160054449, -221.88076231529053, -76.90905836210962, -86.70825033804022, -72.21159418824755, -96.74306770913665, -198.93283211109735, -178.70860671605544, -61.86859596111253, -251.6873480395046, -87.48773613211063, -94.80317469263076, -203.42052476738667, -196.38666653149326, -184.83379255155972, -46.11574113611963, -205.9566087366783, -224.1466871940928, -238.886970569353, -69.62347616991897, -125.46083451894567, -66.98207877360466, -150.99573958547785, -50.735875154577506, -67.90484745737413, -217.55354521837558, -58.01963803525159, -54.73310369527555, -222.92738057289802, -247.05684558131034], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6360613592727017, "mean_inference_ms": 5.293285844026878, "mean_action_processing_ms": 0.19885629120996418, "mean_env_wait_ms": 1.3669082810823567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -41.02270529033929, "episode_reward_min": -262.2645576616276, "episode_reward_mean": -141.83874038224042, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.36804821363313, -202.56929135247708, -52.52685688113133, -48.71503502965906, -91.13452443179396, -127.0915145117528, -240.7783252246184, -142.5533460231618, -103.5292949128537, -93.3350974745271, -136.13731473271486, -137.84112480530246, -56.354308451167114, -85.7304793579532, -46.32460588879141, -51.468393589966, -124.15337349818041, -203.18539124017855, -201.29964602701762, -81.09527204687286, -158.6853062471412, -61.84988912636283, -53.59742773755943, -172.0546626945011, -235.9287424382384, -201.68506843838676, -193.53801211519195, -105.09021143386708, -240.18454009060525, -204.30557487996052, -73.80198181890201, -81.56471199165509, -148.2971429434773, -236.3650673679474, -181.43077611982272, -215.33431179126976, -220.39110277321296, -123.30280022718571, -236.81224245449386, -154.18441034361254, -111.62608247685404, -262.2645576616276, -202.41495979564252, -220.78826441771307, -174.12040694125167, -177.3170927179732, -81.40414059350859, -241.24543088181414, -87.93840698222401, -236.17085435205024, -192.40105001799898, -212.84421545177528, -69.98163671447482, -185.7713014497619, -41.02270529033929, -212.89477158797152, -113.90729579793727, -213.70730434491657, -172.7806465390558, -62.49973897824755, -169.41575756237222, -113.22888081962179, -103.05588144148767, -173.00709650753024, -57.672452647186915, -141.2893577265659, -160.76012995505778, -71.2592340971741, -168.00154960646333, -45.967363724724166, -74.83886160054449, -221.88076231529053, -76.90905836210962, -86.70825033804022, -72.21159418824755, -96.74306770913665, -198.93283211109735, -178.70860671605544, -61.86859596111253, -251.6873480395046, -87.48773613211063, -94.80317469263076, -203.42052476738667, -196.38666653149326, -184.83379255155972, -46.11574113611963, -205.9566087366783, -224.1466871940928, -238.886970569353, -69.62347616991897, -125.46083451894567, -66.98207877360466, -150.99573958547785, -50.735875154577506, -67.90484745737413, -217.55354521837558, -58.01963803525159, -54.73310369527555, -222.92738057289802, -247.05684558131034], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6360613592727017, "mean_inference_ms": 5.293285844026878, "mean_action_processing_ms": 0.19885629120996418, "mean_env_wait_ms": 1.3669082810823567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 126000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 126000, "timers": {"training_iteration_time_ms": 80299.61, "load_time_ms": 30.474, "load_throughput": 459403.619, "learn_time_ms": 72301.796, "learn_throughput": 193.633, "synch_weights_time_ms": 13.52}, "counters": {"num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "done": false, "episodes_total": 126, "training_iteration": 9, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-06-01", "timestamp": 1693051561, "time_this_iter_s": 87.64861226081848, "time_total_s": 722.7588381767273, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270151C0FA0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270151F41C0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 722.7588381767273, "timesteps_since_restore": 0, "iterations_since_restore": 9, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 32.07741935483871, "ram_util_percent": 70.9266129032258}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -401.690421468094, "episode_L1_reward_sum_min": -634.9591215252876, "episode_L1_reward_sum_max": -165.31943184137344, "episode_L2_reward_sum_mean": -175.22900078766048, "episode_L2_reward_sum_min": -231.00740206241608, "episode_L2_reward_sum_max": -117.67889939248562}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.29320962526725863, "policy_loss": 0.19737446314340762, "vf_loss": 0.9583516079454452, "vf_explained_var": 0.6957226888019852, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": -41.02270529033929, "episode_reward_min": -262.2645576616276, "episode_reward_mean": -143.7453797895372, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -401.690421468094, "episode_L1_reward_sum_min": -634.9591215252876, "episode_L1_reward_sum_max": -165.31943184137344, "episode_L2_reward_sum_mean": -175.22900078766048, "episode_L2_reward_sum_min": -231.00740206241608, "episode_L2_reward_sum_max": -117.67889939248562}, "hist_stats": {"episode_reward": [-46.32460588879141, -51.468393589966, -124.15337349818041, -203.18539124017855, -201.29964602701762, -81.09527204687286, -158.6853062471412, -61.84988912636283, -53.59742773755943, -172.0546626945011, -235.9287424382384, -201.68506843838676, -193.53801211519195, -105.09021143386708, -240.18454009060525, -204.30557487996052, -73.80198181890201, -81.56471199165509, -148.2971429434773, -236.3650673679474, -181.43077611982272, -215.33431179126976, -220.39110277321296, -123.30280022718571, -236.81224245449386, -154.18441034361254, -111.62608247685404, -262.2645576616276, -202.41495979564252, -220.78826441771307, -174.12040694125167, -177.3170927179732, -81.40414059350859, -241.24543088181414, -87.93840698222401, -236.17085435205024, -192.40105001799898, -212.84421545177528, -69.98163671447482, -185.7713014497619, -41.02270529033929, -212.89477158797152, -113.90729579793727, -213.70730434491657, -172.7806465390558, -62.49973897824755, -169.41575756237222, -113.22888081962179, -103.05588144148767, -173.00709650753024, -57.672452647186915, -141.2893577265659, -160.76012995505778, -71.2592340971741, -168.00154960646333, -45.967363724724166, -74.83886160054449, -221.88076231529053, -76.90905836210962, -86.70825033804022, -72.21159418824755, -96.74306770913665, -198.93283211109735, -178.70860671605544, -61.86859596111253, -251.6873480395046, -87.48773613211063, -94.80317469263076, -203.42052476738667, -196.38666653149326, -184.83379255155972, -46.11574113611963, -205.9566087366783, -224.1466871940928, -238.886970569353, -69.62347616991897, -125.46083451894567, -66.98207877360466, -150.99573958547785, -50.735875154577506, -67.90484745737413, -217.55354521837558, -58.01963803525159, -54.73310369527555, -222.92738057289802, -247.05684558131034, -75.39604512457146, -46.714609376457496, -46.59764471839472, -82.54626066529119, -98.76612516292282, -193.61215269678635, -135.40062763365043, -79.1889062600092, -117.15922042511865, -203.3042136498167, -141.4303300609727, -227.69400893080444, -203.2283231110316, -106.29003431659373], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6363602703844896, "mean_inference_ms": 5.317599161356647, "mean_action_processing_ms": 0.19968804533511722, "mean_env_wait_ms": 1.3732210884697544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -41.02270529033929, "episode_reward_min": -262.2645576616276, "episode_reward_mean": -143.7453797895372, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-46.32460588879141, -51.468393589966, -124.15337349818041, -203.18539124017855, -201.29964602701762, -81.09527204687286, -158.6853062471412, -61.84988912636283, -53.59742773755943, -172.0546626945011, -235.9287424382384, -201.68506843838676, -193.53801211519195, -105.09021143386708, -240.18454009060525, -204.30557487996052, -73.80198181890201, -81.56471199165509, -148.2971429434773, -236.3650673679474, -181.43077611982272, -215.33431179126976, -220.39110277321296, -123.30280022718571, -236.81224245449386, -154.18441034361254, -111.62608247685404, -262.2645576616276, -202.41495979564252, -220.78826441771307, -174.12040694125167, -177.3170927179732, -81.40414059350859, -241.24543088181414, -87.93840698222401, -236.17085435205024, -192.40105001799898, -212.84421545177528, -69.98163671447482, -185.7713014497619, -41.02270529033929, -212.89477158797152, -113.90729579793727, -213.70730434491657, -172.7806465390558, -62.49973897824755, -169.41575756237222, -113.22888081962179, -103.05588144148767, -173.00709650753024, -57.672452647186915, -141.2893577265659, -160.76012995505778, -71.2592340971741, -168.00154960646333, -45.967363724724166, -74.83886160054449, -221.88076231529053, -76.90905836210962, -86.70825033804022, -72.21159418824755, -96.74306770913665, -198.93283211109735, -178.70860671605544, -61.86859596111253, -251.6873480395046, -87.48773613211063, -94.80317469263076, -203.42052476738667, -196.38666653149326, -184.83379255155972, -46.11574113611963, -205.9566087366783, -224.1466871940928, -238.886970569353, -69.62347616991897, -125.46083451894567, -66.98207877360466, -150.99573958547785, -50.735875154577506, -67.90484745737413, -217.55354521837558, -58.01963803525159, -54.73310369527555, -222.92738057289802, -247.05684558131034, -75.39604512457146, -46.714609376457496, -46.59764471839472, -82.54626066529119, -98.76612516292282, -193.61215269678635, -135.40062763365043, -79.1889062600092, -117.15922042511865, -203.3042136498167, -141.4303300609727, -227.69400893080444, -203.2283231110316, -106.29003431659373], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6363602703844896, "mean_inference_ms": 5.317599161356647, "mean_action_processing_ms": 0.19968804533511722, "mean_env_wait_ms": 1.3732210884697544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 140000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 80303.503, "load_time_ms": 30.419, "load_throughput": 460240.951, "learn_time_ms": 72310.691, "learn_throughput": 193.609, "synch_weights_time_ms": 13.564}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 140, "training_iteration": 10, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-07-22", "timestamp": 1693051642, "time_this_iter_s": 80.34452056884766, "time_total_s": 803.103358745575, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015238FD0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015238E80>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 803.103358745575, "timesteps_since_restore": 0, "iterations_since_restore": 10, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 26.79824561403509, "ram_util_percent": 70.93157894736842}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -390.7734526464343, "episode_L1_reward_sum_min": -634.9591215252876, "episode_L1_reward_sum_max": -170.0014772042632, "episode_L2_reward_sum_mean": -172.64380110763014, "episode_L2_reward_sum_min": -231.00740206241608, "episode_L2_reward_sum_max": -118.89422407746315}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.2423486560384674, "policy_loss": 0.17248558798920335, "vf_loss": 0.6986307069005245, "vf_explained_var": 0.5978258333088439, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 154000, "num_env_steps_trained": 154000, "num_agent_steps_sampled": 154000, "num_agent_steps_trained": 154000}, "sampler_results": {"episode_reward_max": -41.02270529033929, "episode_reward_min": -262.2645576616276, "episode_reward_mean": -138.04558197514908, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -390.7734526464343, "episode_L1_reward_sum_min": -634.9591215252876, "episode_L1_reward_sum_max": -170.0014772042632, "episode_L2_reward_sum_mean": -172.64380110763014, "episode_L2_reward_sum_min": -231.00740206241608, "episode_L2_reward_sum_max": -118.89422407746315}, "hist_stats": {"episode_reward": [-240.18454009060525, -204.30557487996052, -73.80198181890201, -81.56471199165509, -148.2971429434773, -236.3650673679474, -181.43077611982272, -215.33431179126976, -220.39110277321296, -123.30280022718571, -236.81224245449386, -154.18441034361254, -111.62608247685404, -262.2645576616276, -202.41495979564252, -220.78826441771307, -174.12040694125167, -177.3170927179732, -81.40414059350859, -241.24543088181414, -87.93840698222401, -236.17085435205024, -192.40105001799898, -212.84421545177528, -69.98163671447482, -185.7713014497619, -41.02270529033929, -212.89477158797152, -113.90729579793727, -213.70730434491657, -172.7806465390558, -62.49973897824755, -169.41575756237222, -113.22888081962179, -103.05588144148767, -173.00709650753024, -57.672452647186915, -141.2893577265659, -160.76012995505778, -71.2592340971741, -168.00154960646333, -45.967363724724166, -74.83886160054449, -221.88076231529053, -76.90905836210962, -86.70825033804022, -72.21159418824755, -96.74306770913665, -198.93283211109735, -178.70860671605544, -61.86859596111253, -251.6873480395046, -87.48773613211063, -94.80317469263076, -203.42052476738667, -196.38666653149326, -184.83379255155972, -46.11574113611963, -205.9566087366783, -224.1466871940928, -238.886970569353, -69.62347616991897, -125.46083451894567, -66.98207877360466, -150.99573958547785, -50.735875154577506, -67.90484745737413, -217.55354521837558, -58.01963803525159, -54.73310369527555, -222.92738057289802, -247.05684558131034, -75.39604512457146, -46.714609376457496, -46.59764471839472, -82.54626066529119, -98.76612516292282, -193.61215269678635, -135.40062763365043, -79.1889062600092, -117.15922042511865, -203.3042136498167, -141.4303300609727, -227.69400893080444, -203.2283231110316, -106.29003431659373, -175.42836980587248, -76.89976774876442, -61.738947581168134, -87.44454596742098, -56.309488690809054, -43.953957330610585, -177.17884253953574, -213.8192700978908, -58.43248700061222, -94.02339062135988, -54.71738321884991, -90.14789688884476, -46.36702506951608, -83.51484852219099], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6389933015080654, "mean_inference_ms": 5.357322002137745, "mean_action_processing_ms": 0.20090849077934927, "mean_env_wait_ms": 1.383816994575798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -41.02270529033929, "episode_reward_min": -262.2645576616276, "episode_reward_mean": -138.04558197514908, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-240.18454009060525, -204.30557487996052, -73.80198181890201, -81.56471199165509, -148.2971429434773, -236.3650673679474, -181.43077611982272, -215.33431179126976, -220.39110277321296, -123.30280022718571, -236.81224245449386, -154.18441034361254, -111.62608247685404, -262.2645576616276, -202.41495979564252, -220.78826441771307, -174.12040694125167, -177.3170927179732, -81.40414059350859, -241.24543088181414, -87.93840698222401, -236.17085435205024, -192.40105001799898, -212.84421545177528, -69.98163671447482, -185.7713014497619, -41.02270529033929, -212.89477158797152, -113.90729579793727, -213.70730434491657, -172.7806465390558, -62.49973897824755, -169.41575756237222, -113.22888081962179, -103.05588144148767, -173.00709650753024, -57.672452647186915, -141.2893577265659, -160.76012995505778, -71.2592340971741, -168.00154960646333, -45.967363724724166, -74.83886160054449, -221.88076231529053, -76.90905836210962, -86.70825033804022, -72.21159418824755, -96.74306770913665, -198.93283211109735, -178.70860671605544, -61.86859596111253, -251.6873480395046, -87.48773613211063, -94.80317469263076, -203.42052476738667, -196.38666653149326, -184.83379255155972, -46.11574113611963, -205.9566087366783, -224.1466871940928, -238.886970569353, -69.62347616991897, -125.46083451894567, -66.98207877360466, -150.99573958547785, -50.735875154577506, -67.90484745737413, -217.55354521837558, -58.01963803525159, -54.73310369527555, -222.92738057289802, -247.05684558131034, -75.39604512457146, -46.714609376457496, -46.59764471839472, -82.54626066529119, -98.76612516292282, -193.61215269678635, -135.40062763365043, -79.1889062600092, -117.15922042511865, -203.3042136498167, -141.4303300609727, -227.69400893080444, -203.2283231110316, -106.29003431659373, -175.42836980587248, -76.89976774876442, -61.738947581168134, -87.44454596742098, -56.309488690809054, -43.953957330610585, -177.17884253953574, -213.8192700978908, -58.43248700061222, -94.02339062135988, -54.71738321884991, -90.14789688884476, -46.36702506951608, -83.51484852219099], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6389933015080654, "mean_inference_ms": 5.357322002137745, "mean_action_processing_ms": 0.20090849077934927, "mean_env_wait_ms": 1.383816994575798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 154000, "num_agent_steps_trained": 154000, "num_env_steps_sampled": 154000, "num_env_steps_trained": 154000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 154000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 154000, "timers": {"training_iteration_time_ms": 80686.946, "load_time_ms": 29.222, "load_throughput": 479088.561, "learn_time_ms": 72627.781, "learn_throughput": 192.764, "synch_weights_time_ms": 13.265}, "counters": {"num_env_steps_sampled": 154000, "num_env_steps_trained": 154000, "num_agent_steps_sampled": 154000, "num_agent_steps_trained": 154000}, "done": false, "episodes_total": 154, "training_iteration": 11, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-08-42", "timestamp": 1693051722, "time_this_iter_s": 80.32973027229309, "time_total_s": 883.433089017868, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015422C70>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701523C4F0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 883.433089017868, "timesteps_since_restore": 0, "iterations_since_restore": 11, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 26.772807017543858, "ram_util_percent": 70.98333333333333}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -395.7271568506211, "episode_L1_reward_sum_min": -634.9591215252876, "episode_L1_reward_sum_max": -170.0014772042632, "episode_L2_reward_sum_mean": -173.90319271340965, "episode_L2_reward_sum_min": -231.00740206241608, "episode_L2_reward_sum_max": -118.89422407746315}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.3307464815362153, "policy_loss": 0.24034594505575776, "vf_loss": 0.9040053648018479, "vf_explained_var": 0.7999773888921542, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": -41.02270529033929, "episode_reward_min": -251.6873480395046, "episode_reward_mean": -135.57690515494397, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -395.7271568506211, "episode_L1_reward_sum_min": -634.9591215252876, "episode_L1_reward_sum_max": -170.0014772042632, "episode_L2_reward_sum_mean": -173.90319271340965, "episode_L2_reward_sum_min": -231.00740206241608, "episode_L2_reward_sum_max": -118.89422407746315}, "hist_stats": {"episode_reward": [-202.41495979564252, -220.78826441771307, -174.12040694125167, -177.3170927179732, -81.40414059350859, -241.24543088181414, -87.93840698222401, -236.17085435205024, -192.40105001799898, -212.84421545177528, -69.98163671447482, -185.7713014497619, -41.02270529033929, -212.89477158797152, -113.90729579793727, -213.70730434491657, -172.7806465390558, -62.49973897824755, -169.41575756237222, -113.22888081962179, -103.05588144148767, -173.00709650753024, -57.672452647186915, -141.2893577265659, -160.76012995505778, -71.2592340971741, -168.00154960646333, -45.967363724724166, -74.83886160054449, -221.88076231529053, -76.90905836210962, -86.70825033804022, -72.21159418824755, -96.74306770913665, -198.93283211109735, -178.70860671605544, -61.86859596111253, -251.6873480395046, -87.48773613211063, -94.80317469263076, -203.42052476738667, -196.38666653149326, -184.83379255155972, -46.11574113611963, -205.9566087366783, -224.1466871940928, -238.886970569353, -69.62347616991897, -125.46083451894567, -66.98207877360466, -150.99573958547785, -50.735875154577506, -67.90484745737413, -217.55354521837558, -58.01963803525159, -54.73310369527555, -222.92738057289802, -247.05684558131034, -75.39604512457146, -46.714609376457496, -46.59764471839472, -82.54626066529119, -98.76612516292282, -193.61215269678635, -135.40062763365043, -79.1889062600092, -117.15922042511865, -203.3042136498167, -141.4303300609727, -227.69400893080444, -203.2283231110316, -106.29003431659373, -175.42836980587248, -76.89976774876442, -61.738947581168134, -87.44454596742098, -56.309488690809054, -43.953957330610585, -177.17884253953574, -213.8192700978908, -58.43248700061222, -94.02339062135988, -54.71738321884991, -90.14789688884476, -46.36702506951608, -83.51484852219099, -185.55540805603158, -187.53818524696925, -216.99863331077054, -145.37542509890852, -111.1296821127772, -153.01294889287743, -179.5787842697607, -192.9932542569058, -137.42834184487904, -179.53483877595258, -56.004803857754034, -223.43174198566473, -171.16621722250417, -103.24935598836227], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.643681394397471, "mean_inference_ms": 5.397435654247651, "mean_action_processing_ms": 0.20206838646880074, "mean_env_wait_ms": 1.3954745386155574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -41.02270529033929, "episode_reward_min": -251.6873480395046, "episode_reward_mean": -135.57690515494397, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-202.41495979564252, -220.78826441771307, -174.12040694125167, -177.3170927179732, -81.40414059350859, -241.24543088181414, -87.93840698222401, -236.17085435205024, -192.40105001799898, -212.84421545177528, -69.98163671447482, -185.7713014497619, -41.02270529033929, -212.89477158797152, -113.90729579793727, -213.70730434491657, -172.7806465390558, -62.49973897824755, -169.41575756237222, -113.22888081962179, -103.05588144148767, -173.00709650753024, -57.672452647186915, -141.2893577265659, -160.76012995505778, -71.2592340971741, -168.00154960646333, -45.967363724724166, -74.83886160054449, -221.88076231529053, -76.90905836210962, -86.70825033804022, -72.21159418824755, -96.74306770913665, -198.93283211109735, -178.70860671605544, -61.86859596111253, -251.6873480395046, -87.48773613211063, -94.80317469263076, -203.42052476738667, -196.38666653149326, -184.83379255155972, -46.11574113611963, -205.9566087366783, -224.1466871940928, -238.886970569353, -69.62347616991897, -125.46083451894567, -66.98207877360466, -150.99573958547785, -50.735875154577506, -67.90484745737413, -217.55354521837558, -58.01963803525159, -54.73310369527555, -222.92738057289802, -247.05684558131034, -75.39604512457146, -46.714609376457496, -46.59764471839472, -82.54626066529119, -98.76612516292282, -193.61215269678635, -135.40062763365043, -79.1889062600092, -117.15922042511865, -203.3042136498167, -141.4303300609727, -227.69400893080444, -203.2283231110316, -106.29003431659373, -175.42836980587248, -76.89976774876442, -61.738947581168134, -87.44454596742098, -56.309488690809054, -43.953957330610585, -177.17884253953574, -213.8192700978908, -58.43248700061222, -94.02339062135988, -54.71738321884991, -90.14789688884476, -46.36702506951608, -83.51484852219099, -185.55540805603158, -187.53818524696925, -216.99863331077054, -145.37542509890852, -111.1296821127772, -153.01294889287743, -179.5787842697607, -192.9932542569058, -137.42834184487904, -179.53483877595258, -56.004803857754034, -223.43174198566473, -171.16621722250417, -103.24935598836227], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.643681394397471, "mean_inference_ms": 5.397435654247651, "mean_action_processing_ms": 0.20206838646880074, "mean_env_wait_ms": 1.3954745386155574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 168000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 81056.96, "load_time_ms": 29.821, "load_throughput": 469464.595, "learn_time_ms": 73025.144, "learn_throughput": 191.715, "synch_weights_time_ms": 12.567}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 168, "training_iteration": 12, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-10-05", "timestamp": 1693051805, "time_this_iter_s": 82.85131049156189, "time_total_s": 966.2843995094299, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270152FA9A0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270152F7730>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 966.2843995094299, "timesteps_since_restore": 0, "iterations_since_restore": 12, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 30.22457627118644, "ram_util_percent": 71.03305084745766}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -390.30309844844044, "episode_L1_reward_sum_min": -624.4174602329731, "episode_L1_reward_sum_max": -170.0014772042632, "episode_L2_reward_sum_mean": -172.69329966202378, "episode_L2_reward_sum_min": -227.3762103766203, "episode_L2_reward_sum_max": -118.89422407746315}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.2548631495437175, "policy_loss": 0.18950971149180254, "vf_loss": 0.6535343271068332, "vf_explained_var": 0.8358819820446732, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 182000, "num_env_steps_trained": 182000, "num_agent_steps_sampled": 182000, "num_agent_steps_trained": 182000}, "sampler_results": {"episode_reward_max": -43.953957330610585, "episode_reward_min": -251.6873480395046, "episode_reward_mean": -132.25670596748157, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -390.30309844844044, "episode_L1_reward_sum_min": -624.4174602329731, "episode_L1_reward_sum_max": -170.0014772042632, "episode_L2_reward_sum_mean": -172.69329966202378, "episode_L2_reward_sum_min": -227.3762103766203, "episode_L2_reward_sum_max": -118.89422407746315}, "hist_stats": {"episode_reward": [-113.90729579793727, -213.70730434491657, -172.7806465390558, -62.49973897824755, -169.41575756237222, -113.22888081962179, -103.05588144148767, -173.00709650753024, -57.672452647186915, -141.2893577265659, -160.76012995505778, -71.2592340971741, -168.00154960646333, -45.967363724724166, -74.83886160054449, -221.88076231529053, -76.90905836210962, -86.70825033804022, -72.21159418824755, -96.74306770913665, -198.93283211109735, -178.70860671605544, -61.86859596111253, -251.6873480395046, -87.48773613211063, -94.80317469263076, -203.42052476738667, -196.38666653149326, -184.83379255155972, -46.11574113611963, -205.9566087366783, -224.1466871940928, -238.886970569353, -69.62347616991897, -125.46083451894567, -66.98207877360466, -150.99573958547785, -50.735875154577506, -67.90484745737413, -217.55354521837558, -58.01963803525159, -54.73310369527555, -222.92738057289802, -247.05684558131034, -75.39604512457146, -46.714609376457496, -46.59764471839472, -82.54626066529119, -98.76612516292282, -193.61215269678635, -135.40062763365043, -79.1889062600092, -117.15922042511865, -203.3042136498167, -141.4303300609727, -227.69400893080444, -203.2283231110316, -106.29003431659373, -175.42836980587248, -76.89976774876442, -61.738947581168134, -87.44454596742098, -56.309488690809054, -43.953957330610585, -177.17884253953574, -213.8192700978908, -58.43248700061222, -94.02339062135988, -54.71738321884991, -90.14789688884476, -46.36702506951608, -83.51484852219099, -185.55540805603158, -187.53818524696925, -216.99863331077054, -145.37542509890852, -111.1296821127772, -153.01294889287743, -179.5787842697607, -192.9932542569058, -137.42834184487904, -179.53483877595258, -56.004803857754034, -223.43174198566473, -171.16621722250417, -103.24935598836227, -121.74409471227084, -191.8741397078783, -220.05482773278618, -71.40671370314158, -69.30092264120479, -186.40818462449488, -136.36158849598823, -50.14008907480069, -130.84032363245925, -140.1955528782815, -183.37645146607187, -141.14245394230934, -234.4447813197497, -127.00519451681534], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6465218280772668, "mean_inference_ms": 5.428846379605301, "mean_action_processing_ms": 0.2030046133575513, "mean_env_wait_ms": 1.4051249037924103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -43.953957330610585, "episode_reward_min": -251.6873480395046, "episode_reward_mean": -132.25670596748157, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113.90729579793727, -213.70730434491657, -172.7806465390558, -62.49973897824755, -169.41575756237222, -113.22888081962179, -103.05588144148767, -173.00709650753024, -57.672452647186915, -141.2893577265659, -160.76012995505778, -71.2592340971741, -168.00154960646333, -45.967363724724166, -74.83886160054449, -221.88076231529053, -76.90905836210962, -86.70825033804022, -72.21159418824755, -96.74306770913665, -198.93283211109735, -178.70860671605544, -61.86859596111253, -251.6873480395046, -87.48773613211063, -94.80317469263076, -203.42052476738667, -196.38666653149326, -184.83379255155972, -46.11574113611963, -205.9566087366783, -224.1466871940928, -238.886970569353, -69.62347616991897, -125.46083451894567, -66.98207877360466, -150.99573958547785, -50.735875154577506, -67.90484745737413, -217.55354521837558, -58.01963803525159, -54.73310369527555, -222.92738057289802, -247.05684558131034, -75.39604512457146, -46.714609376457496, -46.59764471839472, -82.54626066529119, -98.76612516292282, -193.61215269678635, -135.40062763365043, -79.1889062600092, -117.15922042511865, -203.3042136498167, -141.4303300609727, -227.69400893080444, -203.2283231110316, -106.29003431659373, -175.42836980587248, -76.89976774876442, -61.738947581168134, -87.44454596742098, -56.309488690809054, -43.953957330610585, -177.17884253953574, -213.8192700978908, -58.43248700061222, -94.02339062135988, -54.71738321884991, -90.14789688884476, -46.36702506951608, -83.51484852219099, -185.55540805603158, -187.53818524696925, -216.99863331077054, -145.37542509890852, -111.1296821127772, -153.01294889287743, -179.5787842697607, -192.9932542569058, -137.42834184487904, -179.53483877595258, -56.004803857754034, -223.43174198566473, -171.16621722250417, -103.24935598836227, -121.74409471227084, -191.8741397078783, -220.05482773278618, -71.40671370314158, -69.30092264120479, -186.40818462449488, -136.36158849598823, -50.14008907480069, -130.84032363245925, -140.1955528782815, -183.37645146607187, -141.14245394230934, -234.4447813197497, -127.00519451681534], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6465218280772668, "mean_inference_ms": 5.428846379605301, "mean_action_processing_ms": 0.2030046133575513, "mean_env_wait_ms": 1.4051249037924103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 182000, "num_agent_steps_trained": 182000, "num_env_steps_sampled": 182000, "num_env_steps_trained": 182000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 182000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 182000, "timers": {"training_iteration_time_ms": 81369.905, "load_time_ms": 29.422, "load_throughput": 475830.987, "learn_time_ms": 73208.684, "learn_throughput": 191.234, "synch_weights_time_ms": 13.262}, "counters": {"num_env_steps_sampled": 182000, "num_env_steps_trained": 182000, "num_agent_steps_sampled": 182000, "num_agent_steps_trained": 182000}, "done": false, "episodes_total": 182, "training_iteration": 13, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-11-27", "timestamp": 1693051887, "time_this_iter_s": 81.45563507080078, "time_total_s": 1047.7400345802307, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701542A370>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270152FA9D0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 1047.7400345802307, "timesteps_since_restore": 0, "iterations_since_restore": 13, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 28.853913043478258, "ram_util_percent": 70.93565217391303}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -389.9459968840331, "episode_L1_reward_sum_min": -624.4174602329731, "episode_L1_reward_sum_max": -170.0014772042632, "episode_L2_reward_sum_mean": -172.61539843343198, "episode_L2_reward_sum_min": -227.3762103766203, "episode_L2_reward_sum_max": -118.89422407746315}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.25604030021394536, "policy_loss": 0.18194984311583226, "vf_loss": 0.7409045453054122, "vf_explained_var": 0.7956876747402144, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": -43.953957330610585, "episode_reward_min": -251.6873480395046, "episode_reward_mean": -132.72650983345207, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -389.9459968840331, "episode_L1_reward_sum_min": -624.4174602329731, "episode_L1_reward_sum_max": -170.0014772042632, "episode_L2_reward_sum_mean": -172.61539843343198, "episode_L2_reward_sum_min": -227.3762103766203, "episode_L2_reward_sum_max": -118.89422407746315}, "hist_stats": {"episode_reward": [-74.83886160054449, -221.88076231529053, -76.90905836210962, -86.70825033804022, -72.21159418824755, -96.74306770913665, -198.93283211109735, -178.70860671605544, -61.86859596111253, -251.6873480395046, -87.48773613211063, -94.80317469263076, -203.42052476738667, -196.38666653149326, -184.83379255155972, -46.11574113611963, -205.9566087366783, -224.1466871940928, -238.886970569353, -69.62347616991897, -125.46083451894567, -66.98207877360466, -150.99573958547785, -50.735875154577506, -67.90484745737413, -217.55354521837558, -58.01963803525159, -54.73310369527555, -222.92738057289802, -247.05684558131034, -75.39604512457146, -46.714609376457496, -46.59764471839472, -82.54626066529119, -98.76612516292282, -193.61215269678635, -135.40062763365043, -79.1889062600092, -117.15922042511865, -203.3042136498167, -141.4303300609727, -227.69400893080444, -203.2283231110316, -106.29003431659373, -175.42836980587248, -76.89976774876442, -61.738947581168134, -87.44454596742098, -56.309488690809054, -43.953957330610585, -177.17884253953574, -213.8192700978908, -58.43248700061222, -94.02339062135988, -54.71738321884991, -90.14789688884476, -46.36702506951608, -83.51484852219099, -185.55540805603158, -187.53818524696925, -216.99863331077054, -145.37542509890852, -111.1296821127772, -153.01294889287743, -179.5787842697607, -192.9932542569058, -137.42834184487904, -179.53483877595258, -56.004803857754034, -223.43174198566473, -171.16621722250417, -103.24935598836227, -121.74409471227084, -191.8741397078783, -220.05482773278618, -71.40671370314158, -69.30092264120479, -186.40818462449488, -136.36158849598823, -50.14008907480069, -130.84032363245925, -140.1955528782815, -183.37645146607187, -141.14245394230934, -234.4447813197497, -127.00519451681534, -99.0712282982465, -202.36555055209752, -66.23381581186636, -71.12866945801744, -106.21013281406327, -224.33947792573085, -156.75545937021963, -109.59314589846868, -70.33016237128395, -195.85604067812054, -103.44695297661508, -74.73987321009774, -97.8418203970945, -235.62074658347413], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6473677935783718, "mean_inference_ms": 5.443972710742869, "mean_action_processing_ms": 0.20340794802010767, "mean_env_wait_ms": 1.4102824736144544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -43.953957330610585, "episode_reward_min": -251.6873480395046, "episode_reward_mean": -132.72650983345207, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-74.83886160054449, -221.88076231529053, -76.90905836210962, -86.70825033804022, -72.21159418824755, -96.74306770913665, -198.93283211109735, -178.70860671605544, -61.86859596111253, -251.6873480395046, -87.48773613211063, -94.80317469263076, -203.42052476738667, -196.38666653149326, -184.83379255155972, -46.11574113611963, -205.9566087366783, -224.1466871940928, -238.886970569353, -69.62347616991897, -125.46083451894567, -66.98207877360466, -150.99573958547785, -50.735875154577506, -67.90484745737413, -217.55354521837558, -58.01963803525159, -54.73310369527555, -222.92738057289802, -247.05684558131034, -75.39604512457146, -46.714609376457496, -46.59764471839472, -82.54626066529119, -98.76612516292282, -193.61215269678635, -135.40062763365043, -79.1889062600092, -117.15922042511865, -203.3042136498167, -141.4303300609727, -227.69400893080444, -203.2283231110316, -106.29003431659373, -175.42836980587248, -76.89976774876442, -61.738947581168134, -87.44454596742098, -56.309488690809054, -43.953957330610585, -177.17884253953574, -213.8192700978908, -58.43248700061222, -94.02339062135988, -54.71738321884991, -90.14789688884476, -46.36702506951608, -83.51484852219099, -185.55540805603158, -187.53818524696925, -216.99863331077054, -145.37542509890852, -111.1296821127772, -153.01294889287743, -179.5787842697607, -192.9932542569058, -137.42834184487904, -179.53483877595258, -56.004803857754034, -223.43174198566473, -171.16621722250417, -103.24935598836227, -121.74409471227084, -191.8741397078783, -220.05482773278618, -71.40671370314158, -69.30092264120479, -186.40818462449488, -136.36158849598823, -50.14008907480069, -130.84032363245925, -140.1955528782815, -183.37645146607187, -141.14245394230934, -234.4447813197497, -127.00519451681534, -99.0712282982465, -202.36555055209752, -66.23381581186636, -71.12866945801744, -106.21013281406327, -224.33947792573085, -156.75545937021963, -109.59314589846868, -70.33016237128395, -195.85604067812054, -103.44695297661508, -74.73987321009774, -97.8418203970945, -235.62074658347413], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6473677935783718, "mean_inference_ms": 5.443972710742869, "mean_action_processing_ms": 0.20340794802010767, "mean_env_wait_ms": 1.4102824736144544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 196000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 81563.009, "load_time_ms": 29.323, "load_throughput": 477448.977, "learn_time_ms": 73344.442, "learn_throughput": 190.88, "synch_weights_time_ms": 13.76}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 196, "training_iteration": 14, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-12-46", "timestamp": 1693051966, "time_this_iter_s": 79.26256465911865, "time_total_s": 1127.0025992393494, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015171880>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015171A90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 1127.0025992393494, "timesteps_since_restore": 0, "iterations_since_restore": 14, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 25.723214285714285, "ram_util_percent": 70.86249999999998}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -392.11939065262675, "episode_L1_reward_sum_min": -624.4174602329731, "episode_L1_reward_sum_max": -170.0014772042632, "episode_L2_reward_sum_mean": -173.0720963639021, "episode_L2_reward_sum_min": -227.3762103766203, "episode_L2_reward_sum_max": -118.89422407746315}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.26488401281765694, "policy_loss": 0.20871851621449583, "vf_loss": 0.5616549718042747, "vf_explained_var": 0.7665179920049361, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 210000, "num_env_steps_trained": 210000, "num_agent_steps_sampled": 210000, "num_agent_steps_trained": 210000}, "sampler_results": {"episode_reward_max": -43.953957330610585, "episode_reward_min": -247.05684558131034, "episode_reward_mean": -130.59817038295498, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -392.11939065262675, "episode_L1_reward_sum_min": -624.4174602329731, "episode_L1_reward_sum_max": -170.0014772042632, "episode_L2_reward_sum_mean": -173.0720963639021, "episode_L2_reward_sum_min": -227.3762103766203, "episode_L2_reward_sum_max": -118.89422407746315}, "hist_stats": {"episode_reward": [-184.83379255155972, -46.11574113611963, -205.9566087366783, -224.1466871940928, -238.886970569353, -69.62347616991897, -125.46083451894567, -66.98207877360466, -150.99573958547785, -50.735875154577506, -67.90484745737413, -217.55354521837558, -58.01963803525159, -54.73310369527555, -222.92738057289802, -247.05684558131034, -75.39604512457146, -46.714609376457496, -46.59764471839472, -82.54626066529119, -98.76612516292282, -193.61215269678635, -135.40062763365043, -79.1889062600092, -117.15922042511865, -203.3042136498167, -141.4303300609727, -227.69400893080444, -203.2283231110316, -106.29003431659373, -175.42836980587248, -76.89976774876442, -61.738947581168134, -87.44454596742098, -56.309488690809054, -43.953957330610585, -177.17884253953574, -213.8192700978908, -58.43248700061222, -94.02339062135988, -54.71738321884991, -90.14789688884476, -46.36702506951608, -83.51484852219099, -185.55540805603158, -187.53818524696925, -216.99863331077054, -145.37542509890852, -111.1296821127772, -153.01294889287743, -179.5787842697607, -192.9932542569058, -137.42834184487904, -179.53483877595258, -56.004803857754034, -223.43174198566473, -171.16621722250417, -103.24935598836227, -121.74409471227084, -191.8741397078783, -220.05482773278618, -71.40671370314158, -69.30092264120479, -186.40818462449488, -136.36158849598823, -50.14008907480069, -130.84032363245925, -140.1955528782815, -183.37645146607187, -141.14245394230934, -234.4447813197497, -127.00519451681534, -99.0712282982465, -202.36555055209752, -66.23381581186636, -71.12866945801744, -106.21013281406327, -224.33947792573085, -156.75545937021963, -109.59314589846868, -70.33016237128395, -195.85604067812054, -103.44695297661508, -74.73987321009774, -97.8418203970945, -235.62074658347413, -79.47826789027982, -127.75640591398998, -51.072052500701936, -153.29634086746006, -137.8410323549545, -214.1447020370671, -128.85466335479052, -172.4809292489529, -72.41832705947171, -94.89830929496576, -155.54217204753644, -164.38687495099086, -79.18572154137385, -58.39733535251484], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6479043019278147, "mean_inference_ms": 5.4575311495317305, "mean_action_processing_ms": 0.2038675140611087, "mean_env_wait_ms": 1.414890798158372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -43.953957330610585, "episode_reward_min": -247.05684558131034, "episode_reward_mean": -130.59817038295498, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-184.83379255155972, -46.11574113611963, -205.9566087366783, -224.1466871940928, -238.886970569353, -69.62347616991897, -125.46083451894567, -66.98207877360466, -150.99573958547785, -50.735875154577506, -67.90484745737413, -217.55354521837558, -58.01963803525159, -54.73310369527555, -222.92738057289802, -247.05684558131034, -75.39604512457146, -46.714609376457496, -46.59764471839472, -82.54626066529119, -98.76612516292282, -193.61215269678635, -135.40062763365043, -79.1889062600092, -117.15922042511865, -203.3042136498167, -141.4303300609727, -227.69400893080444, -203.2283231110316, -106.29003431659373, -175.42836980587248, -76.89976774876442, -61.738947581168134, -87.44454596742098, -56.309488690809054, -43.953957330610585, -177.17884253953574, -213.8192700978908, -58.43248700061222, -94.02339062135988, -54.71738321884991, -90.14789688884476, -46.36702506951608, -83.51484852219099, -185.55540805603158, -187.53818524696925, -216.99863331077054, -145.37542509890852, -111.1296821127772, -153.01294889287743, -179.5787842697607, -192.9932542569058, -137.42834184487904, -179.53483877595258, -56.004803857754034, -223.43174198566473, -171.16621722250417, -103.24935598836227, -121.74409471227084, -191.8741397078783, -220.05482773278618, -71.40671370314158, -69.30092264120479, -186.40818462449488, -136.36158849598823, -50.14008907480069, -130.84032363245925, -140.1955528782815, -183.37645146607187, -141.14245394230934, -234.4447813197497, -127.00519451681534, -99.0712282982465, -202.36555055209752, -66.23381581186636, -71.12866945801744, -106.21013281406327, -224.33947792573085, -156.75545937021963, -109.59314589846868, -70.33016237128395, -195.85604067812054, -103.44695297661508, -74.73987321009774, -97.8418203970945, -235.62074658347413, -79.47826789027982, -127.75640591398998, -51.072052500701936, -153.29634086746006, -137.8410323549545, -214.1447020370671, -128.85466335479052, -172.4809292489529, -72.41832705947171, -94.89830929496576, -155.54217204753644, -164.38687495099086, -79.18572154137385, -58.39733535251484], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6479043019278147, "mean_inference_ms": 5.4575311495317305, "mean_action_processing_ms": 0.2038675140611087, "mean_env_wait_ms": 1.414890798158372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 210000, "num_agent_steps_trained": 210000, "num_env_steps_sampled": 210000, "num_env_steps_trained": 210000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 210000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 210000, "timers": {"training_iteration_time_ms": 81534.084, "load_time_ms": 29.123, "load_throughput": 480718.98, "learn_time_ms": 73246.989, "learn_throughput": 191.134, "synch_weights_time_ms": 12.963}, "counters": {"num_env_steps_sampled": 210000, "num_env_steps_trained": 210000, "num_agent_steps_sampled": 210000, "num_agent_steps_trained": 210000}, "done": false, "episodes_total": 210, "training_iteration": 15, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-14-05", "timestamp": 1693052045, "time_this_iter_s": 79.06692171096802, "time_total_s": 1206.0695209503174, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150A2280>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015204100>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 1206.0695209503174, "timesteps_since_restore": 0, "iterations_since_restore": 15, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 25.51875, "ram_util_percent": 70.87410714285714}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -378.3648004091531, "episode_L1_reward_sum_min": -624.4174602329731, "episode_L1_reward_sum_max": -170.0014772042632, "episode_L2_reward_sum_mean": -169.8845173726976, "episode_L2_reward_sum_min": -227.3762103766203, "episode_L2_reward_sum_max": -119.21067361533642}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.24207033078787932, "policy_loss": 0.18345405376773066, "vf_loss": 0.5861627746893313, "vf_explained_var": 0.5925754821656172, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "sampler_results": {"episode_reward_max": -42.931371022220546, "episode_reward_min": -247.05684558131034, "episode_reward_mean": -124.49547192880941, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -378.3648004091531, "episode_L1_reward_sum_min": -624.4174602329731, "episode_L1_reward_sum_max": -170.0014772042632, "episode_L2_reward_sum_mean": -169.8845173726976, "episode_L2_reward_sum_min": -227.3762103766203, "episode_L2_reward_sum_max": -119.21067361533642}, "hist_stats": {"episode_reward": [-222.92738057289802, -247.05684558131034, -75.39604512457146, -46.714609376457496, -46.59764471839472, -82.54626066529119, -98.76612516292282, -193.61215269678635, -135.40062763365043, -79.1889062600092, -117.15922042511865, -203.3042136498167, -141.4303300609727, -227.69400893080444, -203.2283231110316, -106.29003431659373, -175.42836980587248, -76.89976774876442, -61.738947581168134, -87.44454596742098, -56.309488690809054, -43.953957330610585, -177.17884253953574, -213.8192700978908, -58.43248700061222, -94.02339062135988, -54.71738321884991, -90.14789688884476, -46.36702506951608, -83.51484852219099, -185.55540805603158, -187.53818524696925, -216.99863331077054, -145.37542509890852, -111.1296821127772, -153.01294889287743, -179.5787842697607, -192.9932542569058, -137.42834184487904, -179.53483877595258, -56.004803857754034, -223.43174198566473, -171.16621722250417, -103.24935598836227, -121.74409471227084, -191.8741397078783, -220.05482773278618, -71.40671370314158, -69.30092264120479, -186.40818462449488, -136.36158849598823, -50.14008907480069, -130.84032363245925, -140.1955528782815, -183.37645146607187, -141.14245394230934, -234.4447813197497, -127.00519451681534, -99.0712282982465, -202.36555055209752, -66.23381581186636, -71.12866945801744, -106.21013281406327, -224.33947792573085, -156.75545937021963, -109.59314589846868, -70.33016237128395, -195.85604067812054, -103.44695297661508, -74.73987321009774, -97.8418203970945, -235.62074658347413, -79.47826789027982, -127.75640591398998, -51.072052500701936, -153.29634086746006, -137.8410323549545, -214.1447020370671, -128.85466335479052, -172.4809292489529, -72.41832705947171, -94.89830929496576, -155.54217204753644, -164.38687495099086, -79.18572154137385, -58.39733535251484, -142.28140571388246, -42.931371022220546, -83.92579241057983, -63.037918394471966, -53.54605934245362, -112.26216098999461, -96.14773799805751, -48.660194504032624, -110.44080917291843, -82.12751003365797, -117.70987164096144, -52.75814972444358, -64.19853863962366, -81.65157379475002], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6470028134579694, "mean_inference_ms": 5.467030714920029, "mean_action_processing_ms": 0.20408847947080505, "mean_env_wait_ms": 1.4182192652145875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -42.931371022220546, "episode_reward_min": -247.05684558131034, "episode_reward_mean": -124.49547192880941, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-222.92738057289802, -247.05684558131034, -75.39604512457146, -46.714609376457496, -46.59764471839472, -82.54626066529119, -98.76612516292282, -193.61215269678635, -135.40062763365043, -79.1889062600092, -117.15922042511865, -203.3042136498167, -141.4303300609727, -227.69400893080444, -203.2283231110316, -106.29003431659373, -175.42836980587248, -76.89976774876442, -61.738947581168134, -87.44454596742098, -56.309488690809054, -43.953957330610585, -177.17884253953574, -213.8192700978908, -58.43248700061222, -94.02339062135988, -54.71738321884991, -90.14789688884476, -46.36702506951608, -83.51484852219099, -185.55540805603158, -187.53818524696925, -216.99863331077054, -145.37542509890852, -111.1296821127772, -153.01294889287743, -179.5787842697607, -192.9932542569058, -137.42834184487904, -179.53483877595258, -56.004803857754034, -223.43174198566473, -171.16621722250417, -103.24935598836227, -121.74409471227084, -191.8741397078783, -220.05482773278618, -71.40671370314158, -69.30092264120479, -186.40818462449488, -136.36158849598823, -50.14008907480069, -130.84032363245925, -140.1955528782815, -183.37645146607187, -141.14245394230934, -234.4447813197497, -127.00519451681534, -99.0712282982465, -202.36555055209752, -66.23381581186636, -71.12866945801744, -106.21013281406327, -224.33947792573085, -156.75545937021963, -109.59314589846868, -70.33016237128395, -195.85604067812054, -103.44695297661508, -74.73987321009774, -97.8418203970945, -235.62074658347413, -79.47826789027982, -127.75640591398998, -51.072052500701936, -153.29634086746006, -137.8410323549545, -214.1447020370671, -128.85466335479052, -172.4809292489529, -72.41832705947171, -94.89830929496576, -155.54217204753644, -164.38687495099086, -79.18572154137385, -58.39733535251484, -142.28140571388246, -42.931371022220546, -83.92579241057983, -63.037918394471966, -53.54605934245362, -112.26216098999461, -96.14773799805751, -48.660194504032624, -110.44080917291843, -82.12751003365797, -117.70987164096144, -52.75814972444358, -64.19853863962366, -81.65157379475002], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6470028134579694, "mean_inference_ms": 5.467030714920029, "mean_action_processing_ms": 0.20408847947080505, "mean_env_wait_ms": 1.4182192652145875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 224000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 81208.529, "load_time_ms": 28.923, "load_throughput": 484039.27, "learn_time_ms": 72995.655, "learn_throughput": 191.792, "synch_weights_time_ms": 13.86}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "episodes_total": 224, "training_iteration": 16, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-15-23", "timestamp": 1693052123, "time_this_iter_s": 77.88568353652954, "time_total_s": 1283.955204486847, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270129AB490>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701543EA90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 1283.955204486847, "timesteps_since_restore": 0, "iterations_since_restore": 16, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 23.618181818181817, "ram_util_percent": 70.8772727272727}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -358.40664416715504, "episode_L1_reward_sum_min": -624.4174602329731, "episode_L1_reward_sum_max": -170.0014772042632, "episode_L2_reward_sum_mean": -165.07437811650337, "episode_L2_reward_sum_min": -225.6753263771534, "episode_L2_reward_sum_max": -119.21067361533642}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.21862092470307548, "policy_loss": 0.16296261718588662, "vf_loss": 0.5565830625472872, "vf_explained_var": 0.5532630999331121, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 238000, "num_env_steps_trained": 238000, "num_agent_steps_sampled": 238000, "num_agent_steps_trained": 238000}, "sampler_results": {"episode_reward_max": -42.931371022220546, "episode_reward_min": -235.62074658347413, "episode_reward_mean": -117.66500497534082, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -358.40664416715504, "episode_L1_reward_sum_min": -624.4174602329731, "episode_L1_reward_sum_max": -170.0014772042632, "episode_L2_reward_sum_mean": -165.07437811650337, "episode_L2_reward_sum_min": -225.6753263771534, "episode_L2_reward_sum_max": -119.21067361533642}, "hist_stats": {"episode_reward": [-203.2283231110316, -106.29003431659373, -175.42836980587248, -76.89976774876442, -61.738947581168134, -87.44454596742098, -56.309488690809054, -43.953957330610585, -177.17884253953574, -213.8192700978908, -58.43248700061222, -94.02339062135988, -54.71738321884991, -90.14789688884476, -46.36702506951608, -83.51484852219099, -185.55540805603158, -187.53818524696925, -216.99863331077054, -145.37542509890852, -111.1296821127772, -153.01294889287743, -179.5787842697607, -192.9932542569058, -137.42834184487904, -179.53483877595258, -56.004803857754034, -223.43174198566473, -171.16621722250417, -103.24935598836227, -121.74409471227084, -191.8741397078783, -220.05482773278618, -71.40671370314158, -69.30092264120479, -186.40818462449488, -136.36158849598823, -50.14008907480069, -130.84032363245925, -140.1955528782815, -183.37645146607187, -141.14245394230934, -234.4447813197497, -127.00519451681534, -99.0712282982465, -202.36555055209752, -66.23381581186636, -71.12866945801744, -106.21013281406327, -224.33947792573085, -156.75545937021963, -109.59314589846868, -70.33016237128395, -195.85604067812054, -103.44695297661508, -74.73987321009774, -97.8418203970945, -235.62074658347413, -79.47826789027982, -127.75640591398998, -51.072052500701936, -153.29634086746006, -137.8410323549545, -214.1447020370671, -128.85466335479052, -172.4809292489529, -72.41832705947171, -94.89830929496576, -155.54217204753644, -164.38687495099086, -79.18572154137385, -58.39733535251484, -142.28140571388246, -42.931371022220546, -83.92579241057983, -63.037918394471966, -53.54605934245362, -112.26216098999461, -96.14773799805751, -48.660194504032624, -110.44080917291843, -82.12751003365797, -117.70987164096144, -52.75814972444358, -64.19853863962366, -81.65157379475002, -114.80393247179741, -88.45258047893567, -69.83989526873792, -69.00473134024577, -128.2721193817118, -67.26158734392006, -82.92954042594529, -92.23831892738875, -58.91184595744484, -129.46625014626935, -86.73802868671721, -96.36706696854037, -98.58379397675294, -51.877984137738686], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6463318348402437, "mean_inference_ms": 5.472289514194719, "mean_action_processing_ms": 0.2042391043681026, "mean_env_wait_ms": 1.4201292330885105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -42.931371022220546, "episode_reward_min": -235.62074658347413, "episode_reward_mean": -117.66500497534082, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-203.2283231110316, -106.29003431659373, -175.42836980587248, -76.89976774876442, -61.738947581168134, -87.44454596742098, -56.309488690809054, -43.953957330610585, -177.17884253953574, -213.8192700978908, -58.43248700061222, -94.02339062135988, -54.71738321884991, -90.14789688884476, -46.36702506951608, -83.51484852219099, -185.55540805603158, -187.53818524696925, -216.99863331077054, -145.37542509890852, -111.1296821127772, -153.01294889287743, -179.5787842697607, -192.9932542569058, -137.42834184487904, -179.53483877595258, -56.004803857754034, -223.43174198566473, -171.16621722250417, -103.24935598836227, -121.74409471227084, -191.8741397078783, -220.05482773278618, -71.40671370314158, -69.30092264120479, -186.40818462449488, -136.36158849598823, -50.14008907480069, -130.84032363245925, -140.1955528782815, -183.37645146607187, -141.14245394230934, -234.4447813197497, -127.00519451681534, -99.0712282982465, -202.36555055209752, -66.23381581186636, -71.12866945801744, -106.21013281406327, -224.33947792573085, -156.75545937021963, -109.59314589846868, -70.33016237128395, -195.85604067812054, -103.44695297661508, -74.73987321009774, -97.8418203970945, -235.62074658347413, -79.47826789027982, -127.75640591398998, -51.072052500701936, -153.29634086746006, -137.8410323549545, -214.1447020370671, -128.85466335479052, -172.4809292489529, -72.41832705947171, -94.89830929496576, -155.54217204753644, -164.38687495099086, -79.18572154137385, -58.39733535251484, -142.28140571388246, -42.931371022220546, -83.92579241057983, -63.037918394471966, -53.54605934245362, -112.26216098999461, -96.14773799805751, -48.660194504032624, -110.44080917291843, -82.12751003365797, -117.70987164096144, -52.75814972444358, -64.19853863962366, -81.65157379475002, -114.80393247179741, -88.45258047893567, -69.83989526873792, -69.00473134024577, -128.2721193817118, -67.26158734392006, -82.92954042594529, -92.23831892738875, -58.91184595744484, -129.46625014626935, -86.73802868671721, -96.36706696854037, -98.58379397675294, -51.877984137738686], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6463318348402437, "mean_inference_ms": 5.472289514194719, "mean_action_processing_ms": 0.2042391043681026, "mean_env_wait_ms": 1.4201292330885105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 238000, "num_agent_steps_trained": 238000, "num_env_steps_sampled": 238000, "num_env_steps_trained": 238000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 238000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 238000, "timers": {"training_iteration_time_ms": 80753.192, "load_time_ms": 29.522, "load_throughput": 474228.905, "learn_time_ms": 72668.271, "learn_throughput": 192.656, "synch_weights_time_ms": 14.059}, "counters": {"num_env_steps_sampled": 238000, "num_env_steps_trained": 238000, "num_agent_steps_sampled": 238000, "num_agent_steps_trained": 238000}, "done": false, "episodes_total": 238, "training_iteration": 17, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-16-41", "timestamp": 1693052201, "time_this_iter_s": 78.10761666297913, "time_total_s": 1362.062821149826, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014F646A0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270152603A0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 1362.062821149826, "timesteps_since_restore": 0, "iterations_since_restore": 17, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 24.48738738738739, "ram_util_percent": 70.53873873873874}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -355.56224700719116, "episode_L1_reward_sum_min": -624.4174602329731, "episode_L1_reward_sum_max": -170.0014772042632, "episode_L2_reward_sum_mean": -164.53770816229283, "episode_L2_reward_sum_min": -225.6753263771534, "episode_L2_reward_sum_max": -119.21067361533642}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.25030786672141353, "policy_loss": 0.19196815061946207, "vf_loss": 0.583397157380778, "vf_explained_var": 0.7050155631492658, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": -35.50859789153477, "episode_reward_min": -235.62074658347413, "episode_reward_mean": -116.8504560158713, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -355.56224700719116, "episode_L1_reward_sum_min": -624.4174602329731, "episode_L1_reward_sum_max": -170.0014772042632, "episode_L2_reward_sum_mean": -164.53770816229283, "episode_L2_reward_sum_min": -225.6753263771534, "episode_L2_reward_sum_max": -119.21067361533642}, "hist_stats": {"episode_reward": [-46.36702506951608, -83.51484852219099, -185.55540805603158, -187.53818524696925, -216.99863331077054, -145.37542509890852, -111.1296821127772, -153.01294889287743, -179.5787842697607, -192.9932542569058, -137.42834184487904, -179.53483877595258, -56.004803857754034, -223.43174198566473, -171.16621722250417, -103.24935598836227, -121.74409471227084, -191.8741397078783, -220.05482773278618, -71.40671370314158, -69.30092264120479, -186.40818462449488, -136.36158849598823, -50.14008907480069, -130.84032363245925, -140.1955528782815, -183.37645146607187, -141.14245394230934, -234.4447813197497, -127.00519451681534, -99.0712282982465, -202.36555055209752, -66.23381581186636, -71.12866945801744, -106.21013281406327, -224.33947792573085, -156.75545937021963, -109.59314589846868, -70.33016237128395, -195.85604067812054, -103.44695297661508, -74.73987321009774, -97.8418203970945, -235.62074658347413, -79.47826789027982, -127.75640591398998, -51.072052500701936, -153.29634086746006, -137.8410323549545, -214.1447020370671, -128.85466335479052, -172.4809292489529, -72.41832705947171, -94.89830929496576, -155.54217204753644, -164.38687495099086, -79.18572154137385, -58.39733535251484, -142.28140571388246, -42.931371022220546, -83.92579241057983, -63.037918394471966, -53.54605934245362, -112.26216098999461, -96.14773799805751, -48.660194504032624, -110.44080917291843, -82.12751003365797, -117.70987164096144, -52.75814972444358, -64.19853863962366, -81.65157379475002, -114.80393247179741, -88.45258047893567, -69.83989526873792, -69.00473134024577, -128.2721193817118, -67.26158734392006, -82.92954042594529, -92.23831892738875, -58.91184595744484, -129.46625014626935, -86.73802868671721, -96.36706696854037, -98.58379397675294, -51.877984137738686, -130.8089210403914, -139.48891725145197, -121.16509262028657, -69.46701383541571, -70.84100903908929, -85.27969888065954, -134.45568348377552, -69.39778617414177, -173.03723138254514, -89.85979949413904, -58.08020125358754, -107.46081045661984, -133.30704616877216, -35.50859789153477], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.645444228008136, "mean_inference_ms": 5.470324769708618, "mean_action_processing_ms": 0.20408083836131932, "mean_env_wait_ms": 1.4200564166241145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -35.50859789153477, "episode_reward_min": -235.62074658347413, "episode_reward_mean": -116.8504560158713, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-46.36702506951608, -83.51484852219099, -185.55540805603158, -187.53818524696925, -216.99863331077054, -145.37542509890852, -111.1296821127772, -153.01294889287743, -179.5787842697607, -192.9932542569058, -137.42834184487904, -179.53483877595258, -56.004803857754034, -223.43174198566473, -171.16621722250417, -103.24935598836227, -121.74409471227084, -191.8741397078783, -220.05482773278618, -71.40671370314158, -69.30092264120479, -186.40818462449488, -136.36158849598823, -50.14008907480069, -130.84032363245925, -140.1955528782815, -183.37645146607187, -141.14245394230934, -234.4447813197497, -127.00519451681534, -99.0712282982465, -202.36555055209752, -66.23381581186636, -71.12866945801744, -106.21013281406327, -224.33947792573085, -156.75545937021963, -109.59314589846868, -70.33016237128395, -195.85604067812054, -103.44695297661508, -74.73987321009774, -97.8418203970945, -235.62074658347413, -79.47826789027982, -127.75640591398998, -51.072052500701936, -153.29634086746006, -137.8410323549545, -214.1447020370671, -128.85466335479052, -172.4809292489529, -72.41832705947171, -94.89830929496576, -155.54217204753644, -164.38687495099086, -79.18572154137385, -58.39733535251484, -142.28140571388246, -42.931371022220546, -83.92579241057983, -63.037918394471966, -53.54605934245362, -112.26216098999461, -96.14773799805751, -48.660194504032624, -110.44080917291843, -82.12751003365797, -117.70987164096144, -52.75814972444358, -64.19853863962366, -81.65157379475002, -114.80393247179741, -88.45258047893567, -69.83989526873792, -69.00473134024577, -128.2721193817118, -67.26158734392006, -82.92954042594529, -92.23831892738875, -58.91184595744484, -129.46625014626935, -86.73802868671721, -96.36706696854037, -98.58379397675294, -51.877984137738686, -130.8089210403914, -139.48891725145197, -121.16509262028657, -69.46701383541571, -70.84100903908929, -85.27969888065954, -134.45568348377552, -69.39778617414177, -173.03723138254514, -89.85979949413904, -58.08020125358754, -107.46081045661984, -133.30704616877216, -35.50859789153477], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.645444228008136, "mean_inference_ms": 5.470324769708618, "mean_action_processing_ms": 0.20408083836131932, "mean_env_wait_ms": 1.4200564166241145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 252000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 80556.63, "load_time_ms": 28.624, "load_throughput": 489099.476, "learn_time_ms": 72503.126, "learn_throughput": 193.095, "synch_weights_time_ms": 13.956}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 252, "training_iteration": 18, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-18-00", "timestamp": 1693052280, "time_this_iter_s": 78.65860748291016, "time_total_s": 1440.7214286327362, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701516FB50>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701522C0D0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 1440.7214286327362, "timesteps_since_restore": 0, "iterations_since_restore": 18, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 24.916216216216213, "ram_util_percent": 70.5072072072072}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -325.34109436780216, "episode_L1_reward_sum_min": -612.0047866404057, "episode_L1_reward_sum_max": -170.73681887984276, "episode_L2_reward_sum_mean": -157.35969389908016, "episode_L2_reward_sum_min": -225.60654163360596, "episode_L2_reward_sum_max": -118.17989882081747}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.21106550358849052, "policy_loss": 0.17270514757636887, "vf_loss": 0.3836035741693866, "vf_explained_var": 0.6085827786613394, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 266000, "num_env_steps_trained": 266000, "num_agent_steps_sampled": 266000, "num_agent_steps_trained": 266000}, "sampler_results": {"episode_reward_max": -35.50859789153477, "episode_reward_min": -235.62074658347413, "episode_reward_mean": -106.80238729329596, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -325.34109436780216, "episode_L1_reward_sum_min": -612.0047866404057, "episode_L1_reward_sum_max": -170.73681887984276, "episode_L2_reward_sum_mean": -157.35969389908016, "episode_L2_reward_sum_min": -225.60654163360596, "episode_L2_reward_sum_max": -118.17989882081747}, "hist_stats": {"episode_reward": [-171.16621722250417, -103.24935598836227, -121.74409471227084, -191.8741397078783, -220.05482773278618, -71.40671370314158, -69.30092264120479, -186.40818462449488, -136.36158849598823, -50.14008907480069, -130.84032363245925, -140.1955528782815, -183.37645146607187, -141.14245394230934, -234.4447813197497, -127.00519451681534, -99.0712282982465, -202.36555055209752, -66.23381581186636, -71.12866945801744, -106.21013281406327, -224.33947792573085, -156.75545937021963, -109.59314589846868, -70.33016237128395, -195.85604067812054, -103.44695297661508, -74.73987321009774, -97.8418203970945, -235.62074658347413, -79.47826789027982, -127.75640591398998, -51.072052500701936, -153.29634086746006, -137.8410323549545, -214.1447020370671, -128.85466335479052, -172.4809292489529, -72.41832705947171, -94.89830929496576, -155.54217204753644, -164.38687495099086, -79.18572154137385, -58.39733535251484, -142.28140571388246, -42.931371022220546, -83.92579241057983, -63.037918394471966, -53.54605934245362, -112.26216098999461, -96.14773799805751, -48.660194504032624, -110.44080917291843, -82.12751003365797, -117.70987164096144, -52.75814972444358, -64.19853863962366, -81.65157379475002, -114.80393247179741, -88.45258047893567, -69.83989526873792, -69.00473134024577, -128.2721193817118, -67.26158734392006, -82.92954042594529, -92.23831892738875, -58.91184595744484, -129.46625014626935, -86.73802868671721, -96.36706696854037, -98.58379397675294, -51.877984137738686, -130.8089210403914, -139.48891725145197, -121.16509262028657, -69.46701383541571, -70.84100903908929, -85.27969888065954, -134.45568348377552, -69.39778617414177, -173.03723138254514, -89.85979949413904, -58.08020125358754, -107.46081045661984, -133.30704616877216, -35.50859789153477, -46.987716168050085, -92.61604659885738, -73.49672886062483, -76.19191086227906, -114.22641980734731, -54.42163680416536, -77.14847461795526, -76.3532401009025, -84.91396675806108, -97.024331184208, -105.99791583642906, -66.29016222863385, -89.67997096606345, -38.30852824984994], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.644423956759738, "mean_inference_ms": 5.469732974477936, "mean_action_processing_ms": 0.20406230498982736, "mean_env_wait_ms": 1.4202077284341386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -35.50859789153477, "episode_reward_min": -235.62074658347413, "episode_reward_mean": -106.80238729329596, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-171.16621722250417, -103.24935598836227, -121.74409471227084, -191.8741397078783, -220.05482773278618, -71.40671370314158, -69.30092264120479, -186.40818462449488, -136.36158849598823, -50.14008907480069, -130.84032363245925, -140.1955528782815, -183.37645146607187, -141.14245394230934, -234.4447813197497, -127.00519451681534, -99.0712282982465, -202.36555055209752, -66.23381581186636, -71.12866945801744, -106.21013281406327, -224.33947792573085, -156.75545937021963, -109.59314589846868, -70.33016237128395, -195.85604067812054, -103.44695297661508, -74.73987321009774, -97.8418203970945, -235.62074658347413, -79.47826789027982, -127.75640591398998, -51.072052500701936, -153.29634086746006, -137.8410323549545, -214.1447020370671, -128.85466335479052, -172.4809292489529, -72.41832705947171, -94.89830929496576, -155.54217204753644, -164.38687495099086, -79.18572154137385, -58.39733535251484, -142.28140571388246, -42.931371022220546, -83.92579241057983, -63.037918394471966, -53.54605934245362, -112.26216098999461, -96.14773799805751, -48.660194504032624, -110.44080917291843, -82.12751003365797, -117.70987164096144, -52.75814972444358, -64.19853863962366, -81.65157379475002, -114.80393247179741, -88.45258047893567, -69.83989526873792, -69.00473134024577, -128.2721193817118, -67.26158734392006, -82.92954042594529, -92.23831892738875, -58.91184595744484, -129.46625014626935, -86.73802868671721, -96.36706696854037, -98.58379397675294, -51.877984137738686, -130.8089210403914, -139.48891725145197, -121.16509262028657, -69.46701383541571, -70.84100903908929, -85.27969888065954, -134.45568348377552, -69.39778617414177, -173.03723138254514, -89.85979949413904, -58.08020125358754, -107.46081045661984, -133.30704616877216, -35.50859789153477, -46.987716168050085, -92.61604659885738, -73.49672886062483, -76.19191086227906, -114.22641980734731, -54.42163680416536, -77.14847461795526, -76.3532401009025, -84.91396675806108, -97.024331184208, -105.99791583642906, -66.29016222863385, -89.67997096606345, -38.30852824984994], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.644423956759738, "mean_inference_ms": 5.469732974477936, "mean_action_processing_ms": 0.20406230498982736, "mean_env_wait_ms": 1.4202077284341386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 266000, "num_agent_steps_trained": 266000, "num_env_steps_sampled": 266000, "num_env_steps_trained": 266000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 266000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 266000, "timers": {"training_iteration_time_ms": 79932.468, "load_time_ms": 28.325, "load_throughput": 494268.68, "learn_time_ms": 71914.456, "learn_throughput": 194.676, "synch_weights_time_ms": 13.259}, "counters": {"num_env_steps_sampled": 266000, "num_env_steps_trained": 266000, "num_agent_steps_sampled": 266000, "num_agent_steps_trained": 266000}, "done": false, "episodes_total": 266, "training_iteration": 19, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-19-22", "timestamp": 1693052362, "time_this_iter_s": 81.40799355506897, "time_total_s": 1522.1294221878052, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015435FA0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701517ABE0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 1522.1294221878052, "timesteps_since_restore": 0, "iterations_since_restore": 19, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 29.277391304347827, "ram_util_percent": 70.58000000000001}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -303.97297227948906, "episode_L1_reward_sum_min": -612.0047866404057, "episode_L1_reward_sum_max": -170.73681887984276, "episode_L2_reward_sum_mean": -152.2405441173911, "episode_L2_reward_sum_min": -225.60654163360596, "episode_L2_reward_sum_max": -118.17989882081747}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.20633810731810384, "policy_loss": 0.16095233855672264, "vf_loss": 0.4538576666563795, "vf_explained_var": 0.577341012779332, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "sampler_results": {"episode_reward_max": -35.50859789153477, "episode_reward_min": -235.62074658347413, "episode_reward_mean": -99.64753185178388, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -303.97297227948906, "episode_L1_reward_sum_min": -612.0047866404057, "episode_L1_reward_sum_max": -170.73681887984276, "episode_L2_reward_sum_mean": -152.2405441173911, "episode_L2_reward_sum_min": -225.60654163360596, "episode_L2_reward_sum_max": -118.17989882081747}, "hist_stats": {"episode_reward": [-234.4447813197497, -127.00519451681534, -99.0712282982465, -202.36555055209752, -66.23381581186636, -71.12866945801744, -106.21013281406327, -224.33947792573085, -156.75545937021963, -109.59314589846868, -70.33016237128395, -195.85604067812054, -103.44695297661508, -74.73987321009774, -97.8418203970945, -235.62074658347413, -79.47826789027982, -127.75640591398998, -51.072052500701936, -153.29634086746006, -137.8410323549545, -214.1447020370671, -128.85466335479052, -172.4809292489529, -72.41832705947171, -94.89830929496576, -155.54217204753644, -164.38687495099086, -79.18572154137385, -58.39733535251484, -142.28140571388246, -42.931371022220546, -83.92579241057983, -63.037918394471966, -53.54605934245362, -112.26216098999461, -96.14773799805751, -48.660194504032624, -110.44080917291843, -82.12751003365797, -117.70987164096144, -52.75814972444358, -64.19853863962366, -81.65157379475002, -114.80393247179741, -88.45258047893567, -69.83989526873792, -69.00473134024577, -128.2721193817118, -67.26158734392006, -82.92954042594529, -92.23831892738875, -58.91184595744484, -129.46625014626935, -86.73802868671721, -96.36706696854037, -98.58379397675294, -51.877984137738686, -130.8089210403914, -139.48891725145197, -121.16509262028657, -69.46701383541571, -70.84100903908929, -85.27969888065954, -134.45568348377552, -69.39778617414177, -173.03723138254514, -89.85979949413904, -58.08020125358754, -107.46081045661984, -133.30704616877216, -35.50859789153477, -46.987716168050085, -92.61604659885738, -73.49672886062483, -76.19191086227906, -114.22641980734731, -54.42163680416536, -77.14847461795526, -76.3532401009025, -84.91396675806108, -97.024331184208, -105.99791583642906, -66.29016222863385, -89.67997096606345, -38.30852824984994, -113.08364019596881, -155.57510288408986, -73.98333659324302, -56.85295447470406, -63.540492599457224, -82.9046790818409, -74.42304125687723, -55.45240224896914, -63.89942593903741, -84.79743668059166, -142.49838094056153, -98.9566531195982, -42.59852055624084, -93.2093051001649], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6432155235480737, "mean_inference_ms": 5.469862924790286, "mean_action_processing_ms": 0.20415479052334173, "mean_env_wait_ms": 1.4203645970993641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -35.50859789153477, "episode_reward_min": -235.62074658347413, "episode_reward_mean": -99.64753185178388, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-234.4447813197497, -127.00519451681534, -99.0712282982465, -202.36555055209752, -66.23381581186636, -71.12866945801744, -106.21013281406327, -224.33947792573085, -156.75545937021963, -109.59314589846868, -70.33016237128395, -195.85604067812054, -103.44695297661508, -74.73987321009774, -97.8418203970945, -235.62074658347413, -79.47826789027982, -127.75640591398998, -51.072052500701936, -153.29634086746006, -137.8410323549545, -214.1447020370671, -128.85466335479052, -172.4809292489529, -72.41832705947171, -94.89830929496576, -155.54217204753644, -164.38687495099086, -79.18572154137385, -58.39733535251484, -142.28140571388246, -42.931371022220546, -83.92579241057983, -63.037918394471966, -53.54605934245362, -112.26216098999461, -96.14773799805751, -48.660194504032624, -110.44080917291843, -82.12751003365797, -117.70987164096144, -52.75814972444358, -64.19853863962366, -81.65157379475002, -114.80393247179741, -88.45258047893567, -69.83989526873792, -69.00473134024577, -128.2721193817118, -67.26158734392006, -82.92954042594529, -92.23831892738875, -58.91184595744484, -129.46625014626935, -86.73802868671721, -96.36706696854037, -98.58379397675294, -51.877984137738686, -130.8089210403914, -139.48891725145197, -121.16509262028657, -69.46701383541571, -70.84100903908929, -85.27969888065954, -134.45568348377552, -69.39778617414177, -173.03723138254514, -89.85979949413904, -58.08020125358754, -107.46081045661984, -133.30704616877216, -35.50859789153477, -46.987716168050085, -92.61604659885738, -73.49672886062483, -76.19191086227906, -114.22641980734731, -54.42163680416536, -77.14847461795526, -76.3532401009025, -84.91396675806108, -97.024331184208, -105.99791583642906, -66.29016222863385, -89.67997096606345, -38.30852824984994, -113.08364019596881, -155.57510288408986, -73.98333659324302, -56.85295447470406, -63.540492599457224, -82.9046790818409, -74.42304125687723, -55.45240224896914, -63.89942593903741, -84.79743668059166, -142.49838094056153, -98.9566531195982, -42.59852055624084, -93.2093051001649], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6432155235480737, "mean_inference_ms": 5.469862924790286, "mean_action_processing_ms": 0.20415479052334173, "mean_env_wait_ms": 1.4203645970993641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 280000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 79940.91, "load_time_ms": 28.724, "load_throughput": 487403.319, "learn_time_ms": 71831.358, "learn_throughput": 194.901, "synch_weights_time_ms": 13.658}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "episodes_total": 280, "training_iteration": 20, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-20-42", "timestamp": 1693052442, "time_this_iter_s": 80.42693877220154, "time_total_s": 1602.5563609600067, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015238340>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701523CC10>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 1602.5563609600067, "timesteps_since_restore": 0, "iterations_since_restore": 20, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 27.62456140350877, "ram_util_percent": 70.50877192982458}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -295.8573416510224, "episode_L1_reward_sum_min": -612.0047866404057, "episode_L1_reward_sum_max": -170.73681887984276, "episode_L2_reward_sum_mean": -150.39502153664827, "episode_L2_reward_sum_min": -225.60654163360596, "episode_L2_reward_sum_max": -118.17989882081747}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.21949355056295708, "policy_loss": 0.15041410174736286, "vf_loss": 0.6907944636236149, "vf_explained_var": 0.6770494931028703, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 294000, "num_env_steps_trained": 294000, "num_agent_steps_sampled": 294000, "num_agent_steps_trained": 294000}, "sampler_results": {"episode_reward_max": -35.50859789153477, "episode_reward_min": -235.62074658347413, "episode_reward_mean": -96.43265033340725, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -295.8573416510224, "episode_L1_reward_sum_min": -612.0047866404057, "episode_L1_reward_sum_max": -170.73681887984276, "episode_L2_reward_sum_mean": -150.39502153664827, "episode_L2_reward_sum_min": -225.60654163360596, "episode_L2_reward_sum_max": -118.17989882081747}, "hist_stats": {"episode_reward": [-97.8418203970945, -235.62074658347413, -79.47826789027982, -127.75640591398998, -51.072052500701936, -153.29634086746006, -137.8410323549545, -214.1447020370671, -128.85466335479052, -172.4809292489529, -72.41832705947171, -94.89830929496576, -155.54217204753644, -164.38687495099086, -79.18572154137385, -58.39733535251484, -142.28140571388246, -42.931371022220546, -83.92579241057983, -63.037918394471966, -53.54605934245362, -112.26216098999461, -96.14773799805751, -48.660194504032624, -110.44080917291843, -82.12751003365797, -117.70987164096144, -52.75814972444358, -64.19853863962366, -81.65157379475002, -114.80393247179741, -88.45258047893567, -69.83989526873792, -69.00473134024577, -128.2721193817118, -67.26158734392006, -82.92954042594529, -92.23831892738875, -58.91184595744484, -129.46625014626935, -86.73802868671721, -96.36706696854037, -98.58379397675294, -51.877984137738686, -130.8089210403914, -139.48891725145197, -121.16509262028657, -69.46701383541571, -70.84100903908929, -85.27969888065954, -134.45568348377552, -69.39778617414177, -173.03723138254514, -89.85979949413904, -58.08020125358754, -107.46081045661984, -133.30704616877216, -35.50859789153477, -46.987716168050085, -92.61604659885738, -73.49672886062483, -76.19191086227906, -114.22641980734731, -54.42163680416536, -77.14847461795526, -76.3532401009025, -84.91396675806108, -97.024331184208, -105.99791583642906, -66.29016222863385, -89.67997096606345, -38.30852824984994, -113.08364019596881, -155.57510288408986, -73.98333659324302, -56.85295447470406, -63.540492599457224, -82.9046790818409, -74.42304125687723, -55.45240224896914, -63.89942593903741, -84.79743668059166, -142.49838094056153, -98.9566531195982, -42.59852055624084, -93.2093051001649, -151.9378419582124, -136.6277488193511, -109.02739611300827, -67.12111677004378, -140.68571172731134, -55.84403707544652, -75.06664356510163, -199.1977226349603, -50.24904795959949, -63.80068241189106, -80.63495162196992, -169.30284355491798, -100.48293765814219, -120.05365149377465], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6420695309125187, "mean_inference_ms": 5.471679797115181, "mean_action_processing_ms": 0.2042558740079494, "mean_env_wait_ms": 1.4209107613706187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -35.50859789153477, "episode_reward_min": -235.62074658347413, "episode_reward_mean": -96.43265033340725, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-97.8418203970945, -235.62074658347413, -79.47826789027982, -127.75640591398998, -51.072052500701936, -153.29634086746006, -137.8410323549545, -214.1447020370671, -128.85466335479052, -172.4809292489529, -72.41832705947171, -94.89830929496576, -155.54217204753644, -164.38687495099086, -79.18572154137385, -58.39733535251484, -142.28140571388246, -42.931371022220546, -83.92579241057983, -63.037918394471966, -53.54605934245362, -112.26216098999461, -96.14773799805751, -48.660194504032624, -110.44080917291843, -82.12751003365797, -117.70987164096144, -52.75814972444358, -64.19853863962366, -81.65157379475002, -114.80393247179741, -88.45258047893567, -69.83989526873792, -69.00473134024577, -128.2721193817118, -67.26158734392006, -82.92954042594529, -92.23831892738875, -58.91184595744484, -129.46625014626935, -86.73802868671721, -96.36706696854037, -98.58379397675294, -51.877984137738686, -130.8089210403914, -139.48891725145197, -121.16509262028657, -69.46701383541571, -70.84100903908929, -85.27969888065954, -134.45568348377552, -69.39778617414177, -173.03723138254514, -89.85979949413904, -58.08020125358754, -107.46081045661984, -133.30704616877216, -35.50859789153477, -46.987716168050085, -92.61604659885738, -73.49672886062483, -76.19191086227906, -114.22641980734731, -54.42163680416536, -77.14847461795526, -76.3532401009025, -84.91396675806108, -97.024331184208, -105.99791583642906, -66.29016222863385, -89.67997096606345, -38.30852824984994, -113.08364019596881, -155.57510288408986, -73.98333659324302, -56.85295447470406, -63.540492599457224, -82.9046790818409, -74.42304125687723, -55.45240224896914, -63.89942593903741, -84.79743668059166, -142.49838094056153, -98.9566531195982, -42.59852055624084, -93.2093051001649, -151.9378419582124, -136.6277488193511, -109.02739611300827, -67.12111677004378, -140.68571172731134, -55.84403707544652, -75.06664356510163, -199.1977226349603, -50.24904795959949, -63.80068241189106, -80.63495162196992, -169.30284355491798, -100.48293765814219, -120.05365149377465], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6420695309125187, "mean_inference_ms": 5.471679797115181, "mean_action_processing_ms": 0.2042558740079494, "mean_env_wait_ms": 1.4209107613706187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 294000, "num_agent_steps_trained": 294000, "num_env_steps_sampled": 294000, "num_env_steps_trained": 294000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 294000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 294000, "timers": {"training_iteration_time_ms": 79893.209, "load_time_ms": 29.125, "load_throughput": 480690.252, "learn_time_ms": 71821.685, "learn_throughput": 194.927, "synch_weights_time_ms": 14.156}, "counters": {"num_env_steps_sampled": 294000, "num_env_steps_trained": 294000, "num_agent_steps_sampled": 294000, "num_agent_steps_trained": 294000}, "done": false, "episodes_total": 294, "training_iteration": 21, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-22-02", "timestamp": 1693052522, "time_this_iter_s": 79.85170006752014, "time_total_s": 1682.4080610275269, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701534D400>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701545E6D0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 1682.4080610275269, "timesteps_since_restore": 0, "iterations_since_restore": 21, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 26.128070175438598, "ram_util_percent": 69.65526315789474}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -276.96333516962824, "episode_L1_reward_sum_min": -596.1327382028103, "episode_L1_reward_sum_max": -166.25289534777403, "episode_L2_reward_sum_mean": -146.06896815285086, "episode_L2_reward_sum_min": -224.28885425627232, "episode_L2_reward_sum_max": -118.08114666491747}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.19921197265711393, "policy_loss": 0.15376199439786942, "vf_loss": 0.4544997700166545, "vf_explained_var": 0.7197487122789332, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "sampler_results": {"episode_reward_max": -35.50859789153477, "episode_reward_min": -199.1977226349603, "episode_reward_mean": -90.54646297077065, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -276.96333516962824, "episode_L1_reward_sum_min": -596.1327382028103, "episode_L1_reward_sum_max": -166.25289534777403, "episode_L2_reward_sum_mean": -146.06896815285086, "episode_L2_reward_sum_min": -224.28885425627232, "episode_L2_reward_sum_max": -118.08114666491747}, "hist_stats": {"episode_reward": [-79.18572154137385, -58.39733535251484, -142.28140571388246, -42.931371022220546, -83.92579241057983, -63.037918394471966, -53.54605934245362, -112.26216098999461, -96.14773799805751, -48.660194504032624, -110.44080917291843, -82.12751003365797, -117.70987164096144, -52.75814972444358, -64.19853863962366, -81.65157379475002, -114.80393247179741, -88.45258047893567, -69.83989526873792, -69.00473134024577, -128.2721193817118, -67.26158734392006, -82.92954042594529, -92.23831892738875, -58.91184595744484, -129.46625014626935, -86.73802868671721, -96.36706696854037, -98.58379397675294, -51.877984137738686, -130.8089210403914, -139.48891725145197, -121.16509262028657, -69.46701383541571, -70.84100903908929, -85.27969888065954, -134.45568348377552, -69.39778617414177, -173.03723138254514, -89.85979949413904, -58.08020125358754, -107.46081045661984, -133.30704616877216, -35.50859789153477, -46.987716168050085, -92.61604659885738, -73.49672886062483, -76.19191086227906, -114.22641980734731, -54.42163680416536, -77.14847461795526, -76.3532401009025, -84.91396675806108, -97.024331184208, -105.99791583642906, -66.29016222863385, -89.67997096606345, -38.30852824984994, -113.08364019596881, -155.57510288408986, -73.98333659324302, -56.85295447470406, -63.540492599457224, -82.9046790818409, -74.42304125687723, -55.45240224896914, -63.89942593903741, -84.79743668059166, -142.49838094056153, -98.9566531195982, -42.59852055624084, -93.2093051001649, -151.9378419582124, -136.6277488193511, -109.02739611300827, -67.12111677004378, -140.68571172731134, -55.84403707544652, -75.06664356510163, -199.1977226349603, -50.24904795959949, -63.80068241189106, -80.63495162196992, -169.30284355491798, -100.48293765814219, -120.05365149377465, -43.30581028991944, -112.66607836606663, -116.48563193313608, -59.44196727502334, -169.1238908770448, -124.51401764023251, -96.24229751560077, -65.49249225027685, -89.5279777035808, -78.2391275752843, -112.05566871449759, -80.59065413234264, -51.904848874852306, -97.42344509021204], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6412098746407336, "mean_inference_ms": 5.473173345235604, "mean_action_processing_ms": 0.20440889274482985, "mean_env_wait_ms": 1.4213081776377805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -35.50859789153477, "episode_reward_min": -199.1977226349603, "episode_reward_mean": -90.54646297077065, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-79.18572154137385, -58.39733535251484, -142.28140571388246, -42.931371022220546, -83.92579241057983, -63.037918394471966, -53.54605934245362, -112.26216098999461, -96.14773799805751, -48.660194504032624, -110.44080917291843, -82.12751003365797, -117.70987164096144, -52.75814972444358, -64.19853863962366, -81.65157379475002, -114.80393247179741, -88.45258047893567, -69.83989526873792, -69.00473134024577, -128.2721193817118, -67.26158734392006, -82.92954042594529, -92.23831892738875, -58.91184595744484, -129.46625014626935, -86.73802868671721, -96.36706696854037, -98.58379397675294, -51.877984137738686, -130.8089210403914, -139.48891725145197, -121.16509262028657, -69.46701383541571, -70.84100903908929, -85.27969888065954, -134.45568348377552, -69.39778617414177, -173.03723138254514, -89.85979949413904, -58.08020125358754, -107.46081045661984, -133.30704616877216, -35.50859789153477, -46.987716168050085, -92.61604659885738, -73.49672886062483, -76.19191086227906, -114.22641980734731, -54.42163680416536, -77.14847461795526, -76.3532401009025, -84.91396675806108, -97.024331184208, -105.99791583642906, -66.29016222863385, -89.67997096606345, -38.30852824984994, -113.08364019596881, -155.57510288408986, -73.98333659324302, -56.85295447470406, -63.540492599457224, -82.9046790818409, -74.42304125687723, -55.45240224896914, -63.89942593903741, -84.79743668059166, -142.49838094056153, -98.9566531195982, -42.59852055624084, -93.2093051001649, -151.9378419582124, -136.6277488193511, -109.02739611300827, -67.12111677004378, -140.68571172731134, -55.84403707544652, -75.06664356510163, -199.1977226349603, -50.24904795959949, -63.80068241189106, -80.63495162196992, -169.30284355491798, -100.48293765814219, -120.05365149377465, -43.30581028991944, -112.66607836606663, -116.48563193313608, -59.44196727502334, -169.1238908770448, -124.51401764023251, -96.24229751560077, -65.49249225027685, -89.5279777035808, -78.2391275752843, -112.05566871449759, -80.59065413234264, -51.904848874852306, -97.42344509021204], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6412098746407336, "mean_inference_ms": 5.473173345235604, "mean_action_processing_ms": 0.20440889274482985, "mean_env_wait_ms": 1.4213081776377805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 308000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 308000, "timers": {"training_iteration_time_ms": 79554.927, "load_time_ms": 28.326, "load_throughput": 494240.807, "learn_time_ms": 71443.42, "learn_throughput": 195.959, "synch_weights_time_ms": 15.054}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "done": false, "episodes_total": 308, "training_iteration": 22, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-23-22", "timestamp": 1693052602, "time_this_iter_s": 79.46748948097229, "time_total_s": 1761.8755505084991, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270129C6280>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014F64E20>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 1761.8755505084991, "timesteps_since_restore": 0, "iterations_since_restore": 22, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 25.919642857142858, "ram_util_percent": 69.66339285714285}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -275.89271169401707, "episode_L1_reward_sum_min": -596.1327382028103, "episode_L1_reward_sum_max": -166.25289534777403, "episode_L2_reward_sum_mean": -145.92306921474636, "episode_L2_reward_sum_min": -224.28885425627232, "episode_L2_reward_sum_max": -118.08114666491747}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.22567261656297855, "policy_loss": 0.17623896493122304, "vf_loss": 0.49433648256698687, "vf_explained_var": 0.6199620565085254, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 322000, "num_env_steps_trained": 322000, "num_agent_steps_sampled": 322000, "num_agent_steps_trained": 322000}, "sampler_results": {"episode_reward_max": -35.50859789153477, "episode_reward_min": -199.1977226349603, "episode_reward_mean": -91.6395924326884, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -275.89271169401707, "episode_L1_reward_sum_min": -596.1327382028103, "episode_L1_reward_sum_max": -166.25289534777403, "episode_L2_reward_sum_mean": -145.92306921474636, "episode_L2_reward_sum_min": -224.28885425627232, "episode_L2_reward_sum_max": -118.08114666491747}, "hist_stats": {"episode_reward": [-64.19853863962366, -81.65157379475002, -114.80393247179741, -88.45258047893567, -69.83989526873792, -69.00473134024577, -128.2721193817118, -67.26158734392006, -82.92954042594529, -92.23831892738875, -58.91184595744484, -129.46625014626935, -86.73802868671721, -96.36706696854037, -98.58379397675294, -51.877984137738686, -130.8089210403914, -139.48891725145197, -121.16509262028657, -69.46701383541571, -70.84100903908929, -85.27969888065954, -134.45568348377552, -69.39778617414177, -173.03723138254514, -89.85979949413904, -58.08020125358754, -107.46081045661984, -133.30704616877216, -35.50859789153477, -46.987716168050085, -92.61604659885738, -73.49672886062483, -76.19191086227906, -114.22641980734731, -54.42163680416536, -77.14847461795526, -76.3532401009025, -84.91396675806108, -97.024331184208, -105.99791583642906, -66.29016222863385, -89.67997096606345, -38.30852824984994, -113.08364019596881, -155.57510288408986, -73.98333659324302, -56.85295447470406, -63.540492599457224, -82.9046790818409, -74.42304125687723, -55.45240224896914, -63.89942593903741, -84.79743668059166, -142.49838094056153, -98.9566531195982, -42.59852055624084, -93.2093051001649, -151.9378419582124, -136.6277488193511, -109.02739611300827, -67.12111677004378, -140.68571172731134, -55.84403707544652, -75.06664356510163, -199.1977226349603, -50.24904795959949, -63.80068241189106, -80.63495162196992, -169.30284355491798, -100.48293765814219, -120.05365149377465, -43.30581028991944, -112.66607836606663, -116.48563193313608, -59.44196727502334, -169.1238908770448, -124.51401764023251, -96.24229751560077, -65.49249225027685, -89.5279777035808, -78.2391275752843, -112.05566871449759, -80.59065413234264, -51.904848874852306, -97.42344509021204, -136.55111394825065, -71.92346929283482, -69.89973105306748, -106.51784190803025, -111.15243571353562, -62.541443228854796, -71.76761646407043, -76.74666013300265, -141.02976249096386, -66.70153178359386, -80.55464473663717, -43.80143284273148, -109.90481532676985, -103.63248511099543], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6406646861238998, "mean_inference_ms": 5.475035543138025, "mean_action_processing_ms": 0.20454578704110138, "mean_env_wait_ms": 1.4217600797479593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -35.50859789153477, "episode_reward_min": -199.1977226349603, "episode_reward_mean": -91.6395924326884, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.19853863962366, -81.65157379475002, -114.80393247179741, -88.45258047893567, -69.83989526873792, -69.00473134024577, -128.2721193817118, -67.26158734392006, -82.92954042594529, -92.23831892738875, -58.91184595744484, -129.46625014626935, -86.73802868671721, -96.36706696854037, -98.58379397675294, -51.877984137738686, -130.8089210403914, -139.48891725145197, -121.16509262028657, -69.46701383541571, -70.84100903908929, -85.27969888065954, -134.45568348377552, -69.39778617414177, -173.03723138254514, -89.85979949413904, -58.08020125358754, -107.46081045661984, -133.30704616877216, -35.50859789153477, -46.987716168050085, -92.61604659885738, -73.49672886062483, -76.19191086227906, -114.22641980734731, -54.42163680416536, -77.14847461795526, -76.3532401009025, -84.91396675806108, -97.024331184208, -105.99791583642906, -66.29016222863385, -89.67997096606345, -38.30852824984994, -113.08364019596881, -155.57510288408986, -73.98333659324302, -56.85295447470406, -63.540492599457224, -82.9046790818409, -74.42304125687723, -55.45240224896914, -63.89942593903741, -84.79743668059166, -142.49838094056153, -98.9566531195982, -42.59852055624084, -93.2093051001649, -151.9378419582124, -136.6277488193511, -109.02739611300827, -67.12111677004378, -140.68571172731134, -55.84403707544652, -75.06664356510163, -199.1977226349603, -50.24904795959949, -63.80068241189106, -80.63495162196992, -169.30284355491798, -100.48293765814219, -120.05365149377465, -43.30581028991944, -112.66607836606663, -116.48563193313608, -59.44196727502334, -169.1238908770448, -124.51401764023251, -96.24229751560077, -65.49249225027685, -89.5279777035808, -78.2391275752843, -112.05566871449759, -80.59065413234264, -51.904848874852306, -97.42344509021204, -136.55111394825065, -71.92346929283482, -69.89973105306748, -106.51784190803025, -111.15243571353562, -62.541443228854796, -71.76761646407043, -76.74666013300265, -141.02976249096386, -66.70153178359386, -80.55464473663717, -43.80143284273148, -109.90481532676985, -103.63248511099543], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6406646861238998, "mean_inference_ms": 5.475035543138025, "mean_action_processing_ms": 0.20454578704110138, "mean_env_wait_ms": 1.4217600797479593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 322000, "num_agent_steps_trained": 322000, "num_env_steps_sampled": 322000, "num_env_steps_trained": 322000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 322000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 322000, "timers": {"training_iteration_time_ms": 79377.058, "load_time_ms": 29.022, "load_throughput": 482397.386, "learn_time_ms": 71324.438, "learn_throughput": 196.286, "synch_weights_time_ms": 14.758}, "counters": {"num_env_steps_sampled": 322000, "num_env_steps_trained": 322000, "num_agent_steps_sampled": 322000, "num_agent_steps_trained": 322000}, "done": false, "episodes_total": 322, "training_iteration": 23, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-24-41", "timestamp": 1693052681, "time_this_iter_s": 79.67694973945618, "time_total_s": 1841.5525002479553, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701535EAF0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150E8790>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 1841.5525002479553, "timesteps_since_restore": 0, "iterations_since_restore": 23, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 25.657142857142862, "ram_util_percent": 69.26250000000002}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -280.8098515509814, "episode_L1_reward_sum_min": -596.1327382028103, "episode_L1_reward_sum_max": -156.48445282876492, "episode_L2_reward_sum_mean": -147.125866015628, "episode_L2_reward_sum_min": -224.28885425627232, "episode_L2_reward_sum_max": -117.07840558886528}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.15567833677637524, "policy_loss": 0.11465146632217361, "vf_loss": 0.41026869755455203, "vf_explained_var": 0.6562885520021611, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "sampler_results": {"episode_reward_max": -35.50859789153477, "episode_reward_min": -219.16970238661364, "episode_reward_mean": -93.48097299089439, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -280.8098515509814, "episode_L1_reward_sum_min": -596.1327382028103, "episode_L1_reward_sum_max": -156.48445282876492, "episode_L2_reward_sum_mean": -147.125866015628, "episode_L2_reward_sum_min": -224.28885425627232, "episode_L2_reward_sum_max": -117.07840558886528}, "hist_stats": {"episode_reward": [-98.58379397675294, -51.877984137738686, -130.8089210403914, -139.48891725145197, -121.16509262028657, -69.46701383541571, -70.84100903908929, -85.27969888065954, -134.45568348377552, -69.39778617414177, -173.03723138254514, -89.85979949413904, -58.08020125358754, -107.46081045661984, -133.30704616877216, -35.50859789153477, -46.987716168050085, -92.61604659885738, -73.49672886062483, -76.19191086227906, -114.22641980734731, -54.42163680416536, -77.14847461795526, -76.3532401009025, -84.91396675806108, -97.024331184208, -105.99791583642906, -66.29016222863385, -89.67997096606345, -38.30852824984994, -113.08364019596881, -155.57510288408986, -73.98333659324302, -56.85295447470406, -63.540492599457224, -82.9046790818409, -74.42304125687723, -55.45240224896914, -63.89942593903741, -84.79743668059166, -142.49838094056153, -98.9566531195982, -42.59852055624084, -93.2093051001649, -151.9378419582124, -136.6277488193511, -109.02739611300827, -67.12111677004378, -140.68571172731134, -55.84403707544652, -75.06664356510163, -199.1977226349603, -50.24904795959949, -63.80068241189106, -80.63495162196992, -169.30284355491798, -100.48293765814219, -120.05365149377465, -43.30581028991944, -112.66607836606663, -116.48563193313608, -59.44196727502334, -169.1238908770448, -124.51401764023251, -96.24229751560077, -65.49249225027685, -89.5279777035808, -78.2391275752843, -112.05566871449759, -80.59065413234264, -51.904848874852306, -97.42344509021204, -136.55111394825065, -71.92346929283482, -69.89973105306748, -106.51784190803025, -111.15243571353562, -62.541443228854796, -71.76761646407043, -76.74666013300265, -141.02976249096386, -66.70153178359386, -80.55464473663717, -43.80143284273148, -109.90481532676985, -103.63248511099543, -78.7237120368269, -61.33953560744172, -88.00304181520322, -77.7201562780673, -166.41277854059666, -94.79255798658134, -101.89489751533407, -70.73883278319265, -219.16970238661364, -66.75313093622174, -130.1578482788925, -64.09556492149528, -61.00153889367668, -133.47076767248353], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6401142589951466, "mean_inference_ms": 5.477595292175034, "mean_action_processing_ms": 0.2046545755593786, "mean_env_wait_ms": 1.42239164856359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -35.50859789153477, "episode_reward_min": -219.16970238661364, "episode_reward_mean": -93.48097299089439, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-98.58379397675294, -51.877984137738686, -130.8089210403914, -139.48891725145197, -121.16509262028657, -69.46701383541571, -70.84100903908929, -85.27969888065954, -134.45568348377552, -69.39778617414177, -173.03723138254514, -89.85979949413904, -58.08020125358754, -107.46081045661984, -133.30704616877216, -35.50859789153477, -46.987716168050085, -92.61604659885738, -73.49672886062483, -76.19191086227906, -114.22641980734731, -54.42163680416536, -77.14847461795526, -76.3532401009025, -84.91396675806108, -97.024331184208, -105.99791583642906, -66.29016222863385, -89.67997096606345, -38.30852824984994, -113.08364019596881, -155.57510288408986, -73.98333659324302, -56.85295447470406, -63.540492599457224, -82.9046790818409, -74.42304125687723, -55.45240224896914, -63.89942593903741, -84.79743668059166, -142.49838094056153, -98.9566531195982, -42.59852055624084, -93.2093051001649, -151.9378419582124, -136.6277488193511, -109.02739611300827, -67.12111677004378, -140.68571172731134, -55.84403707544652, -75.06664356510163, -199.1977226349603, -50.24904795959949, -63.80068241189106, -80.63495162196992, -169.30284355491798, -100.48293765814219, -120.05365149377465, -43.30581028991944, -112.66607836606663, -116.48563193313608, -59.44196727502334, -169.1238908770448, -124.51401764023251, -96.24229751560077, -65.49249225027685, -89.5279777035808, -78.2391275752843, -112.05566871449759, -80.59065413234264, -51.904848874852306, -97.42344509021204, -136.55111394825065, -71.92346929283482, -69.89973105306748, -106.51784190803025, -111.15243571353562, -62.541443228854796, -71.76761646407043, -76.74666013300265, -141.02976249096386, -66.70153178359386, -80.55464473663717, -43.80143284273148, -109.90481532676985, -103.63248511099543, -78.7237120368269, -61.33953560744172, -88.00304181520322, -77.7201562780673, -166.41277854059666, -94.79255798658134, -101.89489751533407, -70.73883278319265, -219.16970238661364, -66.75313093622174, -130.1578482788925, -64.09556492149528, -61.00153889367668, -133.47076767248353], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6401142589951466, "mean_inference_ms": 5.477595292175034, "mean_action_processing_ms": 0.2046545755593786, "mean_env_wait_ms": 1.42239164856359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 336000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 79082.913, "load_time_ms": 29.235, "load_throughput": 478874.845, "learn_time_ms": 71049.875, "learn_throughput": 197.045, "synch_weights_time_ms": 14.06}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "episodes_total": 336, "training_iteration": 24, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-25-58", "timestamp": 1693052758, "time_this_iter_s": 76.32410407066345, "time_total_s": 1917.8766043186188, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270151C0D60>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015260850>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 1917.8766043186188, "timesteps_since_restore": 0, "iterations_since_restore": 24, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 23.65, "ram_util_percent": 63.3675925925926}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -279.5194748131931, "episode_L1_reward_sum_min": -616.1873790025711, "episode_L1_reward_sum_max": -156.48445282876492, "episode_L2_reward_sum_mean": -146.81064571514725, "episode_L2_reward_sum_min": -228.5352517813444, "episode_L2_reward_sum_max": -117.07840558886528}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.168377956475846, "policy_loss": 0.12790584145305456, "vf_loss": 0.40472110739262623, "vf_explained_var": 0.6444818882785216, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 350000, "num_env_steps_trained": 350000, "num_agent_steps_sampled": 350000, "num_agent_steps_trained": 350000}, "sampler_results": {"episode_reward_max": -35.50859789153477, "episode_reward_min": -222.34610024312227, "episode_reward_mean": -93.64296099989629, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -279.5194748131931, "episode_L1_reward_sum_min": -616.1873790025711, "episode_L1_reward_sum_max": -156.48445282876492, "episode_L2_reward_sum_mean": -146.81064571514725, "episode_L2_reward_sum_min": -228.5352517813444, "episode_L2_reward_sum_max": -117.07840558886528}, "hist_stats": {"episode_reward": [-133.30704616877216, -35.50859789153477, -46.987716168050085, -92.61604659885738, -73.49672886062483, -76.19191086227906, -114.22641980734731, -54.42163680416536, -77.14847461795526, -76.3532401009025, -84.91396675806108, -97.024331184208, -105.99791583642906, -66.29016222863385, -89.67997096606345, -38.30852824984994, -113.08364019596881, -155.57510288408986, -73.98333659324302, -56.85295447470406, -63.540492599457224, -82.9046790818409, -74.42304125687723, -55.45240224896914, -63.89942593903741, -84.79743668059166, -142.49838094056153, -98.9566531195982, -42.59852055624084, -93.2093051001649, -151.9378419582124, -136.6277488193511, -109.02739611300827, -67.12111677004378, -140.68571172731134, -55.84403707544652, -75.06664356510163, -199.1977226349603, -50.24904795959949, -63.80068241189106, -80.63495162196992, -169.30284355491798, -100.48293765814219, -120.05365149377465, -43.30581028991944, -112.66607836606663, -116.48563193313608, -59.44196727502334, -169.1238908770448, -124.51401764023251, -96.24229751560077, -65.49249225027685, -89.5279777035808, -78.2391275752843, -112.05566871449759, -80.59065413234264, -51.904848874852306, -97.42344509021204, -136.55111394825065, -71.92346929283482, -69.89973105306748, -106.51784190803025, -111.15243571353562, -62.541443228854796, -71.76761646407043, -76.74666013300265, -141.02976249096386, -66.70153178359386, -80.55464473663717, -43.80143284273148, -109.90481532676985, -103.63248511099543, -78.7237120368269, -61.33953560744172, -88.00304181520322, -77.7201562780673, -166.41277854059666, -94.79255798658134, -101.89489751533407, -70.73883278319265, -219.16970238661364, -66.75313093622174, -130.1578482788925, -64.09556492149528, -61.00153889367668, -133.47076767248353, -95.0325788832439, -55.14790239606471, -222.34610024312227, -87.92661727252786, -73.33021132478059, -98.02775675400432, -90.66936282847671, -60.95791157473893, -137.83143299233038, -75.2881000412926, -130.2899196193843, -99.69289351854191, -110.10776988942918, -79.35418658884532], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6397160780834512, "mean_inference_ms": 5.480571357098752, "mean_action_processing_ms": 0.20480919562906436, "mean_env_wait_ms": 1.423213779850608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -35.50859789153477, "episode_reward_min": -222.34610024312227, "episode_reward_mean": -93.64296099989629, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-133.30704616877216, -35.50859789153477, -46.987716168050085, -92.61604659885738, -73.49672886062483, -76.19191086227906, -114.22641980734731, -54.42163680416536, -77.14847461795526, -76.3532401009025, -84.91396675806108, -97.024331184208, -105.99791583642906, -66.29016222863385, -89.67997096606345, -38.30852824984994, -113.08364019596881, -155.57510288408986, -73.98333659324302, -56.85295447470406, -63.540492599457224, -82.9046790818409, -74.42304125687723, -55.45240224896914, -63.89942593903741, -84.79743668059166, -142.49838094056153, -98.9566531195982, -42.59852055624084, -93.2093051001649, -151.9378419582124, -136.6277488193511, -109.02739611300827, -67.12111677004378, -140.68571172731134, -55.84403707544652, -75.06664356510163, -199.1977226349603, -50.24904795959949, -63.80068241189106, -80.63495162196992, -169.30284355491798, -100.48293765814219, -120.05365149377465, -43.30581028991944, -112.66607836606663, -116.48563193313608, -59.44196727502334, -169.1238908770448, -124.51401764023251, -96.24229751560077, -65.49249225027685, -89.5279777035808, -78.2391275752843, -112.05566871449759, -80.59065413234264, -51.904848874852306, -97.42344509021204, -136.55111394825065, -71.92346929283482, -69.89973105306748, -106.51784190803025, -111.15243571353562, -62.541443228854796, -71.76761646407043, -76.74666013300265, -141.02976249096386, -66.70153178359386, -80.55464473663717, -43.80143284273148, -109.90481532676985, -103.63248511099543, -78.7237120368269, -61.33953560744172, -88.00304181520322, -77.7201562780673, -166.41277854059666, -94.79255798658134, -101.89489751533407, -70.73883278319265, -219.16970238661364, -66.75313093622174, -130.1578482788925, -64.09556492149528, -61.00153889367668, -133.47076767248353, -95.0325788832439, -55.14790239606471, -222.34610024312227, -87.92661727252786, -73.33021132478059, -98.02775675400432, -90.66936282847671, -60.95791157473893, -137.83143299233038, -75.2881000412926, -130.2899196193843, -99.69289351854191, -110.10776988942918, -79.35418658884532], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6397160780834512, "mean_inference_ms": 5.480571357098752, "mean_action_processing_ms": 0.20480919562906436, "mean_env_wait_ms": 1.423213779850608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 350000, "num_agent_steps_trained": 350000, "num_env_steps_sampled": 350000, "num_env_steps_trained": 350000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 350000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 350000, "timers": {"training_iteration_time_ms": 78746.628, "load_time_ms": 29.644, "load_throughput": 472278.347, "learn_time_ms": 70771.818, "learn_throughput": 197.819, "synch_weights_time_ms": 14.159}, "counters": {"num_env_steps_sampled": 350000, "num_env_steps_trained": 350000, "num_agent_steps_sampled": 350000, "num_agent_steps_trained": 350000}, "done": false, "episodes_total": 350, "training_iteration": 25, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-27-14", "timestamp": 1693052834, "time_this_iter_s": 75.70905327796936, "time_total_s": 1993.5856575965881, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701545E490>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015311DF0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 1993.5856575965881, "timesteps_since_restore": 0, "iterations_since_restore": 25, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 22.03981481481481, "ram_util_percent": 53.029629629629646}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -274.7513501341641, "episode_L1_reward_sum_min": -616.1873790025711, "episode_L1_reward_sum_max": -156.48445282876492, "episode_L2_reward_sum_mean": -145.63704527005552, "episode_L2_reward_sum_min": -228.5352517813444, "episode_L2_reward_sum_max": -117.07840558886528}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.23410297432768737, "policy_loss": 0.20672638413262526, "vf_loss": 0.2737658937156602, "vf_explained_var": 0.5806678264965246, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "sampler_results": {"episode_reward_max": -38.30852824984994, "episode_reward_min": -222.34610024312227, "episode_reward_mean": -93.07246436475742, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -274.7513501341641, "episode_L1_reward_sum_min": -616.1873790025711, "episode_L1_reward_sum_max": -156.48445282876492, "episode_L2_reward_sum_mean": -145.63704527005552, "episode_L2_reward_sum_min": -228.5352517813444, "episode_L2_reward_sum_max": -117.07840558886528}, "hist_stats": {"episode_reward": [-89.67997096606345, -38.30852824984994, -113.08364019596881, -155.57510288408986, -73.98333659324302, -56.85295447470406, -63.540492599457224, -82.9046790818409, -74.42304125687723, -55.45240224896914, -63.89942593903741, -84.79743668059166, -142.49838094056153, -98.9566531195982, -42.59852055624084, -93.2093051001649, -151.9378419582124, -136.6277488193511, -109.02739611300827, -67.12111677004378, -140.68571172731134, -55.84403707544652, -75.06664356510163, -199.1977226349603, -50.24904795959949, -63.80068241189106, -80.63495162196992, -169.30284355491798, -100.48293765814219, -120.05365149377465, -43.30581028991944, -112.66607836606663, -116.48563193313608, -59.44196727502334, -169.1238908770448, -124.51401764023251, -96.24229751560077, -65.49249225027685, -89.5279777035808, -78.2391275752843, -112.05566871449759, -80.59065413234264, -51.904848874852306, -97.42344509021204, -136.55111394825065, -71.92346929283482, -69.89973105306748, -106.51784190803025, -111.15243571353562, -62.541443228854796, -71.76761646407043, -76.74666013300265, -141.02976249096386, -66.70153178359386, -80.55464473663717, -43.80143284273148, -109.90481532676985, -103.63248511099543, -78.7237120368269, -61.33953560744172, -88.00304181520322, -77.7201562780673, -166.41277854059666, -94.79255798658134, -101.89489751533407, -70.73883278319265, -219.16970238661364, -66.75313093622174, -130.1578482788925, -64.09556492149528, -61.00153889367668, -133.47076767248353, -95.0325788832439, -55.14790239606471, -222.34610024312227, -87.92661727252786, -73.33021132478059, -98.02775675400432, -90.66936282847671, -60.95791157473893, -137.83143299233038, -75.2881000412926, -130.2899196193843, -99.69289351854191, -110.10776988942918, -79.35418658884532, -122.39238776260824, -76.5349635153096, -86.02096838539232, -57.88190998250192, -64.75019155115378, -86.05331706866751, -78.10052318040115, -79.64401188624238, -45.37569932588706, -71.18628771193215, -84.0282016263426, -61.36290039144146, -62.73955059412002, -101.36361739193498], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6392091139660269, "mean_inference_ms": 5.480858065970549, "mean_action_processing_ms": 0.20484938946206352, "mean_env_wait_ms": 1.423400259408175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -38.30852824984994, "episode_reward_min": -222.34610024312227, "episode_reward_mean": -93.07246436475742, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-89.67997096606345, -38.30852824984994, -113.08364019596881, -155.57510288408986, -73.98333659324302, -56.85295447470406, -63.540492599457224, -82.9046790818409, -74.42304125687723, -55.45240224896914, -63.89942593903741, -84.79743668059166, -142.49838094056153, -98.9566531195982, -42.59852055624084, -93.2093051001649, -151.9378419582124, -136.6277488193511, -109.02739611300827, -67.12111677004378, -140.68571172731134, -55.84403707544652, -75.06664356510163, -199.1977226349603, -50.24904795959949, -63.80068241189106, -80.63495162196992, -169.30284355491798, -100.48293765814219, -120.05365149377465, -43.30581028991944, -112.66607836606663, -116.48563193313608, -59.44196727502334, -169.1238908770448, -124.51401764023251, -96.24229751560077, -65.49249225027685, -89.5279777035808, -78.2391275752843, -112.05566871449759, -80.59065413234264, -51.904848874852306, -97.42344509021204, -136.55111394825065, -71.92346929283482, -69.89973105306748, -106.51784190803025, -111.15243571353562, -62.541443228854796, -71.76761646407043, -76.74666013300265, -141.02976249096386, -66.70153178359386, -80.55464473663717, -43.80143284273148, -109.90481532676985, -103.63248511099543, -78.7237120368269, -61.33953560744172, -88.00304181520322, -77.7201562780673, -166.41277854059666, -94.79255798658134, -101.89489751533407, -70.73883278319265, -219.16970238661364, -66.75313093622174, -130.1578482788925, -64.09556492149528, -61.00153889367668, -133.47076767248353, -95.0325788832439, -55.14790239606471, -222.34610024312227, -87.92661727252786, -73.33021132478059, -98.02775675400432, -90.66936282847671, -60.95791157473893, -137.83143299233038, -75.2881000412926, -130.2899196193843, -99.69289351854191, -110.10776988942918, -79.35418658884532, -122.39238776260824, -76.5349635153096, -86.02096838539232, -57.88190998250192, -64.75019155115378, -86.05331706866751, -78.10052318040115, -79.64401188624238, -45.37569932588706, -71.18628771193215, -84.0282016263426, -61.36290039144146, -62.73955059412002, -101.36361739193498], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6392091139660269, "mean_inference_ms": 5.480858065970549, "mean_action_processing_ms": 0.20484938946206352, "mean_env_wait_ms": 1.423400259408175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 364000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 364000, "timers": {"training_iteration_time_ms": 78511.947, "load_time_ms": 29.644, "load_throughput": 472278.727, "learn_time_ms": 70585.363, "learn_throughput": 198.341, "synch_weights_time_ms": 13.561}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "done": false, "episodes_total": 364, "training_iteration": 26, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-28-29", "timestamp": 1693052909, "time_this_iter_s": 75.5418655872345, "time_total_s": 2069.1275231838226, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150AA3D0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150EF700>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 2069.1275231838226, "timesteps_since_restore": 0, "iterations_since_restore": 26, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.999999999999996, "ram_util_percent": 53.05566037735851}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -278.39804621718827, "episode_L1_reward_sum_min": -616.1873790025711, "episode_L1_reward_sum_max": -156.48445282876492, "episode_L2_reward_sum_mean": -146.53553499691188, "episode_L2_reward_sum_min": -228.5352517813444, "episode_L2_reward_sum_max": -117.07840558886528}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.2201375873863019, "policy_loss": 0.17719758423616574, "vf_loss": 0.4294000400570136, "vf_explained_var": 0.6375570924868309, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000}, "sampler_results": {"episode_reward_max": -42.156756520449626, "episode_reward_min": -222.34610024312227, "episode_reward_mean": -94.201215867414, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -278.39804621718827, "episode_L1_reward_sum_min": -616.1873790025711, "episode_L1_reward_sum_max": -156.48445282876492, "episode_L2_reward_sum_mean": -146.53553499691188, "episode_L2_reward_sum_min": -228.5352517813444, "episode_L2_reward_sum_max": -117.07840558886528}, "hist_stats": {"episode_reward": [-42.59852055624084, -93.2093051001649, -151.9378419582124, -136.6277488193511, -109.02739611300827, -67.12111677004378, -140.68571172731134, -55.84403707544652, -75.06664356510163, -199.1977226349603, -50.24904795959949, -63.80068241189106, -80.63495162196992, -169.30284355491798, -100.48293765814219, -120.05365149377465, -43.30581028991944, -112.66607836606663, -116.48563193313608, -59.44196727502334, -169.1238908770448, -124.51401764023251, -96.24229751560077, -65.49249225027685, -89.5279777035808, -78.2391275752843, -112.05566871449759, -80.59065413234264, -51.904848874852306, -97.42344509021204, -136.55111394825065, -71.92346929283482, -69.89973105306748, -106.51784190803025, -111.15243571353562, -62.541443228854796, -71.76761646407043, -76.74666013300265, -141.02976249096386, -66.70153178359386, -80.55464473663717, -43.80143284273148, -109.90481532676985, -103.63248511099543, -78.7237120368269, -61.33953560744172, -88.00304181520322, -77.7201562780673, -166.41277854059666, -94.79255798658134, -101.89489751533407, -70.73883278319265, -219.16970238661364, -66.75313093622174, -130.1578482788925, -64.09556492149528, -61.00153889367668, -133.47076767248353, -95.0325788832439, -55.14790239606471, -222.34610024312227, -87.92661727252786, -73.33021132478059, -98.02775675400432, -90.66936282847671, -60.95791157473893, -137.83143299233038, -75.2881000412926, -130.2899196193843, -99.69289351854191, -110.10776988942918, -79.35418658884532, -122.39238776260824, -76.5349635153096, -86.02096838539232, -57.88190998250192, -64.75019155115378, -86.05331706866751, -78.10052318040115, -79.64401188624238, -45.37569932588706, -71.18628771193215, -84.0282016263426, -61.36290039144146, -62.73955059412002, -101.36361739193498, -54.11155920315228, -85.88130665375219, -112.12215306062126, -66.43812634305151, -42.156756520449626, -200.17454587308973, -48.334697625928854, -120.56578947971616, -60.14747711738253, -70.52388418641927, -170.48477952019792, -83.99132137289287, -116.30219462623555, -75.59660391361969], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6383003601245537, "mean_inference_ms": 5.47484086638701, "mean_action_processing_ms": 0.20463003957659212, "mean_env_wait_ms": 1.421860344008394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -42.156756520449626, "episode_reward_min": -222.34610024312227, "episode_reward_mean": -94.201215867414, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-42.59852055624084, -93.2093051001649, -151.9378419582124, -136.6277488193511, -109.02739611300827, -67.12111677004378, -140.68571172731134, -55.84403707544652, -75.06664356510163, -199.1977226349603, -50.24904795959949, -63.80068241189106, -80.63495162196992, -169.30284355491798, -100.48293765814219, -120.05365149377465, -43.30581028991944, -112.66607836606663, -116.48563193313608, -59.44196727502334, -169.1238908770448, -124.51401764023251, -96.24229751560077, -65.49249225027685, -89.5279777035808, -78.2391275752843, -112.05566871449759, -80.59065413234264, -51.904848874852306, -97.42344509021204, -136.55111394825065, -71.92346929283482, -69.89973105306748, -106.51784190803025, -111.15243571353562, -62.541443228854796, -71.76761646407043, -76.74666013300265, -141.02976249096386, -66.70153178359386, -80.55464473663717, -43.80143284273148, -109.90481532676985, -103.63248511099543, -78.7237120368269, -61.33953560744172, -88.00304181520322, -77.7201562780673, -166.41277854059666, -94.79255798658134, -101.89489751533407, -70.73883278319265, -219.16970238661364, -66.75313093622174, -130.1578482788925, -64.09556492149528, -61.00153889367668, -133.47076767248353, -95.0325788832439, -55.14790239606471, -222.34610024312227, -87.92661727252786, -73.33021132478059, -98.02775675400432, -90.66936282847671, -60.95791157473893, -137.83143299233038, -75.2881000412926, -130.2899196193843, -99.69289351854191, -110.10776988942918, -79.35418658884532, -122.39238776260824, -76.5349635153096, -86.02096838539232, -57.88190998250192, -64.75019155115378, -86.05331706866751, -78.10052318040115, -79.64401188624238, -45.37569932588706, -71.18628771193215, -84.0282016263426, -61.36290039144146, -62.73955059412002, -101.36361739193498, -54.11155920315228, -85.88130665375219, -112.12215306062126, -66.43812634305151, -42.156756520449626, -200.17454587308973, -48.334697625928854, -120.56578947971616, -60.14747711738253, -70.52388418641927, -170.48477952019792, -83.99132137289287, -116.30219462623555, -75.59660391361969], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6383003601245537, "mean_inference_ms": 5.47484086638701, "mean_action_processing_ms": 0.20463003957659212, "mean_env_wait_ms": 1.421860344008394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000, "num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 378000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 378000, "timers": {"training_iteration_time_ms": 78271.751, "load_time_ms": 29.145, "load_throughput": 480359.155, "learn_time_ms": 70369.758, "learn_throughput": 198.949, "synch_weights_time_ms": 12.963}, "counters": {"num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000}, "done": false, "episodes_total": 378, "training_iteration": 27, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-29-45", "timestamp": 1693052985, "time_this_iter_s": 75.70865368843079, "time_total_s": 2144.8361768722534, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015443460>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701543FD30>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 2144.8361768722534, "timesteps_since_restore": 0, "iterations_since_restore": 27, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 22.5411214953271, "ram_util_percent": 53.15514018691588}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -275.7273802918196, "episode_L1_reward_sum_min": -616.1873790025711, "episode_L1_reward_sum_max": -156.48445282876492, "episode_L2_reward_sum_mean": -145.82812715485693, "episode_L2_reward_sum_min": -228.5352517813444, "episode_L2_reward_sum_max": -117.07840558886528}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.19126264528379058, "policy_loss": 0.14377761796766456, "vf_loss": 0.4748502649626125, "vf_explained_var": 0.5969264496562412, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "sampler_results": {"episode_reward_max": -41.32277407238246, "episode_reward_min": -243.82355285142717, "episode_reward_mean": -94.27437912795635, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -275.7273802918196, "episode_L1_reward_sum_min": -616.1873790025711, "episode_L1_reward_sum_max": -156.48445282876492, "episode_L2_reward_sum_mean": -145.82812715485693, "episode_L2_reward_sum_min": -228.5352517813444, "episode_L2_reward_sum_max": -117.07840558886528}, "hist_stats": {"episode_reward": [-100.48293765814219, -120.05365149377465, -43.30581028991944, -112.66607836606663, -116.48563193313608, -59.44196727502334, -169.1238908770448, -124.51401764023251, -96.24229751560077, -65.49249225027685, -89.5279777035808, -78.2391275752843, -112.05566871449759, -80.59065413234264, -51.904848874852306, -97.42344509021204, -136.55111394825065, -71.92346929283482, -69.89973105306748, -106.51784190803025, -111.15243571353562, -62.541443228854796, -71.76761646407043, -76.74666013300265, -141.02976249096386, -66.70153178359386, -80.55464473663717, -43.80143284273148, -109.90481532676985, -103.63248511099543, -78.7237120368269, -61.33953560744172, -88.00304181520322, -77.7201562780673, -166.41277854059666, -94.79255798658134, -101.89489751533407, -70.73883278319265, -219.16970238661364, -66.75313093622174, -130.1578482788925, -64.09556492149528, -61.00153889367668, -133.47076767248353, -95.0325788832439, -55.14790239606471, -222.34610024312227, -87.92661727252786, -73.33021132478059, -98.02775675400432, -90.66936282847671, -60.95791157473893, -137.83143299233038, -75.2881000412926, -130.2899196193843, -99.69289351854191, -110.10776988942918, -79.35418658884532, -122.39238776260824, -76.5349635153096, -86.02096838539232, -57.88190998250192, -64.75019155115378, -86.05331706866751, -78.10052318040115, -79.64401188624238, -45.37569932588706, -71.18628771193215, -84.0282016263426, -61.36290039144146, -62.73955059412002, -101.36361739193498, -54.11155920315228, -85.88130665375219, -112.12215306062126, -66.43812634305151, -42.156756520449626, -200.17454587308973, -48.334697625928854, -120.56578947971616, -60.14747711738253, -70.52388418641927, -170.48477952019792, -83.99132137289287, -116.30219462623555, -75.59660391361969, -92.79262040626527, -77.95141496039959, -83.97078236093522, -141.45740281331152, -117.21938329443157, -91.98391270859243, -41.32277407238246, -71.84227618346213, -243.82355285142717, -81.94067937832045, -98.69028973403081, -134.9170602501701, -119.1468739436144, -45.5608729651112], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.637402450948515, "mean_inference_ms": 5.465380794868399, "mean_action_processing_ms": 0.20431821769279318, "mean_env_wait_ms": 1.4193717028896071, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -41.32277407238246, "episode_reward_min": -243.82355285142717, "episode_reward_mean": -94.27437912795635, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-100.48293765814219, -120.05365149377465, -43.30581028991944, -112.66607836606663, -116.48563193313608, -59.44196727502334, -169.1238908770448, -124.51401764023251, -96.24229751560077, -65.49249225027685, -89.5279777035808, -78.2391275752843, -112.05566871449759, -80.59065413234264, -51.904848874852306, -97.42344509021204, -136.55111394825065, -71.92346929283482, -69.89973105306748, -106.51784190803025, -111.15243571353562, -62.541443228854796, -71.76761646407043, -76.74666013300265, -141.02976249096386, -66.70153178359386, -80.55464473663717, -43.80143284273148, -109.90481532676985, -103.63248511099543, -78.7237120368269, -61.33953560744172, -88.00304181520322, -77.7201562780673, -166.41277854059666, -94.79255798658134, -101.89489751533407, -70.73883278319265, -219.16970238661364, -66.75313093622174, -130.1578482788925, -64.09556492149528, -61.00153889367668, -133.47076767248353, -95.0325788832439, -55.14790239606471, -222.34610024312227, -87.92661727252786, -73.33021132478059, -98.02775675400432, -90.66936282847671, -60.95791157473893, -137.83143299233038, -75.2881000412926, -130.2899196193843, -99.69289351854191, -110.10776988942918, -79.35418658884532, -122.39238776260824, -76.5349635153096, -86.02096838539232, -57.88190998250192, -64.75019155115378, -86.05331706866751, -78.10052318040115, -79.64401188624238, -45.37569932588706, -71.18628771193215, -84.0282016263426, -61.36290039144146, -62.73955059412002, -101.36361739193498, -54.11155920315228, -85.88130665375219, -112.12215306062126, -66.43812634305151, -42.156756520449626, -200.17454587308973, -48.334697625928854, -120.56578947971616, -60.14747711738253, -70.52388418641927, -170.48477952019792, -83.99132137289287, -116.30219462623555, -75.59660391361969, -92.79262040626527, -77.95141496039959, -83.97078236093522, -141.45740281331152, -117.21938329443157, -91.98391270859243, -41.32277407238246, -71.84227618346213, -243.82355285142717, -81.94067937832045, -98.69028973403081, -134.9170602501701, -119.1468739436144, -45.5608729651112], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.637402450948515, "mean_inference_ms": 5.465380794868399, "mean_action_processing_ms": 0.20431821769279318, "mean_env_wait_ms": 1.4193717028896071, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 392000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 77988.572, "load_time_ms": 28.649, "load_throughput": 488671.281, "learn_time_ms": 70122.36, "learn_throughput": 199.651, "synch_weights_time_ms": 12.873}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "done": false, "episodes_total": 392, "training_iteration": 28, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-31-01", "timestamp": 1693053061, "time_this_iter_s": 75.82888627052307, "time_total_s": 2220.6650631427765, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015309730>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015359880>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 2220.6650631427765, "timesteps_since_restore": 0, "iterations_since_restore": 28, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 22.57757009345794, "ram_util_percent": 52.063551401869184}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -269.1652553589642, "episode_L1_reward_sum_min": -616.1873790025711, "episode_L1_reward_sum_max": -156.48445282876492, "episode_L2_reward_sum_mean": -144.11835816323756, "episode_L2_reward_sum_min": -228.5352517813444, "episode_L2_reward_sum_max": -116.54271906614304}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.1895405674546549, "policy_loss": 0.147748679156442, "vf_loss": 0.4179188576212076, "vf_explained_var": 0.6154496457289766, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 406000, "num_env_steps_trained": 406000, "num_agent_steps_sampled": 406000, "num_agent_steps_trained": 406000}, "sampler_results": {"episode_reward_max": -36.83720111799079, "episode_reward_min": -243.82355285142717, "episode_reward_mean": -92.28074612408173, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -269.1652553589642, "episode_L1_reward_sum_min": -616.1873790025711, "episode_L1_reward_sum_max": -156.48445282876492, "episode_L2_reward_sum_mean": -144.11835816323756, "episode_L2_reward_sum_min": -228.5352517813444, "episode_L2_reward_sum_max": -116.54271906614304}, "hist_stats": {"episode_reward": [-51.904848874852306, -97.42344509021204, -136.55111394825065, -71.92346929283482, -69.89973105306748, -106.51784190803025, -111.15243571353562, -62.541443228854796, -71.76761646407043, -76.74666013300265, -141.02976249096386, -66.70153178359386, -80.55464473663717, -43.80143284273148, -109.90481532676985, -103.63248511099543, -78.7237120368269, -61.33953560744172, -88.00304181520322, -77.7201562780673, -166.41277854059666, -94.79255798658134, -101.89489751533407, -70.73883278319265, -219.16970238661364, -66.75313093622174, -130.1578482788925, -64.09556492149528, -61.00153889367668, -133.47076767248353, -95.0325788832439, -55.14790239606471, -222.34610024312227, -87.92661727252786, -73.33021132478059, -98.02775675400432, -90.66936282847671, -60.95791157473893, -137.83143299233038, -75.2881000412926, -130.2899196193843, -99.69289351854191, -110.10776988942918, -79.35418658884532, -122.39238776260824, -76.5349635153096, -86.02096838539232, -57.88190998250192, -64.75019155115378, -86.05331706866751, -78.10052318040115, -79.64401188624238, -45.37569932588706, -71.18628771193215, -84.0282016263426, -61.36290039144146, -62.73955059412002, -101.36361739193498, -54.11155920315228, -85.88130665375219, -112.12215306062126, -66.43812634305151, -42.156756520449626, -200.17454587308973, -48.334697625928854, -120.56578947971616, -60.14747711738253, -70.52388418641927, -170.48477952019792, -83.99132137289287, -116.30219462623555, -75.59660391361969, -92.79262040626527, -77.95141496039959, -83.97078236093522, -141.45740281331152, -117.21938329443157, -91.98391270859243, -41.32277407238246, -71.84227618346213, -243.82355285142717, -81.94067937832045, -98.69028973403081, -134.9170602501701, -119.1468739436144, -45.5608729651112, -104.68194703230498, -43.80650127110573, -69.32783687197364, -58.121548027135574, -170.3476867621343, -48.50776300230498, -75.65599927653757, -92.99145548686947, -59.77445438148258, -98.36023620063102, -46.91984275635232, -70.37310352179054, -193.15332732885028, -36.83720111799079], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6362273314446989, "mean_inference_ms": 5.453208155753868, "mean_action_processing_ms": 0.2039005946515916, "mean_env_wait_ms": 1.4162029501687396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -36.83720111799079, "episode_reward_min": -243.82355285142717, "episode_reward_mean": -92.28074612408173, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-51.904848874852306, -97.42344509021204, -136.55111394825065, -71.92346929283482, -69.89973105306748, -106.51784190803025, -111.15243571353562, -62.541443228854796, -71.76761646407043, -76.74666013300265, -141.02976249096386, -66.70153178359386, -80.55464473663717, -43.80143284273148, -109.90481532676985, -103.63248511099543, -78.7237120368269, -61.33953560744172, -88.00304181520322, -77.7201562780673, -166.41277854059666, -94.79255798658134, -101.89489751533407, -70.73883278319265, -219.16970238661364, -66.75313093622174, -130.1578482788925, -64.09556492149528, -61.00153889367668, -133.47076767248353, -95.0325788832439, -55.14790239606471, -222.34610024312227, -87.92661727252786, -73.33021132478059, -98.02775675400432, -90.66936282847671, -60.95791157473893, -137.83143299233038, -75.2881000412926, -130.2899196193843, -99.69289351854191, -110.10776988942918, -79.35418658884532, -122.39238776260824, -76.5349635153096, -86.02096838539232, -57.88190998250192, -64.75019155115378, -86.05331706866751, -78.10052318040115, -79.64401188624238, -45.37569932588706, -71.18628771193215, -84.0282016263426, -61.36290039144146, -62.73955059412002, -101.36361739193498, -54.11155920315228, -85.88130665375219, -112.12215306062126, -66.43812634305151, -42.156756520449626, -200.17454587308973, -48.334697625928854, -120.56578947971616, -60.14747711738253, -70.52388418641927, -170.48477952019792, -83.99132137289287, -116.30219462623555, -75.59660391361969, -92.79262040626527, -77.95141496039959, -83.97078236093522, -141.45740281331152, -117.21938329443157, -91.98391270859243, -41.32277407238246, -71.84227618346213, -243.82355285142717, -81.94067937832045, -98.69028973403081, -134.9170602501701, -119.1468739436144, -45.5608729651112, -104.68194703230498, -43.80650127110573, -69.32783687197364, -58.121548027135574, -170.3476867621343, -48.50776300230498, -75.65599927653757, -92.99145548686947, -59.77445438148258, -98.36023620063102, -46.91984275635232, -70.37310352179054, -193.15332732885028, -36.83720111799079], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6362273314446989, "mean_inference_ms": 5.453208155753868, "mean_action_processing_ms": 0.2039005946515916, "mean_env_wait_ms": 1.4162029501687396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 406000, "num_agent_steps_trained": 406000, "num_env_steps_sampled": 406000, "num_env_steps_trained": 406000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 406000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 406000, "timers": {"training_iteration_time_ms": 77412.471, "load_time_ms": 29.148, "load_throughput": 480306.898, "learn_time_ms": 69609.144, "learn_throughput": 201.123, "synch_weights_time_ms": 13.072}, "counters": {"num_env_steps_sampled": 406000, "num_env_steps_trained": 406000, "num_agent_steps_sampled": 406000, "num_agent_steps_trained": 406000}, "done": false, "episodes_total": 406, "training_iteration": 29, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-32-17", "timestamp": 1693053137, "time_this_iter_s": 75.64798378944397, "time_total_s": 2296.3130469322205, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015350520>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270153503D0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 2296.3130469322205, "timesteps_since_restore": 0, "iterations_since_restore": 29, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 22.095327102803736, "ram_util_percent": 49.582242990654215}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -274.36796282075346, "episode_L1_reward_sum_min": -616.1873790025711, "episode_L1_reward_sum_max": -156.48445282876492, "episode_L2_reward_sum_mean": -145.38015625201166, "episode_L2_reward_sum_min": -228.5352517813444, "episode_L2_reward_sum_max": -116.54271906614304}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.19503420251579126, "policy_loss": 0.14715128987190387, "vf_loss": 0.47882910325330325, "vf_explained_var": 0.6010739522461047, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "sampler_results": {"episode_reward_max": -31.153598691010057, "episode_reward_min": -243.82355285142717, "episode_reward_mean": -93.73183586068991, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -274.36796282075346, "episode_L1_reward_sum_min": -616.1873790025711, "episode_L1_reward_sum_max": -156.48445282876492, "episode_L2_reward_sum_mean": -145.38015625201166, "episode_L2_reward_sum_min": -228.5352517813444, "episode_L2_reward_sum_max": -116.54271906614304}, "hist_stats": {"episode_reward": [-109.90481532676985, -103.63248511099543, -78.7237120368269, -61.33953560744172, -88.00304181520322, -77.7201562780673, -166.41277854059666, -94.79255798658134, -101.89489751533407, -70.73883278319265, -219.16970238661364, -66.75313093622174, -130.1578482788925, -64.09556492149528, -61.00153889367668, -133.47076767248353, -95.0325788832439, -55.14790239606471, -222.34610024312227, -87.92661727252786, -73.33021132478059, -98.02775675400432, -90.66936282847671, -60.95791157473893, -137.83143299233038, -75.2881000412926, -130.2899196193843, -99.69289351854191, -110.10776988942918, -79.35418658884532, -122.39238776260824, -76.5349635153096, -86.02096838539232, -57.88190998250192, -64.75019155115378, -86.05331706866751, -78.10052318040115, -79.64401188624238, -45.37569932588706, -71.18628771193215, -84.0282016263426, -61.36290039144146, -62.73955059412002, -101.36361739193498, -54.11155920315228, -85.88130665375219, -112.12215306062126, -66.43812634305151, -42.156756520449626, -200.17454587308973, -48.334697625928854, -120.56578947971616, -60.14747711738253, -70.52388418641927, -170.48477952019792, -83.99132137289287, -116.30219462623555, -75.59660391361969, -92.79262040626527, -77.95141496039959, -83.97078236093522, -141.45740281331152, -117.21938329443157, -91.98391270859243, -41.32277407238246, -71.84227618346213, -243.82355285142717, -81.94067937832045, -98.69028973403081, -134.9170602501701, -119.1468739436144, -45.5608729651112, -104.68194703230498, -43.80650127110573, -69.32783687197364, -58.121548027135574, -170.3476867621343, -48.50776300230498, -75.65599927653757, -92.99145548686947, -59.77445438148258, -98.36023620063102, -46.91984275635232, -70.37310352179054, -193.15332732885028, -36.83720111799079, -104.45233012716649, -90.35460181325506, -157.20349005922176, -76.30720116129596, -69.36121329597673, -63.77220957516955, -82.84579022837382, -31.153598691010057, -70.19884899463064, -138.31636518151856, -37.43385243074971, -139.0939489299519, -179.74401549032913, -93.3874852428049], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6347741304135908, "mean_inference_ms": 5.439245604886102, "mean_action_processing_ms": 0.20345165513063165, "mean_env_wait_ms": 1.4124971161477198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -31.153598691010057, "episode_reward_min": -243.82355285142717, "episode_reward_mean": -93.73183586068991, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-109.90481532676985, -103.63248511099543, -78.7237120368269, -61.33953560744172, -88.00304181520322, -77.7201562780673, -166.41277854059666, -94.79255798658134, -101.89489751533407, -70.73883278319265, -219.16970238661364, -66.75313093622174, -130.1578482788925, -64.09556492149528, -61.00153889367668, -133.47076767248353, -95.0325788832439, -55.14790239606471, -222.34610024312227, -87.92661727252786, -73.33021132478059, -98.02775675400432, -90.66936282847671, -60.95791157473893, -137.83143299233038, -75.2881000412926, -130.2899196193843, -99.69289351854191, -110.10776988942918, -79.35418658884532, -122.39238776260824, -76.5349635153096, -86.02096838539232, -57.88190998250192, -64.75019155115378, -86.05331706866751, -78.10052318040115, -79.64401188624238, -45.37569932588706, -71.18628771193215, -84.0282016263426, -61.36290039144146, -62.73955059412002, -101.36361739193498, -54.11155920315228, -85.88130665375219, -112.12215306062126, -66.43812634305151, -42.156756520449626, -200.17454587308973, -48.334697625928854, -120.56578947971616, -60.14747711738253, -70.52388418641927, -170.48477952019792, -83.99132137289287, -116.30219462623555, -75.59660391361969, -92.79262040626527, -77.95141496039959, -83.97078236093522, -141.45740281331152, -117.21938329443157, -91.98391270859243, -41.32277407238246, -71.84227618346213, -243.82355285142717, -81.94067937832045, -98.69028973403081, -134.9170602501701, -119.1468739436144, -45.5608729651112, -104.68194703230498, -43.80650127110573, -69.32783687197364, -58.121548027135574, -170.3476867621343, -48.50776300230498, -75.65599927653757, -92.99145548686947, -59.77445438148258, -98.36023620063102, -46.91984275635232, -70.37310352179054, -193.15332732885028, -36.83720111799079, -104.45233012716649, -90.35460181325506, -157.20349005922176, -76.30720116129596, -69.36121329597673, -63.77220957516955, -82.84579022837382, -31.153598691010057, -70.19884899463064, -138.31636518151856, -37.43385243074971, -139.0939489299519, -179.74401549032913, -93.3874852428049], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6347741304135908, "mean_inference_ms": 5.439245604886102, "mean_action_processing_ms": 0.20345165513063165, "mean_env_wait_ms": 1.4124971161477198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 420000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 76943.88, "load_time_ms": 28.45, "load_throughput": 492092.827, "learn_time_ms": 69282.038, "learn_throughput": 202.073, "synch_weights_time_ms": 13.072}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "episodes_total": 420, "training_iteration": 30, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-33-32", "timestamp": 1693053212, "time_this_iter_s": 75.74501872062683, "time_total_s": 2372.0580656528473, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270153603D0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150E8B80>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 2372.0580656528473, "timesteps_since_restore": 0, "iterations_since_restore": 30, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.957009345794397, "ram_util_percent": 49.794392523364486}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -266.1479736598581, "episode_L1_reward_sum_min": -616.1873790025711, "episode_L1_reward_sum_max": -162.33140416443348, "episode_L2_reward_sum_mean": -143.33667847007513, "episode_L2_reward_sum_min": -228.5352517813444, "episode_L2_reward_sum_max": -116.54271906614304}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.19224237541810882, "policy_loss": 0.16217363858739214, "vf_loss": 0.3006873954596197, "vf_explained_var": 0.5647807531825308, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 434000, "num_env_steps_trained": 434000, "num_agent_steps_sampled": 434000, "num_agent_steps_trained": 434000}, "sampler_results": {"episode_reward_max": -31.153598691010057, "episode_reward_min": -243.82355285142717, "episode_reward_mean": -90.20677181230138, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -266.1479736598581, "episode_L1_reward_sum_min": -616.1873790025711, "episode_L1_reward_sum_max": -162.33140416443348, "episode_L2_reward_sum_mean": -143.33667847007513, "episode_L2_reward_sum_min": -228.5352517813444, "episode_L2_reward_sum_max": -116.54271906614304}, "hist_stats": {"episode_reward": [-61.00153889367668, -133.47076767248353, -95.0325788832439, -55.14790239606471, -222.34610024312227, -87.92661727252786, -73.33021132478059, -98.02775675400432, -90.66936282847671, -60.95791157473893, -137.83143299233038, -75.2881000412926, -130.2899196193843, -99.69289351854191, -110.10776988942918, -79.35418658884532, -122.39238776260824, -76.5349635153096, -86.02096838539232, -57.88190998250192, -64.75019155115378, -86.05331706866751, -78.10052318040115, -79.64401188624238, -45.37569932588706, -71.18628771193215, -84.0282016263426, -61.36290039144146, -62.73955059412002, -101.36361739193498, -54.11155920315228, -85.88130665375219, -112.12215306062126, -66.43812634305151, -42.156756520449626, -200.17454587308973, -48.334697625928854, -120.56578947971616, -60.14747711738253, -70.52388418641927, -170.48477952019792, -83.99132137289287, -116.30219462623555, -75.59660391361969, -92.79262040626527, -77.95141496039959, -83.97078236093522, -141.45740281331152, -117.21938329443157, -91.98391270859243, -41.32277407238246, -71.84227618346213, -243.82355285142717, -81.94067937832045, -98.69028973403081, -134.9170602501701, -119.1468739436144, -45.5608729651112, -104.68194703230498, -43.80650127110573, -69.32783687197364, -58.121548027135574, -170.3476867621343, -48.50776300230498, -75.65599927653757, -92.99145548686947, -59.77445438148258, -98.36023620063102, -46.91984275635232, -70.37310352179054, -193.15332732885028, -36.83720111799079, -104.45233012716649, -90.35460181325506, -157.20349005922176, -76.30720116129596, -69.36121329597673, -63.77220957516955, -82.84579022837382, -31.153598691010057, -70.19884899463064, -138.31636518151856, -37.43385243074971, -139.0939489299519, -179.74401549032913, -93.3874852428049, -54.71124348930853, -83.01224267913219, -46.55248313140318, -61.92919877167565, -38.23911889760197, -58.93281188716982, -61.953224924408374, -104.88009844478724, -64.92792274459569, -157.38676238389874, -82.57699548174136, -41.52832596285003, -143.92886077373848, -80.27336511306659], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.633368849576939, "mean_inference_ms": 5.42498962494426, "mean_action_processing_ms": 0.20297850978362483, "mean_env_wait_ms": 1.4086719522930946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -31.153598691010057, "episode_reward_min": -243.82355285142717, "episode_reward_mean": -90.20677181230138, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-61.00153889367668, -133.47076767248353, -95.0325788832439, -55.14790239606471, -222.34610024312227, -87.92661727252786, -73.33021132478059, -98.02775675400432, -90.66936282847671, -60.95791157473893, -137.83143299233038, -75.2881000412926, -130.2899196193843, -99.69289351854191, -110.10776988942918, -79.35418658884532, -122.39238776260824, -76.5349635153096, -86.02096838539232, -57.88190998250192, -64.75019155115378, -86.05331706866751, -78.10052318040115, -79.64401188624238, -45.37569932588706, -71.18628771193215, -84.0282016263426, -61.36290039144146, -62.73955059412002, -101.36361739193498, -54.11155920315228, -85.88130665375219, -112.12215306062126, -66.43812634305151, -42.156756520449626, -200.17454587308973, -48.334697625928854, -120.56578947971616, -60.14747711738253, -70.52388418641927, -170.48477952019792, -83.99132137289287, -116.30219462623555, -75.59660391361969, -92.79262040626527, -77.95141496039959, -83.97078236093522, -141.45740281331152, -117.21938329443157, -91.98391270859243, -41.32277407238246, -71.84227618346213, -243.82355285142717, -81.94067937832045, -98.69028973403081, -134.9170602501701, -119.1468739436144, -45.5608729651112, -104.68194703230498, -43.80650127110573, -69.32783687197364, -58.121548027135574, -170.3476867621343, -48.50776300230498, -75.65599927653757, -92.99145548686947, -59.77445438148258, -98.36023620063102, -46.91984275635232, -70.37310352179054, -193.15332732885028, -36.83720111799079, -104.45233012716649, -90.35460181325506, -157.20349005922176, -76.30720116129596, -69.36121329597673, -63.77220957516955, -82.84579022837382, -31.153598691010057, -70.19884899463064, -138.31636518151856, -37.43385243074971, -139.0939489299519, -179.74401549032913, -93.3874852428049, -54.71124348930853, -83.01224267913219, -46.55248313140318, -61.92919877167565, -38.23911889760197, -58.93281188716982, -61.953224924408374, -104.88009844478724, -64.92792274459569, -157.38676238389874, -82.57699548174136, -41.52832596285003, -143.92886077373848, -80.27336511306659], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.633368849576939, "mean_inference_ms": 5.42498962494426, "mean_action_processing_ms": 0.20297850978362483, "mean_env_wait_ms": 1.4086719522930946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 434000, "num_agent_steps_trained": 434000, "num_env_steps_sampled": 434000, "num_env_steps_trained": 434000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 434000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 434000, "timers": {"training_iteration_time_ms": 76543.95, "load_time_ms": 28.448, "load_throughput": 492130.769, "learn_time_ms": 68977.244, "learn_throughput": 202.965, "synch_weights_time_ms": 12.87}, "counters": {"num_env_steps_sampled": 434000, "num_env_steps_trained": 434000, "num_agent_steps_sampled": 434000, "num_agent_steps_trained": 434000}, "done": false, "episodes_total": 434, "training_iteration": 31, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-34-48", "timestamp": 1693053288, "time_this_iter_s": 75.8544852733612, "time_total_s": 2447.9125509262085, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701524F5B0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701524F790>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 2447.9125509262085, "timesteps_since_restore": 0, "iterations_since_restore": 31, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 22.217757009345792, "ram_util_percent": 49.831775700934564}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -262.5019341560453, "episode_L1_reward_sum_min": -585.6482563912868, "episode_L1_reward_sum_max": -162.33140416443348, "episode_L2_reward_sum_mean": -142.43026465073228, "episode_L2_reward_sum_min": -217.89436520636082, "episode_L2_reward_sum_max": -116.54271906614304}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.19390562726479357, "policy_loss": 0.15884653248916641, "vf_loss": 0.3505909409530026, "vf_explained_var": 0.6598868151444467, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "sampler_results": {"episode_reward_max": -31.153598691010057, "episode_reward_min": -243.82355285142717, "episode_reward_mean": -89.1220210102238, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -262.5019341560453, "episode_L1_reward_sum_min": -585.6482563912868, "episode_L1_reward_sum_max": -162.33140416443348, "episode_L2_reward_sum_mean": -142.43026465073228, "episode_L2_reward_sum_min": -217.89436520636082, "episode_L2_reward_sum_max": -116.54271906614304}, "hist_stats": {"episode_reward": [-110.10776988942918, -79.35418658884532, -122.39238776260824, -76.5349635153096, -86.02096838539232, -57.88190998250192, -64.75019155115378, -86.05331706866751, -78.10052318040115, -79.64401188624238, -45.37569932588706, -71.18628771193215, -84.0282016263426, -61.36290039144146, -62.73955059412002, -101.36361739193498, -54.11155920315228, -85.88130665375219, -112.12215306062126, -66.43812634305151, -42.156756520449626, -200.17454587308973, -48.334697625928854, -120.56578947971616, -60.14747711738253, -70.52388418641927, -170.48477952019792, -83.99132137289287, -116.30219462623555, -75.59660391361969, -92.79262040626527, -77.95141496039959, -83.97078236093522, -141.45740281331152, -117.21938329443157, -91.98391270859243, -41.32277407238246, -71.84227618346213, -243.82355285142717, -81.94067937832045, -98.69028973403081, -134.9170602501701, -119.1468739436144, -45.5608729651112, -104.68194703230498, -43.80650127110573, -69.32783687197364, -58.121548027135574, -170.3476867621343, -48.50776300230498, -75.65599927653757, -92.99145548686947, -59.77445438148258, -98.36023620063102, -46.91984275635232, -70.37310352179054, -193.15332732885028, -36.83720111799079, -104.45233012716649, -90.35460181325506, -157.20349005922176, -76.30720116129596, -69.36121329597673, -63.77220957516955, -82.84579022837382, -31.153598691010057, -70.19884899463064, -138.31636518151856, -37.43385243074971, -139.0939489299519, -179.74401549032913, -93.3874852428049, -54.71124348930853, -83.01224267913219, -46.55248313140318, -61.92919877167565, -38.23911889760197, -58.93281188716982, -61.953224924408374, -104.88009844478724, -64.92792274459569, -157.38676238389874, -82.57699548174136, -41.52832596285003, -143.92886077373848, -80.27336511306659, -49.56825748170716, -75.11686467605855, -64.1119066023742, -77.85221221432145, -95.20938240006612, -213.86231953375582, -76.2201069652885, -114.20430358747733, -89.9634938491778, -52.59887635066159, -121.85379517530397, -70.97260144198319, -111.1126871689187, -99.89120635981561], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6320640242868182, "mean_inference_ms": 5.41048382824765, "mean_action_processing_ms": 0.20257325495898876, "mean_env_wait_ms": 1.4046580970297304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -31.153598691010057, "episode_reward_min": -243.82355285142717, "episode_reward_mean": -89.1220210102238, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-110.10776988942918, -79.35418658884532, -122.39238776260824, -76.5349635153096, -86.02096838539232, -57.88190998250192, -64.75019155115378, -86.05331706866751, -78.10052318040115, -79.64401188624238, -45.37569932588706, -71.18628771193215, -84.0282016263426, -61.36290039144146, -62.73955059412002, -101.36361739193498, -54.11155920315228, -85.88130665375219, -112.12215306062126, -66.43812634305151, -42.156756520449626, -200.17454587308973, -48.334697625928854, -120.56578947971616, -60.14747711738253, -70.52388418641927, -170.48477952019792, -83.99132137289287, -116.30219462623555, -75.59660391361969, -92.79262040626527, -77.95141496039959, -83.97078236093522, -141.45740281331152, -117.21938329443157, -91.98391270859243, -41.32277407238246, -71.84227618346213, -243.82355285142717, -81.94067937832045, -98.69028973403081, -134.9170602501701, -119.1468739436144, -45.5608729651112, -104.68194703230498, -43.80650127110573, -69.32783687197364, -58.121548027135574, -170.3476867621343, -48.50776300230498, -75.65599927653757, -92.99145548686947, -59.77445438148258, -98.36023620063102, -46.91984275635232, -70.37310352179054, -193.15332732885028, -36.83720111799079, -104.45233012716649, -90.35460181325506, -157.20349005922176, -76.30720116129596, -69.36121329597673, -63.77220957516955, -82.84579022837382, -31.153598691010057, -70.19884899463064, -138.31636518151856, -37.43385243074971, -139.0939489299519, -179.74401549032913, -93.3874852428049, -54.71124348930853, -83.01224267913219, -46.55248313140318, -61.92919877167565, -38.23911889760197, -58.93281188716982, -61.953224924408374, -104.88009844478724, -64.92792274459569, -157.38676238389874, -82.57699548174136, -41.52832596285003, -143.92886077373848, -80.27336511306659, -49.56825748170716, -75.11686467605855, -64.1119066023742, -77.85221221432145, -95.20938240006612, -213.86231953375582, -76.2201069652885, -114.20430358747733, -89.9634938491778, -52.59887635066159, -121.85379517530397, -70.97260144198319, -111.1126871689187, -99.89120635981561], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6320640242868182, "mean_inference_ms": 5.41048382824765, "mean_action_processing_ms": 0.20257325495898876, "mean_env_wait_ms": 1.4046580970297304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 448000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 76164.994, "load_time_ms": 28.547, "load_throughput": 490411.102, "learn_time_ms": 68684.08, "learn_throughput": 203.832, "synch_weights_time_ms": 12.269}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "episodes_total": 448, "training_iteration": 32, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-36-04", "timestamp": 1693053364, "time_this_iter_s": 75.68098568916321, "time_total_s": 2523.5935366153717, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015260AC0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015443700>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 2523.5935366153717, "timesteps_since_restore": 0, "iterations_since_restore": 32, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.805607476635515, "ram_util_percent": 49.854205607476615}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -269.6864434903115, "episode_L1_reward_sum_min": -585.6482563912868, "episode_L1_reward_sum_max": -162.33140416443348, "episode_L2_reward_sum_mean": -144.22721078038217, "episode_L2_reward_sum_min": -217.89436520636082, "episode_L2_reward_sum_max": -116.54271906614304}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.19767515159318885, "policy_loss": 0.15919479655722057, "vf_loss": 0.3848035458861551, "vf_explained_var": 0.6802841337865272, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 462000, "num_env_steps_trained": 462000, "num_agent_steps_sampled": 462000, "num_agent_steps_trained": 462000}, "sampler_results": {"episode_reward_max": -28.92725478082487, "episode_reward_min": -243.82355285142717, "episode_reward_mean": -89.63542084878715, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -269.6864434903115, "episode_L1_reward_sum_min": -585.6482563912868, "episode_L1_reward_sum_max": -162.33140416443348, "episode_L2_reward_sum_mean": -144.22721078038217, "episode_L2_reward_sum_min": -217.89436520636082, "episode_L2_reward_sum_max": -116.54271906614304}, "hist_stats": {"episode_reward": [-62.73955059412002, -101.36361739193498, -54.11155920315228, -85.88130665375219, -112.12215306062126, -66.43812634305151, -42.156756520449626, -200.17454587308973, -48.334697625928854, -120.56578947971616, -60.14747711738253, -70.52388418641927, -170.48477952019792, -83.99132137289287, -116.30219462623555, -75.59660391361969, -92.79262040626527, -77.95141496039959, -83.97078236093522, -141.45740281331152, -117.21938329443157, -91.98391270859243, -41.32277407238246, -71.84227618346213, -243.82355285142717, -81.94067937832045, -98.69028973403081, -134.9170602501701, -119.1468739436144, -45.5608729651112, -104.68194703230498, -43.80650127110573, -69.32783687197364, -58.121548027135574, -170.3476867621343, -48.50776300230498, -75.65599927653757, -92.99145548686947, -59.77445438148258, -98.36023620063102, -46.91984275635232, -70.37310352179054, -193.15332732885028, -36.83720111799079, -104.45233012716649, -90.35460181325506, -157.20349005922176, -76.30720116129596, -69.36121329597673, -63.77220957516955, -82.84579022837382, -31.153598691010057, -70.19884899463064, -138.31636518151856, -37.43385243074971, -139.0939489299519, -179.74401549032913, -93.3874852428049, -54.71124348930853, -83.01224267913219, -46.55248313140318, -61.92919877167565, -38.23911889760197, -58.93281188716982, -61.953224924408374, -104.88009844478724, -64.92792274459569, -157.38676238389874, -82.57699548174136, -41.52832596285003, -143.92886077373848, -80.27336511306659, -49.56825748170716, -75.11686467605855, -64.1119066023742, -77.85221221432145, -95.20938240006612, -213.86231953375582, -76.2201069652885, -114.20430358747733, -89.9634938491778, -52.59887635066159, -121.85379517530397, -70.97260144198319, -111.1126871689187, -99.89120635981561, -28.92725478082487, -176.0487704272792, -56.899460755617184, -57.130534138783766, -56.40943134652349, -69.78073555027078, -103.84506606793718, -83.97522779511273, -82.40081692353948, -99.10960270508303, -62.93186487704744, -142.13298960609708, -38.60704240757994, -95.93450534079268], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6307625691037015, "mean_inference_ms": 5.396762604424805, "mean_action_processing_ms": 0.20217667504463033, "mean_env_wait_ms": 1.4008323947278987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -28.92725478082487, "episode_reward_min": -243.82355285142717, "episode_reward_mean": -89.63542084878715, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-62.73955059412002, -101.36361739193498, -54.11155920315228, -85.88130665375219, -112.12215306062126, -66.43812634305151, -42.156756520449626, -200.17454587308973, -48.334697625928854, -120.56578947971616, -60.14747711738253, -70.52388418641927, -170.48477952019792, -83.99132137289287, -116.30219462623555, -75.59660391361969, -92.79262040626527, -77.95141496039959, -83.97078236093522, -141.45740281331152, -117.21938329443157, -91.98391270859243, -41.32277407238246, -71.84227618346213, -243.82355285142717, -81.94067937832045, -98.69028973403081, -134.9170602501701, -119.1468739436144, -45.5608729651112, -104.68194703230498, -43.80650127110573, -69.32783687197364, -58.121548027135574, -170.3476867621343, -48.50776300230498, -75.65599927653757, -92.99145548686947, -59.77445438148258, -98.36023620063102, -46.91984275635232, -70.37310352179054, -193.15332732885028, -36.83720111799079, -104.45233012716649, -90.35460181325506, -157.20349005922176, -76.30720116129596, -69.36121329597673, -63.77220957516955, -82.84579022837382, -31.153598691010057, -70.19884899463064, -138.31636518151856, -37.43385243074971, -139.0939489299519, -179.74401549032913, -93.3874852428049, -54.71124348930853, -83.01224267913219, -46.55248313140318, -61.92919877167565, -38.23911889760197, -58.93281188716982, -61.953224924408374, -104.88009844478724, -64.92792274459569, -157.38676238389874, -82.57699548174136, -41.52832596285003, -143.92886077373848, -80.27336511306659, -49.56825748170716, -75.11686467605855, -64.1119066023742, -77.85221221432145, -95.20938240006612, -213.86231953375582, -76.2201069652885, -114.20430358747733, -89.9634938491778, -52.59887635066159, -121.85379517530397, -70.97260144198319, -111.1126871689187, -99.89120635981561, -28.92725478082487, -176.0487704272792, -56.899460755617184, -57.130534138783766, -56.40943134652349, -69.78073555027078, -103.84506606793718, -83.97522779511273, -82.40081692353948, -99.10960270508303, -62.93186487704744, -142.13298960609708, -38.60704240757994, -95.93450534079268], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6307625691037015, "mean_inference_ms": 5.396762604424805, "mean_action_processing_ms": 0.20217667504463033, "mean_env_wait_ms": 1.4008323947278987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 462000, "num_agent_steps_trained": 462000, "num_env_steps_sampled": 462000, "num_env_steps_trained": 462000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 462000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 462000, "timers": {"training_iteration_time_ms": 75759.741, "load_time_ms": 28.251, "load_throughput": 495560.951, "learn_time_ms": 68341.954, "learn_throughput": 204.852, "synch_weights_time_ms": 12.379}, "counters": {"num_env_steps_sampled": 462000, "num_env_steps_trained": 462000, "num_agent_steps_sampled": 462000, "num_agent_steps_trained": 462000}, "done": false, "episodes_total": 462, "training_iteration": 33, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-37-20", "timestamp": 1693053440, "time_this_iter_s": 75.62749338150024, "time_total_s": 2599.221029996872, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701545E820>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014F1BDC0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 2599.221029996872, "timesteps_since_restore": 0, "iterations_since_restore": 33, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.80841121495327, "ram_util_percent": 49.85981308411213}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -264.3266438546777, "episode_L1_reward_sum_min": -585.6482563912868, "episode_L1_reward_sum_max": -162.33140416443348, "episode_L2_reward_sum_mean": -142.9070920870453, "episode_L2_reward_sum_min": -217.89436520636082, "episode_L2_reward_sum_max": -116.54271906614304}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.16271609686235533, "policy_loss": 0.13228874857663925, "vf_loss": 0.3042734462035127, "vf_explained_var": 0.6418360263538458, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 476000}, "sampler_results": {"episode_reward_max": -28.92725478082487, "episode_reward_min": -243.82355285142717, "episode_reward_mean": -88.52860111485508, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -264.3266438546777, "episode_L1_reward_sum_min": -585.6482563912868, "episode_L1_reward_sum_max": -162.33140416443348, "episode_L2_reward_sum_mean": -142.9070920870453, "episode_L2_reward_sum_min": -217.89436520636082, "episode_L2_reward_sum_max": -116.54271906614304}, "hist_stats": {"episode_reward": [-116.30219462623555, -75.59660391361969, -92.79262040626527, -77.95141496039959, -83.97078236093522, -141.45740281331152, -117.21938329443157, -91.98391270859243, -41.32277407238246, -71.84227618346213, -243.82355285142717, -81.94067937832045, -98.69028973403081, -134.9170602501701, -119.1468739436144, -45.5608729651112, -104.68194703230498, -43.80650127110573, -69.32783687197364, -58.121548027135574, -170.3476867621343, -48.50776300230498, -75.65599927653757, -92.99145548686947, -59.77445438148258, -98.36023620063102, -46.91984275635232, -70.37310352179054, -193.15332732885028, -36.83720111799079, -104.45233012716649, -90.35460181325506, -157.20349005922176, -76.30720116129596, -69.36121329597673, -63.77220957516955, -82.84579022837382, -31.153598691010057, -70.19884899463064, -138.31636518151856, -37.43385243074971, -139.0939489299519, -179.74401549032913, -93.3874852428049, -54.71124348930853, -83.01224267913219, -46.55248313140318, -61.92919877167565, -38.23911889760197, -58.93281188716982, -61.953224924408374, -104.88009844478724, -64.92792274459569, -157.38676238389874, -82.57699548174136, -41.52832596285003, -143.92886077373848, -80.27336511306659, -49.56825748170716, -75.11686467605855, -64.1119066023742, -77.85221221432145, -95.20938240006612, -213.86231953375582, -76.2201069652885, -114.20430358747733, -89.9634938491778, -52.59887635066159, -121.85379517530397, -70.97260144198319, -111.1126871689187, -99.89120635981561, -28.92725478082487, -176.0487704272792, -56.899460755617184, -57.130534138783766, -56.40943134652349, -69.78073555027078, -103.84506606793718, -83.97522779511273, -82.40081692353948, -99.10960270508303, -62.93186487704744, -142.13298960609708, -38.60704240757994, -95.93450534079268, -95.01225736983749, -60.23720819183998, -85.66223734706452, -63.28871740766201, -88.44602414407885, -102.05598971483268, -54.60283593128415, -147.9280017157945, -61.14087064957281, -49.05971268168307, -97.0234349946069, -92.68186835353586, -79.39466785449068, -91.81976519321958], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6297069835451815, "mean_inference_ms": 5.384433123747559, "mean_action_processing_ms": 0.2018714957878588, "mean_env_wait_ms": 1.397426227540802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -28.92725478082487, "episode_reward_min": -243.82355285142717, "episode_reward_mean": -88.52860111485508, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-116.30219462623555, -75.59660391361969, -92.79262040626527, -77.95141496039959, -83.97078236093522, -141.45740281331152, -117.21938329443157, -91.98391270859243, -41.32277407238246, -71.84227618346213, -243.82355285142717, -81.94067937832045, -98.69028973403081, -134.9170602501701, -119.1468739436144, -45.5608729651112, -104.68194703230498, -43.80650127110573, -69.32783687197364, -58.121548027135574, -170.3476867621343, -48.50776300230498, -75.65599927653757, -92.99145548686947, -59.77445438148258, -98.36023620063102, -46.91984275635232, -70.37310352179054, -193.15332732885028, -36.83720111799079, -104.45233012716649, -90.35460181325506, -157.20349005922176, -76.30720116129596, -69.36121329597673, -63.77220957516955, -82.84579022837382, -31.153598691010057, -70.19884899463064, -138.31636518151856, -37.43385243074971, -139.0939489299519, -179.74401549032913, -93.3874852428049, -54.71124348930853, -83.01224267913219, -46.55248313140318, -61.92919877167565, -38.23911889760197, -58.93281188716982, -61.953224924408374, -104.88009844478724, -64.92792274459569, -157.38676238389874, -82.57699548174136, -41.52832596285003, -143.92886077373848, -80.27336511306659, -49.56825748170716, -75.11686467605855, -64.1119066023742, -77.85221221432145, -95.20938240006612, -213.86231953375582, -76.2201069652885, -114.20430358747733, -89.9634938491778, -52.59887635066159, -121.85379517530397, -70.97260144198319, -111.1126871689187, -99.89120635981561, -28.92725478082487, -176.0487704272792, -56.899460755617184, -57.130534138783766, -56.40943134652349, -69.78073555027078, -103.84506606793718, -83.97522779511273, -82.40081692353948, -99.10960270508303, -62.93186487704744, -142.13298960609708, -38.60704240757994, -95.93450534079268, -95.01225736983749, -60.23720819183998, -85.66223734706452, -63.28871740766201, -88.44602414407885, -102.05598971483268, -54.60283593128415, -147.9280017157945, -61.14087064957281, -49.05971268168307, -97.0234349946069, -92.68186835353586, -79.39466785449068, -91.81976519321958], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6297069835451815, "mean_inference_ms": 5.384433123747559, "mean_action_processing_ms": 0.2018714957878588, "mean_env_wait_ms": 1.397426227540802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 476000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 476000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 476000, "timers": {"training_iteration_time_ms": 75739.904, "load_time_ms": 28.24, "load_throughput": 495752.571, "learn_time_ms": 68319.976, "learn_throughput": 204.918, "synch_weights_time_ms": 13.074}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 476000}, "done": false, "episodes_total": 476, "training_iteration": 34, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-38-36", "timestamp": 1693053516, "time_this_iter_s": 76.12373638153076, "time_total_s": 2675.3447663784027, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015238700>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701516F940>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 2675.3447663784027, "timesteps_since_restore": 0, "iterations_since_restore": 34, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 22.483177570093456, "ram_util_percent": 49.580373831775695}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -259.99856614887716, "episode_L1_reward_sum_min": -565.9248368293047, "episode_L1_reward_sum_max": -162.33140416443348, "episode_L2_reward_sum_mean": -141.92104221895337, "episode_L2_reward_sum_min": -216.58170986920595, "episode_L2_reward_sum_max": -116.54271906614304}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.20371542943973542, "policy_loss": 0.1577972897212021, "vf_loss": 0.45918139198520225, "vf_explained_var": 0.6981807315852416, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 490000, "num_env_steps_trained": 490000, "num_agent_steps_sampled": 490000, "num_agent_steps_trained": 490000}, "sampler_results": {"episode_reward_max": -28.92725478082487, "episode_reward_min": -213.86231953375582, "episode_reward_mean": -86.17233481187793, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -259.99856614887716, "episode_L1_reward_sum_min": -565.9248368293047, "episode_L1_reward_sum_max": -162.33140416443348, "episode_L2_reward_sum_mean": -141.92104221895337, "episode_L2_reward_sum_min": -216.58170986920595, "episode_L2_reward_sum_max": -116.54271906614304}, "hist_stats": {"episode_reward": [-119.1468739436144, -45.5608729651112, -104.68194703230498, -43.80650127110573, -69.32783687197364, -58.121548027135574, -170.3476867621343, -48.50776300230498, -75.65599927653757, -92.99145548686947, -59.77445438148258, -98.36023620063102, -46.91984275635232, -70.37310352179054, -193.15332732885028, -36.83720111799079, -104.45233012716649, -90.35460181325506, -157.20349005922176, -76.30720116129596, -69.36121329597673, -63.77220957516955, -82.84579022837382, -31.153598691010057, -70.19884899463064, -138.31636518151856, -37.43385243074971, -139.0939489299519, -179.74401549032913, -93.3874852428049, -54.71124348930853, -83.01224267913219, -46.55248313140318, -61.92919877167565, -38.23911889760197, -58.93281188716982, -61.953224924408374, -104.88009844478724, -64.92792274459569, -157.38676238389874, -82.57699548174136, -41.52832596285003, -143.92886077373848, -80.27336511306659, -49.56825748170716, -75.11686467605855, -64.1119066023742, -77.85221221432145, -95.20938240006612, -213.86231953375582, -76.2201069652885, -114.20430358747733, -89.9634938491778, -52.59887635066159, -121.85379517530397, -70.97260144198319, -111.1126871689187, -99.89120635981561, -28.92725478082487, -176.0487704272792, -56.899460755617184, -57.130534138783766, -56.40943134652349, -69.78073555027078, -103.84506606793718, -83.97522779511273, -82.40081692353948, -99.10960270508303, -62.93186487704744, -142.13298960609708, -38.60704240757994, -95.93450534079268, -95.01225736983749, -60.23720819183998, -85.66223734706452, -63.28871740766201, -88.44602414407885, -102.05598971483268, -54.60283593128415, -147.9280017157945, -61.14087064957281, -49.05971268168307, -97.0234349946069, -92.68186835353586, -79.39466785449068, -91.81976519321958, -83.66177792507898, -133.9275659263071, -77.97731464996953, -75.23649312436551, -111.81312904907689, -121.8823575652659, -105.8255377976743, -70.01292291426883, -63.49795652785755, -90.26696449726738, -97.9634490643354, -85.26096461648267, -52.941206141407534, -63.91667745651255], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6287031362535062, "mean_inference_ms": 5.372437166258193, "mean_action_processing_ms": 0.20153414997814706, "mean_env_wait_ms": 1.3940599702450698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -28.92725478082487, "episode_reward_min": -213.86231953375582, "episode_reward_mean": -86.17233481187793, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-119.1468739436144, -45.5608729651112, -104.68194703230498, -43.80650127110573, -69.32783687197364, -58.121548027135574, -170.3476867621343, -48.50776300230498, -75.65599927653757, -92.99145548686947, -59.77445438148258, -98.36023620063102, -46.91984275635232, -70.37310352179054, -193.15332732885028, -36.83720111799079, -104.45233012716649, -90.35460181325506, -157.20349005922176, -76.30720116129596, -69.36121329597673, -63.77220957516955, -82.84579022837382, -31.153598691010057, -70.19884899463064, -138.31636518151856, -37.43385243074971, -139.0939489299519, -179.74401549032913, -93.3874852428049, -54.71124348930853, -83.01224267913219, -46.55248313140318, -61.92919877167565, -38.23911889760197, -58.93281188716982, -61.953224924408374, -104.88009844478724, -64.92792274459569, -157.38676238389874, -82.57699548174136, -41.52832596285003, -143.92886077373848, -80.27336511306659, -49.56825748170716, -75.11686467605855, -64.1119066023742, -77.85221221432145, -95.20938240006612, -213.86231953375582, -76.2201069652885, -114.20430358747733, -89.9634938491778, -52.59887635066159, -121.85379517530397, -70.97260144198319, -111.1126871689187, -99.89120635981561, -28.92725478082487, -176.0487704272792, -56.899460755617184, -57.130534138783766, -56.40943134652349, -69.78073555027078, -103.84506606793718, -83.97522779511273, -82.40081692353948, -99.10960270508303, -62.93186487704744, -142.13298960609708, -38.60704240757994, -95.93450534079268, -95.01225736983749, -60.23720819183998, -85.66223734706452, -63.28871740766201, -88.44602414407885, -102.05598971483268, -54.60283593128415, -147.9280017157945, -61.14087064957281, -49.05971268168307, -97.0234349946069, -92.68186835353586, -79.39466785449068, -91.81976519321958, -83.66177792507898, -133.9275659263071, -77.97731464996953, -75.23649312436551, -111.81312904907689, -121.8823575652659, -105.8255377976743, -70.01292291426883, -63.49795652785755, -90.26696449726738, -97.9634490643354, -85.26096461648267, -52.941206141407534, -63.91667745651255], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6287031362535062, "mean_inference_ms": 5.372437166258193, "mean_action_processing_ms": 0.20153414997814706, "mean_env_wait_ms": 1.3940599702450698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 490000, "num_agent_steps_trained": 490000, "num_env_steps_sampled": 490000, "num_env_steps_trained": 490000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 490000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 490000, "timers": {"training_iteration_time_ms": 75736.371, "load_time_ms": 27.755, "load_throughput": 504414.085, "learn_time_ms": 68341.85, "learn_throughput": 204.853, "synch_weights_time_ms": 13.071}, "counters": {"num_env_steps_sampled": 490000, "num_env_steps_trained": 490000, "num_agent_steps_sampled": 490000, "num_agent_steps_trained": 490000}, "done": false, "episodes_total": 490, "training_iteration": 35, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-39-52", "timestamp": 1693053592, "time_this_iter_s": 75.66870331764221, "time_total_s": 2751.013469696045, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014F64580>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701543FD60>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 2751.013469696045, "timesteps_since_restore": 0, "iterations_since_restore": 35, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 22.103738317757013, "ram_util_percent": 49.40560747663551}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -258.30557254612444, "episode_L1_reward_sum_min": -565.9248368293047, "episode_L1_reward_sum_max": -154.41432212293148, "episode_L2_reward_sum_mean": -141.53868538103998, "episode_L2_reward_sum_min": -216.58170986920595, "episode_L2_reward_sum_max": -114.88031254708767}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.13462469043232186, "policy_loss": 0.09009648165512263, "vf_loss": 0.4452820732596564, "vf_explained_var": 0.6025635819008321, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": -28.92725478082487, "episode_reward_min": -213.86231953375582, "episode_reward_mean": -87.30270100924807, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -258.30557254612444, "episode_L1_reward_sum_min": -565.9248368293047, "episode_L1_reward_sum_max": -154.41432212293148, "episode_L2_reward_sum_mean": -141.53868538103998, "episode_L2_reward_sum_min": -216.58170986920595, "episode_L2_reward_sum_max": -114.88031254708767}, "hist_stats": {"episode_reward": [-193.15332732885028, -36.83720111799079, -104.45233012716649, -90.35460181325506, -157.20349005922176, -76.30720116129596, -69.36121329597673, -63.77220957516955, -82.84579022837382, -31.153598691010057, -70.19884899463064, -138.31636518151856, -37.43385243074971, -139.0939489299519, -179.74401549032913, -93.3874852428049, -54.71124348930853, -83.01224267913219, -46.55248313140318, -61.92919877167565, -38.23911889760197, -58.93281188716982, -61.953224924408374, -104.88009844478724, -64.92792274459569, -157.38676238389874, -82.57699548174136, -41.52832596285003, -143.92886077373848, -80.27336511306659, -49.56825748170716, -75.11686467605855, -64.1119066023742, -77.85221221432145, -95.20938240006612, -213.86231953375582, -76.2201069652885, -114.20430358747733, -89.9634938491778, -52.59887635066159, -121.85379517530397, -70.97260144198319, -111.1126871689187, -99.89120635981561, -28.92725478082487, -176.0487704272792, -56.899460755617184, -57.130534138783766, -56.40943134652349, -69.78073555027078, -103.84506606793718, -83.97522779511273, -82.40081692353948, -99.10960270508303, -62.93186487704744, -142.13298960609708, -38.60704240757994, -95.93450534079268, -95.01225736983749, -60.23720819183998, -85.66223734706452, -63.28871740766201, -88.44602414407885, -102.05598971483268, -54.60283593128415, -147.9280017157945, -61.14087064957281, -49.05971268168307, -97.0234349946069, -92.68186835353586, -79.39466785449068, -91.81976519321958, -83.66177792507898, -133.9275659263071, -77.97731464996953, -75.23649312436551, -111.81312904907689, -121.8823575652659, -105.8255377976743, -70.01292291426883, -63.49795652785755, -90.26696449726738, -97.9634490643354, -85.26096461648267, -52.941206141407534, -63.91667745651255, -193.57998733303862, -37.30017477260778, -99.06163323073628, -64.61029751487823, -84.91303911765206, -60.87637807936703, -55.69692364374634, -137.04098718045898, -51.76815561361165, -68.9779573295503, -87.41170008541282, -97.57432795418825, -126.99216234146803, -50.809017039644154], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6276416543949267, "mean_inference_ms": 5.360900873887024, "mean_action_processing_ms": 0.2011798013970823, "mean_env_wait_ms": 1.3908413742327068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -28.92725478082487, "episode_reward_min": -213.86231953375582, "episode_reward_mean": -87.30270100924807, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-193.15332732885028, -36.83720111799079, -104.45233012716649, -90.35460181325506, -157.20349005922176, -76.30720116129596, -69.36121329597673, -63.77220957516955, -82.84579022837382, -31.153598691010057, -70.19884899463064, -138.31636518151856, -37.43385243074971, -139.0939489299519, -179.74401549032913, -93.3874852428049, -54.71124348930853, -83.01224267913219, -46.55248313140318, -61.92919877167565, -38.23911889760197, -58.93281188716982, -61.953224924408374, -104.88009844478724, -64.92792274459569, -157.38676238389874, -82.57699548174136, -41.52832596285003, -143.92886077373848, -80.27336511306659, -49.56825748170716, -75.11686467605855, -64.1119066023742, -77.85221221432145, -95.20938240006612, -213.86231953375582, -76.2201069652885, -114.20430358747733, -89.9634938491778, -52.59887635066159, -121.85379517530397, -70.97260144198319, -111.1126871689187, -99.89120635981561, -28.92725478082487, -176.0487704272792, -56.899460755617184, -57.130534138783766, -56.40943134652349, -69.78073555027078, -103.84506606793718, -83.97522779511273, -82.40081692353948, -99.10960270508303, -62.93186487704744, -142.13298960609708, -38.60704240757994, -95.93450534079268, -95.01225736983749, -60.23720819183998, -85.66223734706452, -63.28871740766201, -88.44602414407885, -102.05598971483268, -54.60283593128415, -147.9280017157945, -61.14087064957281, -49.05971268168307, -97.0234349946069, -92.68186835353586, -79.39466785449068, -91.81976519321958, -83.66177792507898, -133.9275659263071, -77.97731464996953, -75.23649312436551, -111.81312904907689, -121.8823575652659, -105.8255377976743, -70.01292291426883, -63.49795652785755, -90.26696449726738, -97.9634490643354, -85.26096461648267, -52.941206141407534, -63.91667745651255, -193.57998733303862, -37.30017477260778, -99.06163323073628, -64.61029751487823, -84.91303911765206, -60.87637807936703, -55.69692364374634, -137.04098718045898, -51.76815561361165, -68.9779573295503, -87.41170008541282, -97.57432795418825, -126.99216234146803, -50.809017039644154], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6276416543949267, "mean_inference_ms": 5.360900873887024, "mean_action_processing_ms": 0.2011798013970823, "mean_env_wait_ms": 1.3908413742327068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 504000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 75729.815, "load_time_ms": 28.465, "load_throughput": 491839.339, "learn_time_ms": 68345.047, "learn_throughput": 204.843, "synch_weights_time_ms": 13.267}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 504, "training_iteration": 36, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-41-07", "timestamp": 1693053667, "time_this_iter_s": 75.47428393363953, "time_total_s": 2826.4877536296844, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270153DBA60>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270153DBFD0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 2826.4877536296844, "timesteps_since_restore": 0, "iterations_since_restore": 36, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.90373831775701, "ram_util_percent": 49.67289719626168}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -249.7242207696289, "episode_L1_reward_sum_min": -565.9248368293047, "episode_L1_reward_sum_max": -154.41432212293148, "episode_L2_reward_sum_mean": -139.44315674558283, "episode_L2_reward_sum_min": -216.58170986920595, "episode_L2_reward_sum_max": -114.88031254708767}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.11401722849051586, "policy_loss": 0.09332688050100257, "vf_loss": 0.2069034877840996, "vf_explained_var": 0.691826463880117, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 518000, "num_env_steps_trained": 518000, "num_agent_steps_sampled": 518000, "num_agent_steps_trained": 518000}, "sampler_results": {"episode_reward_max": -28.92725478082487, "episode_reward_min": -213.86231953375582, "episode_reward_mean": -85.31418925942354, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -249.7242207696289, "episode_L1_reward_sum_min": -565.9248368293047, "episode_L1_reward_sum_max": -154.41432212293148, "episode_L2_reward_sum_mean": -139.44315674558283, "episode_L2_reward_sum_min": -216.58170986920595, "episode_L2_reward_sum_max": -114.88031254708767}, "hist_stats": {"episode_reward": [-179.74401549032913, -93.3874852428049, -54.71124348930853, -83.01224267913219, -46.55248313140318, -61.92919877167565, -38.23911889760197, -58.93281188716982, -61.953224924408374, -104.88009844478724, -64.92792274459569, -157.38676238389874, -82.57699548174136, -41.52832596285003, -143.92886077373848, -80.27336511306659, -49.56825748170716, -75.11686467605855, -64.1119066023742, -77.85221221432145, -95.20938240006612, -213.86231953375582, -76.2201069652885, -114.20430358747733, -89.9634938491778, -52.59887635066159, -121.85379517530397, -70.97260144198319, -111.1126871689187, -99.89120635981561, -28.92725478082487, -176.0487704272792, -56.899460755617184, -57.130534138783766, -56.40943134652349, -69.78073555027078, -103.84506606793718, -83.97522779511273, -82.40081692353948, -99.10960270508303, -62.93186487704744, -142.13298960609708, -38.60704240757994, -95.93450534079268, -95.01225736983749, -60.23720819183998, -85.66223734706452, -63.28871740766201, -88.44602414407885, -102.05598971483268, -54.60283593128415, -147.9280017157945, -61.14087064957281, -49.05971268168307, -97.0234349946069, -92.68186835353586, -79.39466785449068, -91.81976519321958, -83.66177792507898, -133.9275659263071, -77.97731464996953, -75.23649312436551, -111.81312904907689, -121.8823575652659, -105.8255377976743, -70.01292291426883, -63.49795652785755, -90.26696449726738, -97.9634490643354, -85.26096461648267, -52.941206141407534, -63.91667745651255, -193.57998733303862, -37.30017477260778, -99.06163323073628, -64.61029751487823, -84.91303911765206, -60.87637807936703, -55.69692364374634, -137.04098718045898, -51.76815561361165, -68.9779573295503, -87.41170008541282, -97.57432795418825, -126.99216234146803, -50.809017039644154, -124.60015076899582, -107.66951505139382, -84.36799233317538, -92.68886173949959, -50.12862542602683, -60.91383303232845, -55.944815032664906, -76.64059811193002, -84.28323768801157, -58.611969430862345, -97.45826520191488, -77.41749776333744, -70.21589870752736, -50.691543665043135], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.626608414394562, "mean_inference_ms": 5.350120428217074, "mean_action_processing_ms": 0.2008051422610351, "mean_env_wait_ms": 1.3878399759562847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -28.92725478082487, "episode_reward_min": -213.86231953375582, "episode_reward_mean": -85.31418925942354, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-179.74401549032913, -93.3874852428049, -54.71124348930853, -83.01224267913219, -46.55248313140318, -61.92919877167565, -38.23911889760197, -58.93281188716982, -61.953224924408374, -104.88009844478724, -64.92792274459569, -157.38676238389874, -82.57699548174136, -41.52832596285003, -143.92886077373848, -80.27336511306659, -49.56825748170716, -75.11686467605855, -64.1119066023742, -77.85221221432145, -95.20938240006612, -213.86231953375582, -76.2201069652885, -114.20430358747733, -89.9634938491778, -52.59887635066159, -121.85379517530397, -70.97260144198319, -111.1126871689187, -99.89120635981561, -28.92725478082487, -176.0487704272792, -56.899460755617184, -57.130534138783766, -56.40943134652349, -69.78073555027078, -103.84506606793718, -83.97522779511273, -82.40081692353948, -99.10960270508303, -62.93186487704744, -142.13298960609708, -38.60704240757994, -95.93450534079268, -95.01225736983749, -60.23720819183998, -85.66223734706452, -63.28871740766201, -88.44602414407885, -102.05598971483268, -54.60283593128415, -147.9280017157945, -61.14087064957281, -49.05971268168307, -97.0234349946069, -92.68186835353586, -79.39466785449068, -91.81976519321958, -83.66177792507898, -133.9275659263071, -77.97731464996953, -75.23649312436551, -111.81312904907689, -121.8823575652659, -105.8255377976743, -70.01292291426883, -63.49795652785755, -90.26696449726738, -97.9634490643354, -85.26096461648267, -52.941206141407534, -63.91667745651255, -193.57998733303862, -37.30017477260778, -99.06163323073628, -64.61029751487823, -84.91303911765206, -60.87637807936703, -55.69692364374634, -137.04098718045898, -51.76815561361165, -68.9779573295503, -87.41170008541282, -97.57432795418825, -126.99216234146803, -50.809017039644154, -124.60015076899582, -107.66951505139382, -84.36799233317538, -92.68886173949959, -50.12862542602683, -60.91383303232845, -55.944815032664906, -76.64059811193002, -84.28323768801157, -58.611969430862345, -97.45826520191488, -77.41749776333744, -70.21589870752736, -50.691543665043135], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.626608414394562, "mean_inference_ms": 5.350120428217074, "mean_action_processing_ms": 0.2008051422610351, "mean_env_wait_ms": 1.3878399759562847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 518000, "num_agent_steps_trained": 518000, "num_env_steps_sampled": 518000, "num_env_steps_trained": 518000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 518000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 518000, "timers": {"training_iteration_time_ms": 75665.962, "load_time_ms": 28.564, "load_throughput": 490121.704, "learn_time_ms": 68275.321, "learn_throughput": 205.052, "synch_weights_time_ms": 14.094}, "counters": {"num_env_steps_sampled": 518000, "num_env_steps_trained": 518000, "num_agent_steps_sampled": 518000, "num_agent_steps_trained": 518000}, "done": false, "episodes_total": 518, "training_iteration": 37, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-42-23", "timestamp": 1693053743, "time_this_iter_s": 75.0671124458313, "time_total_s": 2901.5548660755157, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701517A430>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701545E7C0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 2901.5548660755157, "timesteps_since_restore": 0, "iterations_since_restore": 37, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.703773584905658, "ram_util_percent": 49.62358490566039}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -251.656749221012, "episode_L1_reward_sum_min": -565.9248368293047, "episode_L1_reward_sum_max": -154.41432212293148, "episode_L2_reward_sum_mean": -139.88309663668275, "episode_L2_reward_sum_min": -216.58170986920595, "episode_L2_reward_sum_max": -114.88031254708767}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.15085559166271292, "policy_loss": 0.12470248939781814, "vf_loss": 0.2615310233809735, "vf_explained_var": 0.6536446437239647, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 532000}, "sampler_results": {"episode_reward_max": -28.92725478082487, "episode_reward_min": -213.86231953375582, "episode_reward_mean": -85.38025392067084, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -251.656749221012, "episode_L1_reward_sum_min": -565.9248368293047, "episode_L1_reward_sum_max": -154.41432212293148, "episode_L2_reward_sum_mean": -139.88309663668275, "episode_L2_reward_sum_min": -216.58170986920595, "episode_L2_reward_sum_max": -114.88031254708767}, "hist_stats": {"episode_reward": [-143.92886077373848, -80.27336511306659, -49.56825748170716, -75.11686467605855, -64.1119066023742, -77.85221221432145, -95.20938240006612, -213.86231953375582, -76.2201069652885, -114.20430358747733, -89.9634938491778, -52.59887635066159, -121.85379517530397, -70.97260144198319, -111.1126871689187, -99.89120635981561, -28.92725478082487, -176.0487704272792, -56.899460755617184, -57.130534138783766, -56.40943134652349, -69.78073555027078, -103.84506606793718, -83.97522779511273, -82.40081692353948, -99.10960270508303, -62.93186487704744, -142.13298960609708, -38.60704240757994, -95.93450534079268, -95.01225736983749, -60.23720819183998, -85.66223734706452, -63.28871740766201, -88.44602414407885, -102.05598971483268, -54.60283593128415, -147.9280017157945, -61.14087064957281, -49.05971268168307, -97.0234349946069, -92.68186835353586, -79.39466785449068, -91.81976519321958, -83.66177792507898, -133.9275659263071, -77.97731464996953, -75.23649312436551, -111.81312904907689, -121.8823575652659, -105.8255377976743, -70.01292291426883, -63.49795652785755, -90.26696449726738, -97.9634490643354, -85.26096461648267, -52.941206141407534, -63.91667745651255, -193.57998733303862, -37.30017477260778, -99.06163323073628, -64.61029751487823, -84.91303911765206, -60.87637807936703, -55.69692364374634, -137.04098718045898, -51.76815561361165, -68.9779573295503, -87.41170008541282, -97.57432795418825, -126.99216234146803, -50.809017039644154, -124.60015076899582, -107.66951505139382, -84.36799233317538, -92.68886173949959, -50.12862542602683, -60.91383303232845, -55.944815032664906, -76.64059811193002, -84.28323768801157, -58.611969430862345, -97.45826520191488, -77.41749776333744, -70.21589870752736, -50.691543665043135, -78.99989550558826, -45.22588691938695, -101.25221337239867, -94.06595169405685, -76.88608347032797, -53.34965391069145, -58.87593552024853, -44.32703745223889, -72.79594624574752, -97.07428854254712, -173.42081103292472, -82.6145965390877, -59.026794790655636, -98.45330066053448], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.625620059534503, "mean_inference_ms": 5.339946574637157, "mean_action_processing_ms": 0.2004723877449637, "mean_env_wait_ms": 1.3850544392610067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -28.92725478082487, "episode_reward_min": -213.86231953375582, "episode_reward_mean": -85.38025392067084, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-143.92886077373848, -80.27336511306659, -49.56825748170716, -75.11686467605855, -64.1119066023742, -77.85221221432145, -95.20938240006612, -213.86231953375582, -76.2201069652885, -114.20430358747733, -89.9634938491778, -52.59887635066159, -121.85379517530397, -70.97260144198319, -111.1126871689187, -99.89120635981561, -28.92725478082487, -176.0487704272792, -56.899460755617184, -57.130534138783766, -56.40943134652349, -69.78073555027078, -103.84506606793718, -83.97522779511273, -82.40081692353948, -99.10960270508303, -62.93186487704744, -142.13298960609708, -38.60704240757994, -95.93450534079268, -95.01225736983749, -60.23720819183998, -85.66223734706452, -63.28871740766201, -88.44602414407885, -102.05598971483268, -54.60283593128415, -147.9280017157945, -61.14087064957281, -49.05971268168307, -97.0234349946069, -92.68186835353586, -79.39466785449068, -91.81976519321958, -83.66177792507898, -133.9275659263071, -77.97731464996953, -75.23649312436551, -111.81312904907689, -121.8823575652659, -105.8255377976743, -70.01292291426883, -63.49795652785755, -90.26696449726738, -97.9634490643354, -85.26096461648267, -52.941206141407534, -63.91667745651255, -193.57998733303862, -37.30017477260778, -99.06163323073628, -64.61029751487823, -84.91303911765206, -60.87637807936703, -55.69692364374634, -137.04098718045898, -51.76815561361165, -68.9779573295503, -87.41170008541282, -97.57432795418825, -126.99216234146803, -50.809017039644154, -124.60015076899582, -107.66951505139382, -84.36799233317538, -92.68886173949959, -50.12862542602683, -60.91383303232845, -55.944815032664906, -76.64059811193002, -84.28323768801157, -58.611969430862345, -97.45826520191488, -77.41749776333744, -70.21589870752736, -50.691543665043135, -78.99989550558826, -45.22588691938695, -101.25221337239867, -94.06595169405685, -76.88608347032797, -53.34965391069145, -58.87593552024853, -44.32703745223889, -72.79594624574752, -97.07428854254712, -173.42081103292472, -82.6145965390877, -59.026794790655636, -98.45330066053448], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.625620059534503, "mean_inference_ms": 5.339946574637157, "mean_action_processing_ms": 0.2004723877449637, "mean_env_wait_ms": 1.3850544392610067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 532000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 532000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 532000, "timers": {"training_iteration_time_ms": 75604.75, "load_time_ms": 28.86, "load_throughput": 485092.123, "learn_time_ms": 68228.064, "learn_throughput": 205.194, "synch_weights_time_ms": 14.095}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 532000}, "done": false, "episodes_total": 532, "training_iteration": 38, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-43-38", "timestamp": 1693053818, "time_this_iter_s": 75.21469044685364, "time_total_s": 2976.7695565223694, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270153609A0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701516F460>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 2976.7695565223694, "timesteps_since_restore": 0, "iterations_since_restore": 38, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.728971962616818, "ram_util_percent": 49.56635514018693}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -248.41717983797193, "episode_L1_reward_sum_min": -565.9248368293047, "episode_L1_reward_sum_max": -154.41432212293148, "episode_L2_reward_sum_mean": -139.06744136609137, "episode_L2_reward_sum_min": -216.58170986920595, "episode_L2_reward_sum_max": -114.88031254708767}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.08707811709765513, "policy_loss": 0.059792905048478714, "vf_loss": 0.27285212739127135, "vf_explained_var": 0.6518355714686123, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 546000, "num_env_steps_trained": 546000, "num_agent_steps_sampled": 546000, "num_agent_steps_trained": 546000}, "sampler_results": {"episode_reward_max": -28.92725478082487, "episode_reward_min": -193.57998733303862, "episode_reward_mean": -84.68346394071645, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -248.41717983797193, "episode_L1_reward_sum_min": -565.9248368293047, "episode_L1_reward_sum_max": -154.41432212293148, "episode_L2_reward_sum_mean": -139.06744136609137, "episode_L2_reward_sum_min": -216.58170986920595, "episode_L2_reward_sum_max": -114.88031254708767}, "hist_stats": {"episode_reward": [-111.1126871689187, -99.89120635981561, -28.92725478082487, -176.0487704272792, -56.899460755617184, -57.130534138783766, -56.40943134652349, -69.78073555027078, -103.84506606793718, -83.97522779511273, -82.40081692353948, -99.10960270508303, -62.93186487704744, -142.13298960609708, -38.60704240757994, -95.93450534079268, -95.01225736983749, -60.23720819183998, -85.66223734706452, -63.28871740766201, -88.44602414407885, -102.05598971483268, -54.60283593128415, -147.9280017157945, -61.14087064957281, -49.05971268168307, -97.0234349946069, -92.68186835353586, -79.39466785449068, -91.81976519321958, -83.66177792507898, -133.9275659263071, -77.97731464996953, -75.23649312436551, -111.81312904907689, -121.8823575652659, -105.8255377976743, -70.01292291426883, -63.49795652785755, -90.26696449726738, -97.9634490643354, -85.26096461648267, -52.941206141407534, -63.91667745651255, -193.57998733303862, -37.30017477260778, -99.06163323073628, -64.61029751487823, -84.91303911765206, -60.87637807936703, -55.69692364374634, -137.04098718045898, -51.76815561361165, -68.9779573295503, -87.41170008541282, -97.57432795418825, -126.99216234146803, -50.809017039644154, -124.60015076899582, -107.66951505139382, -84.36799233317538, -92.68886173949959, -50.12862542602683, -60.91383303232845, -55.944815032664906, -76.64059811193002, -84.28323768801157, -58.611969430862345, -97.45826520191488, -77.41749776333744, -70.21589870752736, -50.691543665043135, -78.99989550558826, -45.22588691938695, -101.25221337239867, -94.06595169405685, -76.88608347032797, -53.34965391069145, -58.87593552024853, -44.32703745223889, -72.79594624574752, -97.07428854254712, -173.42081103292472, -82.6145965390877, -59.026794790655636, -98.45330066053448, -63.33853223916956, -123.68437691547125, -72.56314947051312, -73.34174198199739, -99.17476224420854, -116.6135475446499, -123.03256563143171, -86.41901347394608, -38.80444988227591, -66.54820803876815, -104.28889939068944, -70.44558355109618, -67.91864355951624, -149.88387424580873], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6245752900889527, "mean_inference_ms": 5.3302362826478005, "mean_action_processing_ms": 0.2001031368984394, "mean_env_wait_ms": 1.3824471864953636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -28.92725478082487, "episode_reward_min": -193.57998733303862, "episode_reward_mean": -84.68346394071645, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-111.1126871689187, -99.89120635981561, -28.92725478082487, -176.0487704272792, -56.899460755617184, -57.130534138783766, -56.40943134652349, -69.78073555027078, -103.84506606793718, -83.97522779511273, -82.40081692353948, -99.10960270508303, -62.93186487704744, -142.13298960609708, -38.60704240757994, -95.93450534079268, -95.01225736983749, -60.23720819183998, -85.66223734706452, -63.28871740766201, -88.44602414407885, -102.05598971483268, -54.60283593128415, -147.9280017157945, -61.14087064957281, -49.05971268168307, -97.0234349946069, -92.68186835353586, -79.39466785449068, -91.81976519321958, -83.66177792507898, -133.9275659263071, -77.97731464996953, -75.23649312436551, -111.81312904907689, -121.8823575652659, -105.8255377976743, -70.01292291426883, -63.49795652785755, -90.26696449726738, -97.9634490643354, -85.26096461648267, -52.941206141407534, -63.91667745651255, -193.57998733303862, -37.30017477260778, -99.06163323073628, -64.61029751487823, -84.91303911765206, -60.87637807936703, -55.69692364374634, -137.04098718045898, -51.76815561361165, -68.9779573295503, -87.41170008541282, -97.57432795418825, -126.99216234146803, -50.809017039644154, -124.60015076899582, -107.66951505139382, -84.36799233317538, -92.68886173949959, -50.12862542602683, -60.91383303232845, -55.944815032664906, -76.64059811193002, -84.28323768801157, -58.611969430862345, -97.45826520191488, -77.41749776333744, -70.21589870752736, -50.691543665043135, -78.99989550558826, -45.22588691938695, -101.25221337239867, -94.06595169405685, -76.88608347032797, -53.34965391069145, -58.87593552024853, -44.32703745223889, -72.79594624574752, -97.07428854254712, -173.42081103292472, -82.6145965390877, -59.026794790655636, -98.45330066053448, -63.33853223916956, -123.68437691547125, -72.56314947051312, -73.34174198199739, -99.17476224420854, -116.6135475446499, -123.03256563143171, -86.41901347394608, -38.80444988227591, -66.54820803876815, -104.28889939068944, -70.44558355109618, -67.91864355951624, -149.88387424580873], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6245752900889527, "mean_inference_ms": 5.3302362826478005, "mean_action_processing_ms": 0.2001031368984394, "mean_env_wait_ms": 1.3824471864953636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 546000, "num_agent_steps_trained": 546000, "num_env_steps_sampled": 546000, "num_env_steps_trained": 546000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 546000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 546000, "timers": {"training_iteration_time_ms": 75590.295, "load_time_ms": 28.561, "load_throughput": 490172.845, "learn_time_ms": 68224.53, "learn_throughput": 205.205, "synch_weights_time_ms": 14.301}, "counters": {"num_env_steps_sampled": 546000, "num_env_steps_trained": 546000, "num_agent_steps_sampled": 546000, "num_agent_steps_trained": 546000}, "done": false, "episodes_total": 546, "training_iteration": 39, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-44-53", "timestamp": 1693053893, "time_this_iter_s": 75.50044965744019, "time_total_s": 3052.2700061798096, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015443F10>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014EF5A30>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 3052.2700061798096, "timesteps_since_restore": 0, "iterations_since_restore": 39, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.98301886792453, "ram_util_percent": 49.60660377358491}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -245.65889405295252, "episode_L1_reward_sum_min": -533.4929019063711, "episode_L1_reward_sum_max": -154.41432212293148, "episode_L2_reward_sum_mean": -138.40478864006698, "episode_L2_reward_sum_min": -209.11657395213842, "episode_L2_reward_sum_max": -114.88031254708767}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.1490008948326979, "policy_loss": 0.11625185535493433, "vf_loss": 0.3274903855634556, "vf_explained_var": 0.6411316183552821, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "sampler_results": {"episode_reward_max": -37.30017477260778, "episode_reward_min": -210.760943458211, "episode_reward_mean": -85.41409653253315, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -245.65889405295252, "episode_L1_reward_sum_min": -533.4929019063711, "episode_L1_reward_sum_max": -154.41432212293148, "episode_L2_reward_sum_mean": -138.40478864006698, "episode_L2_reward_sum_min": -209.11657395213842, "episode_L2_reward_sum_max": -114.88031254708767}, "hist_stats": {"episode_reward": [-38.60704240757994, -95.93450534079268, -95.01225736983749, -60.23720819183998, -85.66223734706452, -63.28871740766201, -88.44602414407885, -102.05598971483268, -54.60283593128415, -147.9280017157945, -61.14087064957281, -49.05971268168307, -97.0234349946069, -92.68186835353586, -79.39466785449068, -91.81976519321958, -83.66177792507898, -133.9275659263071, -77.97731464996953, -75.23649312436551, -111.81312904907689, -121.8823575652659, -105.8255377976743, -70.01292291426883, -63.49795652785755, -90.26696449726738, -97.9634490643354, -85.26096461648267, -52.941206141407534, -63.91667745651255, -193.57998733303862, -37.30017477260778, -99.06163323073628, -64.61029751487823, -84.91303911765206, -60.87637807936703, -55.69692364374634, -137.04098718045898, -51.76815561361165, -68.9779573295503, -87.41170008541282, -97.57432795418825, -126.99216234146803, -50.809017039644154, -124.60015076899582, -107.66951505139382, -84.36799233317538, -92.68886173949959, -50.12862542602683, -60.91383303232845, -55.944815032664906, -76.64059811193002, -84.28323768801157, -58.611969430862345, -97.45826520191488, -77.41749776333744, -70.21589870752736, -50.691543665043135, -78.99989550558826, -45.22588691938695, -101.25221337239867, -94.06595169405685, -76.88608347032797, -53.34965391069145, -58.87593552024853, -44.32703745223889, -72.79594624574752, -97.07428854254712, -173.42081103292472, -82.6145965390877, -59.026794790655636, -98.45330066053448, -63.33853223916956, -123.68437691547125, -72.56314947051312, -73.34174198199739, -99.17476224420854, -116.6135475446499, -123.03256563143171, -86.41901347394608, -38.80444988227591, -66.54820803876815, -104.28889939068944, -70.44558355109618, -67.91864355951624, -149.88387424580873, -96.67497337720654, -52.902133462066274, -175.1318113524457, -95.83562394408779, -116.38029802406774, -54.7908272973516, -50.809520094928, -70.32102248985665, -90.39105165852689, -92.33896228350031, -73.4143597759313, -61.88288564748274, -62.024494818855544, -210.760943458211], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6235432434918426, "mean_inference_ms": 5.321014475381792, "mean_action_processing_ms": 0.1997449675866283, "mean_env_wait_ms": 1.3800049299549288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -37.30017477260778, "episode_reward_min": -210.760943458211, "episode_reward_mean": -85.41409653253315, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-38.60704240757994, -95.93450534079268, -95.01225736983749, -60.23720819183998, -85.66223734706452, -63.28871740766201, -88.44602414407885, -102.05598971483268, -54.60283593128415, -147.9280017157945, -61.14087064957281, -49.05971268168307, -97.0234349946069, -92.68186835353586, -79.39466785449068, -91.81976519321958, -83.66177792507898, -133.9275659263071, -77.97731464996953, -75.23649312436551, -111.81312904907689, -121.8823575652659, -105.8255377976743, -70.01292291426883, -63.49795652785755, -90.26696449726738, -97.9634490643354, -85.26096461648267, -52.941206141407534, -63.91667745651255, -193.57998733303862, -37.30017477260778, -99.06163323073628, -64.61029751487823, -84.91303911765206, -60.87637807936703, -55.69692364374634, -137.04098718045898, -51.76815561361165, -68.9779573295503, -87.41170008541282, -97.57432795418825, -126.99216234146803, -50.809017039644154, -124.60015076899582, -107.66951505139382, -84.36799233317538, -92.68886173949959, -50.12862542602683, -60.91383303232845, -55.944815032664906, -76.64059811193002, -84.28323768801157, -58.611969430862345, -97.45826520191488, -77.41749776333744, -70.21589870752736, -50.691543665043135, -78.99989550558826, -45.22588691938695, -101.25221337239867, -94.06595169405685, -76.88608347032797, -53.34965391069145, -58.87593552024853, -44.32703745223889, -72.79594624574752, -97.07428854254712, -173.42081103292472, -82.6145965390877, -59.026794790655636, -98.45330066053448, -63.33853223916956, -123.68437691547125, -72.56314947051312, -73.34174198199739, -99.17476224420854, -116.6135475446499, -123.03256563143171, -86.41901347394608, -38.80444988227591, -66.54820803876815, -104.28889939068944, -70.44558355109618, -67.91864355951624, -149.88387424580873, -96.67497337720654, -52.902133462066274, -175.1318113524457, -95.83562394408779, -116.38029802406774, -54.7908272973516, -50.809520094928, -70.32102248985665, -90.39105165852689, -92.33896228350031, -73.4143597759313, -61.88288564748274, -62.024494818855544, -210.760943458211], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6235432434918426, "mean_inference_ms": 5.321014475381792, "mean_action_processing_ms": 0.1997449675866283, "mean_env_wait_ms": 1.3800049299549288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 560000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 75512.019, "load_time_ms": 28.365, "load_throughput": 493573.619, "learn_time_ms": 68166.194, "learn_throughput": 205.38, "synch_weights_time_ms": 13.416}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "episodes_total": 560, "training_iteration": 40, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-46-08", "timestamp": 1693053968, "time_this_iter_s": 74.95732688903809, "time_total_s": 3127.2273330688477, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701524FD90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270152CF760>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 3127.2273330688477, "timesteps_since_restore": 0, "iterations_since_restore": 40, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.669811320754718, "ram_util_percent": 49.613207547169814}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -247.97987868256868, "episode_L1_reward_sum_min": -533.4929019063711, "episode_L1_reward_sum_max": -154.41432212293148, "episode_L2_reward_sum_mean": -138.9869269473851, "episode_L2_reward_sum_min": -209.11657395213842, "episode_L2_reward_sum_max": -114.88031254708767}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.17339335872186634, "policy_loss": 0.14413591976629173, "vf_loss": 0.2925743779326565, "vf_explained_var": 0.6824569805168811, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 574000, "num_env_steps_trained": 574000, "num_agent_steps_sampled": 574000, "num_agent_steps_trained": 574000}, "sampler_results": {"episode_reward_max": -37.30017477260778, "episode_reward_min": -210.760943458211, "episode_reward_mean": -87.20920057795749, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -247.97987868256868, "episode_L1_reward_sum_min": -533.4929019063711, "episode_L1_reward_sum_max": -154.41432212293148, "episode_L2_reward_sum_mean": -138.9869269473851, "episode_L2_reward_sum_min": -209.11657395213842, "episode_L2_reward_sum_max": -114.88031254708767}, "hist_stats": {"episode_reward": [-79.39466785449068, -91.81976519321958, -83.66177792507898, -133.9275659263071, -77.97731464996953, -75.23649312436551, -111.81312904907689, -121.8823575652659, -105.8255377976743, -70.01292291426883, -63.49795652785755, -90.26696449726738, -97.9634490643354, -85.26096461648267, -52.941206141407534, -63.91667745651255, -193.57998733303862, -37.30017477260778, -99.06163323073628, -64.61029751487823, -84.91303911765206, -60.87637807936703, -55.69692364374634, -137.04098718045898, -51.76815561361165, -68.9779573295503, -87.41170008541282, -97.57432795418825, -126.99216234146803, -50.809017039644154, -124.60015076899582, -107.66951505139382, -84.36799233317538, -92.68886173949959, -50.12862542602683, -60.91383303232845, -55.944815032664906, -76.64059811193002, -84.28323768801157, -58.611969430862345, -97.45826520191488, -77.41749776333744, -70.21589870752736, -50.691543665043135, -78.99989550558826, -45.22588691938695, -101.25221337239867, -94.06595169405685, -76.88608347032797, -53.34965391069145, -58.87593552024853, -44.32703745223889, -72.79594624574752, -97.07428854254712, -173.42081103292472, -82.6145965390877, -59.026794790655636, -98.45330066053448, -63.33853223916956, -123.68437691547125, -72.56314947051312, -73.34174198199739, -99.17476224420854, -116.6135475446499, -123.03256563143171, -86.41901347394608, -38.80444988227591, -66.54820803876815, -104.28889939068944, -70.44558355109618, -67.91864355951624, -149.88387424580873, -96.67497337720654, -52.902133462066274, -175.1318113524457, -95.83562394408779, -116.38029802406774, -54.7908272973516, -50.809520094928, -70.32102248985665, -90.39105165852689, -92.33896228350031, -73.4143597759313, -61.88288564748274, -62.024494818855544, -210.760943458211, -99.011205146168, -83.80217897199128, -67.6464300024659, -94.31760752025743, -69.73310177829418, -103.97114373279754, -126.15215061728975, -84.44055756463621, -125.71659667778228, -114.68702293982211, -70.21828812033242, -78.68707101126037, -106.43421726575829, -86.37353944374705], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6224932362730223, "mean_inference_ms": 5.3115834247233, "mean_action_processing_ms": 0.19933140397904253, "mean_env_wait_ms": 1.3775147330907953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -37.30017477260778, "episode_reward_min": -210.760943458211, "episode_reward_mean": -87.20920057795749, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-79.39466785449068, -91.81976519321958, -83.66177792507898, -133.9275659263071, -77.97731464996953, -75.23649312436551, -111.81312904907689, -121.8823575652659, -105.8255377976743, -70.01292291426883, -63.49795652785755, -90.26696449726738, -97.9634490643354, -85.26096461648267, -52.941206141407534, -63.91667745651255, -193.57998733303862, -37.30017477260778, -99.06163323073628, -64.61029751487823, -84.91303911765206, -60.87637807936703, -55.69692364374634, -137.04098718045898, -51.76815561361165, -68.9779573295503, -87.41170008541282, -97.57432795418825, -126.99216234146803, -50.809017039644154, -124.60015076899582, -107.66951505139382, -84.36799233317538, -92.68886173949959, -50.12862542602683, -60.91383303232845, -55.944815032664906, -76.64059811193002, -84.28323768801157, -58.611969430862345, -97.45826520191488, -77.41749776333744, -70.21589870752736, -50.691543665043135, -78.99989550558826, -45.22588691938695, -101.25221337239867, -94.06595169405685, -76.88608347032797, -53.34965391069145, -58.87593552024853, -44.32703745223889, -72.79594624574752, -97.07428854254712, -173.42081103292472, -82.6145965390877, -59.026794790655636, -98.45330066053448, -63.33853223916956, -123.68437691547125, -72.56314947051312, -73.34174198199739, -99.17476224420854, -116.6135475446499, -123.03256563143171, -86.41901347394608, -38.80444988227591, -66.54820803876815, -104.28889939068944, -70.44558355109618, -67.91864355951624, -149.88387424580873, -96.67497337720654, -52.902133462066274, -175.1318113524457, -95.83562394408779, -116.38029802406774, -54.7908272973516, -50.809520094928, -70.32102248985665, -90.39105165852689, -92.33896228350031, -73.4143597759313, -61.88288564748274, -62.024494818855544, -210.760943458211, -99.011205146168, -83.80217897199128, -67.6464300024659, -94.31760752025743, -69.73310177829418, -103.97114373279754, -126.15215061728975, -84.44055756463621, -125.71659667778228, -114.68702293982211, -70.21828812033242, -78.68707101126037, -106.43421726575829, -86.37353944374705], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6224932362730223, "mean_inference_ms": 5.3115834247233, "mean_action_processing_ms": 0.19933140397904253, "mean_env_wait_ms": 1.3775147330907953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 574000, "num_agent_steps_trained": 574000, "num_env_steps_sampled": 574000, "num_env_steps_trained": 574000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 574000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 574000, "timers": {"training_iteration_time_ms": 75430.848, "load_time_ms": 29.113, "load_throughput": 480885.901, "learn_time_ms": 68098.185, "learn_throughput": 205.586, "synch_weights_time_ms": 13.825}, "counters": {"num_env_steps_sampled": 574000, "num_env_steps_trained": 574000, "num_agent_steps_sampled": 574000, "num_agent_steps_trained": 574000}, "done": false, "episodes_total": 574, "training_iteration": 41, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-47-24", "timestamp": 1693054044, "time_this_iter_s": 75.04068779945374, "time_total_s": 3202.2680208683014, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270152F7C70>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701539C7C0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 3202.2680208683014, "timesteps_since_restore": 0, "iterations_since_restore": 41, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.682075471698116, "ram_util_percent": 49.60471698113208}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -242.67720026381315, "episode_L1_reward_sum_min": -533.4929019063711, "episode_L1_reward_sum_max": -154.41432212293148, "episode_L2_reward_sum_mean": -137.5728009083867, "episode_L2_reward_sum_min": -209.11657395213842, "episode_L2_reward_sum_max": -114.88031254708767}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.13681907107353636, "policy_loss": 0.11403765657714496, "vf_loss": 0.2278141294366774, "vf_explained_var": 0.5743294938356297, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "sampler_results": {"episode_reward_max": -37.30017477260778, "episode_reward_min": -210.760943458211, "episode_reward_mean": -87.22942066085785, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -242.67720026381315, "episode_L1_reward_sum_min": -533.4929019063711, "episode_L1_reward_sum_max": -154.41432212293148, "episode_L2_reward_sum_mean": -137.5728009083867, "episode_L2_reward_sum_min": -209.11657395213842, "episode_L2_reward_sum_max": -114.88031254708767}, "hist_stats": {"episode_reward": [-52.941206141407534, -63.91667745651255, -193.57998733303862, -37.30017477260778, -99.06163323073628, -64.61029751487823, -84.91303911765206, -60.87637807936703, -55.69692364374634, -137.04098718045898, -51.76815561361165, -68.9779573295503, -87.41170008541282, -97.57432795418825, -126.99216234146803, -50.809017039644154, -124.60015076899582, -107.66951505139382, -84.36799233317538, -92.68886173949959, -50.12862542602683, -60.91383303232845, -55.944815032664906, -76.64059811193002, -84.28323768801157, -58.611969430862345, -97.45826520191488, -77.41749776333744, -70.21589870752736, -50.691543665043135, -78.99989550558826, -45.22588691938695, -101.25221337239867, -94.06595169405685, -76.88608347032797, -53.34965391069145, -58.87593552024853, -44.32703745223889, -72.79594624574752, -97.07428854254712, -173.42081103292472, -82.6145965390877, -59.026794790655636, -98.45330066053448, -63.33853223916956, -123.68437691547125, -72.56314947051312, -73.34174198199739, -99.17476224420854, -116.6135475446499, -123.03256563143171, -86.41901347394608, -38.80444988227591, -66.54820803876815, -104.28889939068944, -70.44558355109618, -67.91864355951624, -149.88387424580873, -96.67497337720654, -52.902133462066274, -175.1318113524457, -95.83562394408779, -116.38029802406774, -54.7908272973516, -50.809520094928, -70.32102248985665, -90.39105165852689, -92.33896228350031, -73.4143597759313, -61.88288564748274, -62.024494818855544, -210.760943458211, -99.011205146168, -83.80217897199128, -67.6464300024659, -94.31760752025743, -69.73310177829418, -103.97114373279754, -126.15215061728975, -84.44055756463621, -125.71659667778228, -114.68702293982211, -70.21828812033242, -78.68707101126037, -106.43421726575829, -86.37353944374705, -72.90429886549619, -100.51818735600831, -44.6876090641976, -76.97500119101028, -133.4310457216472, -78.5582309642471, -100.97442474541836, -101.82862555996635, -81.10679534091915, -166.43294520154546, -86.40624544971864, -96.85718933558084, -56.74952678612317, -93.132749413816], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6214419627451172, "mean_inference_ms": 5.302580350250775, "mean_action_processing_ms": 0.19897018884810627, "mean_env_wait_ms": 1.3751913271994443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -37.30017477260778, "episode_reward_min": -210.760943458211, "episode_reward_mean": -87.22942066085785, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-52.941206141407534, -63.91667745651255, -193.57998733303862, -37.30017477260778, -99.06163323073628, -64.61029751487823, -84.91303911765206, -60.87637807936703, -55.69692364374634, -137.04098718045898, -51.76815561361165, -68.9779573295503, -87.41170008541282, -97.57432795418825, -126.99216234146803, -50.809017039644154, -124.60015076899582, -107.66951505139382, -84.36799233317538, -92.68886173949959, -50.12862542602683, -60.91383303232845, -55.944815032664906, -76.64059811193002, -84.28323768801157, -58.611969430862345, -97.45826520191488, -77.41749776333744, -70.21589870752736, -50.691543665043135, -78.99989550558826, -45.22588691938695, -101.25221337239867, -94.06595169405685, -76.88608347032797, -53.34965391069145, -58.87593552024853, -44.32703745223889, -72.79594624574752, -97.07428854254712, -173.42081103292472, -82.6145965390877, -59.026794790655636, -98.45330066053448, -63.33853223916956, -123.68437691547125, -72.56314947051312, -73.34174198199739, -99.17476224420854, -116.6135475446499, -123.03256563143171, -86.41901347394608, -38.80444988227591, -66.54820803876815, -104.28889939068944, -70.44558355109618, -67.91864355951624, -149.88387424580873, -96.67497337720654, -52.902133462066274, -175.1318113524457, -95.83562394408779, -116.38029802406774, -54.7908272973516, -50.809520094928, -70.32102248985665, -90.39105165852689, -92.33896228350031, -73.4143597759313, -61.88288564748274, -62.024494818855544, -210.760943458211, -99.011205146168, -83.80217897199128, -67.6464300024659, -94.31760752025743, -69.73310177829418, -103.97114373279754, -126.15215061728975, -84.44055756463621, -125.71659667778228, -114.68702293982211, -70.21828812033242, -78.68707101126037, -106.43421726575829, -86.37353944374705, -72.90429886549619, -100.51818735600831, -44.6876090641976, -76.97500119101028, -133.4310457216472, -78.5582309642471, -100.97442474541836, -101.82862555996635, -81.10679534091915, -166.43294520154546, -86.40624544971864, -96.85718933558084, -56.74952678612317, -93.132749413816], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6214419627451172, "mean_inference_ms": 5.302580350250775, "mean_action_processing_ms": 0.19897018884810627, "mean_env_wait_ms": 1.3751913271994443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 588000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 75382.254, "load_time_ms": 28.536, "load_throughput": 490613.105, "learn_time_ms": 68043.435, "learn_throughput": 205.751, "synch_weights_time_ms": 13.834}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "done": false, "episodes_total": 588, "training_iteration": 42, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-48-39", "timestamp": 1693054119, "time_this_iter_s": 75.19198727607727, "time_total_s": 3277.4600081443787, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015422D30>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701539CBE0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 3277.4600081443787, "timesteps_since_restore": 0, "iterations_since_restore": 42, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.697196261682247, "ram_util_percent": 49.63925233644861}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -245.53654193475842, "episode_L1_reward_sum_min": -533.4929019063711, "episode_L1_reward_sum_max": -154.41432212293148, "episode_L2_reward_sum_mean": -138.2477021986246, "episode_L2_reward_sum_min": -209.11657395213842, "episode_L2_reward_sum_max": -114.88031254708767}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.13898061725386196, "policy_loss": 0.1107457138850917, "vf_loss": 0.2823490523995735, "vf_explained_var": 0.6684794577428833, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 602000, "num_env_steps_trained": 602000, "num_agent_steps_sampled": 602000, "num_agent_steps_trained": 602000}, "sampler_results": {"episode_reward_max": -38.80444988227591, "episode_reward_min": -219.53628909142208, "episode_reward_mean": -88.88414233465542, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -245.53654193475842, "episode_L1_reward_sum_min": -533.4929019063711, "episode_L1_reward_sum_max": -154.41432212293148, "episode_L2_reward_sum_mean": -138.2477021986246, "episode_L2_reward_sum_min": -209.11657395213842, "episode_L2_reward_sum_max": -114.88031254708767}, "hist_stats": {"episode_reward": [-126.99216234146803, -50.809017039644154, -124.60015076899582, -107.66951505139382, -84.36799233317538, -92.68886173949959, -50.12862542602683, -60.91383303232845, -55.944815032664906, -76.64059811193002, -84.28323768801157, -58.611969430862345, -97.45826520191488, -77.41749776333744, -70.21589870752736, -50.691543665043135, -78.99989550558826, -45.22588691938695, -101.25221337239867, -94.06595169405685, -76.88608347032797, -53.34965391069145, -58.87593552024853, -44.32703745223889, -72.79594624574752, -97.07428854254712, -173.42081103292472, -82.6145965390877, -59.026794790655636, -98.45330066053448, -63.33853223916956, -123.68437691547125, -72.56314947051312, -73.34174198199739, -99.17476224420854, -116.6135475446499, -123.03256563143171, -86.41901347394608, -38.80444988227591, -66.54820803876815, -104.28889939068944, -70.44558355109618, -67.91864355951624, -149.88387424580873, -96.67497337720654, -52.902133462066274, -175.1318113524457, -95.83562394408779, -116.38029802406774, -54.7908272973516, -50.809520094928, -70.32102248985665, -90.39105165852689, -92.33896228350031, -73.4143597759313, -61.88288564748274, -62.024494818855544, -210.760943458211, -99.011205146168, -83.80217897199128, -67.6464300024659, -94.31760752025743, -69.73310177829418, -103.97114373279754, -126.15215061728975, -84.44055756463621, -125.71659667778228, -114.68702293982211, -70.21828812033242, -78.68707101126037, -106.43421726575829, -86.37353944374705, -72.90429886549619, -100.51818735600831, -44.6876090641976, -76.97500119101028, -133.4310457216472, -78.5582309642471, -100.97442474541836, -101.82862555996635, -81.10679534091915, -166.43294520154546, -86.40624544971864, -96.85718933558084, -56.74952678612317, -93.132749413816, -60.085352692433204, -70.126454233255, -113.33168957446445, -219.53628909142208, -79.31387570458332, -75.90723018141867, -89.04932393169459, -150.05432889371946, -84.56500288236101, -68.94139082779142, -57.37929635358759, -117.23452026052556, -68.26700931759339, -67.34984888807806], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6204327423050959, "mean_inference_ms": 5.294207665232418, "mean_action_processing_ms": 0.19861721327185441, "mean_env_wait_ms": 1.3730316066822814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -38.80444988227591, "episode_reward_min": -219.53628909142208, "episode_reward_mean": -88.88414233465542, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-126.99216234146803, -50.809017039644154, -124.60015076899582, -107.66951505139382, -84.36799233317538, -92.68886173949959, -50.12862542602683, -60.91383303232845, -55.944815032664906, -76.64059811193002, -84.28323768801157, -58.611969430862345, -97.45826520191488, -77.41749776333744, -70.21589870752736, -50.691543665043135, -78.99989550558826, -45.22588691938695, -101.25221337239867, -94.06595169405685, -76.88608347032797, -53.34965391069145, -58.87593552024853, -44.32703745223889, -72.79594624574752, -97.07428854254712, -173.42081103292472, -82.6145965390877, -59.026794790655636, -98.45330066053448, -63.33853223916956, -123.68437691547125, -72.56314947051312, -73.34174198199739, -99.17476224420854, -116.6135475446499, -123.03256563143171, -86.41901347394608, -38.80444988227591, -66.54820803876815, -104.28889939068944, -70.44558355109618, -67.91864355951624, -149.88387424580873, -96.67497337720654, -52.902133462066274, -175.1318113524457, -95.83562394408779, -116.38029802406774, -54.7908272973516, -50.809520094928, -70.32102248985665, -90.39105165852689, -92.33896228350031, -73.4143597759313, -61.88288564748274, -62.024494818855544, -210.760943458211, -99.011205146168, -83.80217897199128, -67.6464300024659, -94.31760752025743, -69.73310177829418, -103.97114373279754, -126.15215061728975, -84.44055756463621, -125.71659667778228, -114.68702293982211, -70.21828812033242, -78.68707101126037, -106.43421726575829, -86.37353944374705, -72.90429886549619, -100.51818735600831, -44.6876090641976, -76.97500119101028, -133.4310457216472, -78.5582309642471, -100.97442474541836, -101.82862555996635, -81.10679534091915, -166.43294520154546, -86.40624544971864, -96.85718933558084, -56.74952678612317, -93.132749413816, -60.085352692433204, -70.126454233255, -113.33168957446445, -219.53628909142208, -79.31387570458332, -75.90723018141867, -89.04932393169459, -150.05432889371946, -84.56500288236101, -68.94139082779142, -57.37929635358759, -117.23452026052556, -68.26700931759339, -67.34984888807806], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6204327423050959, "mean_inference_ms": 5.294207665232418, "mean_action_processing_ms": 0.19861721327185441, "mean_env_wait_ms": 1.3730316066822814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 602000, "num_agent_steps_trained": 602000, "num_env_steps_sampled": 602000, "num_env_steps_trained": 602000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 602000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 602000, "timers": {"training_iteration_time_ms": 75342.17, "load_time_ms": 28.237, "load_throughput": 495809.081, "learn_time_ms": 68007.723, "learn_throughput": 205.859, "synch_weights_time_ms": 13.325}, "counters": {"num_env_steps_sampled": 602000, "num_env_steps_trained": 602000, "num_agent_steps_sampled": 602000, "num_agent_steps_trained": 602000}, "done": false, "episodes_total": 602, "training_iteration": 43, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-49-54", "timestamp": 1693054194, "time_this_iter_s": 75.22461986541748, "time_total_s": 3352.684628009796, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270153A5C70>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270129C6280>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 3352.684628009796, "timesteps_since_restore": 0, "iterations_since_restore": 43, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.703773584905658, "ram_util_percent": 49.651886792452835}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -255.58976957447828, "episode_L1_reward_sum_min": -542.7376702129841, "episode_L1_reward_sum_max": -163.054135017097, "episode_L2_reward_sum_mean": -140.72788905665277, "episode_L2_reward_sum_min": -212.0476402491331, "episode_L2_reward_sum_max": -117.2527984380722}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.10652310806115775, "policy_loss": 0.07173189853410018, "vf_loss": 0.347912076077226, "vf_explained_var": 0.6697424272144282, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000}, "sampler_results": {"episode_reward_max": -38.80444988227591, "episode_reward_min": -219.53628909142208, "episode_reward_mean": -92.14997053489564, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -255.58976957447828, "episode_L1_reward_sum_min": -542.7376702129841, "episode_L1_reward_sum_max": -163.054135017097, "episode_L2_reward_sum_mean": -140.72788905665277, "episode_L2_reward_sum_min": -212.0476402491331, "episode_L2_reward_sum_max": -117.2527984380722}, "hist_stats": {"episode_reward": [-70.21589870752736, -50.691543665043135, -78.99989550558826, -45.22588691938695, -101.25221337239867, -94.06595169405685, -76.88608347032797, -53.34965391069145, -58.87593552024853, -44.32703745223889, -72.79594624574752, -97.07428854254712, -173.42081103292472, -82.6145965390877, -59.026794790655636, -98.45330066053448, -63.33853223916956, -123.68437691547125, -72.56314947051312, -73.34174198199739, -99.17476224420854, -116.6135475446499, -123.03256563143171, -86.41901347394608, -38.80444988227591, -66.54820803876815, -104.28889939068944, -70.44558355109618, -67.91864355951624, -149.88387424580873, -96.67497337720654, -52.902133462066274, -175.1318113524457, -95.83562394408779, -116.38029802406774, -54.7908272973516, -50.809520094928, -70.32102248985665, -90.39105165852689, -92.33896228350031, -73.4143597759313, -61.88288564748274, -62.024494818855544, -210.760943458211, -99.011205146168, -83.80217897199128, -67.6464300024659, -94.31760752025743, -69.73310177829418, -103.97114373279754, -126.15215061728975, -84.44055756463621, -125.71659667778228, -114.68702293982211, -70.21828812033242, -78.68707101126037, -106.43421726575829, -86.37353944374705, -72.90429886549619, -100.51818735600831, -44.6876090641976, -76.97500119101028, -133.4310457216472, -78.5582309642471, -100.97442474541836, -101.82862555996635, -81.10679534091915, -166.43294520154546, -86.40624544971864, -96.85718933558084, -56.74952678612317, -93.132749413816, -60.085352692433204, -70.126454233255, -113.33168957446445, -219.53628909142208, -79.31387570458332, -75.90723018141867, -89.04932393169459, -150.05432889371946, -84.56500288236101, -68.94139082779142, -57.37929635358759, -117.23452026052556, -68.26700931759339, -67.34984888807806, -53.04011084238001, -73.90230275168456, -149.71273657420755, -144.6236987935324, -123.26105772615483, -56.80710029008032, -39.96447797193567, -94.47908667492304, -100.44951784858985, -176.44663631029604, -219.29090868970965, -103.1790190480535, -75.377824652944, -64.57488281078187], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6195426692674144, "mean_inference_ms": 5.286220097279213, "mean_action_processing_ms": 0.19826271987168048, "mean_env_wait_ms": 1.3709650110078127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -38.80444988227591, "episode_reward_min": -219.53628909142208, "episode_reward_mean": -92.14997053489564, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-70.21589870752736, -50.691543665043135, -78.99989550558826, -45.22588691938695, -101.25221337239867, -94.06595169405685, -76.88608347032797, -53.34965391069145, -58.87593552024853, -44.32703745223889, -72.79594624574752, -97.07428854254712, -173.42081103292472, -82.6145965390877, -59.026794790655636, -98.45330066053448, -63.33853223916956, -123.68437691547125, -72.56314947051312, -73.34174198199739, -99.17476224420854, -116.6135475446499, -123.03256563143171, -86.41901347394608, -38.80444988227591, -66.54820803876815, -104.28889939068944, -70.44558355109618, -67.91864355951624, -149.88387424580873, -96.67497337720654, -52.902133462066274, -175.1318113524457, -95.83562394408779, -116.38029802406774, -54.7908272973516, -50.809520094928, -70.32102248985665, -90.39105165852689, -92.33896228350031, -73.4143597759313, -61.88288564748274, -62.024494818855544, -210.760943458211, -99.011205146168, -83.80217897199128, -67.6464300024659, -94.31760752025743, -69.73310177829418, -103.97114373279754, -126.15215061728975, -84.44055756463621, -125.71659667778228, -114.68702293982211, -70.21828812033242, -78.68707101126037, -106.43421726575829, -86.37353944374705, -72.90429886549619, -100.51818735600831, -44.6876090641976, -76.97500119101028, -133.4310457216472, -78.5582309642471, -100.97442474541836, -101.82862555996635, -81.10679534091915, -166.43294520154546, -86.40624544971864, -96.85718933558084, -56.74952678612317, -93.132749413816, -60.085352692433204, -70.126454233255, -113.33168957446445, -219.53628909142208, -79.31387570458332, -75.90723018141867, -89.04932393169459, -150.05432889371946, -84.56500288236101, -68.94139082779142, -57.37929635358759, -117.23452026052556, -68.26700931759339, -67.34984888807806, -53.04011084238001, -73.90230275168456, -149.71273657420755, -144.6236987935324, -123.26105772615483, -56.80710029008032, -39.96447797193567, -94.47908667492304, -100.44951784858985, -176.44663631029604, -219.29090868970965, -103.1790190480535, -75.377824652944, -64.57488281078187], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6195426692674144, "mean_inference_ms": 5.286220097279213, "mean_action_processing_ms": 0.19826271987168048, "mean_env_wait_ms": 1.3709650110078127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 616000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 616000, "timers": {"training_iteration_time_ms": 75242.992, "load_time_ms": 28.371, "load_throughput": 493461.628, "learn_time_ms": 67950.983, "learn_throughput": 206.031, "synch_weights_time_ms": 12.73}, "counters": {"num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000}, "done": false, "episodes_total": 616, "training_iteration": 44, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-51-09", "timestamp": 1693054269, "time_this_iter_s": 75.1309642791748, "time_total_s": 3427.815592288971, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150E8850>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701545ED60>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 3427.815592288971, "timesteps_since_restore": 0, "iterations_since_restore": 44, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.46728971962617, "ram_util_percent": 49.651401869158875}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -257.79605691216886, "episode_L1_reward_sum_min": -544.2822695225477, "episode_L1_reward_sum_max": -163.054135017097, "episode_L2_reward_sum_mean": -141.3646771221608, "episode_L2_reward_sum_min": -213.68403412401676, "episode_L2_reward_sum_max": -117.2527984380722}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.1676850620593249, "policy_loss": 0.13103146603788007, "vf_loss": 0.3665359536915551, "vf_explained_var": 0.6811059690368029, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000}, "sampler_results": {"episode_reward_max": -38.80444988227591, "episode_reward_min": -219.53628909142208, "episode_reward_mean": -93.80560897499677, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -257.79605691216886, "episode_L1_reward_sum_min": -544.2822695225477, "episode_L1_reward_sum_max": -163.054135017097, "episode_L2_reward_sum_mean": -141.3646771221608, "episode_L2_reward_sum_min": -213.68403412401676, "episode_L2_reward_sum_max": -117.2527984380722}, "hist_stats": {"episode_reward": [-59.026794790655636, -98.45330066053448, -63.33853223916956, -123.68437691547125, -72.56314947051312, -73.34174198199739, -99.17476224420854, -116.6135475446499, -123.03256563143171, -86.41901347394608, -38.80444988227591, -66.54820803876815, -104.28889939068944, -70.44558355109618, -67.91864355951624, -149.88387424580873, -96.67497337720654, -52.902133462066274, -175.1318113524457, -95.83562394408779, -116.38029802406774, -54.7908272973516, -50.809520094928, -70.32102248985665, -90.39105165852689, -92.33896228350031, -73.4143597759313, -61.88288564748274, -62.024494818855544, -210.760943458211, -99.011205146168, -83.80217897199128, -67.6464300024659, -94.31760752025743, -69.73310177829418, -103.97114373279754, -126.15215061728975, -84.44055756463621, -125.71659667778228, -114.68702293982211, -70.21828812033242, -78.68707101126037, -106.43421726575829, -86.37353944374705, -72.90429886549619, -100.51818735600831, -44.6876090641976, -76.97500119101028, -133.4310457216472, -78.5582309642471, -100.97442474541836, -101.82862555996635, -81.10679534091915, -166.43294520154546, -86.40624544971864, -96.85718933558084, -56.74952678612317, -93.132749413816, -60.085352692433204, -70.126454233255, -113.33168957446445, -219.53628909142208, -79.31387570458332, -75.90723018141867, -89.04932393169459, -150.05432889371946, -84.56500288236101, -68.94139082779142, -57.37929635358759, -117.23452026052556, -68.26700931759339, -67.34984888807806, -53.04011084238001, -73.90230275168456, -149.71273657420755, -144.6236987935324, -123.26105772615483, -56.80710029008032, -39.96447797193567, -94.47908667492304, -100.44951784858985, -176.44663631029604, -219.29090868970965, -103.1790190480535, -75.377824652944, -64.57488281078187, -128.51661536422782, -189.4733591786347, -88.12643016540451, -53.53314916448294, -103.79326112000933, -85.99514329109273, -53.24120400415989, -53.11150694291621, -62.97242992327591, -135.45002714131638, -75.88290943943335, -92.38171713568946, -104.06163385036946, -38.82019986691541], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6186265815632759, "mean_inference_ms": 5.278516207993176, "mean_action_processing_ms": 0.19789856428540037, "mean_env_wait_ms": 1.3689511015282385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -38.80444988227591, "episode_reward_min": -219.53628909142208, "episode_reward_mean": -93.80560897499677, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-59.026794790655636, -98.45330066053448, -63.33853223916956, -123.68437691547125, -72.56314947051312, -73.34174198199739, -99.17476224420854, -116.6135475446499, -123.03256563143171, -86.41901347394608, -38.80444988227591, -66.54820803876815, -104.28889939068944, -70.44558355109618, -67.91864355951624, -149.88387424580873, -96.67497337720654, -52.902133462066274, -175.1318113524457, -95.83562394408779, -116.38029802406774, -54.7908272973516, -50.809520094928, -70.32102248985665, -90.39105165852689, -92.33896228350031, -73.4143597759313, -61.88288564748274, -62.024494818855544, -210.760943458211, -99.011205146168, -83.80217897199128, -67.6464300024659, -94.31760752025743, -69.73310177829418, -103.97114373279754, -126.15215061728975, -84.44055756463621, -125.71659667778228, -114.68702293982211, -70.21828812033242, -78.68707101126037, -106.43421726575829, -86.37353944374705, -72.90429886549619, -100.51818735600831, -44.6876090641976, -76.97500119101028, -133.4310457216472, -78.5582309642471, -100.97442474541836, -101.82862555996635, -81.10679534091915, -166.43294520154546, -86.40624544971864, -96.85718933558084, -56.74952678612317, -93.132749413816, -60.085352692433204, -70.126454233255, -113.33168957446445, -219.53628909142208, -79.31387570458332, -75.90723018141867, -89.04932393169459, -150.05432889371946, -84.56500288236101, -68.94139082779142, -57.37929635358759, -117.23452026052556, -68.26700931759339, -67.34984888807806, -53.04011084238001, -73.90230275168456, -149.71273657420755, -144.6236987935324, -123.26105772615483, -56.80710029008032, -39.96447797193567, -94.47908667492304, -100.44951784858985, -176.44663631029604, -219.29090868970965, -103.1790190480535, -75.377824652944, -64.57488281078187, -128.51661536422782, -189.4733591786347, -88.12643016540451, -53.53314916448294, -103.79326112000933, -85.99514329109273, -53.24120400415989, -53.11150694291621, -62.97242992327591, -135.45002714131638, -75.88290943943335, -92.38171713568946, -104.06163385036946, -38.82019986691541], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6186265815632759, "mean_inference_ms": 5.278516207993176, "mean_action_processing_ms": 0.19789856428540037, "mean_env_wait_ms": 1.3689511015282385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000, "num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 630000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 630000, "timers": {"training_iteration_time_ms": 75170.852, "load_time_ms": 29.146, "load_throughput": 480344.223, "learn_time_ms": 67881.523, "learn_throughput": 206.242, "synch_weights_time_ms": 12.73}, "counters": {"num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000}, "done": false, "episodes_total": 630, "training_iteration": 45, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-52-24", "timestamp": 1693054344, "time_this_iter_s": 74.94736528396606, "time_total_s": 3502.762957572937, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015443DC0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701543E100>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 3502.762957572937, "timesteps_since_restore": 0, "iterations_since_restore": 45, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.754716981132077, "ram_util_percent": 49.657547169811316}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -257.24365728370844, "episode_L1_reward_sum_min": -544.2822695225477, "episode_L1_reward_sum_max": -163.054135017097, "episode_L2_reward_sum_mean": -141.23169485121966, "episode_L2_reward_sum_min": -213.68403412401676, "episode_L2_reward_sum_max": -117.2527984380722}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.17345453107608827, "policy_loss": 0.14893179983326996, "vf_loss": 0.24522729492556644, "vf_explained_var": 0.6563790927453296, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 644000, "num_agent_steps_trained": 644000}, "sampler_results": {"episode_reward_max": -37.805766867188126, "episode_reward_min": -219.53628909142208, "episode_reward_mean": -93.60794543232043, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -257.24365728370844, "episode_L1_reward_sum_min": -544.2822695225477, "episode_L1_reward_sum_max": -163.054135017097, "episode_L2_reward_sum_mean": -141.23169485121966, "episode_L2_reward_sum_min": -213.68403412401676, "episode_L2_reward_sum_max": -117.2527984380722}, "hist_stats": {"episode_reward": [-67.91864355951624, -149.88387424580873, -96.67497337720654, -52.902133462066274, -175.1318113524457, -95.83562394408779, -116.38029802406774, -54.7908272973516, -50.809520094928, -70.32102248985665, -90.39105165852689, -92.33896228350031, -73.4143597759313, -61.88288564748274, -62.024494818855544, -210.760943458211, -99.011205146168, -83.80217897199128, -67.6464300024659, -94.31760752025743, -69.73310177829418, -103.97114373279754, -126.15215061728975, -84.44055756463621, -125.71659667778228, -114.68702293982211, -70.21828812033242, -78.68707101126037, -106.43421726575829, -86.37353944374705, -72.90429886549619, -100.51818735600831, -44.6876090641976, -76.97500119101028, -133.4310457216472, -78.5582309642471, -100.97442474541836, -101.82862555996635, -81.10679534091915, -166.43294520154546, -86.40624544971864, -96.85718933558084, -56.74952678612317, -93.132749413816, -60.085352692433204, -70.126454233255, -113.33168957446445, -219.53628909142208, -79.31387570458332, -75.90723018141867, -89.04932393169459, -150.05432889371946, -84.56500288236101, -68.94139082779142, -57.37929635358759, -117.23452026052556, -68.26700931759339, -67.34984888807806, -53.04011084238001, -73.90230275168456, -149.71273657420755, -144.6236987935324, -123.26105772615483, -56.80710029008032, -39.96447797193567, -94.47908667492304, -100.44951784858985, -176.44663631029604, -219.29090868970965, -103.1790190480535, -75.377824652944, -64.57488281078187, -128.51661536422782, -189.4733591786347, -88.12643016540451, -53.53314916448294, -103.79326112000933, -85.99514329109273, -53.24120400415989, -53.11150694291621, -62.97242992327591, -135.45002714131638, -75.88290943943335, -92.38171713568946, -104.06163385036946, -38.82019986691541, -59.18101925041172, -42.49722275765121, -128.69153310017015, -144.66753503845692, -112.86579929332902, -90.18613255261678, -50.43530570960365, -46.201899001053455, -123.8681644214987, -50.410051292596584, -51.598301144796004, -37.805766867188126, -156.69798434705865, -80.86185677134318], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6178102926854965, "mean_inference_ms": 5.271337828938766, "mean_action_processing_ms": 0.197583071908778, "mean_env_wait_ms": 1.367069753716801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -37.805766867188126, "episode_reward_min": -219.53628909142208, "episode_reward_mean": -93.60794543232043, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-67.91864355951624, -149.88387424580873, -96.67497337720654, -52.902133462066274, -175.1318113524457, -95.83562394408779, -116.38029802406774, -54.7908272973516, -50.809520094928, -70.32102248985665, -90.39105165852689, -92.33896228350031, -73.4143597759313, -61.88288564748274, -62.024494818855544, -210.760943458211, -99.011205146168, -83.80217897199128, -67.6464300024659, -94.31760752025743, -69.73310177829418, -103.97114373279754, -126.15215061728975, -84.44055756463621, -125.71659667778228, -114.68702293982211, -70.21828812033242, -78.68707101126037, -106.43421726575829, -86.37353944374705, -72.90429886549619, -100.51818735600831, -44.6876090641976, -76.97500119101028, -133.4310457216472, -78.5582309642471, -100.97442474541836, -101.82862555996635, -81.10679534091915, -166.43294520154546, -86.40624544971864, -96.85718933558084, -56.74952678612317, -93.132749413816, -60.085352692433204, -70.126454233255, -113.33168957446445, -219.53628909142208, -79.31387570458332, -75.90723018141867, -89.04932393169459, -150.05432889371946, -84.56500288236101, -68.94139082779142, -57.37929635358759, -117.23452026052556, -68.26700931759339, -67.34984888807806, -53.04011084238001, -73.90230275168456, -149.71273657420755, -144.6236987935324, -123.26105772615483, -56.80710029008032, -39.96447797193567, -94.47908667492304, -100.44951784858985, -176.44663631029604, -219.29090868970965, -103.1790190480535, -75.377824652944, -64.57488281078187, -128.51661536422782, -189.4733591786347, -88.12643016540451, -53.53314916448294, -103.79326112000933, -85.99514329109273, -53.24120400415989, -53.11150694291621, -62.97242992327591, -135.45002714131638, -75.88290943943335, -92.38171713568946, -104.06163385036946, -38.82019986691541, -59.18101925041172, -42.49722275765121, -128.69153310017015, -144.66753503845692, -112.86579929332902, -90.18613255261678, -50.43530570960365, -46.201899001053455, -123.8681644214987, -50.410051292596584, -51.598301144796004, -37.805766867188126, -156.69798434705865, -80.86185677134318], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6178102926854965, "mean_inference_ms": 5.271337828938766, "mean_action_processing_ms": 0.197583071908778, "mean_env_wait_ms": 1.367069753716801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 644000, "num_agent_steps_trained": 644000, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 644000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 644000, "timers": {"training_iteration_time_ms": 75131.16, "load_time_ms": 29.071, "load_throughput": 481582.786, "learn_time_ms": 67837.064, "learn_throughput": 206.377, "synch_weights_time_ms": 12.132}, "counters": {"num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 644000, "num_agent_steps_trained": 644000}, "done": false, "episodes_total": 644, "training_iteration": 46, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-53-40", "timestamp": 1693054420, "time_this_iter_s": 75.07635855674744, "time_total_s": 3577.8393161296844, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015350D30>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701516F5B0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 3577.8393161296844, "timesteps_since_restore": 0, "iterations_since_restore": 46, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.77264150943396, "ram_util_percent": 49.65660377358491}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -255.12830910019576, "episode_L1_reward_sum_min": -544.2822695225477, "episode_L1_reward_sum_max": -163.054135017097, "episode_L2_reward_sum_mean": -140.72658371843397, "episode_L2_reward_sum_min": -213.68403412401676, "episode_L2_reward_sum_max": -117.2527984380722}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.14044289128767917, "policy_loss": 0.11294287162189277, "vf_loss": 0.27500017965174456, "vf_explained_var": 0.6288451251914963, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 658000, "num_env_steps_trained": 658000, "num_agent_steps_sampled": 658000, "num_agent_steps_trained": 658000}, "sampler_results": {"episode_reward_max": -30.69654279845391, "episode_reward_min": -219.53628909142208, "episode_reward_mean": -92.61106745882387, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -255.12830910019576, "episode_L1_reward_sum_min": -544.2822695225477, "episode_L1_reward_sum_max": -163.054135017097, "episode_L2_reward_sum_mean": -140.72658371843397, "episode_L2_reward_sum_min": -213.68403412401676, "episode_L2_reward_sum_max": -117.2527984380722}, "hist_stats": {"episode_reward": [-62.024494818855544, -210.760943458211, -99.011205146168, -83.80217897199128, -67.6464300024659, -94.31760752025743, -69.73310177829418, -103.97114373279754, -126.15215061728975, -84.44055756463621, -125.71659667778228, -114.68702293982211, -70.21828812033242, -78.68707101126037, -106.43421726575829, -86.37353944374705, -72.90429886549619, -100.51818735600831, -44.6876090641976, -76.97500119101028, -133.4310457216472, -78.5582309642471, -100.97442474541836, -101.82862555996635, -81.10679534091915, -166.43294520154546, -86.40624544971864, -96.85718933558084, -56.74952678612317, -93.132749413816, -60.085352692433204, -70.126454233255, -113.33168957446445, -219.53628909142208, -79.31387570458332, -75.90723018141867, -89.04932393169459, -150.05432889371946, -84.56500288236101, -68.94139082779142, -57.37929635358759, -117.23452026052556, -68.26700931759339, -67.34984888807806, -53.04011084238001, -73.90230275168456, -149.71273657420755, -144.6236987935324, -123.26105772615483, -56.80710029008032, -39.96447797193567, -94.47908667492304, -100.44951784858985, -176.44663631029604, -219.29090868970965, -103.1790190480535, -75.377824652944, -64.57488281078187, -128.51661536422782, -189.4733591786347, -88.12643016540451, -53.53314916448294, -103.79326112000933, -85.99514329109273, -53.24120400415989, -53.11150694291621, -62.97242992327591, -135.45002714131638, -75.88290943943335, -92.38171713568946, -104.06163385036946, -38.82019986691541, -59.18101925041172, -42.49722275765121, -128.69153310017015, -144.66753503845692, -112.86579929332902, -90.18613255261678, -50.43530570960365, -46.201899001053455, -123.8681644214987, -50.410051292596584, -51.598301144796004, -37.805766867188126, -156.69798434705865, -80.86185677134318, -85.2856709701179, -84.14901285335083, -82.8468644656326, -93.61308538991865, -30.69654279845391, -83.10921617717234, -52.68503675473868, -109.665873934243, -107.46274121518037, -91.07644663924556, -48.37268534800775, -94.09058271457387, -74.52277715855331, -111.41165344392893], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6170789067499244, "mean_inference_ms": 5.265300157543004, "mean_action_processing_ms": 0.19734522528608486, "mean_env_wait_ms": 1.3655423206839572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -30.69654279845391, "episode_reward_min": -219.53628909142208, "episode_reward_mean": -92.61106745882387, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-62.024494818855544, -210.760943458211, -99.011205146168, -83.80217897199128, -67.6464300024659, -94.31760752025743, -69.73310177829418, -103.97114373279754, -126.15215061728975, -84.44055756463621, -125.71659667778228, -114.68702293982211, -70.21828812033242, -78.68707101126037, -106.43421726575829, -86.37353944374705, -72.90429886549619, -100.51818735600831, -44.6876090641976, -76.97500119101028, -133.4310457216472, -78.5582309642471, -100.97442474541836, -101.82862555996635, -81.10679534091915, -166.43294520154546, -86.40624544971864, -96.85718933558084, -56.74952678612317, -93.132749413816, -60.085352692433204, -70.126454233255, -113.33168957446445, -219.53628909142208, -79.31387570458332, -75.90723018141867, -89.04932393169459, -150.05432889371946, -84.56500288236101, -68.94139082779142, -57.37929635358759, -117.23452026052556, -68.26700931759339, -67.34984888807806, -53.04011084238001, -73.90230275168456, -149.71273657420755, -144.6236987935324, -123.26105772615483, -56.80710029008032, -39.96447797193567, -94.47908667492304, -100.44951784858985, -176.44663631029604, -219.29090868970965, -103.1790190480535, -75.377824652944, -64.57488281078187, -128.51661536422782, -189.4733591786347, -88.12643016540451, -53.53314916448294, -103.79326112000933, -85.99514329109273, -53.24120400415989, -53.11150694291621, -62.97242992327591, -135.45002714131638, -75.88290943943335, -92.38171713568946, -104.06163385036946, -38.82019986691541, -59.18101925041172, -42.49722275765121, -128.69153310017015, -144.66753503845692, -112.86579929332902, -90.18613255261678, -50.43530570960365, -46.201899001053455, -123.8681644214987, -50.410051292596584, -51.598301144796004, -37.805766867188126, -156.69798434705865, -80.86185677134318, -85.2856709701179, -84.14901285335083, -82.8468644656326, -93.61308538991865, -30.69654279845391, -83.10921617717234, -52.68503675473868, -109.665873934243, -107.46274121518037, -91.07644663924556, -48.37268534800775, -94.09058271457387, -74.52277715855331, -111.41165344392893], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6170789067499244, "mean_inference_ms": 5.265300157543004, "mean_action_processing_ms": 0.19734522528608486, "mean_env_wait_ms": 1.3655423206839572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 658000, "num_agent_steps_trained": 658000, "num_env_steps_sampled": 658000, "num_env_steps_trained": 658000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 658000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 658000, "timers": {"training_iteration_time_ms": 75162.867, "load_time_ms": 29.587, "load_throughput": 473181.065, "learn_time_ms": 67839.993, "learn_throughput": 206.368, "synch_weights_time_ms": 12.412}, "counters": {"num_env_steps_sampled": 658000, "num_env_steps_trained": 658000, "num_agent_steps_sampled": 658000, "num_agent_steps_trained": 658000}, "done": false, "episodes_total": 658, "training_iteration": 47, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-54-55", "timestamp": 1693054495, "time_this_iter_s": 75.38526606559753, "time_total_s": 3653.224582195282, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015360460>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701536D880>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 3653.224582195282, "timesteps_since_restore": 0, "iterations_since_restore": 47, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.845794392523363, "ram_util_percent": 49.654205607476634}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -253.63287455625832, "episode_L1_reward_sum_min": -544.2822695225477, "episode_L1_reward_sum_max": -158.54467759281397, "episode_L2_reward_sum_mean": -140.3988306248188, "episode_L2_reward_sum_min": -213.68403412401676, "episode_L2_reward_sum_max": -115.65313643217087}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.1512676373171072, "policy_loss": 0.11874918224588957, "vf_loss": 0.3251845625321588, "vf_explained_var": 0.7100225339026608, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "sampler_results": {"episode_reward_max": -30.69654279845391, "episode_reward_min": -219.53628909142208, "episode_reward_mean": -92.30587154767707, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -253.63287455625832, "episode_L1_reward_sum_min": -544.2822695225477, "episode_L1_reward_sum_max": -158.54467759281397, "episode_L2_reward_sum_mean": -140.3988306248188, "episode_L2_reward_sum_min": -213.68403412401676, "episode_L2_reward_sum_max": -115.65313643217087}, "hist_stats": {"episode_reward": [-106.43421726575829, -86.37353944374705, -72.90429886549619, -100.51818735600831, -44.6876090641976, -76.97500119101028, -133.4310457216472, -78.5582309642471, -100.97442474541836, -101.82862555996635, -81.10679534091915, -166.43294520154546, -86.40624544971864, -96.85718933558084, -56.74952678612317, -93.132749413816, -60.085352692433204, -70.126454233255, -113.33168957446445, -219.53628909142208, -79.31387570458332, -75.90723018141867, -89.04932393169459, -150.05432889371946, -84.56500288236101, -68.94139082779142, -57.37929635358759, -117.23452026052556, -68.26700931759339, -67.34984888807806, -53.04011084238001, -73.90230275168456, -149.71273657420755, -144.6236987935324, -123.26105772615483, -56.80710029008032, -39.96447797193567, -94.47908667492304, -100.44951784858985, -176.44663631029604, -219.29090868970965, -103.1790190480535, -75.377824652944, -64.57488281078187, -128.51661536422782, -189.4733591786347, -88.12643016540451, -53.53314916448294, -103.79326112000933, -85.99514329109273, -53.24120400415989, -53.11150694291621, -62.97242992327591, -135.45002714131638, -75.88290943943335, -92.38171713568946, -104.06163385036946, -38.82019986691541, -59.18101925041172, -42.49722275765121, -128.69153310017015, -144.66753503845692, -112.86579929332902, -90.18613255261678, -50.43530570960365, -46.201899001053455, -123.8681644214987, -50.410051292596584, -51.598301144796004, -37.805766867188126, -156.69798434705865, -80.86185677134318, -85.2856709701179, -84.14901285335083, -82.8468644656326, -93.61308538991865, -30.69654279845391, -83.10921617717234, -52.68503675473868, -109.665873934243, -107.46274121518037, -91.07644663924556, -48.37268534800775, -94.09058271457387, -74.52277715855331, -111.41165344392893, -154.7380645246537, -86.31064029596388, -120.00518844229308, -86.44821602443193, -90.31564348416187, -172.7957596743019, -82.86648591328704, -156.57127083497514, -39.267551200190766, -45.650414420928776, -64.88654087128715, -50.05323517366661, -94.32294908896193, -116.41724129638132], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.616475908498746, "mean_inference_ms": 5.259760555009258, "mean_action_processing_ms": 0.19708490186979788, "mean_env_wait_ms": 1.3641373583788623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -30.69654279845391, "episode_reward_min": -219.53628909142208, "episode_reward_mean": -92.30587154767707, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-106.43421726575829, -86.37353944374705, -72.90429886549619, -100.51818735600831, -44.6876090641976, -76.97500119101028, -133.4310457216472, -78.5582309642471, -100.97442474541836, -101.82862555996635, -81.10679534091915, -166.43294520154546, -86.40624544971864, -96.85718933558084, -56.74952678612317, -93.132749413816, -60.085352692433204, -70.126454233255, -113.33168957446445, -219.53628909142208, -79.31387570458332, -75.90723018141867, -89.04932393169459, -150.05432889371946, -84.56500288236101, -68.94139082779142, -57.37929635358759, -117.23452026052556, -68.26700931759339, -67.34984888807806, -53.04011084238001, -73.90230275168456, -149.71273657420755, -144.6236987935324, -123.26105772615483, -56.80710029008032, -39.96447797193567, -94.47908667492304, -100.44951784858985, -176.44663631029604, -219.29090868970965, -103.1790190480535, -75.377824652944, -64.57488281078187, -128.51661536422782, -189.4733591786347, -88.12643016540451, -53.53314916448294, -103.79326112000933, -85.99514329109273, -53.24120400415989, -53.11150694291621, -62.97242992327591, -135.45002714131638, -75.88290943943335, -92.38171713568946, -104.06163385036946, -38.82019986691541, -59.18101925041172, -42.49722275765121, -128.69153310017015, -144.66753503845692, -112.86579929332902, -90.18613255261678, -50.43530570960365, -46.201899001053455, -123.8681644214987, -50.410051292596584, -51.598301144796004, -37.805766867188126, -156.69798434705865, -80.86185677134318, -85.2856709701179, -84.14901285335083, -82.8468644656326, -93.61308538991865, -30.69654279845391, -83.10921617717234, -52.68503675473868, -109.665873934243, -107.46274121518037, -91.07644663924556, -48.37268534800775, -94.09058271457387, -74.52277715855331, -111.41165344392893, -154.7380645246537, -86.31064029596388, -120.00518844229308, -86.44821602443193, -90.31564348416187, -172.7957596743019, -82.86648591328704, -156.57127083497514, -39.267551200190766, -45.650414420928776, -64.88654087128715, -50.05323517366661, -94.32294908896193, -116.41724129638132], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.616475908498746, "mean_inference_ms": 5.259760555009258, "mean_action_processing_ms": 0.19708490186979788, "mean_env_wait_ms": 1.3641373583788623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 672000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 75173.143, "load_time_ms": 30.286, "load_throughput": 462266.307, "learn_time_ms": 67829.439, "learn_throughput": 206.4, "synch_weights_time_ms": 12.799}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "episodes_total": 672, "training_iteration": 48, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-56-10", "timestamp": 1693054570, "time_this_iter_s": 75.31748223304749, "time_total_s": 3728.5420644283295, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270153DBAF0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150E8BB0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 3728.5420644283295, "timesteps_since_restore": 0, "iterations_since_restore": 48, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.75754716981132, "ram_util_percent": 49.67264150943396}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -255.9940211555362, "episode_L1_reward_sum_min": -544.2822695225477, "episode_L1_reward_sum_max": -158.54467759281397, "episode_L2_reward_sum_mean": -141.0096638135612, "episode_L2_reward_sum_min": -213.68403412401676, "episode_L2_reward_sum_max": -115.65313643217087}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.12318200469419452, "policy_loss": 0.08647448561439836, "vf_loss": 0.3670751962820538, "vf_explained_var": 0.6259402290845113, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 686000, "num_env_steps_trained": 686000, "num_agent_steps_sampled": 686000, "num_agent_steps_trained": 686000}, "sampler_results": {"episode_reward_max": -30.69654279845391, "episode_reward_min": -219.53628909142208, "episode_reward_mean": -93.40393728636755, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -255.9940211555362, "episode_L1_reward_sum_min": -544.2822695225477, "episode_L1_reward_sum_max": -158.54467759281397, "episode_L2_reward_sum_mean": -141.0096638135612, "episode_L2_reward_sum_min": -213.68403412401676, "episode_L2_reward_sum_max": -115.65313643217087}, "hist_stats": {"episode_reward": [-56.74952678612317, -93.132749413816, -60.085352692433204, -70.126454233255, -113.33168957446445, -219.53628909142208, -79.31387570458332, -75.90723018141867, -89.04932393169459, -150.05432889371946, -84.56500288236101, -68.94139082779142, -57.37929635358759, -117.23452026052556, -68.26700931759339, -67.34984888807806, -53.04011084238001, -73.90230275168456, -149.71273657420755, -144.6236987935324, -123.26105772615483, -56.80710029008032, -39.96447797193567, -94.47908667492304, -100.44951784858985, -176.44663631029604, -219.29090868970965, -103.1790190480535, -75.377824652944, -64.57488281078187, -128.51661536422782, -189.4733591786347, -88.12643016540451, -53.53314916448294, -103.79326112000933, -85.99514329109273, -53.24120400415989, -53.11150694291621, -62.97242992327591, -135.45002714131638, -75.88290943943335, -92.38171713568946, -104.06163385036946, -38.82019986691541, -59.18101925041172, -42.49722275765121, -128.69153310017015, -144.66753503845692, -112.86579929332902, -90.18613255261678, -50.43530570960365, -46.201899001053455, -123.8681644214987, -50.410051292596584, -51.598301144796004, -37.805766867188126, -156.69798434705865, -80.86185677134318, -85.2856709701179, -84.14901285335083, -82.8468644656326, -93.61308538991865, -30.69654279845391, -83.10921617717234, -52.68503675473868, -109.665873934243, -107.46274121518037, -91.07644663924556, -48.37268534800775, -94.09058271457387, -74.52277715855331, -111.41165344392893, -154.7380645246537, -86.31064029596388, -120.00518844229308, -86.44821602443193, -90.31564348416187, -172.7957596743019, -82.86648591328704, -156.57127083497514, -39.267551200190766, -45.650414420928776, -64.88654087128715, -50.05323517366661, -94.32294908896193, -116.41724129638132, -56.52536837569236, -57.15068955534428, -202.02652441609237, -65.27176814804275, -101.0234337465188, -105.99470524867534, -108.6879277848331, -140.69524147547273, -209.87692987905226, -74.82871563762147, -93.53630455613718, -48.07213775327179, -73.25259051366226, -106.35259228389218], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6158545184264, "mean_inference_ms": 5.254669094646675, "mean_action_processing_ms": 0.1968517422871888, "mean_env_wait_ms": 1.3628563505536682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -30.69654279845391, "episode_reward_min": -219.53628909142208, "episode_reward_mean": -93.40393728636755, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-56.74952678612317, -93.132749413816, -60.085352692433204, -70.126454233255, -113.33168957446445, -219.53628909142208, -79.31387570458332, -75.90723018141867, -89.04932393169459, -150.05432889371946, -84.56500288236101, -68.94139082779142, -57.37929635358759, -117.23452026052556, -68.26700931759339, -67.34984888807806, -53.04011084238001, -73.90230275168456, -149.71273657420755, -144.6236987935324, -123.26105772615483, -56.80710029008032, -39.96447797193567, -94.47908667492304, -100.44951784858985, -176.44663631029604, -219.29090868970965, -103.1790190480535, -75.377824652944, -64.57488281078187, -128.51661536422782, -189.4733591786347, -88.12643016540451, -53.53314916448294, -103.79326112000933, -85.99514329109273, -53.24120400415989, -53.11150694291621, -62.97242992327591, -135.45002714131638, -75.88290943943335, -92.38171713568946, -104.06163385036946, -38.82019986691541, -59.18101925041172, -42.49722275765121, -128.69153310017015, -144.66753503845692, -112.86579929332902, -90.18613255261678, -50.43530570960365, -46.201899001053455, -123.8681644214987, -50.410051292596584, -51.598301144796004, -37.805766867188126, -156.69798434705865, -80.86185677134318, -85.2856709701179, -84.14901285335083, -82.8468644656326, -93.61308538991865, -30.69654279845391, -83.10921617717234, -52.68503675473868, -109.665873934243, -107.46274121518037, -91.07644663924556, -48.37268534800775, -94.09058271457387, -74.52277715855331, -111.41165344392893, -154.7380645246537, -86.31064029596388, -120.00518844229308, -86.44821602443193, -90.31564348416187, -172.7957596743019, -82.86648591328704, -156.57127083497514, -39.267551200190766, -45.650414420928776, -64.88654087128715, -50.05323517366661, -94.32294908896193, -116.41724129638132, -56.52536837569236, -57.15068955534428, -202.02652441609237, -65.27176814804275, -101.0234337465188, -105.99470524867534, -108.6879277848331, -140.69524147547273, -209.87692987905226, -74.82871563762147, -93.53630455613718, -48.07213775327179, -73.25259051366226, -106.35259228389218], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6158545184264, "mean_inference_ms": 5.254669094646675, "mean_action_processing_ms": 0.1968517422871888, "mean_env_wait_ms": 1.3628563505536682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 686000, "num_agent_steps_trained": 686000, "num_env_steps_sampled": 686000, "num_env_steps_trained": 686000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 686000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 686000, "timers": {"training_iteration_time_ms": 75153.781, "load_time_ms": 30.033, "load_throughput": 466146.985, "learn_time_ms": 67798.532, "learn_throughput": 206.494, "synch_weights_time_ms": 12.199}, "counters": {"num_env_steps_sampled": 686000, "num_env_steps_trained": 686000, "num_agent_steps_sampled": 686000, "num_agent_steps_trained": 686000}, "done": false, "episodes_total": 686, "training_iteration": 49, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-57-26", "timestamp": 1693054646, "time_this_iter_s": 75.30687355995178, "time_total_s": 3803.8489379882812, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015204880>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150AA2E0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 3803.8489379882812, "timesteps_since_restore": 0, "iterations_since_restore": 49, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.84299065420561, "ram_util_percent": 49.7233644859813}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -255.73333843678236, "episode_L1_reward_sum_min": -544.2822695225477, "episode_L1_reward_sum_max": -158.54467759281397, "episode_L2_reward_sum_mean": -141.00119853265585, "episode_L2_reward_sum_min": -213.68403412401676, "episode_L2_reward_sum_max": -115.65313643217087}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.17437150474481328, "policy_loss": 0.1430195114063195, "vf_loss": 0.31351990057474544, "vf_explained_var": 0.6808934101351986, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 700000}, "sampler_results": {"episode_reward_max": -30.69654279845391, "episode_reward_min": -219.29090868970965, "episode_reward_mean": -92.34503176933927, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -255.73333843678236, "episode_L1_reward_sum_min": -544.2822695225477, "episode_L1_reward_sum_max": -158.54467759281397, "episode_L2_reward_sum_mean": -141.00119853265585, "episode_L2_reward_sum_min": -213.68403412401676, "episode_L2_reward_sum_max": -115.65313643217087}, "hist_stats": {"episode_reward": [-68.26700931759339, -67.34984888807806, -53.04011084238001, -73.90230275168456, -149.71273657420755, -144.6236987935324, -123.26105772615483, -56.80710029008032, -39.96447797193567, -94.47908667492304, -100.44951784858985, -176.44663631029604, -219.29090868970965, -103.1790190480535, -75.377824652944, -64.57488281078187, -128.51661536422782, -189.4733591786347, -88.12643016540451, -53.53314916448294, -103.79326112000933, -85.99514329109273, -53.24120400415989, -53.11150694291621, -62.97242992327591, -135.45002714131638, -75.88290943943335, -92.38171713568946, -104.06163385036946, -38.82019986691541, -59.18101925041172, -42.49722275765121, -128.69153310017015, -144.66753503845692, -112.86579929332902, -90.18613255261678, -50.43530570960365, -46.201899001053455, -123.8681644214987, -50.410051292596584, -51.598301144796004, -37.805766867188126, -156.69798434705865, -80.86185677134318, -85.2856709701179, -84.14901285335083, -82.8468644656326, -93.61308538991865, -30.69654279845391, -83.10921617717234, -52.68503675473868, -109.665873934243, -107.46274121518037, -91.07644663924556, -48.37268534800775, -94.09058271457387, -74.52277715855331, -111.41165344392893, -154.7380645246537, -86.31064029596388, -120.00518844229308, -86.44821602443193, -90.31564348416187, -172.7957596743019, -82.86648591328704, -156.57127083497514, -39.267551200190766, -45.650414420928776, -64.88654087128715, -50.05323517366661, -94.32294908896193, -116.41724129638132, -56.52536837569236, -57.15068955534428, -202.02652441609237, -65.27176814804275, -101.0234337465188, -105.99470524867534, -108.6879277848331, -140.69524147547273, -209.87692987905226, -74.82871563762147, -93.53630455613718, -48.07213775327179, -73.25259051366226, -106.35259228389218, -76.71387112624055, -128.90886294328467, -85.83445993156455, -123.43633396771868, -83.75717319450202, -118.36478029811106, -134.01810266274097, -53.666559852483154, -107.01775076017866, -63.576878395478765, -65.08734789212373, -66.51251216365793, -43.84668460900175, -78.77516132728293], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6153131323011778, "mean_inference_ms": 5.249955401933443, "mean_action_processing_ms": 0.19666372265356688, "mean_env_wait_ms": 1.3616691347499577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -30.69654279845391, "episode_reward_min": -219.29090868970965, "episode_reward_mean": -92.34503176933927, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-68.26700931759339, -67.34984888807806, -53.04011084238001, -73.90230275168456, -149.71273657420755, -144.6236987935324, -123.26105772615483, -56.80710029008032, -39.96447797193567, -94.47908667492304, -100.44951784858985, -176.44663631029604, -219.29090868970965, -103.1790190480535, -75.377824652944, -64.57488281078187, -128.51661536422782, -189.4733591786347, -88.12643016540451, -53.53314916448294, -103.79326112000933, -85.99514329109273, -53.24120400415989, -53.11150694291621, -62.97242992327591, -135.45002714131638, -75.88290943943335, -92.38171713568946, -104.06163385036946, -38.82019986691541, -59.18101925041172, -42.49722275765121, -128.69153310017015, -144.66753503845692, -112.86579929332902, -90.18613255261678, -50.43530570960365, -46.201899001053455, -123.8681644214987, -50.410051292596584, -51.598301144796004, -37.805766867188126, -156.69798434705865, -80.86185677134318, -85.2856709701179, -84.14901285335083, -82.8468644656326, -93.61308538991865, -30.69654279845391, -83.10921617717234, -52.68503675473868, -109.665873934243, -107.46274121518037, -91.07644663924556, -48.37268534800775, -94.09058271457387, -74.52277715855331, -111.41165344392893, -154.7380645246537, -86.31064029596388, -120.00518844229308, -86.44821602443193, -90.31564348416187, -172.7957596743019, -82.86648591328704, -156.57127083497514, -39.267551200190766, -45.650414420928776, -64.88654087128715, -50.05323517366661, -94.32294908896193, -116.41724129638132, -56.52536837569236, -57.15068955534428, -202.02652441609237, -65.27176814804275, -101.0234337465188, -105.99470524867534, -108.6879277848331, -140.69524147547273, -209.87692987905226, -74.82871563762147, -93.53630455613718, -48.07213775327179, -73.25259051366226, -106.35259228389218, -76.71387112624055, -128.90886294328467, -85.83445993156455, -123.43633396771868, -83.75717319450202, -118.36478029811106, -134.01810266274097, -53.666559852483154, -107.01775076017866, -63.576878395478765, -65.08734789212373, -66.51251216365793, -43.84668460900175, -78.77516132728293], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6153131323011778, "mean_inference_ms": 5.249955401933443, "mean_action_processing_ms": 0.19666372265356688, "mean_env_wait_ms": 1.3616691347499577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 700000, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 700000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 700000, "timers": {"training_iteration_time_ms": 75175.382, "load_time_ms": 30.531, "load_throughput": 458547.087, "learn_time_ms": 67804.387, "learn_throughput": 206.476, "synch_weights_time_ms": 12.682}, "counters": {"num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 700000}, "done": false, "episodes_total": 700, "training_iteration": 50, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-58-41", "timestamp": 1693054721, "time_this_iter_s": 75.17424654960632, "time_total_s": 3879.0231845378876, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015464520>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701543E760>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 3879.0231845378876, "timesteps_since_restore": 0, "iterations_since_restore": 50, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.805660377358492, "ram_util_percent": 49.880188679245265}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -246.4279070442915, "episode_L1_reward_sum_min": -544.2822695225477, "episode_L1_reward_sum_max": -158.54467759281397, "episode_L2_reward_sum_mean": -138.6756409382075, "episode_L2_reward_sum_min": -213.68403412401676, "episode_L2_reward_sum_max": -115.65313643217087}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.15842170310762738, "policy_loss": 0.13735147223962613, "vf_loss": 0.21070230035444523, "vf_explained_var": 0.5410588905521871, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 714000, "num_env_steps_trained": 714000, "num_agent_steps_sampled": 714000, "num_agent_steps_trained": 714000}, "sampler_results": {"episode_reward_max": -30.69654279845391, "episode_reward_min": -209.87692987905226, "episode_reward_mean": -88.77757268641766, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -246.4279070442915, "episode_L1_reward_sum_min": -544.2822695225477, "episode_L1_reward_sum_max": -158.54467759281397, "episode_L2_reward_sum_mean": -138.6756409382075, "episode_L2_reward_sum_min": -213.68403412401676, "episode_L2_reward_sum_max": -115.65313643217087}, "hist_stats": {"episode_reward": [-75.377824652944, -64.57488281078187, -128.51661536422782, -189.4733591786347, -88.12643016540451, -53.53314916448294, -103.79326112000933, -85.99514329109273, -53.24120400415989, -53.11150694291621, -62.97242992327591, -135.45002714131638, -75.88290943943335, -92.38171713568946, -104.06163385036946, -38.82019986691541, -59.18101925041172, -42.49722275765121, -128.69153310017015, -144.66753503845692, -112.86579929332902, -90.18613255261678, -50.43530570960365, -46.201899001053455, -123.8681644214987, -50.410051292596584, -51.598301144796004, -37.805766867188126, -156.69798434705865, -80.86185677134318, -85.2856709701179, -84.14901285335083, -82.8468644656326, -93.61308538991865, -30.69654279845391, -83.10921617717234, -52.68503675473868, -109.665873934243, -107.46274121518037, -91.07644663924556, -48.37268534800775, -94.09058271457387, -74.52277715855331, -111.41165344392893, -154.7380645246537, -86.31064029596388, -120.00518844229308, -86.44821602443193, -90.31564348416187, -172.7957596743019, -82.86648591328704, -156.57127083497514, -39.267551200190766, -45.650414420928776, -64.88654087128715, -50.05323517366661, -94.32294908896193, -116.41724129638132, -56.52536837569236, -57.15068955534428, -202.02652441609237, -65.27176814804275, -101.0234337465188, -105.99470524867534, -108.6879277848331, -140.69524147547273, -209.87692987905226, -74.82871563762147, -93.53630455613718, -48.07213775327179, -73.25259051366226, -106.35259228389218, -76.71387112624055, -128.90886294328467, -85.83445993156455, -123.43633396771868, -83.75717319450202, -118.36478029811106, -134.01810266274097, -53.666559852483154, -107.01775076017866, -63.576878395478765, -65.08734789212373, -66.51251216365793, -43.84668460900175, -78.77516132728293, -43.47128923479054, -73.21340847068272, -46.9204783258202, -59.79877980871917, -98.21747616838428, -72.73634505736271, -63.067015111264915, -105.49355462656663, -76.8559332998999, -73.15429615984942, -77.52870484913433, -130.9881058654762, -129.87826910992175, -62.70394734718446], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6147813115768327, "mean_inference_ms": 5.245552547933443, "mean_action_processing_ms": 0.19648384540227173, "mean_env_wait_ms": 1.3605614668070307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -30.69654279845391, "episode_reward_min": -209.87692987905226, "episode_reward_mean": -88.77757268641766, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-75.377824652944, -64.57488281078187, -128.51661536422782, -189.4733591786347, -88.12643016540451, -53.53314916448294, -103.79326112000933, -85.99514329109273, -53.24120400415989, -53.11150694291621, -62.97242992327591, -135.45002714131638, -75.88290943943335, -92.38171713568946, -104.06163385036946, -38.82019986691541, -59.18101925041172, -42.49722275765121, -128.69153310017015, -144.66753503845692, -112.86579929332902, -90.18613255261678, -50.43530570960365, -46.201899001053455, -123.8681644214987, -50.410051292596584, -51.598301144796004, -37.805766867188126, -156.69798434705865, -80.86185677134318, -85.2856709701179, -84.14901285335083, -82.8468644656326, -93.61308538991865, -30.69654279845391, -83.10921617717234, -52.68503675473868, -109.665873934243, -107.46274121518037, -91.07644663924556, -48.37268534800775, -94.09058271457387, -74.52277715855331, -111.41165344392893, -154.7380645246537, -86.31064029596388, -120.00518844229308, -86.44821602443193, -90.31564348416187, -172.7957596743019, -82.86648591328704, -156.57127083497514, -39.267551200190766, -45.650414420928776, -64.88654087128715, -50.05323517366661, -94.32294908896193, -116.41724129638132, -56.52536837569236, -57.15068955534428, -202.02652441609237, -65.27176814804275, -101.0234337465188, -105.99470524867534, -108.6879277848331, -140.69524147547273, -209.87692987905226, -74.82871563762147, -93.53630455613718, -48.07213775327179, -73.25259051366226, -106.35259228389218, -76.71387112624055, -128.90886294328467, -85.83445993156455, -123.43633396771868, -83.75717319450202, -118.36478029811106, -134.01810266274097, -53.666559852483154, -107.01775076017866, -63.576878395478765, -65.08734789212373, -66.51251216365793, -43.84668460900175, -78.77516132728293, -43.47128923479054, -73.21340847068272, -46.9204783258202, -59.79877980871917, -98.21747616838428, -72.73634505736271, -63.067015111264915, -105.49355462656663, -76.8559332998999, -73.15429615984942, -77.52870484913433, -130.9881058654762, -129.87826910992175, -62.70394734718446], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6147813115768327, "mean_inference_ms": 5.245552547933443, "mean_action_processing_ms": 0.19648384540227173, "mean_env_wait_ms": 1.3605614668070307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 714000, "num_agent_steps_trained": 714000, "num_env_steps_sampled": 714000, "num_env_steps_trained": 714000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 714000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 714000, "timers": {"training_iteration_time_ms": 75200.575, "load_time_ms": 30.478, "load_throughput": 459342.686, "learn_time_ms": 67812.916, "learn_throughput": 206.45, "synch_weights_time_ms": 12.882}, "counters": {"num_env_steps_sampled": 714000, "num_env_steps_trained": 714000, "num_agent_steps_sampled": 714000, "num_agent_steps_trained": 714000}, "done": false, "episodes_total": 714, "training_iteration": 51, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_13-59-56", "timestamp": 1693054796, "time_this_iter_s": 75.2926914691925, "time_total_s": 3954.31587600708, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701535E3A0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015464550>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 3954.31587600708, "timesteps_since_restore": 0, "iterations_since_restore": 51, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.700943396226418, "ram_util_percent": 49.86698113207546}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -241.4851270353794, "episode_L1_reward_sum_min": -540.6022461950779, "episode_L1_reward_sum_max": -158.54467759281397, "episode_L2_reward_sum_mean": -137.37390567831696, "episode_L2_reward_sum_min": -211.12198401987553, "episode_L2_reward_sum_max": -115.65313643217087}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.16847374564187156, "policy_loss": 0.14569217832581766, "vf_loss": 0.22781567064515018, "vf_explained_var": 0.5187529076212718, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000}, "sampler_results": {"episode_reward_max": -30.69654279845391, "episode_reward_min": -209.87692987905226, "episode_reward_mean": -87.10651750876558, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -241.4851270353794, "episode_L1_reward_sum_min": -540.6022461950779, "episode_L1_reward_sum_max": -158.54467759281397, "episode_L2_reward_sum_mean": -137.37390567831696, "episode_L2_reward_sum_min": -211.12198401987553, "episode_L2_reward_sum_max": -115.65313643217087}, "hist_stats": {"episode_reward": [-104.06163385036946, -38.82019986691541, -59.18101925041172, -42.49722275765121, -128.69153310017015, -144.66753503845692, -112.86579929332902, -90.18613255261678, -50.43530570960365, -46.201899001053455, -123.8681644214987, -50.410051292596584, -51.598301144796004, -37.805766867188126, -156.69798434705865, -80.86185677134318, -85.2856709701179, -84.14901285335083, -82.8468644656326, -93.61308538991865, -30.69654279845391, -83.10921617717234, -52.68503675473868, -109.665873934243, -107.46274121518037, -91.07644663924556, -48.37268534800775, -94.09058271457387, -74.52277715855331, -111.41165344392893, -154.7380645246537, -86.31064029596388, -120.00518844229308, -86.44821602443193, -90.31564348416187, -172.7957596743019, -82.86648591328704, -156.57127083497514, -39.267551200190766, -45.650414420928776, -64.88654087128715, -50.05323517366661, -94.32294908896193, -116.41724129638132, -56.52536837569236, -57.15068955534428, -202.02652441609237, -65.27176814804275, -101.0234337465188, -105.99470524867534, -108.6879277848331, -140.69524147547273, -209.87692987905226, -74.82871563762147, -93.53630455613718, -48.07213775327179, -73.25259051366226, -106.35259228389218, -76.71387112624055, -128.90886294328467, -85.83445993156455, -123.43633396771868, -83.75717319450202, -118.36478029811106, -134.01810266274097, -53.666559852483154, -107.01775076017866, -63.576878395478765, -65.08734789212373, -66.51251216365793, -43.84668460900175, -78.77516132728293, -43.47128923479054, -73.21340847068272, -46.9204783258202, -59.79877980871917, -98.21747616838428, -72.73634505736271, -63.067015111264915, -105.49355462656663, -76.8559332998999, -73.15429615984942, -77.52870484913433, -130.9881058654762, -129.87826910992175, -62.70394734718446, -114.92925946578922, -91.61047710934668, -76.0697997946951, -81.1945987809939, -136.51077196276415, -46.77618292658205, -61.09237455459262, -72.2695672924541, -80.64006155953876, -54.6702406265183, -76.00243447047738, -68.3906641129565, -57.240507061165616, -77.92800285128577], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.614288891457901, "mean_inference_ms": 5.24158025397756, "mean_action_processing_ms": 0.19632063625648008, "mean_env_wait_ms": 1.3595752302812714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -30.69654279845391, "episode_reward_min": -209.87692987905226, "episode_reward_mean": -87.10651750876558, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-104.06163385036946, -38.82019986691541, -59.18101925041172, -42.49722275765121, -128.69153310017015, -144.66753503845692, -112.86579929332902, -90.18613255261678, -50.43530570960365, -46.201899001053455, -123.8681644214987, -50.410051292596584, -51.598301144796004, -37.805766867188126, -156.69798434705865, -80.86185677134318, -85.2856709701179, -84.14901285335083, -82.8468644656326, -93.61308538991865, -30.69654279845391, -83.10921617717234, -52.68503675473868, -109.665873934243, -107.46274121518037, -91.07644663924556, -48.37268534800775, -94.09058271457387, -74.52277715855331, -111.41165344392893, -154.7380645246537, -86.31064029596388, -120.00518844229308, -86.44821602443193, -90.31564348416187, -172.7957596743019, -82.86648591328704, -156.57127083497514, -39.267551200190766, -45.650414420928776, -64.88654087128715, -50.05323517366661, -94.32294908896193, -116.41724129638132, -56.52536837569236, -57.15068955534428, -202.02652441609237, -65.27176814804275, -101.0234337465188, -105.99470524867534, -108.6879277848331, -140.69524147547273, -209.87692987905226, -74.82871563762147, -93.53630455613718, -48.07213775327179, -73.25259051366226, -106.35259228389218, -76.71387112624055, -128.90886294328467, -85.83445993156455, -123.43633396771868, -83.75717319450202, -118.36478029811106, -134.01810266274097, -53.666559852483154, -107.01775076017866, -63.576878395478765, -65.08734789212373, -66.51251216365793, -43.84668460900175, -78.77516132728293, -43.47128923479054, -73.21340847068272, -46.9204783258202, -59.79877980871917, -98.21747616838428, -72.73634505736271, -63.067015111264915, -105.49355462656663, -76.8559332998999, -73.15429615984942, -77.52870484913433, -130.9881058654762, -129.87826910992175, -62.70394734718446, -114.92925946578922, -91.61047710934668, -76.0697997946951, -81.1945987809939, -136.51077196276415, -46.77618292658205, -61.09237455459262, -72.2695672924541, -80.64006155953876, -54.6702406265183, -76.00243447047738, -68.3906641129565, -57.240507061165616, -77.92800285128577], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.614288891457901, "mean_inference_ms": 5.24158025397756, "mean_action_processing_ms": 0.19632063625648008, "mean_env_wait_ms": 1.3595752302812714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 728000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 728000, "timers": {"training_iteration_time_ms": 75204.011, "load_time_ms": 30.554, "load_throughput": 458212.169, "learn_time_ms": 67813.038, "learn_throughput": 206.45, "synch_weights_time_ms": 13.472}, "counters": {"num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000}, "done": false, "episodes_total": 728, "training_iteration": 52, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-01-12", "timestamp": 1693054872, "time_this_iter_s": 75.22634100914001, "time_total_s": 4029.54221701622, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701524F070>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015464760>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 4029.54221701622, "timesteps_since_restore": 0, "iterations_since_restore": 52, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.593457943925237, "ram_util_percent": 49.949532710280394}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -236.11713038757443, "episode_L1_reward_sum_min": -540.6022461950779, "episode_L1_reward_sum_max": -158.54467759281397, "episode_L2_reward_sum_mean": -135.98552032366396, "episode_L2_reward_sum_min": -211.12198401987553, "episode_L2_reward_sum_max": -115.65313643217087}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.17735869883092067, "policy_loss": 0.16422404116402867, "vf_loss": 0.13134656374248463, "vf_explained_var": 0.6234385440501656, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 742000, "num_env_steps_trained": 742000, "num_agent_steps_sampled": 742000, "num_agent_steps_trained": 742000}, "sampler_results": {"episode_reward_max": -30.69654279845391, "episode_reward_min": -209.87692987905226, "episode_reward_mean": -84.99609090084857, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -236.11713038757443, "episode_L1_reward_sum_min": -540.6022461950779, "episode_L1_reward_sum_max": -158.54467759281397, "episode_L2_reward_sum_mean": -135.98552032366396, "episode_L2_reward_sum_min": -211.12198401987553, "episode_L2_reward_sum_max": -115.65313643217087}, "hist_stats": {"episode_reward": [-156.69798434705865, -80.86185677134318, -85.2856709701179, -84.14901285335083, -82.8468644656326, -93.61308538991865, -30.69654279845391, -83.10921617717234, -52.68503675473868, -109.665873934243, -107.46274121518037, -91.07644663924556, -48.37268534800775, -94.09058271457387, -74.52277715855331, -111.41165344392893, -154.7380645246537, -86.31064029596388, -120.00518844229308, -86.44821602443193, -90.31564348416187, -172.7957596743019, -82.86648591328704, -156.57127083497514, -39.267551200190766, -45.650414420928776, -64.88654087128715, -50.05323517366661, -94.32294908896193, -116.41724129638132, -56.52536837569236, -57.15068955534428, -202.02652441609237, -65.27176814804275, -101.0234337465188, -105.99470524867534, -108.6879277848331, -140.69524147547273, -209.87692987905226, -74.82871563762147, -93.53630455613718, -48.07213775327179, -73.25259051366226, -106.35259228389218, -76.71387112624055, -128.90886294328467, -85.83445993156455, -123.43633396771868, -83.75717319450202, -118.36478029811106, -134.01810266274097, -53.666559852483154, -107.01775076017866, -63.576878395478765, -65.08734789212373, -66.51251216365793, -43.84668460900175, -78.77516132728293, -43.47128923479054, -73.21340847068272, -46.9204783258202, -59.79877980871917, -98.21747616838428, -72.73634505736271, -63.067015111264915, -105.49355462656663, -76.8559332998999, -73.15429615984942, -77.52870484913433, -130.9881058654762, -129.87826910992175, -62.70394734718446, -114.92925946578922, -91.61047710934668, -76.0697997946951, -81.1945987809939, -136.51077196276415, -46.77618292658205, -61.09237455459262, -72.2695672924541, -80.64006155953876, -54.6702406265183, -76.00243447047738, -68.3906641129565, -57.240507061165616, -77.92800285128577, -67.02244471452792, -54.578404485899505, -47.27334811319534, -58.47984325232492, -39.0711756119205, -71.80957059757286, -99.63634704138649, -49.96937855604027, -87.82649612810809, -66.48959290066117, -85.50782031448806, -42.74436197533166, -40.29461415348769, -59.544505510011454], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6138135873848916, "mean_inference_ms": 5.23785444270895, "mean_action_processing_ms": 0.1961803057721011, "mean_env_wait_ms": 1.3586570848513662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -30.69654279845391, "episode_reward_min": -209.87692987905226, "episode_reward_mean": -84.99609090084857, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-156.69798434705865, -80.86185677134318, -85.2856709701179, -84.14901285335083, -82.8468644656326, -93.61308538991865, -30.69654279845391, -83.10921617717234, -52.68503675473868, -109.665873934243, -107.46274121518037, -91.07644663924556, -48.37268534800775, -94.09058271457387, -74.52277715855331, -111.41165344392893, -154.7380645246537, -86.31064029596388, -120.00518844229308, -86.44821602443193, -90.31564348416187, -172.7957596743019, -82.86648591328704, -156.57127083497514, -39.267551200190766, -45.650414420928776, -64.88654087128715, -50.05323517366661, -94.32294908896193, -116.41724129638132, -56.52536837569236, -57.15068955534428, -202.02652441609237, -65.27176814804275, -101.0234337465188, -105.99470524867534, -108.6879277848331, -140.69524147547273, -209.87692987905226, -74.82871563762147, -93.53630455613718, -48.07213775327179, -73.25259051366226, -106.35259228389218, -76.71387112624055, -128.90886294328467, -85.83445993156455, -123.43633396771868, -83.75717319450202, -118.36478029811106, -134.01810266274097, -53.666559852483154, -107.01775076017866, -63.576878395478765, -65.08734789212373, -66.51251216365793, -43.84668460900175, -78.77516132728293, -43.47128923479054, -73.21340847068272, -46.9204783258202, -59.79877980871917, -98.21747616838428, -72.73634505736271, -63.067015111264915, -105.49355462656663, -76.8559332998999, -73.15429615984942, -77.52870484913433, -130.9881058654762, -129.87826910992175, -62.70394734718446, -114.92925946578922, -91.61047710934668, -76.0697997946951, -81.1945987809939, -136.51077196276415, -46.77618292658205, -61.09237455459262, -72.2695672924541, -80.64006155953876, -54.6702406265183, -76.00243447047738, -68.3906641129565, -57.240507061165616, -77.92800285128577, -67.02244471452792, -54.578404485899505, -47.27334811319534, -58.47984325232492, -39.0711756119205, -71.80957059757286, -99.63634704138649, -49.96937855604027, -87.82649612810809, -66.48959290066117, -85.50782031448806, -42.74436197533166, -40.29461415348769, -59.544505510011454], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6138135873848916, "mean_inference_ms": 5.23785444270895, "mean_action_processing_ms": 0.1961803057721011, "mean_env_wait_ms": 1.3586570848513662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 742000, "num_agent_steps_trained": 742000, "num_env_steps_sampled": 742000, "num_env_steps_trained": 742000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 742000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 742000, "timers": {"training_iteration_time_ms": 75202.693, "load_time_ms": 31.252, "load_throughput": 447975.392, "learn_time_ms": 67802.15, "learn_throughput": 206.483, "synch_weights_time_ms": 14.37}, "counters": {"num_env_steps_sampled": 742000, "num_env_steps_trained": 742000, "num_agent_steps_sampled": 742000, "num_agent_steps_trained": 742000}, "done": false, "episodes_total": 742, "training_iteration": 53, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-02-27", "timestamp": 1693054947, "time_this_iter_s": 75.2114007472992, "time_total_s": 4104.753617763519, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270152049D0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015309610>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 4104.753617763519, "timesteps_since_restore": 0, "iterations_since_restore": 53, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.710377358490568, "ram_util_percent": 49.91886792452829}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -237.44622671067714, "episode_L1_reward_sum_min": -540.6022461950779, "episode_L1_reward_sum_max": -158.54467759281397, "episode_L2_reward_sum_mean": -136.2676162804663, "episode_L2_reward_sum_min": -211.12198401987553, "episode_L2_reward_sum_max": -115.65313643217087}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.10741096669798449, "policy_loss": 0.08098898881015372, "vf_loss": 0.2642198012312161, "vf_explained_var": 0.635081125231682, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "sampler_results": {"episode_reward_max": -32.372955967435914, "episode_reward_min": -209.87692987905226, "episode_reward_mean": -85.20381190488055, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -237.44622671067714, "episode_L1_reward_sum_min": -540.6022461950779, "episode_L1_reward_sum_max": -158.54467759281397, "episode_L2_reward_sum_mean": -136.2676162804663, "episode_L2_reward_sum_min": -211.12198401987553, "episode_L2_reward_sum_max": -115.65313643217087}, "hist_stats": {"episode_reward": [-74.52277715855331, -111.41165344392893, -154.7380645246537, -86.31064029596388, -120.00518844229308, -86.44821602443193, -90.31564348416187, -172.7957596743019, -82.86648591328704, -156.57127083497514, -39.267551200190766, -45.650414420928776, -64.88654087128715, -50.05323517366661, -94.32294908896193, -116.41724129638132, -56.52536837569236, -57.15068955534428, -202.02652441609237, -65.27176814804275, -101.0234337465188, -105.99470524867534, -108.6879277848331, -140.69524147547273, -209.87692987905226, -74.82871563762147, -93.53630455613718, -48.07213775327179, -73.25259051366226, -106.35259228389218, -76.71387112624055, -128.90886294328467, -85.83445993156455, -123.43633396771868, -83.75717319450202, -118.36478029811106, -134.01810266274097, -53.666559852483154, -107.01775076017866, -63.576878395478765, -65.08734789212373, -66.51251216365793, -43.84668460900175, -78.77516132728293, -43.47128923479054, -73.21340847068272, -46.9204783258202, -59.79877980871917, -98.21747616838428, -72.73634505736271, -63.067015111264915, -105.49355462656663, -76.8559332998999, -73.15429615984942, -77.52870484913433, -130.9881058654762, -129.87826910992175, -62.70394734718446, -114.92925946578922, -91.61047710934668, -76.0697997946951, -81.1945987809939, -136.51077196276415, -46.77618292658205, -61.09237455459262, -72.2695672924541, -80.64006155953876, -54.6702406265183, -76.00243447047738, -68.3906641129565, -57.240507061165616, -77.92800285128577, -67.02244471452792, -54.578404485899505, -47.27334811319534, -58.47984325232492, -39.0711756119205, -71.80957059757286, -99.63634704138649, -49.96937855604027, -87.82649612810809, -66.48959290066117, -85.50782031448806, -42.74436197533166, -40.29461415348769, -59.544505510011454, -68.43987078969718, -94.24511026434705, -32.372955967435914, -82.40750826686241, -87.77212821400485, -92.20269560999574, -40.64318846410529, -97.09208955810209, -82.83121536953756, -65.35863700976327, -149.54904698747168, -93.8858420853012, -153.21424753756088, -81.37116465805255], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6133681457955209, "mean_inference_ms": 5.233886321612266, "mean_action_processing_ms": 0.1960337164160702, "mean_env_wait_ms": 1.3575375267664083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -32.372955967435914, "episode_reward_min": -209.87692987905226, "episode_reward_mean": -85.20381190488055, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-74.52277715855331, -111.41165344392893, -154.7380645246537, -86.31064029596388, -120.00518844229308, -86.44821602443193, -90.31564348416187, -172.7957596743019, -82.86648591328704, -156.57127083497514, -39.267551200190766, -45.650414420928776, -64.88654087128715, -50.05323517366661, -94.32294908896193, -116.41724129638132, -56.52536837569236, -57.15068955534428, -202.02652441609237, -65.27176814804275, -101.0234337465188, -105.99470524867534, -108.6879277848331, -140.69524147547273, -209.87692987905226, -74.82871563762147, -93.53630455613718, -48.07213775327179, -73.25259051366226, -106.35259228389218, -76.71387112624055, -128.90886294328467, -85.83445993156455, -123.43633396771868, -83.75717319450202, -118.36478029811106, -134.01810266274097, -53.666559852483154, -107.01775076017866, -63.576878395478765, -65.08734789212373, -66.51251216365793, -43.84668460900175, -78.77516132728293, -43.47128923479054, -73.21340847068272, -46.9204783258202, -59.79877980871917, -98.21747616838428, -72.73634505736271, -63.067015111264915, -105.49355462656663, -76.8559332998999, -73.15429615984942, -77.52870484913433, -130.9881058654762, -129.87826910992175, -62.70394734718446, -114.92925946578922, -91.61047710934668, -76.0697997946951, -81.1945987809939, -136.51077196276415, -46.77618292658205, -61.09237455459262, -72.2695672924541, -80.64006155953876, -54.6702406265183, -76.00243447047738, -68.3906641129565, -57.240507061165616, -77.92800285128577, -67.02244471452792, -54.578404485899505, -47.27334811319534, -58.47984325232492, -39.0711756119205, -71.80957059757286, -99.63634704138649, -49.96937855604027, -87.82649612810809, -66.48959290066117, -85.50782031448806, -42.74436197533166, -40.29461415348769, -59.544505510011454, -68.43987078969718, -94.24511026434705, -32.372955967435914, -82.40750826686241, -87.77212821400485, -92.20269560999574, -40.64318846410529, -97.09208955810209, -82.83121536953756, -65.35863700976327, -149.54904698747168, -93.8858420853012, -153.21424753756088, -81.37116465805255], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6133681457955209, "mean_inference_ms": 5.233886321612266, "mean_action_processing_ms": 0.1960337164160702, "mean_env_wait_ms": 1.3575375267664083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 756000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 75192.195, "load_time_ms": 31.623, "load_throughput": 442714.995, "learn_time_ms": 67781.508, "learn_throughput": 206.546, "synch_weights_time_ms": 14.469}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "episodes_total": 756, "training_iteration": 54, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-03-42", "timestamp": 1693055022, "time_this_iter_s": 75.02706694602966, "time_total_s": 4179.780684709549, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701535E7F0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701545EE50>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 4179.780684709549, "timesteps_since_restore": 0, "iterations_since_restore": 54, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.9377358490566, "ram_util_percent": 50.26132075471697}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -238.52024120539426, "episode_L1_reward_sum_min": -540.6022461950779, "episode_L1_reward_sum_max": -162.2006294876337, "episode_L2_reward_sum_mean": -136.61165995173155, "episode_L2_reward_sum_min": -211.12198401987553, "episode_L2_reward_sum_max": -116.56686671078205}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.12498831686549358, "policy_loss": 0.09991711587561275, "vf_loss": 0.25071201831952056, "vf_explained_var": 0.6448790899826666, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 770000, "num_env_steps_trained": 770000, "num_agent_steps_sampled": 770000, "num_agent_steps_trained": 770000}, "sampler_results": {"episode_reward_max": -32.372955967435914, "episode_reward_min": -209.87692987905226, "episode_reward_mean": -85.38836612268815, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -238.52024120539426, "episode_L1_reward_sum_min": -540.6022461950779, "episode_L1_reward_sum_max": -162.2006294876337, "episode_L2_reward_sum_mean": -136.61165995173155, "episode_L2_reward_sum_min": -211.12198401987553, "episode_L2_reward_sum_max": -116.56686671078205}, "hist_stats": {"episode_reward": [-94.32294908896193, -116.41724129638132, -56.52536837569236, -57.15068955534428, -202.02652441609237, -65.27176814804275, -101.0234337465188, -105.99470524867534, -108.6879277848331, -140.69524147547273, -209.87692987905226, -74.82871563762147, -93.53630455613718, -48.07213775327179, -73.25259051366226, -106.35259228389218, -76.71387112624055, -128.90886294328467, -85.83445993156455, -123.43633396771868, -83.75717319450202, -118.36478029811106, -134.01810266274097, -53.666559852483154, -107.01775076017866, -63.576878395478765, -65.08734789212373, -66.51251216365793, -43.84668460900175, -78.77516132728293, -43.47128923479054, -73.21340847068272, -46.9204783258202, -59.79877980871917, -98.21747616838428, -72.73634505736271, -63.067015111264915, -105.49355462656663, -76.8559332998999, -73.15429615984942, -77.52870484913433, -130.9881058654762, -129.87826910992175, -62.70394734718446, -114.92925946578922, -91.61047710934668, -76.0697997946951, -81.1945987809939, -136.51077196276415, -46.77618292658205, -61.09237455459262, -72.2695672924541, -80.64006155953876, -54.6702406265183, -76.00243447047738, -68.3906641129565, -57.240507061165616, -77.92800285128577, -67.02244471452792, -54.578404485899505, -47.27334811319534, -58.47984325232492, -39.0711756119205, -71.80957059757286, -99.63634704138649, -49.96937855604027, -87.82649612810809, -66.48959290066117, -85.50782031448806, -42.74436197533166, -40.29461415348769, -59.544505510011454, -68.43987078969718, -94.24511026434705, -32.372955967435914, -82.40750826686241, -87.77212821400485, -92.20269560999574, -40.64318846410529, -97.09208955810209, -82.83121536953756, -65.35863700976327, -149.54904698747168, -93.8858420853012, -153.21424753756088, -81.37116465805255, -66.19452486117774, -83.6972424958952, -72.46100692377787, -78.14281282953239, -76.53956994085384, -110.527642651722, -70.34260563902741, -78.50729047834383, -175.6627992844998, -163.65001163256753, -138.02302049683107, -61.484707476092204, -69.65814267346647, -109.40748585959358], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6129023494921629, "mean_inference_ms": 5.230821899385291, "mean_action_processing_ms": 0.19592139564080996, "mean_env_wait_ms": 1.3566442650329962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -32.372955967435914, "episode_reward_min": -209.87692987905226, "episode_reward_mean": -85.38836612268815, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-94.32294908896193, -116.41724129638132, -56.52536837569236, -57.15068955534428, -202.02652441609237, -65.27176814804275, -101.0234337465188, -105.99470524867534, -108.6879277848331, -140.69524147547273, -209.87692987905226, -74.82871563762147, -93.53630455613718, -48.07213775327179, -73.25259051366226, -106.35259228389218, -76.71387112624055, -128.90886294328467, -85.83445993156455, -123.43633396771868, -83.75717319450202, -118.36478029811106, -134.01810266274097, -53.666559852483154, -107.01775076017866, -63.576878395478765, -65.08734789212373, -66.51251216365793, -43.84668460900175, -78.77516132728293, -43.47128923479054, -73.21340847068272, -46.9204783258202, -59.79877980871917, -98.21747616838428, -72.73634505736271, -63.067015111264915, -105.49355462656663, -76.8559332998999, -73.15429615984942, -77.52870484913433, -130.9881058654762, -129.87826910992175, -62.70394734718446, -114.92925946578922, -91.61047710934668, -76.0697997946951, -81.1945987809939, -136.51077196276415, -46.77618292658205, -61.09237455459262, -72.2695672924541, -80.64006155953876, -54.6702406265183, -76.00243447047738, -68.3906641129565, -57.240507061165616, -77.92800285128577, -67.02244471452792, -54.578404485899505, -47.27334811319534, -58.47984325232492, -39.0711756119205, -71.80957059757286, -99.63634704138649, -49.96937855604027, -87.82649612810809, -66.48959290066117, -85.50782031448806, -42.74436197533166, -40.29461415348769, -59.544505510011454, -68.43987078969718, -94.24511026434705, -32.372955967435914, -82.40750826686241, -87.77212821400485, -92.20269560999574, -40.64318846410529, -97.09208955810209, -82.83121536953756, -65.35863700976327, -149.54904698747168, -93.8858420853012, -153.21424753756088, -81.37116465805255, -66.19452486117774, -83.6972424958952, -72.46100692377787, -78.14281282953239, -76.53956994085384, -110.527642651722, -70.34260563902741, -78.50729047834383, -175.6627992844998, -163.65001163256753, -138.02302049683107, -61.484707476092204, -69.65814267346647, -109.40748585959358], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6129023494921629, "mean_inference_ms": 5.230821899385291, "mean_action_processing_ms": 0.19592139564080996, "mean_env_wait_ms": 1.3566442650329962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 770000, "num_agent_steps_trained": 770000, "num_env_steps_sampled": 770000, "num_env_steps_trained": 770000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 770000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 770000, "timers": {"training_iteration_time_ms": 75235.306, "load_time_ms": 32.134, "load_throughput": 435670.322, "learn_time_ms": 67782.983, "learn_throughput": 206.542, "synch_weights_time_ms": 14.572}, "counters": {"num_env_steps_sampled": 770000, "num_env_steps_trained": 770000, "num_agent_steps_sampled": 770000, "num_agent_steps_trained": 770000}, "done": false, "episodes_total": 770, "training_iteration": 55, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-04-58", "timestamp": 1693055098, "time_this_iter_s": 75.37944746017456, "time_total_s": 4255.1601321697235, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015359A90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270129C6460>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 4255.1601321697235, "timesteps_since_restore": 0, "iterations_since_restore": 55, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 22.185981308411215, "ram_util_percent": 50.28037383177569}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -228.71199384398759, "episode_L1_reward_sum_min": -479.23302724957466, "episode_L1_reward_sum_max": -162.2006294876337, "episode_L2_reward_sum_mean": -134.14523512549698, "episode_L2_reward_sum_min": -200.83811695873737, "episode_L2_reward_sum_max": -116.56686671078205}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.16560422787146975, "policy_loss": 0.1416182326770449, "vf_loss": 0.23985993886271073, "vf_explained_var": 0.542591620006679, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "sampler_results": {"episode_reward_max": -32.372955967435914, "episode_reward_min": -175.6627992844998, "episode_reward_mean": -80.80219097428076, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -228.71199384398759, "episode_L1_reward_sum_min": -479.23302724957466, "episode_L1_reward_sum_max": -162.2006294876337, "episode_L2_reward_sum_mean": -134.14523512549698, "episode_L2_reward_sum_min": -200.83811695873737, "episode_L2_reward_sum_max": -116.56686671078205}, "hist_stats": {"episode_reward": [-73.25259051366226, -106.35259228389218, -76.71387112624055, -128.90886294328467, -85.83445993156455, -123.43633396771868, -83.75717319450202, -118.36478029811106, -134.01810266274097, -53.666559852483154, -107.01775076017866, -63.576878395478765, -65.08734789212373, -66.51251216365793, -43.84668460900175, -78.77516132728293, -43.47128923479054, -73.21340847068272, -46.9204783258202, -59.79877980871917, -98.21747616838428, -72.73634505736271, -63.067015111264915, -105.49355462656663, -76.8559332998999, -73.15429615984942, -77.52870484913433, -130.9881058654762, -129.87826910992175, -62.70394734718446, -114.92925946578922, -91.61047710934668, -76.0697997946951, -81.1945987809939, -136.51077196276415, -46.77618292658205, -61.09237455459262, -72.2695672924541, -80.64006155953876, -54.6702406265183, -76.00243447047738, -68.3906641129565, -57.240507061165616, -77.92800285128577, -67.02244471452792, -54.578404485899505, -47.27334811319534, -58.47984325232492, -39.0711756119205, -71.80957059757286, -99.63634704138649, -49.96937855604027, -87.82649612810809, -66.48959290066117, -85.50782031448806, -42.74436197533166, -40.29461415348769, -59.544505510011454, -68.43987078969718, -94.24511026434705, -32.372955967435914, -82.40750826686241, -87.77212821400485, -92.20269560999574, -40.64318846410529, -97.09208955810209, -82.83121536953756, -65.35863700976327, -149.54904698747168, -93.8858420853012, -153.21424753756088, -81.37116465805255, -66.19452486117774, -83.6972424958952, -72.46100692377787, -78.14281282953239, -76.53956994085384, -110.527642651722, -70.34260563902741, -78.50729047834383, -175.6627992844998, -163.65001163256753, -138.02302049683107, -61.484707476092204, -69.65814267346647, -109.40748585959358, -82.56774301369082, -43.341551466927505, -74.90602386545936, -59.97238206242556, -56.266276416997044, -95.4781671837987, -60.59982584496745, -35.80708138271123, -87.09681724154744, -69.84899413368979, -81.77045898203885, -118.4911719770194, -85.24027759161771, -64.42565095846851], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6125164826901017, "mean_inference_ms": 5.227995125482073, "mean_action_processing_ms": 0.19579385313705913, "mean_env_wait_ms": 1.355816509830861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -32.372955967435914, "episode_reward_min": -175.6627992844998, "episode_reward_mean": -80.80219097428076, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-73.25259051366226, -106.35259228389218, -76.71387112624055, -128.90886294328467, -85.83445993156455, -123.43633396771868, -83.75717319450202, -118.36478029811106, -134.01810266274097, -53.666559852483154, -107.01775076017866, -63.576878395478765, -65.08734789212373, -66.51251216365793, -43.84668460900175, -78.77516132728293, -43.47128923479054, -73.21340847068272, -46.9204783258202, -59.79877980871917, -98.21747616838428, -72.73634505736271, -63.067015111264915, -105.49355462656663, -76.8559332998999, -73.15429615984942, -77.52870484913433, -130.9881058654762, -129.87826910992175, -62.70394734718446, -114.92925946578922, -91.61047710934668, -76.0697997946951, -81.1945987809939, -136.51077196276415, -46.77618292658205, -61.09237455459262, -72.2695672924541, -80.64006155953876, -54.6702406265183, -76.00243447047738, -68.3906641129565, -57.240507061165616, -77.92800285128577, -67.02244471452792, -54.578404485899505, -47.27334811319534, -58.47984325232492, -39.0711756119205, -71.80957059757286, -99.63634704138649, -49.96937855604027, -87.82649612810809, -66.48959290066117, -85.50782031448806, -42.74436197533166, -40.29461415348769, -59.544505510011454, -68.43987078969718, -94.24511026434705, -32.372955967435914, -82.40750826686241, -87.77212821400485, -92.20269560999574, -40.64318846410529, -97.09208955810209, -82.83121536953756, -65.35863700976327, -149.54904698747168, -93.8858420853012, -153.21424753756088, -81.37116465805255, -66.19452486117774, -83.6972424958952, -72.46100692377787, -78.14281282953239, -76.53956994085384, -110.527642651722, -70.34260563902741, -78.50729047834383, -175.6627992844998, -163.65001163256753, -138.02302049683107, -61.484707476092204, -69.65814267346647, -109.40748585959358, -82.56774301369082, -43.341551466927505, -74.90602386545936, -59.97238206242556, -56.266276416997044, -95.4781671837987, -60.59982584496745, -35.80708138271123, -87.09681724154744, -69.84899413368979, -81.77045898203885, -118.4911719770194, -85.24027759161771, -64.42565095846851], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6125164826901017, "mean_inference_ms": 5.227995125482073, "mean_action_processing_ms": 0.19579385313705913, "mean_env_wait_ms": 1.355816509830861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 784000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 75236.986, "load_time_ms": 31.899, "load_throughput": 438889.507, "learn_time_ms": 67768.675, "learn_throughput": 206.585, "synch_weights_time_ms": 14.574}, "counters": {"num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "episodes_total": 784, "training_iteration": 56, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-06-13", "timestamp": 1693055173, "time_this_iter_s": 75.09319472312927, "time_total_s": 4330.253326892853, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270153608E0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270153DB670>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 4330.253326892853, "timesteps_since_restore": 0, "iterations_since_restore": 56, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.90754716981132, "ram_util_percent": 50.31320754716981}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -238.2177512396127, "episode_L1_reward_sum_min": -606.770585089922, "episode_L1_reward_sum_max": -162.2006294876337, "episode_L2_reward_sum_mean": -136.56280977733434, "episode_L2_reward_sum_min": -225.92934927344322, "episode_L2_reward_sum_max": -116.56686671078205}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.08062370651767593, "policy_loss": 0.04416472872972121, "vf_loss": 0.36458975781728387, "vf_explained_var": 0.7541515702696003, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 798000, "num_env_steps_trained": 798000, "num_agent_steps_sampled": 798000, "num_agent_steps_trained": 798000}, "sampler_results": {"episode_reward_max": -32.372955967435914, "episode_reward_min": -241.97822055740136, "episode_reward_mean": -83.39999946408119, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -238.2177512396127, "episode_L1_reward_sum_min": -606.770585089922, "episode_L1_reward_sum_max": -162.2006294876337, "episode_L2_reward_sum_mean": -136.56280977733434, "episode_L2_reward_sum_min": -225.92934927344322, "episode_L2_reward_sum_max": -116.56686671078205}, "hist_stats": {"episode_reward": [-43.84668460900175, -78.77516132728293, -43.47128923479054, -73.21340847068272, -46.9204783258202, -59.79877980871917, -98.21747616838428, -72.73634505736271, -63.067015111264915, -105.49355462656663, -76.8559332998999, -73.15429615984942, -77.52870484913433, -130.9881058654762, -129.87826910992175, -62.70394734718446, -114.92925946578922, -91.61047710934668, -76.0697997946951, -81.1945987809939, -136.51077196276415, -46.77618292658205, -61.09237455459262, -72.2695672924541, -80.64006155953876, -54.6702406265183, -76.00243447047738, -68.3906641129565, -57.240507061165616, -77.92800285128577, -67.02244471452792, -54.578404485899505, -47.27334811319534, -58.47984325232492, -39.0711756119205, -71.80957059757286, -99.63634704138649, -49.96937855604027, -87.82649612810809, -66.48959290066117, -85.50782031448806, -42.74436197533166, -40.29461415348769, -59.544505510011454, -68.43987078969718, -94.24511026434705, -32.372955967435914, -82.40750826686241, -87.77212821400485, -92.20269560999574, -40.64318846410529, -97.09208955810209, -82.83121536953756, -65.35863700976327, -149.54904698747168, -93.8858420853012, -153.21424753756088, -81.37116465805255, -66.19452486117774, -83.6972424958952, -72.46100692377787, -78.14281282953239, -76.53956994085384, -110.527642651722, -70.34260563902741, -78.50729047834383, -175.6627992844998, -163.65001163256753, -138.02302049683107, -61.484707476092204, -69.65814267346647, -109.40748585959358, -82.56774301369082, -43.341551466927505, -74.90602386545936, -59.97238206242556, -56.266276416997044, -95.4781671837987, -60.59982584496745, -35.80708138271123, -87.09681724154744, -69.84899413368979, -81.77045898203885, -118.4911719770194, -85.24027759161771, -64.42565095846851, -117.25780458672233, -83.27845072378719, -102.1361133810901, -121.30761895195387, -62.60825009599966, -124.95549562919663, -83.2543858283352, -46.47176278696636, -158.59947302450257, -90.99904480070698, -75.65705937814882, -241.97822055740136, -172.77399557076123, -65.00298965011027], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6121171431821636, "mean_inference_ms": 5.225334692078677, "mean_action_processing_ms": 0.19564513710238246, "mean_env_wait_ms": 1.3550493447618726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -32.372955967435914, "episode_reward_min": -241.97822055740136, "episode_reward_mean": -83.39999946408119, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-43.84668460900175, -78.77516132728293, -43.47128923479054, -73.21340847068272, -46.9204783258202, -59.79877980871917, -98.21747616838428, -72.73634505736271, -63.067015111264915, -105.49355462656663, -76.8559332998999, -73.15429615984942, -77.52870484913433, -130.9881058654762, -129.87826910992175, -62.70394734718446, -114.92925946578922, -91.61047710934668, -76.0697997946951, -81.1945987809939, -136.51077196276415, -46.77618292658205, -61.09237455459262, -72.2695672924541, -80.64006155953876, -54.6702406265183, -76.00243447047738, -68.3906641129565, -57.240507061165616, -77.92800285128577, -67.02244471452792, -54.578404485899505, -47.27334811319534, -58.47984325232492, -39.0711756119205, -71.80957059757286, -99.63634704138649, -49.96937855604027, -87.82649612810809, -66.48959290066117, -85.50782031448806, -42.74436197533166, -40.29461415348769, -59.544505510011454, -68.43987078969718, -94.24511026434705, -32.372955967435914, -82.40750826686241, -87.77212821400485, -92.20269560999574, -40.64318846410529, -97.09208955810209, -82.83121536953756, -65.35863700976327, -149.54904698747168, -93.8858420853012, -153.21424753756088, -81.37116465805255, -66.19452486117774, -83.6972424958952, -72.46100692377787, -78.14281282953239, -76.53956994085384, -110.527642651722, -70.34260563902741, -78.50729047834383, -175.6627992844998, -163.65001163256753, -138.02302049683107, -61.484707476092204, -69.65814267346647, -109.40748585959358, -82.56774301369082, -43.341551466927505, -74.90602386545936, -59.97238206242556, -56.266276416997044, -95.4781671837987, -60.59982584496745, -35.80708138271123, -87.09681724154744, -69.84899413368979, -81.77045898203885, -118.4911719770194, -85.24027759161771, -64.42565095846851, -117.25780458672233, -83.27845072378719, -102.1361133810901, -121.30761895195387, -62.60825009599966, -124.95549562919663, -83.2543858283352, -46.47176278696636, -158.59947302450257, -90.99904480070698, -75.65705937814882, -241.97822055740136, -172.77399557076123, -65.00298965011027], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6121171431821636, "mean_inference_ms": 5.225334692078677, "mean_action_processing_ms": 0.19564513710238246, "mean_env_wait_ms": 1.3550493447618726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 798000, "num_agent_steps_trained": 798000, "num_env_steps_sampled": 798000, "num_env_steps_trained": 798000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 798000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 798000, "timers": {"training_iteration_time_ms": 75195.177, "load_time_ms": 31.289, "load_throughput": 447446.973, "learn_time_ms": 67741.764, "learn_throughput": 206.667, "synch_weights_time_ms": 14.067}, "counters": {"num_env_steps_sampled": 798000, "num_env_steps_trained": 798000, "num_agent_steps_sampled": 798000, "num_agent_steps_trained": 798000}, "done": false, "episodes_total": 798, "training_iteration": 57, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-07-28", "timestamp": 1693055248, "time_this_iter_s": 74.96611523628235, "time_total_s": 4405.219442129135, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701543FFD0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014F64C40>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 4405.219442129135, "timesteps_since_restore": 0, "iterations_since_restore": 57, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.889622641509437, "ram_util_percent": 50.469811320754715}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -246.86605263903738, "episode_L1_reward_sum_min": -606.770585089922, "episode_L1_reward_sum_max": -162.2006294876337, "episode_L2_reward_sum_mean": -138.79279384121298, "episode_L2_reward_sum_min": -226.84348438680172, "episode_L2_reward_sum_max": -116.56686671078205}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.13433373867583925, "policy_loss": 0.0955813047540788, "vf_loss": 0.387524331173756, "vf_explained_var": 0.6297124152995431, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 812000, "num_env_steps_trained": 812000, "num_agent_steps_sampled": 812000, "num_agent_steps_trained": 812000}, "sampler_results": {"episode_reward_max": -32.372955967435914, "episode_reward_min": -241.97822055740136, "episode_reward_mean": -87.8987798226015, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -246.86605263903738, "episode_L1_reward_sum_min": -606.770585089922, "episode_L1_reward_sum_max": -162.2006294876337, "episode_L2_reward_sum_mean": -138.79279384121298, "episode_L2_reward_sum_min": -226.84348438680172, "episode_L2_reward_sum_max": -116.56686671078205}, "hist_stats": {"episode_reward": [-129.87826910992175, -62.70394734718446, -114.92925946578922, -91.61047710934668, -76.0697997946951, -81.1945987809939, -136.51077196276415, -46.77618292658205, -61.09237455459262, -72.2695672924541, -80.64006155953876, -54.6702406265183, -76.00243447047738, -68.3906641129565, -57.240507061165616, -77.92800285128577, -67.02244471452792, -54.578404485899505, -47.27334811319534, -58.47984325232492, -39.0711756119205, -71.80957059757286, -99.63634704138649, -49.96937855604027, -87.82649612810809, -66.48959290066117, -85.50782031448806, -42.74436197533166, -40.29461415348769, -59.544505510011454, -68.43987078969718, -94.24511026434705, -32.372955967435914, -82.40750826686241, -87.77212821400485, -92.20269560999574, -40.64318846410529, -97.09208955810209, -82.83121536953756, -65.35863700976327, -149.54904698747168, -93.8858420853012, -153.21424753756088, -81.37116465805255, -66.19452486117774, -83.6972424958952, -72.46100692377787, -78.14281282953239, -76.53956994085384, -110.527642651722, -70.34260563902741, -78.50729047834383, -175.6627992844998, -163.65001163256753, -138.02302049683107, -61.484707476092204, -69.65814267346647, -109.40748585959358, -82.56774301369082, -43.341551466927505, -74.90602386545936, -59.97238206242556, -56.266276416997044, -95.4781671837987, -60.59982584496745, -35.80708138271123, -87.09681724154744, -69.84899413368979, -81.77045898203885, -118.4911719770194, -85.24027759161771, -64.42565095846851, -117.25780458672233, -83.27845072378719, -102.1361133810901, -121.30761895195387, -62.60825009599966, -124.95549562919663, -83.2543858283352, -46.47176278696636, -158.59947302450257, -90.99904480070698, -75.65705937814882, -241.97822055740136, -172.77399557076123, -65.00298965011027, -141.29506943086378, -126.78355780320578, -116.39634058740515, -110.38605991606575, -183.76943951354028, -75.65654935840953, -46.31978109017587, -62.87593708703633, -115.78411523123808, -97.89041744556387, -82.95684022425348, -51.95532926343064, -214.86277196593468, -67.01305984914455], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6116886134403061, "mean_inference_ms": 5.222802986784825, "mean_action_processing_ms": 0.19551530478681697, "mean_env_wait_ms": 1.3543284310365158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -32.372955967435914, "episode_reward_min": -241.97822055740136, "episode_reward_mean": -87.8987798226015, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-129.87826910992175, -62.70394734718446, -114.92925946578922, -91.61047710934668, -76.0697997946951, -81.1945987809939, -136.51077196276415, -46.77618292658205, -61.09237455459262, -72.2695672924541, -80.64006155953876, -54.6702406265183, -76.00243447047738, -68.3906641129565, -57.240507061165616, -77.92800285128577, -67.02244471452792, -54.578404485899505, -47.27334811319534, -58.47984325232492, -39.0711756119205, -71.80957059757286, -99.63634704138649, -49.96937855604027, -87.82649612810809, -66.48959290066117, -85.50782031448806, -42.74436197533166, -40.29461415348769, -59.544505510011454, -68.43987078969718, -94.24511026434705, -32.372955967435914, -82.40750826686241, -87.77212821400485, -92.20269560999574, -40.64318846410529, -97.09208955810209, -82.83121536953756, -65.35863700976327, -149.54904698747168, -93.8858420853012, -153.21424753756088, -81.37116465805255, -66.19452486117774, -83.6972424958952, -72.46100692377787, -78.14281282953239, -76.53956994085384, -110.527642651722, -70.34260563902741, -78.50729047834383, -175.6627992844998, -163.65001163256753, -138.02302049683107, -61.484707476092204, -69.65814267346647, -109.40748585959358, -82.56774301369082, -43.341551466927505, -74.90602386545936, -59.97238206242556, -56.266276416997044, -95.4781671837987, -60.59982584496745, -35.80708138271123, -87.09681724154744, -69.84899413368979, -81.77045898203885, -118.4911719770194, -85.24027759161771, -64.42565095846851, -117.25780458672233, -83.27845072378719, -102.1361133810901, -121.30761895195387, -62.60825009599966, -124.95549562919663, -83.2543858283352, -46.47176278696636, -158.59947302450257, -90.99904480070698, -75.65705937814882, -241.97822055740136, -172.77399557076123, -65.00298965011027, -141.29506943086378, -126.78355780320578, -116.39634058740515, -110.38605991606575, -183.76943951354028, -75.65654935840953, -46.31978109017587, -62.87593708703633, -115.78411523123808, -97.89041744556387, -82.95684022425348, -51.95532926343064, -214.86277196593468, -67.01305984914455], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6116886134403061, "mean_inference_ms": 5.222802986784825, "mean_action_processing_ms": 0.19551530478681697, "mean_env_wait_ms": 1.3543284310365158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 812000, "num_agent_steps_trained": 812000, "num_env_steps_sampled": 812000, "num_env_steps_trained": 812000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 812000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 812000, "timers": {"training_iteration_time_ms": 75158.304, "load_time_ms": 30.707, "load_throughput": 455920.307, "learn_time_ms": 67711.61, "learn_throughput": 206.759, "synch_weights_time_ms": 13.97}, "counters": {"num_env_steps_sampled": 812000, "num_env_steps_trained": 812000, "num_agent_steps_sampled": 812000, "num_agent_steps_trained": 812000}, "done": false, "episodes_total": 812, "training_iteration": 58, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-08-43", "timestamp": 1693055323, "time_this_iter_s": 74.94872999191284, "time_total_s": 4480.168172121048, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701517A3D0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701522CFA0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 4480.168172121048, "timesteps_since_restore": 0, "iterations_since_restore": 58, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.86380952380952, "ram_util_percent": 50.46380952380953}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -246.638950137645, "episode_L1_reward_sum_min": -606.770585089922, "episode_L1_reward_sum_max": -162.2006294876337, "episode_L2_reward_sum_mean": -138.75536683142184, "episode_L2_reward_sum_min": -226.84348438680172, "episode_L2_reward_sum_max": -116.56686671078205}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.14880292354426597, "policy_loss": 0.1243791294351475, "vf_loss": 0.24423791975062586, "vf_explained_var": 0.5999411946093595, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 826000, "num_env_steps_trained": 826000, "num_agent_steps_sampled": 826000, "num_agent_steps_trained": 826000}, "sampler_results": {"episode_reward_max": -32.372955967435914, "episode_reward_min": -241.97822055740136, "episode_reward_mean": -88.20322458817678, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -246.638950137645, "episode_L1_reward_sum_min": -606.770585089922, "episode_L1_reward_sum_max": -162.2006294876337, "episode_L2_reward_sum_mean": -138.75536683142184, "episode_L2_reward_sum_min": -226.84348438680172, "episode_L2_reward_sum_max": -116.56686671078205}, "hist_stats": {"episode_reward": [-57.240507061165616, -77.92800285128577, -67.02244471452792, -54.578404485899505, -47.27334811319534, -58.47984325232492, -39.0711756119205, -71.80957059757286, -99.63634704138649, -49.96937855604027, -87.82649612810809, -66.48959290066117, -85.50782031448806, -42.74436197533166, -40.29461415348769, -59.544505510011454, -68.43987078969718, -94.24511026434705, -32.372955967435914, -82.40750826686241, -87.77212821400485, -92.20269560999574, -40.64318846410529, -97.09208955810209, -82.83121536953756, -65.35863700976327, -149.54904698747168, -93.8858420853012, -153.21424753756088, -81.37116465805255, -66.19452486117774, -83.6972424958952, -72.46100692377787, -78.14281282953239, -76.53956994085384, -110.527642651722, -70.34260563902741, -78.50729047834383, -175.6627992844998, -163.65001163256753, -138.02302049683107, -61.484707476092204, -69.65814267346647, -109.40748585959358, -82.56774301369082, -43.341551466927505, -74.90602386545936, -59.97238206242556, -56.266276416997044, -95.4781671837987, -60.59982584496745, -35.80708138271123, -87.09681724154744, -69.84899413368979, -81.77045898203885, -118.4911719770194, -85.24027759161771, -64.42565095846851, -117.25780458672233, -83.27845072378719, -102.1361133810901, -121.30761895195387, -62.60825009599966, -124.95549562919663, -83.2543858283352, -46.47176278696636, -158.59947302450257, -90.99904480070698, -75.65705937814882, -241.97822055740136, -172.77399557076123, -65.00298965011027, -141.29506943086378, -126.78355780320578, -116.39634058740515, -110.38605991606575, -183.76943951354028, -75.65654935840953, -46.31978109017587, -62.87593708703633, -115.78411523123808, -97.89041744556387, -82.95684022425348, -51.95532926343064, -214.86277196593468, -67.01305984914455, -79.62093515756602, -109.24850617333207, -97.35788171127068, -64.67424249154931, -129.0847064350573, -51.03427848908333, -63.75449723530359, -67.03301176354755, -72.35043210204906, -98.11792530645313, -122.21379030865342, -60.63752815938681, -105.94352793031646, -62.111862407774915], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6112970982038755, "mean_inference_ms": 5.220571675675635, "mean_action_processing_ms": 0.19540298466468806, "mean_env_wait_ms": 1.3536783479940482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -32.372955967435914, "episode_reward_min": -241.97822055740136, "episode_reward_mean": -88.20322458817678, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-57.240507061165616, -77.92800285128577, -67.02244471452792, -54.578404485899505, -47.27334811319534, -58.47984325232492, -39.0711756119205, -71.80957059757286, -99.63634704138649, -49.96937855604027, -87.82649612810809, -66.48959290066117, -85.50782031448806, -42.74436197533166, -40.29461415348769, -59.544505510011454, -68.43987078969718, -94.24511026434705, -32.372955967435914, -82.40750826686241, -87.77212821400485, -92.20269560999574, -40.64318846410529, -97.09208955810209, -82.83121536953756, -65.35863700976327, -149.54904698747168, -93.8858420853012, -153.21424753756088, -81.37116465805255, -66.19452486117774, -83.6972424958952, -72.46100692377787, -78.14281282953239, -76.53956994085384, -110.527642651722, -70.34260563902741, -78.50729047834383, -175.6627992844998, -163.65001163256753, -138.02302049683107, -61.484707476092204, -69.65814267346647, -109.40748585959358, -82.56774301369082, -43.341551466927505, -74.90602386545936, -59.97238206242556, -56.266276416997044, -95.4781671837987, -60.59982584496745, -35.80708138271123, -87.09681724154744, -69.84899413368979, -81.77045898203885, -118.4911719770194, -85.24027759161771, -64.42565095846851, -117.25780458672233, -83.27845072378719, -102.1361133810901, -121.30761895195387, -62.60825009599966, -124.95549562919663, -83.2543858283352, -46.47176278696636, -158.59947302450257, -90.99904480070698, -75.65705937814882, -241.97822055740136, -172.77399557076123, -65.00298965011027, -141.29506943086378, -126.78355780320578, -116.39634058740515, -110.38605991606575, -183.76943951354028, -75.65654935840953, -46.31978109017587, -62.87593708703633, -115.78411523123808, -97.89041744556387, -82.95684022425348, -51.95532926343064, -214.86277196593468, -67.01305984914455, -79.62093515756602, -109.24850617333207, -97.35788171127068, -64.67424249154931, -129.0847064350573, -51.03427848908333, -63.75449723530359, -67.03301176354755, -72.35043210204906, -98.11792530645313, -122.21379030865342, -60.63752815938681, -105.94352793031646, -62.111862407774915], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6112970982038755, "mean_inference_ms": 5.220571675675635, "mean_action_processing_ms": 0.19540298466468806, "mean_env_wait_ms": 1.3536783479940482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 826000, "num_agent_steps_trained": 826000, "num_env_steps_sampled": 826000, "num_env_steps_trained": 826000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 826000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 826000, "timers": {"training_iteration_time_ms": 75125.832, "load_time_ms": 30.865, "load_throughput": 453587.481, "learn_time_ms": 67671.286, "learn_throughput": 206.882, "synch_weights_time_ms": 14.676}, "counters": {"num_env_steps_sampled": 826000, "num_env_steps_trained": 826000, "num_agent_steps_sampled": 826000, "num_agent_steps_trained": 826000}, "done": false, "episodes_total": 826, "training_iteration": 59, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-09-58", "timestamp": 1693055398, "time_this_iter_s": 74.98309874534607, "time_total_s": 4555.151270866394, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270154FB370>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701517A220>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 4555.151270866394, "timesteps_since_restore": 0, "iterations_since_restore": 59, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.931132075471698, "ram_util_percent": 50.070754716981114}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -247.80972514800726, "episode_L1_reward_sum_min": -606.770585089922, "episode_L1_reward_sum_max": -162.2006294876337, "episode_L2_reward_sum_mean": -139.09287246510385, "episode_L2_reward_sum_min": -226.84348438680172, "episode_L2_reward_sum_max": -116.56686671078205}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.17328205338807168, "policy_loss": 0.1501931360962996, "vf_loss": 0.2308891646094342, "vf_explained_var": 0.5785443733442467, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "sampler_results": {"episode_reward_max": -32.372955967435914, "episode_reward_min": -241.97822055740136, "episode_reward_mean": -89.21669678242779, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -247.80972514800726, "episode_L1_reward_sum_min": -606.770585089922, "episode_L1_reward_sum_max": -162.2006294876337, "episode_L2_reward_sum_mean": -139.09287246510385, "episode_L2_reward_sum_min": -226.84348438680172, "episode_L2_reward_sum_max": -116.56686671078205}, "hist_stats": {"episode_reward": [-40.29461415348769, -59.544505510011454, -68.43987078969718, -94.24511026434705, -32.372955967435914, -82.40750826686241, -87.77212821400485, -92.20269560999574, -40.64318846410529, -97.09208955810209, -82.83121536953756, -65.35863700976327, -149.54904698747168, -93.8858420853012, -153.21424753756088, -81.37116465805255, -66.19452486117774, -83.6972424958952, -72.46100692377787, -78.14281282953239, -76.53956994085384, -110.527642651722, -70.34260563902741, -78.50729047834383, -175.6627992844998, -163.65001163256753, -138.02302049683107, -61.484707476092204, -69.65814267346647, -109.40748585959358, -82.56774301369082, -43.341551466927505, -74.90602386545936, -59.97238206242556, -56.266276416997044, -95.4781671837987, -60.59982584496745, -35.80708138271123, -87.09681724154744, -69.84899413368979, -81.77045898203885, -118.4911719770194, -85.24027759161771, -64.42565095846851, -117.25780458672233, -83.27845072378719, -102.1361133810901, -121.30761895195387, -62.60825009599966, -124.95549562919663, -83.2543858283352, -46.47176278696636, -158.59947302450257, -90.99904480070698, -75.65705937814882, -241.97822055740136, -172.77399557076123, -65.00298965011027, -141.29506943086378, -126.78355780320578, -116.39634058740515, -110.38605991606575, -183.76943951354028, -75.65654935840953, -46.31978109017587, -62.87593708703633, -115.78411523123808, -97.89041744556387, -82.95684022425348, -51.95532926343064, -214.86277196593468, -67.01305984914455, -79.62093515756602, -109.24850617333207, -97.35788171127068, -64.67424249154931, -129.0847064350573, -51.03427848908333, -63.75449723530359, -67.03301176354755, -72.35043210204906, -98.11792530645313, -122.21379030865342, -60.63752815938681, -105.94352793031646, -62.111862407774915, -93.62782301944672, -50.75565221198099, -67.59273827394229, -57.78400189169814, -80.48224028759667, -75.46968023931717, -57.02286350020257, -56.84958683086067, -51.790222470473175, -117.19728173599772, -86.0179856575134, -68.81418796629607, -58.753990679352704, -84.7662582643274], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6109538598400434, "mean_inference_ms": 5.2184315174454925, "mean_action_processing_ms": 0.19531274460510029, "mean_env_wait_ms": 1.3530461635325428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -32.372955967435914, "episode_reward_min": -241.97822055740136, "episode_reward_mean": -89.21669678242779, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-40.29461415348769, -59.544505510011454, -68.43987078969718, -94.24511026434705, -32.372955967435914, -82.40750826686241, -87.77212821400485, -92.20269560999574, -40.64318846410529, -97.09208955810209, -82.83121536953756, -65.35863700976327, -149.54904698747168, -93.8858420853012, -153.21424753756088, -81.37116465805255, -66.19452486117774, -83.6972424958952, -72.46100692377787, -78.14281282953239, -76.53956994085384, -110.527642651722, -70.34260563902741, -78.50729047834383, -175.6627992844998, -163.65001163256753, -138.02302049683107, -61.484707476092204, -69.65814267346647, -109.40748585959358, -82.56774301369082, -43.341551466927505, -74.90602386545936, -59.97238206242556, -56.266276416997044, -95.4781671837987, -60.59982584496745, -35.80708138271123, -87.09681724154744, -69.84899413368979, -81.77045898203885, -118.4911719770194, -85.24027759161771, -64.42565095846851, -117.25780458672233, -83.27845072378719, -102.1361133810901, -121.30761895195387, -62.60825009599966, -124.95549562919663, -83.2543858283352, -46.47176278696636, -158.59947302450257, -90.99904480070698, -75.65705937814882, -241.97822055740136, -172.77399557076123, -65.00298965011027, -141.29506943086378, -126.78355780320578, -116.39634058740515, -110.38605991606575, -183.76943951354028, -75.65654935840953, -46.31978109017587, -62.87593708703633, -115.78411523123808, -97.89041744556387, -82.95684022425348, -51.95532926343064, -214.86277196593468, -67.01305984914455, -79.62093515756602, -109.24850617333207, -97.35788171127068, -64.67424249154931, -129.0847064350573, -51.03427848908333, -63.75449723530359, -67.03301176354755, -72.35043210204906, -98.11792530645313, -122.21379030865342, -60.63752815938681, -105.94352793031646, -62.111862407774915, -93.62782301944672, -50.75565221198099, -67.59273827394229, -57.78400189169814, -80.48224028759667, -75.46968023931717, -57.02286350020257, -56.84958683086067, -51.790222470473175, -117.19728173599772, -86.0179856575134, -68.81418796629607, -58.753990679352704, -84.7662582643274], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6109538598400434, "mean_inference_ms": 5.2184315174454925, "mean_action_processing_ms": 0.19531274460510029, "mean_env_wait_ms": 1.3530461635325428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 840000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 75120.877, "load_time_ms": 30.863, "load_throughput": 453612.359, "learn_time_ms": 67657.178, "learn_throughput": 206.926, "synch_weights_time_ms": 14.58}, "counters": {"num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "episodes_total": 840, "training_iteration": 60, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-11-13", "timestamp": 1693055473, "time_this_iter_s": 75.12471747398376, "time_total_s": 4630.275988340378, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270151C0130>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270154E9040>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 4630.275988340378, "timesteps_since_restore": 0, "iterations_since_restore": 60, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.920754716981133, "ram_util_percent": 49.88867924528301}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -246.0610788667947, "episode_L1_reward_sum_min": -606.770585089922, "episode_L1_reward_sum_max": -158.57641565054655, "episode_L2_reward_sum_mean": -138.74087424099446, "episode_L2_reward_sum_min": -226.84348438680172, "episode_L2_reward_sum_max": -116.33275185525417}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.15415910591942417, "policy_loss": 0.13535273699578543, "vf_loss": 0.18806369067215428, "vf_explained_var": 0.6989975349341401, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 854000, "num_env_steps_trained": 854000, "num_agent_steps_sampled": 854000, "num_agent_steps_trained": 854000}, "sampler_results": {"episode_reward_max": -35.80708138271123, "episode_reward_min": -241.97822055740136, "episode_reward_mean": -88.82445323036154, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -246.0610788667947, "episode_L1_reward_sum_min": -606.770585089922, "episode_L1_reward_sum_max": -158.57641565054655, "episode_L2_reward_sum_mean": -138.74087424099446, "episode_L2_reward_sum_min": -226.84348438680172, "episode_L2_reward_sum_max": -116.33275185525417}, "hist_stats": {"episode_reward": [-153.21424753756088, -81.37116465805255, -66.19452486117774, -83.6972424958952, -72.46100692377787, -78.14281282953239, -76.53956994085384, -110.527642651722, -70.34260563902741, -78.50729047834383, -175.6627992844998, -163.65001163256753, -138.02302049683107, -61.484707476092204, -69.65814267346647, -109.40748585959358, -82.56774301369082, -43.341551466927505, -74.90602386545936, -59.97238206242556, -56.266276416997044, -95.4781671837987, -60.59982584496745, -35.80708138271123, -87.09681724154744, -69.84899413368979, -81.77045898203885, -118.4911719770194, -85.24027759161771, -64.42565095846851, -117.25780458672233, -83.27845072378719, -102.1361133810901, -121.30761895195387, -62.60825009599966, -124.95549562919663, -83.2543858283352, -46.47176278696636, -158.59947302450257, -90.99904480070698, -75.65705937814882, -241.97822055740136, -172.77399557076123, -65.00298965011027, -141.29506943086378, -126.78355780320578, -116.39634058740515, -110.38605991606575, -183.76943951354028, -75.65654935840953, -46.31978109017587, -62.87593708703633, -115.78411523123808, -97.89041744556387, -82.95684022425348, -51.95532926343064, -214.86277196593468, -67.01305984914455, -79.62093515756602, -109.24850617333207, -97.35788171127068, -64.67424249154931, -129.0847064350573, -51.03427848908333, -63.75449723530359, -67.03301176354755, -72.35043210204906, -98.11792530645313, -122.21379030865342, -60.63752815938681, -105.94352793031646, -62.111862407774915, -93.62782301944672, -50.75565221198099, -67.59273827394229, -57.78400189169814, -80.48224028759667, -75.46968023931717, -57.02286350020257, -56.84958683086067, -51.790222470473175, -117.19728173599772, -86.0179856575134, -68.81418796629607, -58.753990679352704, -84.7662582643274, -95.99251271504932, -57.594391413213145, -63.87737959293834, -65.29860268206002, -69.70839179999633, -63.58141743335336, -66.38570649779432, -91.10104543417269, -56.610346833299204, -82.73283516378704, -73.61254127071656, -66.6953859469071, -122.72270044303775, -71.50179581717731], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6106432495052496, "mean_inference_ms": 5.216573992197015, "mean_action_processing_ms": 0.19524105147907528, "mean_env_wait_ms": 1.3524927190907845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -35.80708138271123, "episode_reward_min": -241.97822055740136, "episode_reward_mean": -88.82445323036154, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153.21424753756088, -81.37116465805255, -66.19452486117774, -83.6972424958952, -72.46100692377787, -78.14281282953239, -76.53956994085384, -110.527642651722, -70.34260563902741, -78.50729047834383, -175.6627992844998, -163.65001163256753, -138.02302049683107, -61.484707476092204, -69.65814267346647, -109.40748585959358, -82.56774301369082, -43.341551466927505, -74.90602386545936, -59.97238206242556, -56.266276416997044, -95.4781671837987, -60.59982584496745, -35.80708138271123, -87.09681724154744, -69.84899413368979, -81.77045898203885, -118.4911719770194, -85.24027759161771, -64.42565095846851, -117.25780458672233, -83.27845072378719, -102.1361133810901, -121.30761895195387, -62.60825009599966, -124.95549562919663, -83.2543858283352, -46.47176278696636, -158.59947302450257, -90.99904480070698, -75.65705937814882, -241.97822055740136, -172.77399557076123, -65.00298965011027, -141.29506943086378, -126.78355780320578, -116.39634058740515, -110.38605991606575, -183.76943951354028, -75.65654935840953, -46.31978109017587, -62.87593708703633, -115.78411523123808, -97.89041744556387, -82.95684022425348, -51.95532926343064, -214.86277196593468, -67.01305984914455, -79.62093515756602, -109.24850617333207, -97.35788171127068, -64.67424249154931, -129.0847064350573, -51.03427848908333, -63.75449723530359, -67.03301176354755, -72.35043210204906, -98.11792530645313, -122.21379030865342, -60.63752815938681, -105.94352793031646, -62.111862407774915, -93.62782301944672, -50.75565221198099, -67.59273827394229, -57.78400189169814, -80.48224028759667, -75.46968023931717, -57.02286350020257, -56.84958683086067, -51.790222470473175, -117.19728173599772, -86.0179856575134, -68.81418796629607, -58.753990679352704, -84.7662582643274, -95.99251271504932, -57.594391413213145, -63.87737959293834, -65.29860268206002, -69.70839179999633, -63.58141743335336, -66.38570649779432, -91.10104543417269, -56.610346833299204, -82.73283516378704, -73.61254127071656, -66.6953859469071, -122.72270044303775, -71.50179581717731], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6106432495052496, "mean_inference_ms": 5.216573992197015, "mean_action_processing_ms": 0.19524105147907528, "mean_env_wait_ms": 1.3524927190907845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 854000, "num_agent_steps_trained": 854000, "num_env_steps_sampled": 854000, "num_env_steps_trained": 854000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 854000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 854000, "timers": {"training_iteration_time_ms": 75094.937, "load_time_ms": 30.168, "load_throughput": 464069.952, "learn_time_ms": 67625.665, "learn_throughput": 207.022, "synch_weights_time_ms": 14.073}, "counters": {"num_env_steps_sampled": 854000, "num_env_steps_trained": 854000, "num_agent_steps_sampled": 854000, "num_agent_steps_trained": 854000}, "done": false, "episodes_total": 854, "training_iteration": 61, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-12-28", "timestamp": 1693055548, "time_this_iter_s": 75.03429412841797, "time_total_s": 4705.310282468796, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270154E9FA0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701517A250>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 4705.310282468796, "timesteps_since_restore": 0, "iterations_since_restore": 61, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.916037735849056, "ram_util_percent": 49.933018867924524}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -238.5738990803063, "episode_L1_reward_sum_min": -606.770585089922, "episode_L1_reward_sum_max": -158.57641565054655, "episode_L2_reward_sum_mean": -136.80546376243234, "episode_L2_reward_sum_min": -226.84348438680172, "episode_L2_reward_sum_max": -116.33275185525417}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.19390299458474922, "policy_loss": 0.17256828346419045, "vf_loss": 0.21334710068843227, "vf_explained_var": 0.5961372422460666, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 868000, "num_env_steps_trained": 868000, "num_agent_steps_sampled": 868000, "num_agent_steps_trained": 868000}, "sampler_results": {"episode_reward_max": -35.80708138271123, "episode_reward_min": -241.97822055740136, "episode_reward_mean": -84.47951089853272, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -238.5738990803063, "episode_L1_reward_sum_min": -606.770585089922, "episode_L1_reward_sum_max": -158.57641565054655, "episode_L2_reward_sum_mean": -136.80546376243234, "episode_L2_reward_sum_min": -226.84348438680172, "episode_L2_reward_sum_max": -116.33275185525417}, "hist_stats": {"episode_reward": [-69.65814267346647, -109.40748585959358, -82.56774301369082, -43.341551466927505, -74.90602386545936, -59.97238206242556, -56.266276416997044, -95.4781671837987, -60.59982584496745, -35.80708138271123, -87.09681724154744, -69.84899413368979, -81.77045898203885, -118.4911719770194, -85.24027759161771, -64.42565095846851, -117.25780458672233, -83.27845072378719, -102.1361133810901, -121.30761895195387, -62.60825009599966, -124.95549562919663, -83.2543858283352, -46.47176278696636, -158.59947302450257, -90.99904480070698, -75.65705937814882, -241.97822055740136, -172.77399557076123, -65.00298965011027, -141.29506943086378, -126.78355780320578, -116.39634058740515, -110.38605991606575, -183.76943951354028, -75.65654935840953, -46.31978109017587, -62.87593708703633, -115.78411523123808, -97.89041744556387, -82.95684022425348, -51.95532926343064, -214.86277196593468, -67.01305984914455, -79.62093515756602, -109.24850617333207, -97.35788171127068, -64.67424249154931, -129.0847064350573, -51.03427848908333, -63.75449723530359, -67.03301176354755, -72.35043210204906, -98.11792530645313, -122.21379030865342, -60.63752815938681, -105.94352793031646, -62.111862407774915, -93.62782301944672, -50.75565221198099, -67.59273827394229, -57.78400189169814, -80.48224028759667, -75.46968023931717, -57.02286350020257, -56.84958683086067, -51.790222470473175, -117.19728173599772, -86.0179856575134, -68.81418796629607, -58.753990679352704, -84.7662582643274, -95.99251271504932, -57.594391413213145, -63.87737959293834, -65.29860268206002, -69.70839179999633, -63.58141743335336, -66.38570649779432, -91.10104543417269, -56.610346833299204, -82.73283516378704, -73.61254127071656, -66.6953859469071, -122.72270044303775, -71.50179581717731, -44.0198897941661, -51.15226767640333, -79.10717094814117, -137.3774231797575, -37.265177829124056, -61.760062602814834, -42.79596110806297, -72.87226774876177, -63.751412454389566, -88.88720094878151, -64.7884967519027, -69.56150382116493, -86.18863290625936, -75.79694595331915], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6103253945709202, "mean_inference_ms": 5.214287331088854, "mean_action_processing_ms": 0.1951598678914031, "mean_env_wait_ms": 1.3518542576535861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -35.80708138271123, "episode_reward_min": -241.97822055740136, "episode_reward_mean": -84.47951089853272, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-69.65814267346647, -109.40748585959358, -82.56774301369082, -43.341551466927505, -74.90602386545936, -59.97238206242556, -56.266276416997044, -95.4781671837987, -60.59982584496745, -35.80708138271123, -87.09681724154744, -69.84899413368979, -81.77045898203885, -118.4911719770194, -85.24027759161771, -64.42565095846851, -117.25780458672233, -83.27845072378719, -102.1361133810901, -121.30761895195387, -62.60825009599966, -124.95549562919663, -83.2543858283352, -46.47176278696636, -158.59947302450257, -90.99904480070698, -75.65705937814882, -241.97822055740136, -172.77399557076123, -65.00298965011027, -141.29506943086378, -126.78355780320578, -116.39634058740515, -110.38605991606575, -183.76943951354028, -75.65654935840953, -46.31978109017587, -62.87593708703633, -115.78411523123808, -97.89041744556387, -82.95684022425348, -51.95532926343064, -214.86277196593468, -67.01305984914455, -79.62093515756602, -109.24850617333207, -97.35788171127068, -64.67424249154931, -129.0847064350573, -51.03427848908333, -63.75449723530359, -67.03301176354755, -72.35043210204906, -98.11792530645313, -122.21379030865342, -60.63752815938681, -105.94352793031646, -62.111862407774915, -93.62782301944672, -50.75565221198099, -67.59273827394229, -57.78400189169814, -80.48224028759667, -75.46968023931717, -57.02286350020257, -56.84958683086067, -51.790222470473175, -117.19728173599772, -86.0179856575134, -68.81418796629607, -58.753990679352704, -84.7662582643274, -95.99251271504932, -57.594391413213145, -63.87737959293834, -65.29860268206002, -69.70839179999633, -63.58141743335336, -66.38570649779432, -91.10104543417269, -56.610346833299204, -82.73283516378704, -73.61254127071656, -66.6953859469071, -122.72270044303775, -71.50179581717731, -44.0198897941661, -51.15226767640333, -79.10717094814117, -137.3774231797575, -37.265177829124056, -61.760062602814834, -42.79596110806297, -72.87226774876177, -63.751412454389566, -88.88720094878151, -64.7884967519027, -69.56150382116493, -86.18863290625936, -75.79694595331915], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6103253945709202, "mean_inference_ms": 5.214287331088854, "mean_action_processing_ms": 0.1951598678914031, "mean_env_wait_ms": 1.3518542576535861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 868000, "num_agent_steps_trained": 868000, "num_env_steps_sampled": 868000, "num_env_steps_trained": 868000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 868000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 868000, "timers": {"training_iteration_time_ms": 75097.223, "load_time_ms": 30.594, "load_throughput": 457604.771, "learn_time_ms": 67609.83, "learn_throughput": 207.07, "synch_weights_time_ms": 13.278}, "counters": {"num_env_steps_sampled": 868000, "num_env_steps_trained": 868000, "num_agent_steps_sampled": 868000, "num_agent_steps_trained": 868000}, "done": false, "episodes_total": 868, "training_iteration": 62, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-13-44", "timestamp": 1693055624, "time_this_iter_s": 75.2492401599884, "time_total_s": 4780.559522628784, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015422CD0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150E85B0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 4780.559522628784, "timesteps_since_restore": 0, "iterations_since_restore": 62, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.7811320754717, "ram_util_percent": 49.96132075471698}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -241.26407256633044, "episode_L1_reward_sum_min": -606.770585089922, "episode_L1_reward_sum_max": -158.57641565054655, "episode_L2_reward_sum_mean": -137.4734891397506, "episode_L2_reward_sum_min": -226.84348438680172, "episode_L2_reward_sum_max": -116.33275185525417}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.1460606898220664, "policy_loss": 0.1284481084580033, "vf_loss": 0.1761258339971804, "vf_explained_var": 0.5314976689194946, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000}, "sampler_results": {"episode_reward_max": -37.265177829124056, "episode_reward_min": -241.97822055740136, "episode_reward_mean": -85.229806701182, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -241.26407256633044, "episode_L1_reward_sum_min": -606.770585089922, "episode_L1_reward_sum_max": -158.57641565054655, "episode_L2_reward_sum_mean": -137.4734891397506, "episode_L2_reward_sum_min": -226.84348438680172, "episode_L2_reward_sum_max": -116.33275185525417}, "hist_stats": {"episode_reward": [-85.24027759161771, -64.42565095846851, -117.25780458672233, -83.27845072378719, -102.1361133810901, -121.30761895195387, -62.60825009599966, -124.95549562919663, -83.2543858283352, -46.47176278696636, -158.59947302450257, -90.99904480070698, -75.65705937814882, -241.97822055740136, -172.77399557076123, -65.00298965011027, -141.29506943086378, -126.78355780320578, -116.39634058740515, -110.38605991606575, -183.76943951354028, -75.65654935840953, -46.31978109017587, -62.87593708703633, -115.78411523123808, -97.89041744556387, -82.95684022425348, -51.95532926343064, -214.86277196593468, -67.01305984914455, -79.62093515756602, -109.24850617333207, -97.35788171127068, -64.67424249154931, -129.0847064350573, -51.03427848908333, -63.75449723530359, -67.03301176354755, -72.35043210204906, -98.11792530645313, -122.21379030865342, -60.63752815938681, -105.94352793031646, -62.111862407774915, -93.62782301944672, -50.75565221198099, -67.59273827394229, -57.78400189169814, -80.48224028759667, -75.46968023931717, -57.02286350020257, -56.84958683086067, -51.790222470473175, -117.19728173599772, -86.0179856575134, -68.81418796629607, -58.753990679352704, -84.7662582643274, -95.99251271504932, -57.594391413213145, -63.87737959293834, -65.29860268206002, -69.70839179999633, -63.58141743335336, -66.38570649779432, -91.10104543417269, -56.610346833299204, -82.73283516378704, -73.61254127071656, -66.6953859469071, -122.72270044303775, -71.50179581717731, -44.0198897941661, -51.15226767640333, -79.10717094814117, -137.3774231797575, -37.265177829124056, -61.760062602814834, -42.79596110806297, -72.87226774876177, -63.751412454389566, -88.88720094878151, -64.7884967519027, -69.56150382116493, -86.18863290625936, -75.79694595331915, -41.21334036439238, -143.19871269576515, -75.03419731791332, -126.07370552333641, -74.30423402108234, -61.03804779835882, -86.74618787026326, -47.17556793669618, -86.27997903775972, -72.66320648785863, -101.01111343674597, -75.26161012297571, -64.10969386469414, -66.13210589142278], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6099716957499468, "mean_inference_ms": 5.2125196023698654, "mean_action_processing_ms": 0.19507733568816776, "mean_env_wait_ms": 1.3514659111337601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -37.265177829124056, "episode_reward_min": -241.97822055740136, "episode_reward_mean": -85.229806701182, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-85.24027759161771, -64.42565095846851, -117.25780458672233, -83.27845072378719, -102.1361133810901, -121.30761895195387, -62.60825009599966, -124.95549562919663, -83.2543858283352, -46.47176278696636, -158.59947302450257, -90.99904480070698, -75.65705937814882, -241.97822055740136, -172.77399557076123, -65.00298965011027, -141.29506943086378, -126.78355780320578, -116.39634058740515, -110.38605991606575, -183.76943951354028, -75.65654935840953, -46.31978109017587, -62.87593708703633, -115.78411523123808, -97.89041744556387, -82.95684022425348, -51.95532926343064, -214.86277196593468, -67.01305984914455, -79.62093515756602, -109.24850617333207, -97.35788171127068, -64.67424249154931, -129.0847064350573, -51.03427848908333, -63.75449723530359, -67.03301176354755, -72.35043210204906, -98.11792530645313, -122.21379030865342, -60.63752815938681, -105.94352793031646, -62.111862407774915, -93.62782301944672, -50.75565221198099, -67.59273827394229, -57.78400189169814, -80.48224028759667, -75.46968023931717, -57.02286350020257, -56.84958683086067, -51.790222470473175, -117.19728173599772, -86.0179856575134, -68.81418796629607, -58.753990679352704, -84.7662582643274, -95.99251271504932, -57.594391413213145, -63.87737959293834, -65.29860268206002, -69.70839179999633, -63.58141743335336, -66.38570649779432, -91.10104543417269, -56.610346833299204, -82.73283516378704, -73.61254127071656, -66.6953859469071, -122.72270044303775, -71.50179581717731, -44.0198897941661, -51.15226767640333, -79.10717094814117, -137.3774231797575, -37.265177829124056, -61.760062602814834, -42.79596110806297, -72.87226774876177, -63.751412454389566, -88.88720094878151, -64.7884967519027, -69.56150382116493, -86.18863290625936, -75.79694595331915, -41.21334036439238, -143.19871269576515, -75.03419731791332, -126.07370552333641, -74.30423402108234, -61.03804779835882, -86.74618787026326, -47.17556793669618, -86.27997903775972, -72.66320648785863, -101.01111343674597, -75.26161012297571, -64.10969386469414, -66.13210589142278], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6099716957499468, "mean_inference_ms": 5.2125196023698654, "mean_action_processing_ms": 0.19507733568816776, "mean_env_wait_ms": 1.3514659111337601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000, "num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 882000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 882000, "timers": {"training_iteration_time_ms": 75112.248, "load_time_ms": 30.307, "load_throughput": 461938.292, "learn_time_ms": 67593.355, "learn_throughput": 207.121, "synch_weights_time_ms": 12.785}, "counters": {"num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000}, "done": false, "episodes_total": 882, "training_iteration": 63, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-14-59", "timestamp": 1693055699, "time_this_iter_s": 75.360684633255, "time_total_s": 4855.920207262039, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015464820>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014EF5CA0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 4855.920207262039, "timesteps_since_restore": 0, "iterations_since_restore": 63, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 22.066355140186918, "ram_util_percent": 49.973831775700944}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -238.58376388400794, "episode_L1_reward_sum_min": -599.9843849539757, "episode_L1_reward_sum_max": -158.57641565054655, "episode_L2_reward_sum_mean": -136.81747503988444, "episode_L2_reward_sum_min": -226.84348438680172, "episode_L2_reward_sum_max": -116.33275185525417}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.14459842027197573, "policy_loss": 0.11655596741800936, "vf_loss": 0.2804245098677597, "vf_explained_var": 0.6710125514509256, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 896000, "num_env_steps_trained": 896000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "sampler_results": {"episode_reward_max": -37.265177829124056, "episode_reward_min": -214.86277196593468, "episode_reward_mean": -84.32310067961517, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -238.58376388400794, "episode_L1_reward_sum_min": -599.9843849539757, "episode_L1_reward_sum_max": -158.57641565054655, "episode_L2_reward_sum_mean": -136.81747503988444, "episode_L2_reward_sum_min": -226.84348438680172, "episode_L2_reward_sum_max": -116.33275185525417}, "hist_stats": {"episode_reward": [-172.77399557076123, -65.00298965011027, -141.29506943086378, -126.78355780320578, -116.39634058740515, -110.38605991606575, -183.76943951354028, -75.65654935840953, -46.31978109017587, -62.87593708703633, -115.78411523123808, -97.89041744556387, -82.95684022425348, -51.95532926343064, -214.86277196593468, -67.01305984914455, -79.62093515756602, -109.24850617333207, -97.35788171127068, -64.67424249154931, -129.0847064350573, -51.03427848908333, -63.75449723530359, -67.03301176354755, -72.35043210204906, -98.11792530645313, -122.21379030865342, -60.63752815938681, -105.94352793031646, -62.111862407774915, -93.62782301944672, -50.75565221198099, -67.59273827394229, -57.78400189169814, -80.48224028759667, -75.46968023931717, -57.02286350020257, -56.84958683086067, -51.790222470473175, -117.19728173599772, -86.0179856575134, -68.81418796629607, -58.753990679352704, -84.7662582643274, -95.99251271504932, -57.594391413213145, -63.87737959293834, -65.29860268206002, -69.70839179999633, -63.58141743335336, -66.38570649779432, -91.10104543417269, -56.610346833299204, -82.73283516378704, -73.61254127071656, -66.6953859469071, -122.72270044303775, -71.50179581717731, -44.0198897941661, -51.15226767640333, -79.10717094814117, -137.3774231797575, -37.265177829124056, -61.760062602814834, -42.79596110806297, -72.87226774876177, -63.751412454389566, -88.88720094878151, -64.7884967519027, -69.56150382116493, -86.18863290625936, -75.79694595331915, -41.21334036439238, -143.19871269576515, -75.03419731791332, -126.07370552333641, -74.30423402108234, -61.03804779835882, -86.74618787026326, -47.17556793669618, -86.27997903775972, -72.66320648785863, -101.01111343674597, -75.26161012297571, -64.10969386469414, -66.13210589142278, -90.43274246949338, -81.13736248484905, -57.74808420287854, -88.34889687031537, -88.08280278960217, -75.25396421636472, -139.20922676195187, -97.59521981946857, -133.10710422715428, -85.47352017634893, -94.60422303367048, -65.0345560602742, -167.12551057187324, -104.34579245396593], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6096638676720144, "mean_inference_ms": 5.210766664280651, "mean_action_processing_ms": 0.19500634845510822, "mean_env_wait_ms": 1.3510803087489074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -37.265177829124056, "episode_reward_min": -214.86277196593468, "episode_reward_mean": -84.32310067961517, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-172.77399557076123, -65.00298965011027, -141.29506943086378, -126.78355780320578, -116.39634058740515, -110.38605991606575, -183.76943951354028, -75.65654935840953, -46.31978109017587, -62.87593708703633, -115.78411523123808, -97.89041744556387, -82.95684022425348, -51.95532926343064, -214.86277196593468, -67.01305984914455, -79.62093515756602, -109.24850617333207, -97.35788171127068, -64.67424249154931, -129.0847064350573, -51.03427848908333, -63.75449723530359, -67.03301176354755, -72.35043210204906, -98.11792530645313, -122.21379030865342, -60.63752815938681, -105.94352793031646, -62.111862407774915, -93.62782301944672, -50.75565221198099, -67.59273827394229, -57.78400189169814, -80.48224028759667, -75.46968023931717, -57.02286350020257, -56.84958683086067, -51.790222470473175, -117.19728173599772, -86.0179856575134, -68.81418796629607, -58.753990679352704, -84.7662582643274, -95.99251271504932, -57.594391413213145, -63.87737959293834, -65.29860268206002, -69.70839179999633, -63.58141743335336, -66.38570649779432, -91.10104543417269, -56.610346833299204, -82.73283516378704, -73.61254127071656, -66.6953859469071, -122.72270044303775, -71.50179581717731, -44.0198897941661, -51.15226767640333, -79.10717094814117, -137.3774231797575, -37.265177829124056, -61.760062602814834, -42.79596110806297, -72.87226774876177, -63.751412454389566, -88.88720094878151, -64.7884967519027, -69.56150382116493, -86.18863290625936, -75.79694595331915, -41.21334036439238, -143.19871269576515, -75.03419731791332, -126.07370552333641, -74.30423402108234, -61.03804779835882, -86.74618787026326, -47.17556793669618, -86.27997903775972, -72.66320648785863, -101.01111343674597, -75.26161012297571, -64.10969386469414, -66.13210589142278, -90.43274246949338, -81.13736248484905, -57.74808420287854, -88.34889687031537, -88.08280278960217, -75.25396421636472, -139.20922676195187, -97.59521981946857, -133.10710422715428, -85.47352017634893, -94.60422303367048, -65.0345560602742, -167.12551057187324, -104.34579245396593], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6096638676720144, "mean_inference_ms": 5.210766664280651, "mean_action_processing_ms": 0.19500634845510822, "mean_env_wait_ms": 1.3510803087489074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 896000, "num_env_steps_trained": 896000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 896000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 75121.351, "load_time_ms": 29.499, "load_throughput": 474589.573, "learn_time_ms": 67589.512, "learn_throughput": 207.133, "synch_weights_time_ms": 12.885}, "counters": {"num_env_steps_sampled": 896000, "num_env_steps_trained": 896000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "episodes_total": 896, "training_iteration": 64, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-16-14", "timestamp": 1693055774, "time_this_iter_s": 75.11701846122742, "time_total_s": 4931.037225723267, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270152CFEB0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015422B20>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 4931.037225723267, "timesteps_since_restore": 0, "iterations_since_restore": 64, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 22.901886792452828, "ram_util_percent": 50.05377358490567}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -232.51330089211464, "episode_L1_reward_sum_min": -599.9843849539757, "episode_L1_reward_sum_max": -158.57641565054655, "episode_L2_reward_sum_mean": -135.25940304473042, "episode_L2_reward_sum_min": -226.84348438680172, "episode_L2_reward_sum_max": -116.33275185525417}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.17187012944894137, "policy_loss": 0.14757240484439893, "vf_loss": 0.24297726317186402, "vf_explained_var": 0.522012144787076, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 910000, "num_env_steps_trained": 910000, "num_agent_steps_sampled": 910000, "num_agent_steps_trained": 910000}, "sampler_results": {"episode_reward_max": -37.265177829124056, "episode_reward_min": -214.86277196593468, "episode_reward_mean": -81.65826304496895, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -232.51330089211464, "episode_L1_reward_sum_min": -599.9843849539757, "episode_L1_reward_sum_max": -158.57641565054655, "episode_L2_reward_sum_mean": -135.25940304473042, "episode_L2_reward_sum_min": -226.84348438680172, "episode_L2_reward_sum_max": -116.33275185525417}, "hist_stats": {"episode_reward": [-214.86277196593468, -67.01305984914455, -79.62093515756602, -109.24850617333207, -97.35788171127068, -64.67424249154931, -129.0847064350573, -51.03427848908333, -63.75449723530359, -67.03301176354755, -72.35043210204906, -98.11792530645313, -122.21379030865342, -60.63752815938681, -105.94352793031646, -62.111862407774915, -93.62782301944672, -50.75565221198099, -67.59273827394229, -57.78400189169814, -80.48224028759667, -75.46968023931717, -57.02286350020257, -56.84958683086067, -51.790222470473175, -117.19728173599772, -86.0179856575134, -68.81418796629607, -58.753990679352704, -84.7662582643274, -95.99251271504932, -57.594391413213145, -63.87737959293834, -65.29860268206002, -69.70839179999633, -63.58141743335336, -66.38570649779432, -91.10104543417269, -56.610346833299204, -82.73283516378704, -73.61254127071656, -66.6953859469071, -122.72270044303775, -71.50179581717731, -44.0198897941661, -51.15226767640333, -79.10717094814117, -137.3774231797575, -37.265177829124056, -61.760062602814834, -42.79596110806297, -72.87226774876177, -63.751412454389566, -88.88720094878151, -64.7884967519027, -69.56150382116493, -86.18863290625936, -75.79694595331915, -41.21334036439238, -143.19871269576515, -75.03419731791332, -126.07370552333641, -74.30423402108234, -61.03804779835882, -86.74618787026326, -47.17556793669618, -86.27997903775972, -72.66320648785863, -101.01111343674597, -75.26161012297571, -64.10969386469414, -66.13210589142278, -90.43274246949338, -81.13736248484905, -57.74808420287854, -88.34889687031537, -88.08280278960217, -75.25396421636472, -139.20922676195187, -97.59521981946857, -133.10710422715428, -85.47352017634893, -94.60422303367048, -65.0345560602742, -167.12551057187324, -104.34579245396593, -46.42719443806535, -94.57741026502232, -39.55318706934175, -151.16602228960474, -76.38469844303773, -67.26595354561223, -93.02898400971058, -99.52992559098047, -106.10777170975, -75.87405765182453, -88.87352627828693, -93.21024440832998, -95.54845099751925, -55.81523201035312], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6094575791851865, "mean_inference_ms": 5.210327545881797, "mean_action_processing_ms": 0.19496460472466196, "mean_env_wait_ms": 1.3510143309761604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -37.265177829124056, "episode_reward_min": -214.86277196593468, "episode_reward_mean": -81.65826304496895, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-214.86277196593468, -67.01305984914455, -79.62093515756602, -109.24850617333207, -97.35788171127068, -64.67424249154931, -129.0847064350573, -51.03427848908333, -63.75449723530359, -67.03301176354755, -72.35043210204906, -98.11792530645313, -122.21379030865342, -60.63752815938681, -105.94352793031646, -62.111862407774915, -93.62782301944672, -50.75565221198099, -67.59273827394229, -57.78400189169814, -80.48224028759667, -75.46968023931717, -57.02286350020257, -56.84958683086067, -51.790222470473175, -117.19728173599772, -86.0179856575134, -68.81418796629607, -58.753990679352704, -84.7662582643274, -95.99251271504932, -57.594391413213145, -63.87737959293834, -65.29860268206002, -69.70839179999633, -63.58141743335336, -66.38570649779432, -91.10104543417269, -56.610346833299204, -82.73283516378704, -73.61254127071656, -66.6953859469071, -122.72270044303775, -71.50179581717731, -44.0198897941661, -51.15226767640333, -79.10717094814117, -137.3774231797575, -37.265177829124056, -61.760062602814834, -42.79596110806297, -72.87226774876177, -63.751412454389566, -88.88720094878151, -64.7884967519027, -69.56150382116493, -86.18863290625936, -75.79694595331915, -41.21334036439238, -143.19871269576515, -75.03419731791332, -126.07370552333641, -74.30423402108234, -61.03804779835882, -86.74618787026326, -47.17556793669618, -86.27997903775972, -72.66320648785863, -101.01111343674597, -75.26161012297571, -64.10969386469414, -66.13210589142278, -90.43274246949338, -81.13736248484905, -57.74808420287854, -88.34889687031537, -88.08280278960217, -75.25396421636472, -139.20922676195187, -97.59521981946857, -133.10710422715428, -85.47352017634893, -94.60422303367048, -65.0345560602742, -167.12551057187324, -104.34579245396593, -46.42719443806535, -94.57741026502232, -39.55318706934175, -151.16602228960474, -76.38469844303773, -67.26595354561223, -93.02898400971058, -99.52992559098047, -106.10777170975, -75.87405765182453, -88.87352627828693, -93.21024440832998, -95.54845099751925, -55.81523201035312], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6094575791851865, "mean_inference_ms": 5.210327545881797, "mean_action_processing_ms": 0.19496460472466196, "mean_env_wait_ms": 1.3510143309761604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 910000, "num_agent_steps_trained": 910000, "num_env_steps_sampled": 910000, "num_env_steps_trained": 910000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 910000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 910000, "timers": {"training_iteration_time_ms": 75166.194, "load_time_ms": 28.489, "load_throughput": 491413.737, "learn_time_ms": 67582.379, "learn_throughput": 207.155, "synch_weights_time_ms": 12.61}, "counters": {"num_env_steps_sampled": 910000, "num_env_steps_trained": 910000, "num_agent_steps_sampled": 910000, "num_agent_steps_trained": 910000}, "done": false, "episodes_total": 910, "training_iteration": 65, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-17-30", "timestamp": 1693055850, "time_this_iter_s": 75.82787442207336, "time_total_s": 5006.86510014534, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701539C400>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701539C550>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 5006.86510014534, "timesteps_since_restore": 0, "iterations_since_restore": 65, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 22.613084112149533, "ram_util_percent": 50.15046728971963}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -229.68195828869938, "episode_L1_reward_sum_min": -476.8037574067712, "episode_L1_reward_sum_max": -158.57641565054655, "episode_L2_reward_sum_mean": -134.57310608133673, "episode_L2_reward_sum_min": -197.26911622285843, "episode_L2_reward_sum_max": -116.33275185525417}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.17505823209625, "policy_loss": 0.14892541103873694, "vf_loss": 0.26132820274144986, "vf_explained_var": 0.5673101407632907, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "sampler_results": {"episode_reward_max": -37.265177829124056, "episode_reward_min": -173.38090437699907, "episode_reward_mean": -80.34317712807311, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -229.68195828869938, "episode_L1_reward_sum_min": -476.8037574067712, "episode_L1_reward_sum_max": -158.57641565054655, "episode_L2_reward_sum_mean": -134.57310608133673, "episode_L2_reward_sum_min": -197.26911622285843, "episode_L2_reward_sum_max": -116.33275185525417}, "hist_stats": {"episode_reward": [-105.94352793031646, -62.111862407774915, -93.62782301944672, -50.75565221198099, -67.59273827394229, -57.78400189169814, -80.48224028759667, -75.46968023931717, -57.02286350020257, -56.84958683086067, -51.790222470473175, -117.19728173599772, -86.0179856575134, -68.81418796629607, -58.753990679352704, -84.7662582643274, -95.99251271504932, -57.594391413213145, -63.87737959293834, -65.29860268206002, -69.70839179999633, -63.58141743335336, -66.38570649779432, -91.10104543417269, -56.610346833299204, -82.73283516378704, -73.61254127071656, -66.6953859469071, -122.72270044303775, -71.50179581717731, -44.0198897941661, -51.15226767640333, -79.10717094814117, -137.3774231797575, -37.265177829124056, -61.760062602814834, -42.79596110806297, -72.87226774876177, -63.751412454389566, -88.88720094878151, -64.7884967519027, -69.56150382116493, -86.18863290625936, -75.79694595331915, -41.21334036439238, -143.19871269576515, -75.03419731791332, -126.07370552333641, -74.30423402108234, -61.03804779835882, -86.74618787026326, -47.17556793669618, -86.27997903775972, -72.66320648785863, -101.01111343674597, -75.26161012297571, -64.10969386469414, -66.13210589142278, -90.43274246949338, -81.13736248484905, -57.74808420287854, -88.34889687031537, -88.08280278960217, -75.25396421636472, -139.20922676195187, -97.59521981946857, -133.10710422715428, -85.47352017634893, -94.60422303367048, -65.0345560602742, -167.12551057187324, -104.34579245396593, -46.42719443806535, -94.57741026502232, -39.55318706934175, -151.16602228960474, -76.38469844303773, -67.26595354561223, -93.02898400971058, -99.52992559098047, -106.10777170975, -75.87405765182453, -88.87352627828693, -93.21024440832998, -95.54845099751925, -55.81523201035312, -49.99627606101177, -64.96669546123769, -62.859256940414404, -80.6588142535156, -90.96341123863415, -102.63739395122344, -72.19398365452473, -52.31773635385924, -161.38792704248462, -60.85444450302712, -84.47691602616253, -63.69098736011167, -45.1102282355424, -173.38090437699907], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6092108279909033, "mean_inference_ms": 5.2099982174999715, "mean_action_processing_ms": 0.194916680308616, "mean_env_wait_ms": 1.3509853382955572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -37.265177829124056, "episode_reward_min": -173.38090437699907, "episode_reward_mean": -80.34317712807311, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105.94352793031646, -62.111862407774915, -93.62782301944672, -50.75565221198099, -67.59273827394229, -57.78400189169814, -80.48224028759667, -75.46968023931717, -57.02286350020257, -56.84958683086067, -51.790222470473175, -117.19728173599772, -86.0179856575134, -68.81418796629607, -58.753990679352704, -84.7662582643274, -95.99251271504932, -57.594391413213145, -63.87737959293834, -65.29860268206002, -69.70839179999633, -63.58141743335336, -66.38570649779432, -91.10104543417269, -56.610346833299204, -82.73283516378704, -73.61254127071656, -66.6953859469071, -122.72270044303775, -71.50179581717731, -44.0198897941661, -51.15226767640333, -79.10717094814117, -137.3774231797575, -37.265177829124056, -61.760062602814834, -42.79596110806297, -72.87226774876177, -63.751412454389566, -88.88720094878151, -64.7884967519027, -69.56150382116493, -86.18863290625936, -75.79694595331915, -41.21334036439238, -143.19871269576515, -75.03419731791332, -126.07370552333641, -74.30423402108234, -61.03804779835882, -86.74618787026326, -47.17556793669618, -86.27997903775972, -72.66320648785863, -101.01111343674597, -75.26161012297571, -64.10969386469414, -66.13210589142278, -90.43274246949338, -81.13736248484905, -57.74808420287854, -88.34889687031537, -88.08280278960217, -75.25396421636472, -139.20922676195187, -97.59521981946857, -133.10710422715428, -85.47352017634893, -94.60422303367048, -65.0345560602742, -167.12551057187324, -104.34579245396593, -46.42719443806535, -94.57741026502232, -39.55318706934175, -151.16602228960474, -76.38469844303773, -67.26595354561223, -93.02898400971058, -99.52992559098047, -106.10777170975, -75.87405765182453, -88.87352627828693, -93.21024440832998, -95.54845099751925, -55.81523201035312, -49.99627606101177, -64.96669546123769, -62.859256940414404, -80.6588142535156, -90.96341123863415, -102.63739395122344, -72.19398365452473, -52.31773635385924, -161.38792704248462, -60.85444450302712, -84.47691602616253, -63.69098736011167, -45.1102282355424, -173.38090437699907], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6092108279909033, "mean_inference_ms": 5.2099982174999715, "mean_action_processing_ms": 0.194916680308616, "mean_env_wait_ms": 1.3509853382955572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 924000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 924000, "timers": {"training_iteration_time_ms": 75176.688, "load_time_ms": 28.387, "load_throughput": 493187.259, "learn_time_ms": 67592.334, "learn_throughput": 207.124, "synch_weights_time_ms": 12.809}, "counters": {"num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "done": false, "episodes_total": 924, "training_iteration": 66, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-18-46", "timestamp": 1693055926, "time_this_iter_s": 75.1981635093689, "time_total_s": 5082.063263654709, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015435220>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701522C250>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 5082.063263654709, "timesteps_since_restore": 0, "iterations_since_restore": 66, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.785849056603777, "ram_util_percent": 50.13867924528303}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -239.18232350677252, "episode_L1_reward_sum_min": -476.8037574067712, "episode_L1_reward_sum_max": -157.37127356231213, "episode_L2_reward_sum_mean": -137.00376786127686, "episode_L2_reward_sum_min": -197.26911622285843, "episode_L2_reward_sum_max": -115.6959551423788}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.17707449352486565, "policy_loss": 0.14860464302787496, "vf_loss": 0.28469849997375907, "vf_explained_var": 0.6541853291384968, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 938000, "num_env_steps_trained": 938000, "num_agent_steps_sampled": 938000, "num_agent_steps_trained": 938000}, "sampler_results": {"episode_reward_max": -37.265177829124056, "episode_reward_min": -173.38090437699907, "episode_reward_mean": -83.42625486617156, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -239.18232350677252, "episode_L1_reward_sum_min": -476.8037574067712, "episode_L1_reward_sum_max": -157.37127356231213, "episode_L2_reward_sum_mean": -137.00376786127686, "episode_L2_reward_sum_min": -197.26911622285843, "episode_L2_reward_sum_max": -115.6959551423788}, "hist_stats": {"episode_reward": [-58.753990679352704, -84.7662582643274, -95.99251271504932, -57.594391413213145, -63.87737959293834, -65.29860268206002, -69.70839179999633, -63.58141743335336, -66.38570649779432, -91.10104543417269, -56.610346833299204, -82.73283516378704, -73.61254127071656, -66.6953859469071, -122.72270044303775, -71.50179581717731, -44.0198897941661, -51.15226767640333, -79.10717094814117, -137.3774231797575, -37.265177829124056, -61.760062602814834, -42.79596110806297, -72.87226774876177, -63.751412454389566, -88.88720094878151, -64.7884967519027, -69.56150382116493, -86.18863290625936, -75.79694595331915, -41.21334036439238, -143.19871269576515, -75.03419731791332, -126.07370552333641, -74.30423402108234, -61.03804779835882, -86.74618787026326, -47.17556793669618, -86.27997903775972, -72.66320648785863, -101.01111343674597, -75.26161012297571, -64.10969386469414, -66.13210589142278, -90.43274246949338, -81.13736248484905, -57.74808420287854, -88.34889687031537, -88.08280278960217, -75.25396421636472, -139.20922676195187, -97.59521981946857, -133.10710422715428, -85.47352017634893, -94.60422303367048, -65.0345560602742, -167.12551057187324, -104.34579245396593, -46.42719443806535, -94.57741026502232, -39.55318706934175, -151.16602228960474, -76.38469844303773, -67.26595354561223, -93.02898400971058, -99.52992559098047, -106.10777170975, -75.87405765182453, -88.87352627828693, -93.21024440832998, -95.54845099751925, -55.81523201035312, -49.99627606101177, -64.96669546123769, -62.859256940414404, -80.6588142535156, -90.96341123863415, -102.63739395122344, -72.19398365452473, -52.31773635385924, -161.38792704248462, -60.85444450302712, -84.47691602616253, -63.69098736011167, -45.1102282355424, -173.38090437699907, -102.2048858679369, -124.1751935823878, -59.64975628672107, -157.01507467929412, -111.39921211228251, -58.72358477284392, -111.99735162810157, -90.90149989039104, -120.62346174064427, -79.21675754880616, -105.54582609751166, -66.26754627870562, -66.22000804018948, -85.82726970744662], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6089704041252951, "mean_inference_ms": 5.20975281549153, "mean_action_processing_ms": 0.1948425999108295, "mean_env_wait_ms": 1.351005754139765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -37.265177829124056, "episode_reward_min": -173.38090437699907, "episode_reward_mean": -83.42625486617156, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-58.753990679352704, -84.7662582643274, -95.99251271504932, -57.594391413213145, -63.87737959293834, -65.29860268206002, -69.70839179999633, -63.58141743335336, -66.38570649779432, -91.10104543417269, -56.610346833299204, -82.73283516378704, -73.61254127071656, -66.6953859469071, -122.72270044303775, -71.50179581717731, -44.0198897941661, -51.15226767640333, -79.10717094814117, -137.3774231797575, -37.265177829124056, -61.760062602814834, -42.79596110806297, -72.87226774876177, -63.751412454389566, -88.88720094878151, -64.7884967519027, -69.56150382116493, -86.18863290625936, -75.79694595331915, -41.21334036439238, -143.19871269576515, -75.03419731791332, -126.07370552333641, -74.30423402108234, -61.03804779835882, -86.74618787026326, -47.17556793669618, -86.27997903775972, -72.66320648785863, -101.01111343674597, -75.26161012297571, -64.10969386469414, -66.13210589142278, -90.43274246949338, -81.13736248484905, -57.74808420287854, -88.34889687031537, -88.08280278960217, -75.25396421636472, -139.20922676195187, -97.59521981946857, -133.10710422715428, -85.47352017634893, -94.60422303367048, -65.0345560602742, -167.12551057187324, -104.34579245396593, -46.42719443806535, -94.57741026502232, -39.55318706934175, -151.16602228960474, -76.38469844303773, -67.26595354561223, -93.02898400971058, -99.52992559098047, -106.10777170975, -75.87405765182453, -88.87352627828693, -93.21024440832998, -95.54845099751925, -55.81523201035312, -49.99627606101177, -64.96669546123769, -62.859256940414404, -80.6588142535156, -90.96341123863415, -102.63739395122344, -72.19398365452473, -52.31773635385924, -161.38792704248462, -60.85444450302712, -84.47691602616253, -63.69098736011167, -45.1102282355424, -173.38090437699907, -102.2048858679369, -124.1751935823878, -59.64975628672107, -157.01507467929412, -111.39921211228251, -58.72358477284392, -111.99735162810157, -90.90149989039104, -120.62346174064427, -79.21675754880616, -105.54582609751166, -66.26754627870562, -66.22000804018948, -85.82726970744662], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6089704041252951, "mean_inference_ms": 5.20975281549153, "mean_action_processing_ms": 0.1948425999108295, "mean_env_wait_ms": 1.351005754139765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 938000, "num_agent_steps_trained": 938000, "num_env_steps_sampled": 938000, "num_env_steps_trained": 938000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 938000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 938000, "timers": {"training_iteration_time_ms": 75211.175, "load_time_ms": 29.0, "load_throughput": 482761.462, "learn_time_ms": 67616.543, "learn_throughput": 207.05, "synch_weights_time_ms": 12.806}, "counters": {"num_env_steps_sampled": 938000, "num_env_steps_trained": 938000, "num_agent_steps_sampled": 938000, "num_agent_steps_trained": 938000}, "done": false, "episodes_total": 938, "training_iteration": 67, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-20-01", "timestamp": 1693056001, "time_this_iter_s": 75.31099128723145, "time_total_s": 5157.37425494194, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270152F7790>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015311850>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 5157.37425494194, "timesteps_since_restore": 0, "iterations_since_restore": 67, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.627102803738318, "ram_util_percent": 50.12897196261682}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -245.84496808439494, "episode_L1_reward_sum_min": -476.8037574067712, "episode_L1_reward_sum_max": -157.37127356231213, "episode_L2_reward_sum_mean": -138.65838368587197, "episode_L2_reward_sum_min": -197.26911622285843, "episode_L2_reward_sum_max": -115.6959551423788}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.1682745762868482, "policy_loss": 0.14364315803733127, "vf_loss": 0.24631420585369254, "vf_explained_var": 0.5795892691354693, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 952000, "num_env_steps_trained": 952000, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 952000}, "sampler_results": {"episode_reward_max": -37.265177829124056, "episode_reward_min": -173.38090437699907, "episode_reward_mean": -85.39517077763394, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -245.84496808439494, "episode_L1_reward_sum_min": -476.8037574067712, "episode_L1_reward_sum_max": -157.37127356231213, "episode_L2_reward_sum_mean": -138.65838368587197, "episode_L2_reward_sum_min": -197.26911622285843, "episode_L2_reward_sum_max": -115.6959551423788}, "hist_stats": {"episode_reward": [-122.72270044303775, -71.50179581717731, -44.0198897941661, -51.15226767640333, -79.10717094814117, -137.3774231797575, -37.265177829124056, -61.760062602814834, -42.79596110806297, -72.87226774876177, -63.751412454389566, -88.88720094878151, -64.7884967519027, -69.56150382116493, -86.18863290625936, -75.79694595331915, -41.21334036439238, -143.19871269576515, -75.03419731791332, -126.07370552333641, -74.30423402108234, -61.03804779835882, -86.74618787026326, -47.17556793669618, -86.27997903775972, -72.66320648785863, -101.01111343674597, -75.26161012297571, -64.10969386469414, -66.13210589142278, -90.43274246949338, -81.13736248484905, -57.74808420287854, -88.34889687031537, -88.08280278960217, -75.25396421636472, -139.20922676195187, -97.59521981946857, -133.10710422715428, -85.47352017634893, -94.60422303367048, -65.0345560602742, -167.12551057187324, -104.34579245396593, -46.42719443806535, -94.57741026502232, -39.55318706934175, -151.16602228960474, -76.38469844303773, -67.26595354561223, -93.02898400971058, -99.52992559098047, -106.10777170975, -75.87405765182453, -88.87352627828693, -93.21024440832998, -95.54845099751925, -55.81523201035312, -49.99627606101177, -64.96669546123769, -62.859256940414404, -80.6588142535156, -90.96341123863415, -102.63739395122344, -72.19398365452473, -52.31773635385924, -161.38792704248462, -60.85444450302712, -84.47691602616253, -63.69098736011167, -45.1102282355424, -173.38090437699907, -102.2048858679369, -124.1751935823878, -59.64975628672107, -157.01507467929412, -111.39921211228251, -58.72358477284392, -111.99735162810157, -90.90149989039104, -120.62346174064427, -79.21675754880616, -105.54582609751166, -66.26754627870562, -66.22000804018948, -85.82726970744662, -156.28607267119773, -79.25862357440907, -88.40818650816597, -51.08735127683281, -83.80803663011515, -68.06384257719465, -63.84976629595801, -93.39147371784159, -105.92115240249397, -131.71511856386223, -78.3248144574477, -91.9958752986664, -48.93823857745572, -52.5538443215621], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6087107644588895, "mean_inference_ms": 5.209498777760108, "mean_action_processing_ms": 0.19475196045084328, "mean_env_wait_ms": 1.3510264794103835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -37.265177829124056, "episode_reward_min": -173.38090437699907, "episode_reward_mean": -85.39517077763394, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-122.72270044303775, -71.50179581717731, -44.0198897941661, -51.15226767640333, -79.10717094814117, -137.3774231797575, -37.265177829124056, -61.760062602814834, -42.79596110806297, -72.87226774876177, -63.751412454389566, -88.88720094878151, -64.7884967519027, -69.56150382116493, -86.18863290625936, -75.79694595331915, -41.21334036439238, -143.19871269576515, -75.03419731791332, -126.07370552333641, -74.30423402108234, -61.03804779835882, -86.74618787026326, -47.17556793669618, -86.27997903775972, -72.66320648785863, -101.01111343674597, -75.26161012297571, -64.10969386469414, -66.13210589142278, -90.43274246949338, -81.13736248484905, -57.74808420287854, -88.34889687031537, -88.08280278960217, -75.25396421636472, -139.20922676195187, -97.59521981946857, -133.10710422715428, -85.47352017634893, -94.60422303367048, -65.0345560602742, -167.12551057187324, -104.34579245396593, -46.42719443806535, -94.57741026502232, -39.55318706934175, -151.16602228960474, -76.38469844303773, -67.26595354561223, -93.02898400971058, -99.52992559098047, -106.10777170975, -75.87405765182453, -88.87352627828693, -93.21024440832998, -95.54845099751925, -55.81523201035312, -49.99627606101177, -64.96669546123769, -62.859256940414404, -80.6588142535156, -90.96341123863415, -102.63739395122344, -72.19398365452473, -52.31773635385924, -161.38792704248462, -60.85444450302712, -84.47691602616253, -63.69098736011167, -45.1102282355424, -173.38090437699907, -102.2048858679369, -124.1751935823878, -59.64975628672107, -157.01507467929412, -111.39921211228251, -58.72358477284392, -111.99735162810157, -90.90149989039104, -120.62346174064427, -79.21675754880616, -105.54582609751166, -66.26754627870562, -66.22000804018948, -85.82726970744662, -156.28607267119773, -79.25862357440907, -88.40818650816597, -51.08735127683281, -83.80803663011515, -68.06384257719465, -63.84976629595801, -93.39147371784159, -105.92115240249397, -131.71511856386223, -78.3248144574477, -91.9958752986664, -48.93823857745572, -52.5538443215621], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6087107644588895, "mean_inference_ms": 5.209498777760108, "mean_action_processing_ms": 0.19475196045084328, "mean_env_wait_ms": 1.3510264794103835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 952000, "num_env_steps_sampled": 952000, "num_env_steps_trained": 952000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 952000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 952000, "timers": {"training_iteration_time_ms": 75241.12, "load_time_ms": 29.185, "load_throughput": 479700.679, "learn_time_ms": 67645.463, "learn_throughput": 206.961, "synch_weights_time_ms": 13.405}, "counters": {"num_env_steps_sampled": 952000, "num_env_steps_trained": 952000, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 952000}, "done": false, "episodes_total": 952, "training_iteration": 68, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-21-16", "timestamp": 1693056076, "time_this_iter_s": 75.24818086624146, "time_total_s": 5232.622435808182, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270153592B0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701517A1F0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 5232.622435808182, "timesteps_since_restore": 0, "iterations_since_restore": 68, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.77358490566038, "ram_util_percent": 50.14433962264151}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -250.26290053993463, "episode_L1_reward_sum_min": -479.104232236743, "episode_L1_reward_sum_max": -157.37127356231213, "episode_L2_reward_sum_mean": -139.70536049582063, "episode_L2_reward_sum_min": -197.82009935379028, "episode_L2_reward_sum_max": -115.48616129904985}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.19273423603563397, "policy_loss": 0.17095880955691237, "vf_loss": 0.21775427050141674, "vf_explained_var": 0.6884654549720847, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 966000, "num_env_steps_trained": 966000, "num_agent_steps_sampled": 966000, "num_agent_steps_trained": 966000}, "sampler_results": {"episode_reward_max": -36.90760392641001, "episode_reward_min": -173.38090437699907, "episode_reward_mean": -87.63505791839515, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -250.26290053993463, "episode_L1_reward_sum_min": -479.104232236743, "episode_L1_reward_sum_max": -157.37127356231213, "episode_L2_reward_sum_mean": -139.70536049582063, "episode_L2_reward_sum_min": -197.82009935379028, "episode_L2_reward_sum_max": -115.48616129904985}, "hist_stats": {"episode_reward": [-86.18863290625936, -75.79694595331915, -41.21334036439238, -143.19871269576515, -75.03419731791332, -126.07370552333641, -74.30423402108234, -61.03804779835882, -86.74618787026326, -47.17556793669618, -86.27997903775972, -72.66320648785863, -101.01111343674597, -75.26161012297571, -64.10969386469414, -66.13210589142278, -90.43274246949338, -81.13736248484905, -57.74808420287854, -88.34889687031537, -88.08280278960217, -75.25396421636472, -139.20922676195187, -97.59521981946857, -133.10710422715428, -85.47352017634893, -94.60422303367048, -65.0345560602742, -167.12551057187324, -104.34579245396593, -46.42719443806535, -94.57741026502232, -39.55318706934175, -151.16602228960474, -76.38469844303773, -67.26595354561223, -93.02898400971058, -99.52992559098047, -106.10777170975, -75.87405765182453, -88.87352627828693, -93.21024440832998, -95.54845099751925, -55.81523201035312, -49.99627606101177, -64.96669546123769, -62.859256940414404, -80.6588142535156, -90.96341123863415, -102.63739395122344, -72.19398365452473, -52.31773635385924, -161.38792704248462, -60.85444450302712, -84.47691602616253, -63.69098736011167, -45.1102282355424, -173.38090437699907, -102.2048858679369, -124.1751935823878, -59.64975628672107, -157.01507467929412, -111.39921211228251, -58.72358477284392, -111.99735162810157, -90.90149989039104, -120.62346174064427, -79.21675754880616, -105.54582609751166, -66.26754627870562, -66.22000804018948, -85.82726970744662, -156.28607267119773, -79.25862357440907, -88.40818650816597, -51.08735127683281, -83.80803663011515, -68.06384257719465, -63.84976629595801, -93.39147371784159, -105.92115240249397, -131.71511856386223, -78.3248144574477, -91.9958752986664, -48.93823857745572, -52.5538443215621, -61.27444198280632, -62.041735680972295, -129.91098718988064, -82.21368130072753, -155.76608596289486, -140.36374881894696, -64.85600673650642, -66.90642644748065, -91.29085359589493, -86.77643064986398, -121.17545348955045, -68.48987896415034, -36.90760392641001, -63.57871045372227], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6084756028530314, "mean_inference_ms": 5.209261683253717, "mean_action_processing_ms": 0.19467132804537324, "mean_env_wait_ms": 1.351076623503179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -36.90760392641001, "episode_reward_min": -173.38090437699907, "episode_reward_mean": -87.63505791839515, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-86.18863290625936, -75.79694595331915, -41.21334036439238, -143.19871269576515, -75.03419731791332, -126.07370552333641, -74.30423402108234, -61.03804779835882, -86.74618787026326, -47.17556793669618, -86.27997903775972, -72.66320648785863, -101.01111343674597, -75.26161012297571, -64.10969386469414, -66.13210589142278, -90.43274246949338, -81.13736248484905, -57.74808420287854, -88.34889687031537, -88.08280278960217, -75.25396421636472, -139.20922676195187, -97.59521981946857, -133.10710422715428, -85.47352017634893, -94.60422303367048, -65.0345560602742, -167.12551057187324, -104.34579245396593, -46.42719443806535, -94.57741026502232, -39.55318706934175, -151.16602228960474, -76.38469844303773, -67.26595354561223, -93.02898400971058, -99.52992559098047, -106.10777170975, -75.87405765182453, -88.87352627828693, -93.21024440832998, -95.54845099751925, -55.81523201035312, -49.99627606101177, -64.96669546123769, -62.859256940414404, -80.6588142535156, -90.96341123863415, -102.63739395122344, -72.19398365452473, -52.31773635385924, -161.38792704248462, -60.85444450302712, -84.47691602616253, -63.69098736011167, -45.1102282355424, -173.38090437699907, -102.2048858679369, -124.1751935823878, -59.64975628672107, -157.01507467929412, -111.39921211228251, -58.72358477284392, -111.99735162810157, -90.90149989039104, -120.62346174064427, -79.21675754880616, -105.54582609751166, -66.26754627870562, -66.22000804018948, -85.82726970744662, -156.28607267119773, -79.25862357440907, -88.40818650816597, -51.08735127683281, -83.80803663011515, -68.06384257719465, -63.84976629595801, -93.39147371784159, -105.92115240249397, -131.71511856386223, -78.3248144574477, -91.9958752986664, -48.93823857745572, -52.5538443215621, -61.27444198280632, -62.041735680972295, -129.91098718988064, -82.21368130072753, -155.76608596289486, -140.36374881894696, -64.85600673650642, -66.90642644748065, -91.29085359589493, -86.77643064986398, -121.17545348955045, -68.48987896415034, -36.90760392641001, -63.57871045372227], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6084756028530314, "mean_inference_ms": 5.209261683253717, "mean_action_processing_ms": 0.19467132804537324, "mean_env_wait_ms": 1.351076623503179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 966000, "num_agent_steps_trained": 966000, "num_env_steps_sampled": 966000, "num_env_steps_trained": 966000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 966000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 966000, "timers": {"training_iteration_time_ms": 75271.675, "load_time_ms": 30.174, "load_throughput": 463983.046, "learn_time_ms": 67676.353, "learn_throughput": 206.867, "synch_weights_time_ms": 13.002}, "counters": {"num_env_steps_sampled": 966000, "num_env_steps_trained": 966000, "num_agent_steps_sampled": 966000, "num_agent_steps_trained": 966000}, "done": false, "episodes_total": 966, "training_iteration": 69, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-22-32", "timestamp": 1693056152, "time_this_iter_s": 75.2896478176117, "time_total_s": 5307.9120836257935, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701543E5B0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150788B0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 5307.9120836257935, "timesteps_since_restore": 0, "iterations_since_restore": 69, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.7622641509434, "ram_util_percent": 50.11698113207548}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -247.49492953412235, "episode_L1_reward_sum_min": -479.104232236743, "episode_L1_reward_sum_max": -157.37127356231213, "episode_L2_reward_sum_mean": -139.00880183190108, "episode_L2_reward_sum_min": -197.82009935379028, "episode_L2_reward_sum_max": -115.48616129904985}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.1980767922793082, "policy_loss": 0.1817405416583259, "vf_loss": 0.16336249363714406, "vf_explained_var": 0.60036518225454, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 980000, "num_env_steps_trained": 980000, "num_agent_steps_sampled": 980000, "num_agent_steps_trained": 980000}, "sampler_results": {"episode_reward_max": -33.64350384579765, "episode_reward_min": -173.38090437699907, "episode_reward_mean": -86.20597486596138, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -247.49492953412235, "episode_L1_reward_sum_min": -479.104232236743, "episode_L1_reward_sum_max": -157.37127356231213, "episode_L2_reward_sum_mean": -139.00880183190108, "episode_L2_reward_sum_min": -197.82009935379028, "episode_L2_reward_sum_max": -115.48616129904985}, "hist_stats": {"episode_reward": [-64.10969386469414, -66.13210589142278, -90.43274246949338, -81.13736248484905, -57.74808420287854, -88.34889687031537, -88.08280278960217, -75.25396421636472, -139.20922676195187, -97.59521981946857, -133.10710422715428, -85.47352017634893, -94.60422303367048, -65.0345560602742, -167.12551057187324, -104.34579245396593, -46.42719443806535, -94.57741026502232, -39.55318706934175, -151.16602228960474, -76.38469844303773, -67.26595354561223, -93.02898400971058, -99.52992559098047, -106.10777170975, -75.87405765182453, -88.87352627828693, -93.21024440832998, -95.54845099751925, -55.81523201035312, -49.99627606101177, -64.96669546123769, -62.859256940414404, -80.6588142535156, -90.96341123863415, -102.63739395122344, -72.19398365452473, -52.31773635385924, -161.38792704248462, -60.85444450302712, -84.47691602616253, -63.69098736011167, -45.1102282355424, -173.38090437699907, -102.2048858679369, -124.1751935823878, -59.64975628672107, -157.01507467929412, -111.39921211228251, -58.72358477284392, -111.99735162810157, -90.90149989039104, -120.62346174064427, -79.21675754880616, -105.54582609751166, -66.26754627870562, -66.22000804018948, -85.82726970744662, -156.28607267119773, -79.25862357440907, -88.40818650816597, -51.08735127683281, -83.80803663011515, -68.06384257719465, -63.84976629595801, -93.39147371784159, -105.92115240249397, -131.71511856386223, -78.3248144574477, -91.9958752986664, -48.93823857745572, -52.5538443215621, -61.27444198280632, -62.041735680972295, -129.91098718988064, -82.21368130072753, -155.76608596289486, -140.36374881894696, -64.85600673650642, -66.90642644748065, -91.29085359589493, -86.77643064986398, -121.17545348955045, -68.48987896415034, -36.90760392641001, -63.57871045372227, -145.35210416974536, -65.44263978340678, -83.07839536717147, -55.81380446655214, -130.34123321100603, -33.64350384579765, -65.81157109227311, -67.90307493027191, -49.37075927640596, -60.595448921925204, -45.477148931116545, -72.14603342459678, -65.26691910223659, -68.83453970684478], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6083150855784473, "mean_inference_ms": 5.2087302871193355, "mean_action_processing_ms": 0.1946203976447923, "mean_env_wait_ms": 1.3509254484014361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -33.64350384579765, "episode_reward_min": -173.38090437699907, "episode_reward_mean": -86.20597486596138, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.10969386469414, -66.13210589142278, -90.43274246949338, -81.13736248484905, -57.74808420287854, -88.34889687031537, -88.08280278960217, -75.25396421636472, -139.20922676195187, -97.59521981946857, -133.10710422715428, -85.47352017634893, -94.60422303367048, -65.0345560602742, -167.12551057187324, -104.34579245396593, -46.42719443806535, -94.57741026502232, -39.55318706934175, -151.16602228960474, -76.38469844303773, -67.26595354561223, -93.02898400971058, -99.52992559098047, -106.10777170975, -75.87405765182453, -88.87352627828693, -93.21024440832998, -95.54845099751925, -55.81523201035312, -49.99627606101177, -64.96669546123769, -62.859256940414404, -80.6588142535156, -90.96341123863415, -102.63739395122344, -72.19398365452473, -52.31773635385924, -161.38792704248462, -60.85444450302712, -84.47691602616253, -63.69098736011167, -45.1102282355424, -173.38090437699907, -102.2048858679369, -124.1751935823878, -59.64975628672107, -157.01507467929412, -111.39921211228251, -58.72358477284392, -111.99735162810157, -90.90149989039104, -120.62346174064427, -79.21675754880616, -105.54582609751166, -66.26754627870562, -66.22000804018948, -85.82726970744662, -156.28607267119773, -79.25862357440907, -88.40818650816597, -51.08735127683281, -83.80803663011515, -68.06384257719465, -63.84976629595801, -93.39147371784159, -105.92115240249397, -131.71511856386223, -78.3248144574477, -91.9958752986664, -48.93823857745572, -52.5538443215621, -61.27444198280632, -62.041735680972295, -129.91098718988064, -82.21368130072753, -155.76608596289486, -140.36374881894696, -64.85600673650642, -66.90642644748065, -91.29085359589493, -86.77643064986398, -121.17545348955045, -68.48987896415034, -36.90760392641001, -63.57871045372227, -145.35210416974536, -65.44263978340678, -83.07839536717147, -55.81380446655214, -130.34123321100603, -33.64350384579765, -65.81157109227311, -67.90307493027191, -49.37075927640596, -60.595448921925204, -45.477148931116545, -72.14603342459678, -65.26691910223659, -68.83453970684478], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6083150855784473, "mean_inference_ms": 5.2087302871193355, "mean_action_processing_ms": 0.1946203976447923, "mean_env_wait_ms": 1.3509254484014361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 980000, "num_agent_steps_trained": 980000, "num_env_steps_sampled": 980000, "num_env_steps_trained": 980000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 980000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 980000, "timers": {"training_iteration_time_ms": 75495.02, "load_time_ms": 29.903, "load_throughput": 468184.827, "learn_time_ms": 67898.828, "learn_throughput": 206.189, "synch_weights_time_ms": 12.809}, "counters": {"num_env_steps_sampled": 980000, "num_env_steps_trained": 980000, "num_agent_steps_sampled": 980000, "num_agent_steps_trained": 980000}, "done": false, "episodes_total": 980, "training_iteration": 70, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-23-49", "timestamp": 1693056229, "time_this_iter_s": 77.35819244384766, "time_total_s": 5385.270276069641, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150A2E50>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015422460>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 5385.270276069641, "timesteps_since_restore": 0, "iterations_since_restore": 70, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 28.05545454545454, "ram_util_percent": 50.42000000000002}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -241.77706283405422, "episode_L1_reward_sum_min": -479.104232236743, "episode_L1_reward_sum_max": -157.37127356231213, "episode_L2_reward_sum_mean": -137.50971419222654, "episode_L2_reward_sum_min": -197.82009935379028, "episode_L2_reward_sum_max": -115.48616129904985}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.19284494936949126, "policy_loss": 0.17903441812942733, "vf_loss": 0.13810531431578946, "vf_explained_var": 0.5172598886882327, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 994000, "num_env_steps_trained": 994000, "num_agent_steps_sampled": 994000, "num_agent_steps_trained": 994000}, "sampler_results": {"episode_reward_max": -33.64350384579765, "episode_reward_min": -173.38090437699907, "episode_reward_mean": -83.025536023599, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -241.77706283405422, "episode_L1_reward_sum_min": -479.104232236743, "episode_L1_reward_sum_max": -157.37127356231213, "episode_L2_reward_sum_mean": -137.50971419222654, "episode_L2_reward_sum_min": -197.82009935379028, "episode_L2_reward_sum_max": -115.48616129904985}, "hist_stats": {"episode_reward": [-167.12551057187324, -104.34579245396593, -46.42719443806535, -94.57741026502232, -39.55318706934175, -151.16602228960474, -76.38469844303773, -67.26595354561223, -93.02898400971058, -99.52992559098047, -106.10777170975, -75.87405765182453, -88.87352627828693, -93.21024440832998, -95.54845099751925, -55.81523201035312, -49.99627606101177, -64.96669546123769, -62.859256940414404, -80.6588142535156, -90.96341123863415, -102.63739395122344, -72.19398365452473, -52.31773635385924, -161.38792704248462, -60.85444450302712, -84.47691602616253, -63.69098736011167, -45.1102282355424, -173.38090437699907, -102.2048858679369, -124.1751935823878, -59.64975628672107, -157.01507467929412, -111.39921211228251, -58.72358477284392, -111.99735162810157, -90.90149989039104, -120.62346174064427, -79.21675754880616, -105.54582609751166, -66.26754627870562, -66.22000804018948, -85.82726970744662, -156.28607267119773, -79.25862357440907, -88.40818650816597, -51.08735127683281, -83.80803663011515, -68.06384257719465, -63.84976629595801, -93.39147371784159, -105.92115240249397, -131.71511856386223, -78.3248144574477, -91.9958752986664, -48.93823857745572, -52.5538443215621, -61.27444198280632, -62.041735680972295, -129.91098718988064, -82.21368130072753, -155.76608596289486, -140.36374881894696, -64.85600673650642, -66.90642644748065, -91.29085359589493, -86.77643064986398, -121.17545348955045, -68.48987896415034, -36.90760392641001, -63.57871045372227, -145.35210416974536, -65.44263978340678, -83.07839536717147, -55.81380446655214, -130.34123321100603, -33.64350384579765, -65.81157109227311, -67.90307493027191, -49.37075927640596, -60.595448921925204, -45.477148931116545, -72.14603342459678, -65.26691910223659, -68.83453970684478, -61.67307828973238, -54.90618692726017, -90.86199418368213, -47.363068628334894, -73.90691838435278, -49.71956184780464, -63.58888338045041, -51.49955655318059, -64.54194521223724, -54.56372227487316, -61.07119701381774, -46.331917509862635, -114.38529520953784, -73.81229321712102], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.608286508787953, "mean_inference_ms": 5.209778244354897, "mean_action_processing_ms": 0.19462259955277766, "mean_env_wait_ms": 1.351236491594144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -33.64350384579765, "episode_reward_min": -173.38090437699907, "episode_reward_mean": -83.025536023599, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-167.12551057187324, -104.34579245396593, -46.42719443806535, -94.57741026502232, -39.55318706934175, -151.16602228960474, -76.38469844303773, -67.26595354561223, -93.02898400971058, -99.52992559098047, -106.10777170975, -75.87405765182453, -88.87352627828693, -93.21024440832998, -95.54845099751925, -55.81523201035312, -49.99627606101177, -64.96669546123769, -62.859256940414404, -80.6588142535156, -90.96341123863415, -102.63739395122344, -72.19398365452473, -52.31773635385924, -161.38792704248462, -60.85444450302712, -84.47691602616253, -63.69098736011167, -45.1102282355424, -173.38090437699907, -102.2048858679369, -124.1751935823878, -59.64975628672107, -157.01507467929412, -111.39921211228251, -58.72358477284392, -111.99735162810157, -90.90149989039104, -120.62346174064427, -79.21675754880616, -105.54582609751166, -66.26754627870562, -66.22000804018948, -85.82726970744662, -156.28607267119773, -79.25862357440907, -88.40818650816597, -51.08735127683281, -83.80803663011515, -68.06384257719465, -63.84976629595801, -93.39147371784159, -105.92115240249397, -131.71511856386223, -78.3248144574477, -91.9958752986664, -48.93823857745572, -52.5538443215621, -61.27444198280632, -62.041735680972295, -129.91098718988064, -82.21368130072753, -155.76608596289486, -140.36374881894696, -64.85600673650642, -66.90642644748065, -91.29085359589493, -86.77643064986398, -121.17545348955045, -68.48987896415034, -36.90760392641001, -63.57871045372227, -145.35210416974536, -65.44263978340678, -83.07839536717147, -55.81380446655214, -130.34123321100603, -33.64350384579765, -65.81157109227311, -67.90307493027191, -49.37075927640596, -60.595448921925204, -45.477148931116545, -72.14603342459678, -65.26691910223659, -68.83453970684478, -61.67307828973238, -54.90618692726017, -90.86199418368213, -47.363068628334894, -73.90691838435278, -49.71956184780464, -63.58888338045041, -51.49955655318059, -64.54194521223724, -54.56372227487316, -61.07119701381774, -46.331917509862635, -114.38529520953784, -73.81229321712102], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.608286508787953, "mean_inference_ms": 5.209778244354897, "mean_action_processing_ms": 0.19462259955277766, "mean_env_wait_ms": 1.351236491594144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 994000, "num_agent_steps_trained": 994000, "num_env_steps_sampled": 994000, "num_env_steps_trained": 994000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 994000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 994000, "timers": {"training_iteration_time_ms": 75770.122, "load_time_ms": 30.302, "load_throughput": 462021.161, "learn_time_ms": 68062.647, "learn_throughput": 205.693, "synch_weights_time_ms": 12.709}, "counters": {"num_env_steps_sampled": 994000, "num_env_steps_trained": 994000, "num_agent_steps_sampled": 994000, "num_agent_steps_trained": 994000}, "done": false, "episodes_total": 994, "training_iteration": 71, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-25-07", "timestamp": 1693056307, "time_this_iter_s": 77.78430104255676, "time_total_s": 5463.054577112198, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270152CF700>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701522CAC0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 5463.054577112198, "timesteps_since_restore": 0, "iterations_since_restore": 71, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 27.667272727272728, "ram_util_percent": 50.8790909090909}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -236.36855935513972, "episode_L1_reward_sum_min": -479.104232236743, "episode_L1_reward_sum_max": -157.37127356231213, "episode_L2_reward_sum_mean": -136.18086181610823, "episode_L2_reward_sum_min": -197.82009935379028, "episode_L2_reward_sum_max": -115.48616129904985}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.1433081314900375, "policy_loss": 0.12742788029539756, "vf_loss": 0.1588025262595594, "vf_explained_var": 0.4943392350043289, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "sampler_results": {"episode_reward_max": -33.64350384579765, "episode_reward_min": -173.38090437699907, "episode_reward_mean": -81.00076248798135, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -236.36855935513972, "episode_L1_reward_sum_min": -479.104232236743, "episode_L1_reward_sum_max": -157.37127356231213, "episode_L2_reward_sum_mean": -136.18086181610823, "episode_L2_reward_sum_min": -197.82009935379028, "episode_L2_reward_sum_max": -115.48616129904985}, "hist_stats": {"episode_reward": [-95.54845099751925, -55.81523201035312, -49.99627606101177, -64.96669546123769, -62.859256940414404, -80.6588142535156, -90.96341123863415, -102.63739395122344, -72.19398365452473, -52.31773635385924, -161.38792704248462, -60.85444450302712, -84.47691602616253, -63.69098736011167, -45.1102282355424, -173.38090437699907, -102.2048858679369, -124.1751935823878, -59.64975628672107, -157.01507467929412, -111.39921211228251, -58.72358477284392, -111.99735162810157, -90.90149989039104, -120.62346174064427, -79.21675754880616, -105.54582609751166, -66.26754627870562, -66.22000804018948, -85.82726970744662, -156.28607267119773, -79.25862357440907, -88.40818650816597, -51.08735127683281, -83.80803663011515, -68.06384257719465, -63.84976629595801, -93.39147371784159, -105.92115240249397, -131.71511856386223, -78.3248144574477, -91.9958752986664, -48.93823857745572, -52.5538443215621, -61.27444198280632, -62.041735680972295, -129.91098718988064, -82.21368130072753, -155.76608596289486, -140.36374881894696, -64.85600673650642, -66.90642644748065, -91.29085359589493, -86.77643064986398, -121.17545348955045, -68.48987896415034, -36.90760392641001, -63.57871045372227, -145.35210416974536, -65.44263978340678, -83.07839536717147, -55.81380446655214, -130.34123321100603, -33.64350384579765, -65.81157109227311, -67.90307493027191, -49.37075927640596, -60.595448921925204, -45.477148931116545, -72.14603342459678, -65.26691910223659, -68.83453970684478, -61.67307828973238, -54.90618692726017, -90.86199418368213, -47.363068628334894, -73.90691838435278, -49.71956184780464, -63.58888338045041, -51.49955655318059, -64.54194521223724, -54.56372227487316, -61.07119701381774, -46.331917509862635, -114.38529520953784, -73.81229321712102, -115.42986444389817, -65.17151397564479, -72.30188967231918, -41.814428203288024, -68.94894076098878, -84.67875982242678, -98.03907423459012, -94.95926357111773, -67.64210922736483, -68.51275461020232, -89.94023678414604, -74.4591286562427, -93.2980775775833, -65.79688362383078], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6082131696952323, "mean_inference_ms": 5.210199117984417, "mean_action_processing_ms": 0.19462112306741147, "mean_env_wait_ms": 1.3513887396974433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -33.64350384579765, "episode_reward_min": -173.38090437699907, "episode_reward_mean": -81.00076248798135, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-95.54845099751925, -55.81523201035312, -49.99627606101177, -64.96669546123769, -62.859256940414404, -80.6588142535156, -90.96341123863415, -102.63739395122344, -72.19398365452473, -52.31773635385924, -161.38792704248462, -60.85444450302712, -84.47691602616253, -63.69098736011167, -45.1102282355424, -173.38090437699907, -102.2048858679369, -124.1751935823878, -59.64975628672107, -157.01507467929412, -111.39921211228251, -58.72358477284392, -111.99735162810157, -90.90149989039104, -120.62346174064427, -79.21675754880616, -105.54582609751166, -66.26754627870562, -66.22000804018948, -85.82726970744662, -156.28607267119773, -79.25862357440907, -88.40818650816597, -51.08735127683281, -83.80803663011515, -68.06384257719465, -63.84976629595801, -93.39147371784159, -105.92115240249397, -131.71511856386223, -78.3248144574477, -91.9958752986664, -48.93823857745572, -52.5538443215621, -61.27444198280632, -62.041735680972295, -129.91098718988064, -82.21368130072753, -155.76608596289486, -140.36374881894696, -64.85600673650642, -66.90642644748065, -91.29085359589493, -86.77643064986398, -121.17545348955045, -68.48987896415034, -36.90760392641001, -63.57871045372227, -145.35210416974536, -65.44263978340678, -83.07839536717147, -55.81380446655214, -130.34123321100603, -33.64350384579765, -65.81157109227311, -67.90307493027191, -49.37075927640596, -60.595448921925204, -45.477148931116545, -72.14603342459678, -65.26691910223659, -68.83453970684478, -61.67307828973238, -54.90618692726017, -90.86199418368213, -47.363068628334894, -73.90691838435278, -49.71956184780464, -63.58888338045041, -51.49955655318059, -64.54194521223724, -54.56372227487316, -61.07119701381774, -46.331917509862635, -114.38529520953784, -73.81229321712102, -115.42986444389817, -65.17151397564479, -72.30188967231918, -41.814428203288024, -68.94894076098878, -84.67875982242678, -98.03907423459012, -94.95926357111773, -67.64210922736483, -68.51275461020232, -89.94023678414604, -74.4591286562427, -93.2980775775833, -65.79688362383078], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6082131696952323, "mean_inference_ms": 5.210199117984417, "mean_action_processing_ms": 0.19462112306741147, "mean_env_wait_ms": 1.3513887396974433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1008000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 75820.458, "load_time_ms": 30.879, "load_throughput": 453379.804, "learn_time_ms": 68104.527, "learn_throughput": 205.566, "synch_weights_time_ms": 13.029}, "counters": {"num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "episodes_total": 1008, "training_iteration": 72, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-26-23", "timestamp": 1693056383, "time_this_iter_s": 75.75262212753296, "time_total_s": 5538.807199239731, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015359700>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701534D700>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 5538.807199239731, "timesteps_since_restore": 0, "iterations_since_restore": 72, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 23.012149532710282, "ram_util_percent": 51.087850467289734}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -237.63534751743077, "episode_L1_reward_sum_min": -479.104232236743, "episode_L1_reward_sum_max": -157.37127356231213, "episode_L2_reward_sum_mean": -136.46886113740504, "episode_L2_reward_sum_min": -197.82009935379028, "episode_L2_reward_sum_max": -115.48616129904985}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.12190834921916445, "policy_loss": 0.09913267275481868, "vf_loss": 0.22775676505803497, "vf_explained_var": 0.5387060630897926, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1022000, "num_env_steps_trained": 1022000, "num_agent_steps_sampled": 1022000, "num_agent_steps_trained": 1022000}, "sampler_results": {"episode_reward_max": -28.19283149862183, "episode_reward_min": -173.38090437699907, "episode_reward_mean": -81.1124908728507, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -237.63534751743077, "episode_L1_reward_sum_min": -479.104232236743, "episode_L1_reward_sum_max": -157.37127356231213, "episode_L2_reward_sum_mean": -136.46886113740504, "episode_L2_reward_sum_min": -197.82009935379028, "episode_L2_reward_sum_max": -115.48616129904985}, "hist_stats": {"episode_reward": [-45.1102282355424, -173.38090437699907, -102.2048858679369, -124.1751935823878, -59.64975628672107, -157.01507467929412, -111.39921211228251, -58.72358477284392, -111.99735162810157, -90.90149989039104, -120.62346174064427, -79.21675754880616, -105.54582609751166, -66.26754627870562, -66.22000804018948, -85.82726970744662, -156.28607267119773, -79.25862357440907, -88.40818650816597, -51.08735127683281, -83.80803663011515, -68.06384257719465, -63.84976629595801, -93.39147371784159, -105.92115240249397, -131.71511856386223, -78.3248144574477, -91.9958752986664, -48.93823857745572, -52.5538443215621, -61.27444198280632, -62.041735680972295, -129.91098718988064, -82.21368130072753, -155.76608596289486, -140.36374881894696, -64.85600673650642, -66.90642644748065, -91.29085359589493, -86.77643064986398, -121.17545348955045, -68.48987896415034, -36.90760392641001, -63.57871045372227, -145.35210416974536, -65.44263978340678, -83.07839536717147, -55.81380446655214, -130.34123321100603, -33.64350384579765, -65.81157109227311, -67.90307493027191, -49.37075927640596, -60.595448921925204, -45.477148931116545, -72.14603342459678, -65.26691910223659, -68.83453970684478, -61.67307828973238, -54.90618692726017, -90.86199418368213, -47.363068628334894, -73.90691838435278, -49.71956184780464, -63.58888338045041, -51.49955655318059, -64.54194521223724, -54.56372227487316, -61.07119701381774, -46.331917509862635, -114.38529520953784, -73.81229321712102, -115.42986444389817, -65.17151397564479, -72.30188967231918, -41.814428203288024, -68.94894076098878, -84.67875982242678, -98.03907423459012, -94.95926357111773, -67.64210922736483, -68.51275461020232, -89.94023678414604, -74.4591286562427, -93.2980775775833, -65.79688362383078, -99.12467900511953, -55.49057205056669, -50.76634663933105, -131.7798815224666, -68.83782162407876, -91.0617306181406, -28.19283149862183, -55.66195621307273, -43.94597555377842, -74.50853184717391, -131.05019561642976, -91.71956500251814, -67.34143923419698, -120.05883791551906], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6081636037583553, "mean_inference_ms": 5.210578410808952, "mean_action_processing_ms": 0.1946301952029831, "mean_env_wait_ms": 1.3515396012654513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -28.19283149862183, "episode_reward_min": -173.38090437699907, "episode_reward_mean": -81.1124908728507, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-45.1102282355424, -173.38090437699907, -102.2048858679369, -124.1751935823878, -59.64975628672107, -157.01507467929412, -111.39921211228251, -58.72358477284392, -111.99735162810157, -90.90149989039104, -120.62346174064427, -79.21675754880616, -105.54582609751166, -66.26754627870562, -66.22000804018948, -85.82726970744662, -156.28607267119773, -79.25862357440907, -88.40818650816597, -51.08735127683281, -83.80803663011515, -68.06384257719465, -63.84976629595801, -93.39147371784159, -105.92115240249397, -131.71511856386223, -78.3248144574477, -91.9958752986664, -48.93823857745572, -52.5538443215621, -61.27444198280632, -62.041735680972295, -129.91098718988064, -82.21368130072753, -155.76608596289486, -140.36374881894696, -64.85600673650642, -66.90642644748065, -91.29085359589493, -86.77643064986398, -121.17545348955045, -68.48987896415034, -36.90760392641001, -63.57871045372227, -145.35210416974536, -65.44263978340678, -83.07839536717147, -55.81380446655214, -130.34123321100603, -33.64350384579765, -65.81157109227311, -67.90307493027191, -49.37075927640596, -60.595448921925204, -45.477148931116545, -72.14603342459678, -65.26691910223659, -68.83453970684478, -61.67307828973238, -54.90618692726017, -90.86199418368213, -47.363068628334894, -73.90691838435278, -49.71956184780464, -63.58888338045041, -51.49955655318059, -64.54194521223724, -54.56372227487316, -61.07119701381774, -46.331917509862635, -114.38529520953784, -73.81229321712102, -115.42986444389817, -65.17151397564479, -72.30188967231918, -41.814428203288024, -68.94894076098878, -84.67875982242678, -98.03907423459012, -94.95926357111773, -67.64210922736483, -68.51275461020232, -89.94023678414604, -74.4591286562427, -93.2980775775833, -65.79688362383078, -99.12467900511953, -55.49057205056669, -50.76634663933105, -131.7798815224666, -68.83782162407876, -91.0617306181406, -28.19283149862183, -55.66195621307273, -43.94597555377842, -74.50853184717391, -131.05019561642976, -91.71956500251814, -67.34143923419698, -120.05883791551906], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6081636037583553, "mean_inference_ms": 5.210578410808952, "mean_action_processing_ms": 0.1946301952029831, "mean_env_wait_ms": 1.3515396012654513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1022000, "num_agent_steps_trained": 1022000, "num_env_steps_sampled": 1022000, "num_env_steps_trained": 1022000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1022000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1022000, "timers": {"training_iteration_time_ms": 75934.693, "load_time_ms": 30.87, "load_throughput": 453514.615, "learn_time_ms": 68226.823, "learn_throughput": 205.198, "synch_weights_time_ms": 12.622}, "counters": {"num_env_steps_sampled": 1022000, "num_env_steps_trained": 1022000, "num_agent_steps_sampled": 1022000, "num_agent_steps_trained": 1022000}, "done": false, "episodes_total": 1022, "training_iteration": 73, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-27-39", "timestamp": 1693056459, "time_this_iter_s": 76.50300335884094, "time_total_s": 5615.310202598572, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701555FFD0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270154356A0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 5615.310202598572, "timesteps_since_restore": 0, "iterations_since_restore": 73, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 24.566055045871558, "ram_util_percent": 51.202752293577966}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -232.111768502146, "episode_L1_reward_sum_min": -479.104232236743, "episode_L1_reward_sum_max": -157.74925783276558, "episode_L2_reward_sum_mean": -135.0517089906335, "episode_L2_reward_sum_min": -197.82009935379028, "episode_L2_reward_sum_max": -115.48616129904985}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.1438039071505165, "policy_loss": 0.122718019073564, "vf_loss": 0.21085892449556465, "vf_explained_var": 0.5419216147727437, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1036000, "num_env_steps_trained": 1036000, "num_agent_steps_sampled": 1036000, "num_agent_steps_trained": 1036000}, "sampler_results": {"episode_reward_max": -28.19283149862183, "episode_reward_min": -156.28607267119773, "episode_reward_mean": -78.30601918928664, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -232.111768502146, "episode_L1_reward_sum_min": -479.104232236743, "episode_L1_reward_sum_max": -157.74925783276558, "episode_L2_reward_sum_mean": -135.0517089906335, "episode_L2_reward_sum_min": -197.82009935379028, "episode_L2_reward_sum_max": -115.48616129904985}, "hist_stats": {"episode_reward": [-66.22000804018948, -85.82726970744662, -156.28607267119773, -79.25862357440907, -88.40818650816597, -51.08735127683281, -83.80803663011515, -68.06384257719465, -63.84976629595801, -93.39147371784159, -105.92115240249397, -131.71511856386223, -78.3248144574477, -91.9958752986664, -48.93823857745572, -52.5538443215621, -61.27444198280632, -62.041735680972295, -129.91098718988064, -82.21368130072753, -155.76608596289486, -140.36374881894696, -64.85600673650642, -66.90642644748065, -91.29085359589493, -86.77643064986398, -121.17545348955045, -68.48987896415034, -36.90760392641001, -63.57871045372227, -145.35210416974536, -65.44263978340678, -83.07839536717147, -55.81380446655214, -130.34123321100603, -33.64350384579765, -65.81157109227311, -67.90307493027191, -49.37075927640596, -60.595448921925204, -45.477148931116545, -72.14603342459678, -65.26691910223659, -68.83453970684478, -61.67307828973238, -54.90618692726017, -90.86199418368213, -47.363068628334894, -73.90691838435278, -49.71956184780464, -63.58888338045041, -51.49955655318059, -64.54194521223724, -54.56372227487316, -61.07119701381774, -46.331917509862635, -114.38529520953784, -73.81229321712102, -115.42986444389817, -65.17151397564479, -72.30188967231918, -41.814428203288024, -68.94894076098878, -84.67875982242678, -98.03907423459012, -94.95926357111773, -67.64210922736483, -68.51275461020232, -89.94023678414604, -74.4591286562427, -93.2980775775833, -65.79688362383078, -99.12467900511953, -55.49057205056669, -50.76634663933105, -131.7798815224666, -68.83782162407876, -91.0617306181406, -28.19283149862183, -55.66195621307273, -43.94597555377842, -74.50853184717391, -131.05019561642976, -91.71956500251814, -67.34143923419698, -120.05883791551906, -55.96397806575766, -66.70680056625903, -80.88365297043725, -97.90004689195088, -91.59127638543322, -76.28631210638517, -68.94024942453355, -52.39977724729095, -96.12719870913244, -118.42375819454568, -50.71606955207909, -98.1355066325273, -78.50471200661957, -92.98477598880986], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.608150303603301, "mean_inference_ms": 5.211182410353801, "mean_action_processing_ms": 0.19465026964324167, "mean_env_wait_ms": 1.351753433408144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -28.19283149862183, "episode_reward_min": -156.28607267119773, "episode_reward_mean": -78.30601918928664, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-66.22000804018948, -85.82726970744662, -156.28607267119773, -79.25862357440907, -88.40818650816597, -51.08735127683281, -83.80803663011515, -68.06384257719465, -63.84976629595801, -93.39147371784159, -105.92115240249397, -131.71511856386223, -78.3248144574477, -91.9958752986664, -48.93823857745572, -52.5538443215621, -61.27444198280632, -62.041735680972295, -129.91098718988064, -82.21368130072753, -155.76608596289486, -140.36374881894696, -64.85600673650642, -66.90642644748065, -91.29085359589493, -86.77643064986398, -121.17545348955045, -68.48987896415034, -36.90760392641001, -63.57871045372227, -145.35210416974536, -65.44263978340678, -83.07839536717147, -55.81380446655214, -130.34123321100603, -33.64350384579765, -65.81157109227311, -67.90307493027191, -49.37075927640596, -60.595448921925204, -45.477148931116545, -72.14603342459678, -65.26691910223659, -68.83453970684478, -61.67307828973238, -54.90618692726017, -90.86199418368213, -47.363068628334894, -73.90691838435278, -49.71956184780464, -63.58888338045041, -51.49955655318059, -64.54194521223724, -54.56372227487316, -61.07119701381774, -46.331917509862635, -114.38529520953784, -73.81229321712102, -115.42986444389817, -65.17151397564479, -72.30188967231918, -41.814428203288024, -68.94894076098878, -84.67875982242678, -98.03907423459012, -94.95926357111773, -67.64210922736483, -68.51275461020232, -89.94023678414604, -74.4591286562427, -93.2980775775833, -65.79688362383078, -99.12467900511953, -55.49057205056669, -50.76634663933105, -131.7798815224666, -68.83782162407876, -91.0617306181406, -28.19283149862183, -55.66195621307273, -43.94597555377842, -74.50853184717391, -131.05019561642976, -91.71956500251814, -67.34143923419698, -120.05883791551906, -55.96397806575766, -66.70680056625903, -80.88365297043725, -97.90004689195088, -91.59127638543322, -76.28631210638517, -68.94024942453355, -52.39977724729095, -96.12719870913244, -118.42375819454568, -50.71606955207909, -98.1355066325273, -78.50471200661957, -92.98477598880986], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.608150303603301, "mean_inference_ms": 5.211182410353801, "mean_action_processing_ms": 0.19465026964324167, "mean_env_wait_ms": 1.351753433408144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1036000, "num_agent_steps_trained": 1036000, "num_env_steps_sampled": 1036000, "num_env_steps_trained": 1036000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1036000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1036000, "timers": {"training_iteration_time_ms": 76063.727, "load_time_ms": 31.014, "load_throughput": 451413.012, "learn_time_ms": 68348.222, "learn_throughput": 204.833, "synch_weights_time_ms": 13.148}, "counters": {"num_env_steps_sampled": 1036000, "num_env_steps_trained": 1036000, "num_agent_steps_sampled": 1036000, "num_agent_steps_trained": 1036000}, "done": false, "episodes_total": 1036, "training_iteration": 74, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-28-56", "timestamp": 1693056536, "time_this_iter_s": 76.40735673904419, "time_total_s": 5691.717559337616, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270152F7100>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015657130>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 5691.717559337616, "timesteps_since_restore": 0, "iterations_since_restore": 74, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 24.57407407407407, "ram_util_percent": 51.351851851851855}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -227.56517062895, "episode_L1_reward_sum_min": -512.7868594229221, "episode_L1_reward_sum_max": -157.74925783276558, "episode_L2_reward_sum_mean": -133.87263956457377, "episode_L2_reward_sum_min": -205.78890961408615, "episode_L2_reward_sum_max": -115.48616129904985}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.0790096901408914, "policy_loss": 0.06569443677826076, "vf_loss": 0.13315252573637934, "vf_explained_var": 0.5296896196932459, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1050000, "num_env_steps_trained": 1050000, "num_agent_steps_sampled": 1050000, "num_agent_steps_trained": 1050000}, "sampler_results": {"episode_reward_max": -28.19283149862183, "episode_reward_min": -170.52279506044485, "episode_reward_mean": -77.82868797173319, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -227.56517062895, "episode_L1_reward_sum_min": -512.7868594229221, "episode_L1_reward_sum_max": -157.74925783276558, "episode_L2_reward_sum_mean": -133.87263956457377, "episode_L2_reward_sum_min": -205.78890961408615, "episode_L2_reward_sum_max": -115.48616129904985}, "hist_stats": {"episode_reward": [-48.93823857745572, -52.5538443215621, -61.27444198280632, -62.041735680972295, -129.91098718988064, -82.21368130072753, -155.76608596289486, -140.36374881894696, -64.85600673650642, -66.90642644748065, -91.29085359589493, -86.77643064986398, -121.17545348955045, -68.48987896415034, -36.90760392641001, -63.57871045372227, -145.35210416974536, -65.44263978340678, -83.07839536717147, -55.81380446655214, -130.34123321100603, -33.64350384579765, -65.81157109227311, -67.90307493027191, -49.37075927640596, -60.595448921925204, -45.477148931116545, -72.14603342459678, -65.26691910223659, -68.83453970684478, -61.67307828973238, -54.90618692726017, -90.86199418368213, -47.363068628334894, -73.90691838435278, -49.71956184780464, -63.58888338045041, -51.49955655318059, -64.54194521223724, -54.56372227487316, -61.07119701381774, -46.331917509862635, -114.38529520953784, -73.81229321712102, -115.42986444389817, -65.17151397564479, -72.30188967231918, -41.814428203288024, -68.94894076098878, -84.67875982242678, -98.03907423459012, -94.95926357111773, -67.64210922736483, -68.51275461020232, -89.94023678414604, -74.4591286562427, -93.2980775775833, -65.79688362383078, -99.12467900511953, -55.49057205056669, -50.76634663933105, -131.7798815224666, -68.83782162407876, -91.0617306181406, -28.19283149862183, -55.66195621307273, -43.94597555377842, -74.50853184717391, -131.05019561642976, -91.71956500251814, -67.34143923419698, -120.05883791551906, -55.96397806575766, -66.70680056625903, -80.88365297043725, -97.90004689195088, -91.59127638543322, -76.28631210638517, -68.94024942453355, -52.39977724729095, -96.12719870913244, -118.42375819454568, -50.71606955207909, -98.1355066325273, -78.50471200661957, -92.98477598880986, -144.97945388703772, -76.67702744610202, -75.01986410377054, -68.16623286020062, -55.76675437987526, -55.817967093979675, -66.91207238818404, -84.66177236551492, -53.05239546933123, -91.01846254856643, -89.22573937767002, -170.52279506044485, -94.91293173825787, -69.69100124754144], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6081560080141472, "mean_inference_ms": 5.212177164060941, "mean_action_processing_ms": 0.19468763962572255, "mean_env_wait_ms": 1.352078686409595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -28.19283149862183, "episode_reward_min": -170.52279506044485, "episode_reward_mean": -77.82868797173319, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.93823857745572, -52.5538443215621, -61.27444198280632, -62.041735680972295, -129.91098718988064, -82.21368130072753, -155.76608596289486, -140.36374881894696, -64.85600673650642, -66.90642644748065, -91.29085359589493, -86.77643064986398, -121.17545348955045, -68.48987896415034, -36.90760392641001, -63.57871045372227, -145.35210416974536, -65.44263978340678, -83.07839536717147, -55.81380446655214, -130.34123321100603, -33.64350384579765, -65.81157109227311, -67.90307493027191, -49.37075927640596, -60.595448921925204, -45.477148931116545, -72.14603342459678, -65.26691910223659, -68.83453970684478, -61.67307828973238, -54.90618692726017, -90.86199418368213, -47.363068628334894, -73.90691838435278, -49.71956184780464, -63.58888338045041, -51.49955655318059, -64.54194521223724, -54.56372227487316, -61.07119701381774, -46.331917509862635, -114.38529520953784, -73.81229321712102, -115.42986444389817, -65.17151397564479, -72.30188967231918, -41.814428203288024, -68.94894076098878, -84.67875982242678, -98.03907423459012, -94.95926357111773, -67.64210922736483, -68.51275461020232, -89.94023678414604, -74.4591286562427, -93.2980775775833, -65.79688362383078, -99.12467900511953, -55.49057205056669, -50.76634663933105, -131.7798815224666, -68.83782162407876, -91.0617306181406, -28.19283149862183, -55.66195621307273, -43.94597555377842, -74.50853184717391, -131.05019561642976, -91.71956500251814, -67.34143923419698, -120.05883791551906, -55.96397806575766, -66.70680056625903, -80.88365297043725, -97.90004689195088, -91.59127638543322, -76.28631210638517, -68.94024942453355, -52.39977724729095, -96.12719870913244, -118.42375819454568, -50.71606955207909, -98.1355066325273, -78.50471200661957, -92.98477598880986, -144.97945388703772, -76.67702744610202, -75.01986410377054, -68.16623286020062, -55.76675437987526, -55.817967093979675, -66.91207238818404, -84.66177236551492, -53.05239546933123, -91.01846254856643, -89.22573937767002, -170.52279506044485, -94.91293173825787, -69.69100124754144], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6081560080141472, "mean_inference_ms": 5.212177164060941, "mean_action_processing_ms": 0.19468763962572255, "mean_env_wait_ms": 1.352078686409595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1050000, "num_agent_steps_trained": 1050000, "num_env_steps_sampled": 1050000, "num_env_steps_trained": 1050000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1050000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1050000, "timers": {"training_iteration_time_ms": 76023.621, "load_time_ms": 31.313, "load_throughput": 447099.13, "learn_time_ms": 68355.566, "learn_throughput": 204.811, "synch_weights_time_ms": 13.423}, "counters": {"num_env_steps_sampled": 1050000, "num_env_steps_trained": 1050000, "num_agent_steps_sampled": 1050000, "num_agent_steps_trained": 1050000}, "done": false, "episodes_total": 1050, "training_iteration": 75, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-30-11", "timestamp": 1693056611, "time_this_iter_s": 75.42585897445679, "time_total_s": 5767.143418312073, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015422FD0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015435B50>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 5767.143418312073, "timesteps_since_restore": 0, "iterations_since_restore": 75, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.813084112149532, "ram_util_percent": 51.456074766355144}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -223.00432239346208, "episode_L1_reward_sum_min": -512.7868594229221, "episode_L1_reward_sum_max": -157.74925783276558, "episode_L2_reward_sum_mean": -132.7302822252363, "episode_L2_reward_sum_min": -205.78890961408615, "episode_L2_reward_sum_max": -115.48616129904985}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.1016233280148269, "policy_loss": 0.08646260544948985, "vf_loss": 0.15160719161027778, "vf_explained_var": 0.5315551062424978, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1064000, "num_env_steps_trained": 1064000, "num_agent_steps_sampled": 1064000, "num_agent_steps_trained": 1064000}, "sampler_results": {"episode_reward_max": -28.19283149862183, "episode_reward_min": -170.52279506044485, "episode_reward_mean": -75.95096874454539, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -223.00432239346208, "episode_L1_reward_sum_min": -512.7868594229221, "episode_L1_reward_sum_max": -157.74925783276558, "episode_L2_reward_sum_mean": -132.7302822252363, "episode_L2_reward_sum_min": -205.78890961408615, "episode_L2_reward_sum_max": -115.48616129904985}, "hist_stats": {"episode_reward": [-36.90760392641001, -63.57871045372227, -145.35210416974536, -65.44263978340678, -83.07839536717147, -55.81380446655214, -130.34123321100603, -33.64350384579765, -65.81157109227311, -67.90307493027191, -49.37075927640596, -60.595448921925204, -45.477148931116545, -72.14603342459678, -65.26691910223659, -68.83453970684478, -61.67307828973238, -54.90618692726017, -90.86199418368213, -47.363068628334894, -73.90691838435278, -49.71956184780464, -63.58888338045041, -51.49955655318059, -64.54194521223724, -54.56372227487316, -61.07119701381774, -46.331917509862635, -114.38529520953784, -73.81229321712102, -115.42986444389817, -65.17151397564479, -72.30188967231918, -41.814428203288024, -68.94894076098878, -84.67875982242678, -98.03907423459012, -94.95926357111773, -67.64210922736483, -68.51275461020232, -89.94023678414604, -74.4591286562427, -93.2980775775833, -65.79688362383078, -99.12467900511953, -55.49057205056669, -50.76634663933105, -131.7798815224666, -68.83782162407876, -91.0617306181406, -28.19283149862183, -55.66195621307273, -43.94597555377842, -74.50853184717391, -131.05019561642976, -91.71956500251814, -67.34143923419698, -120.05883791551906, -55.96397806575766, -66.70680056625903, -80.88365297043725, -97.90004689195088, -91.59127638543322, -76.28631210638517, -68.94024942453355, -52.39977724729095, -96.12719870913244, -118.42375819454568, -50.71606955207909, -98.1355066325273, -78.50471200661957, -92.98477598880986, -144.97945388703772, -76.67702744610202, -75.01986410377054, -68.16623286020062, -55.76675437987526, -55.817967093979675, -66.91207238818404, -84.66177236551492, -53.05239546933123, -91.01846254856643, -89.22573937767002, -170.52279506044485, -94.91293173825787, -69.69100124754144, -53.014624483201715, -145.07929135748802, -56.6713378966996, -52.78384199128386, -86.55885843841835, -56.27689292604626, -76.51827741905026, -89.87577299566365, -81.68022633739041, -52.97627034393238, -38.92486437876044, -78.58911987325108, -48.31866430125684, -127.51784825747107], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6081984952672531, "mean_inference_ms": 5.213299846053079, "mean_action_processing_ms": 0.1947267171966922, "mean_env_wait_ms": 1.3524123509759394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -28.19283149862183, "episode_reward_min": -170.52279506044485, "episode_reward_mean": -75.95096874454539, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-36.90760392641001, -63.57871045372227, -145.35210416974536, -65.44263978340678, -83.07839536717147, -55.81380446655214, -130.34123321100603, -33.64350384579765, -65.81157109227311, -67.90307493027191, -49.37075927640596, -60.595448921925204, -45.477148931116545, -72.14603342459678, -65.26691910223659, -68.83453970684478, -61.67307828973238, -54.90618692726017, -90.86199418368213, -47.363068628334894, -73.90691838435278, -49.71956184780464, -63.58888338045041, -51.49955655318059, -64.54194521223724, -54.56372227487316, -61.07119701381774, -46.331917509862635, -114.38529520953784, -73.81229321712102, -115.42986444389817, -65.17151397564479, -72.30188967231918, -41.814428203288024, -68.94894076098878, -84.67875982242678, -98.03907423459012, -94.95926357111773, -67.64210922736483, -68.51275461020232, -89.94023678414604, -74.4591286562427, -93.2980775775833, -65.79688362383078, -99.12467900511953, -55.49057205056669, -50.76634663933105, -131.7798815224666, -68.83782162407876, -91.0617306181406, -28.19283149862183, -55.66195621307273, -43.94597555377842, -74.50853184717391, -131.05019561642976, -91.71956500251814, -67.34143923419698, -120.05883791551906, -55.96397806575766, -66.70680056625903, -80.88365297043725, -97.90004689195088, -91.59127638543322, -76.28631210638517, -68.94024942453355, -52.39977724729095, -96.12719870913244, -118.42375819454568, -50.71606955207909, -98.1355066325273, -78.50471200661957, -92.98477598880986, -144.97945388703772, -76.67702744610202, -75.01986410377054, -68.16623286020062, -55.76675437987526, -55.817967093979675, -66.91207238818404, -84.66177236551492, -53.05239546933123, -91.01846254856643, -89.22573937767002, -170.52279506044485, -94.91293173825787, -69.69100124754144, -53.014624483201715, -145.07929135748802, -56.6713378966996, -52.78384199128386, -86.55885843841835, -56.27689292604626, -76.51827741905026, -89.87577299566365, -81.68022633739041, -52.97627034393238, -38.92486437876044, -78.58911987325108, -48.31866430125684, -127.51784825747107], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6081984952672531, "mean_inference_ms": 5.213299846053079, "mean_action_processing_ms": 0.1947267171966922, "mean_env_wait_ms": 1.3524123509759394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1064000, "num_agent_steps_trained": 1064000, "num_env_steps_sampled": 1064000, "num_env_steps_trained": 1064000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1064000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1064000, "timers": {"training_iteration_time_ms": 76015.471, "load_time_ms": 31.014, "load_throughput": 451413.359, "learn_time_ms": 68340.373, "learn_throughput": 204.857, "synch_weights_time_ms": 13.631}, "counters": {"num_env_steps_sampled": 1064000, "num_env_steps_trained": 1064000, "num_agent_steps_sampled": 1064000, "num_agent_steps_trained": 1064000}, "done": false, "episodes_total": 1064, "training_iteration": 76, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-31-27", "timestamp": 1693056687, "time_this_iter_s": 75.11666250228882, "time_total_s": 5842.260080814362, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270151C00A0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270152D18E0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 5842.260080814362, "timesteps_since_restore": 0, "iterations_since_restore": 76, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.732075471698113, "ram_util_percent": 51.43018867924528}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -226.04029953047632, "episode_L1_reward_sum_min": -512.7868594229221, "episode_L1_reward_sum_max": -161.6662151813507, "episode_L2_reward_sum_mean": -133.45054245606065, "episode_L2_reward_sum_min": -205.78890961408615, "episode_L2_reward_sum_max": -117.38020863384008}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.06382834764318196, "policy_loss": 0.045446663788316674, "vf_loss": 0.1838168280031173, "vf_explained_var": 0.7526801703152833, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1078000, "num_env_steps_trained": 1078000, "num_agent_steps_sampled": 1078000, "num_agent_steps_trained": 1078000}, "sampler_results": {"episode_reward_max": -28.19283149862183, "episode_reward_min": -170.52279506044485, "episode_reward_mean": -78.10885666818783, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -226.04029953047632, "episode_L1_reward_sum_min": -512.7868594229221, "episode_L1_reward_sum_max": -161.6662151813507, "episode_L2_reward_sum_mean": -133.45054245606065, "episode_L2_reward_sum_min": -205.78890961408615, "episode_L2_reward_sum_max": -117.38020863384008}, "hist_stats": {"episode_reward": [-65.26691910223659, -68.83453970684478, -61.67307828973238, -54.90618692726017, -90.86199418368213, -47.363068628334894, -73.90691838435278, -49.71956184780464, -63.58888338045041, -51.49955655318059, -64.54194521223724, -54.56372227487316, -61.07119701381774, -46.331917509862635, -114.38529520953784, -73.81229321712102, -115.42986444389817, -65.17151397564479, -72.30188967231918, -41.814428203288024, -68.94894076098878, -84.67875982242678, -98.03907423459012, -94.95926357111773, -67.64210922736483, -68.51275461020232, -89.94023678414604, -74.4591286562427, -93.2980775775833, -65.79688362383078, -99.12467900511953, -55.49057205056669, -50.76634663933105, -131.7798815224666, -68.83782162407876, -91.0617306181406, -28.19283149862183, -55.66195621307273, -43.94597555377842, -74.50853184717391, -131.05019561642976, -91.71956500251814, -67.34143923419698, -120.05883791551906, -55.96397806575766, -66.70680056625903, -80.88365297043725, -97.90004689195088, -91.59127638543322, -76.28631210638517, -68.94024942453355, -52.39977724729095, -96.12719870913244, -118.42375819454568, -50.71606955207909, -98.1355066325273, -78.50471200661957, -92.98477598880986, -144.97945388703772, -76.67702744610202, -75.01986410377054, -68.16623286020062, -55.76675437987526, -55.817967093979675, -66.91207238818404, -84.66177236551492, -53.05239546933123, -91.01846254856643, -89.22573937767002, -170.52279506044485, -94.91293173825787, -69.69100124754144, -53.014624483201715, -145.07929135748802, -56.6713378966996, -52.78384199128386, -86.55885843841835, -56.27689292604626, -76.51827741905026, -89.87577299566365, -81.68022633739041, -52.97627034393238, -38.92486437876044, -78.58911987325108, -48.31866430125684, -127.51784825747107, -51.80392226827515, -126.394528601146, -71.24982873539435, -58.33058782516306, -80.4991256923799, -98.50647874103994, -123.25027022630356, -83.46589172966162, -83.7306268927986, -123.85213630920659, -102.78948437592804, -66.41337767386243, -49.93032283063861, -71.03424226284676], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6082144589901154, "mean_inference_ms": 5.2143831433786785, "mean_action_processing_ms": 0.1947650101744301, "mean_env_wait_ms": 1.3527340093365858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -28.19283149862183, "episode_reward_min": -170.52279506044485, "episode_reward_mean": -78.10885666818783, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-65.26691910223659, -68.83453970684478, -61.67307828973238, -54.90618692726017, -90.86199418368213, -47.363068628334894, -73.90691838435278, -49.71956184780464, -63.58888338045041, -51.49955655318059, -64.54194521223724, -54.56372227487316, -61.07119701381774, -46.331917509862635, -114.38529520953784, -73.81229321712102, -115.42986444389817, -65.17151397564479, -72.30188967231918, -41.814428203288024, -68.94894076098878, -84.67875982242678, -98.03907423459012, -94.95926357111773, -67.64210922736483, -68.51275461020232, -89.94023678414604, -74.4591286562427, -93.2980775775833, -65.79688362383078, -99.12467900511953, -55.49057205056669, -50.76634663933105, -131.7798815224666, -68.83782162407876, -91.0617306181406, -28.19283149862183, -55.66195621307273, -43.94597555377842, -74.50853184717391, -131.05019561642976, -91.71956500251814, -67.34143923419698, -120.05883791551906, -55.96397806575766, -66.70680056625903, -80.88365297043725, -97.90004689195088, -91.59127638543322, -76.28631210638517, -68.94024942453355, -52.39977724729095, -96.12719870913244, -118.42375819454568, -50.71606955207909, -98.1355066325273, -78.50471200661957, -92.98477598880986, -144.97945388703772, -76.67702744610202, -75.01986410377054, -68.16623286020062, -55.76675437987526, -55.817967093979675, -66.91207238818404, -84.66177236551492, -53.05239546933123, -91.01846254856643, -89.22573937767002, -170.52279506044485, -94.91293173825787, -69.69100124754144, -53.014624483201715, -145.07929135748802, -56.6713378966996, -52.78384199128386, -86.55885843841835, -56.27689292604626, -76.51827741905026, -89.87577299566365, -81.68022633739041, -52.97627034393238, -38.92486437876044, -78.58911987325108, -48.31866430125684, -127.51784825747107, -51.80392226827515, -126.394528601146, -71.24982873539435, -58.33058782516306, -80.4991256923799, -98.50647874103994, -123.25027022630356, -83.46589172966162, -83.7306268927986, -123.85213630920659, -102.78948437592804, -66.41337767386243, -49.93032283063861, -71.03424226284676], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6082144589901154, "mean_inference_ms": 5.2143831433786785, "mean_action_processing_ms": 0.1947650101744301, "mean_env_wait_ms": 1.3527340093365858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1078000, "num_agent_steps_trained": 1078000, "num_env_steps_sampled": 1078000, "num_env_steps_trained": 1078000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1078000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1078000, "timers": {"training_iteration_time_ms": 76013.455, "load_time_ms": 30.801, "load_throughput": 454534.066, "learn_time_ms": 68348.736, "learn_throughput": 204.832, "synch_weights_time_ms": 13.232}, "counters": {"num_env_steps_sampled": 1078000, "num_env_steps_trained": 1078000, "num_agent_steps_sampled": 1078000, "num_agent_steps_trained": 1078000}, "done": false, "episodes_total": 1078, "training_iteration": 77, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-32-42", "timestamp": 1693056762, "time_this_iter_s": 75.29087233543396, "time_total_s": 5917.5509531497955, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015204D60>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015204400>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 5917.5509531497955, "timesteps_since_restore": 0, "iterations_since_restore": 77, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.770093457943922, "ram_util_percent": 51.48130841121495}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -236.40742072097956, "episode_L1_reward_sum_min": -598.8038388490677, "episode_L1_reward_sum_max": -161.6662151813507, "episode_L2_reward_sum_mean": -136.09132599115372, "episode_L2_reward_sum_min": -222.9019753932953, "episode_L2_reward_sum_max": -117.38020863384008}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.085686118193469, "policy_loss": 0.06392215559481348, "vf_loss": 0.217639650430706, "vf_explained_var": 0.7161677746186531, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "sampler_results": {"episode_reward_max": -28.19283149862183, "episode_reward_min": -203.92797221089745, "episode_reward_mean": -82.05599155974357, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -236.40742072097956, "episode_L1_reward_sum_min": -598.8038388490677, "episode_L1_reward_sum_max": -161.6662151813507, "episode_L2_reward_sum_mean": -136.09132599115372, "episode_L2_reward_sum_min": -222.9019753932953, "episode_L2_reward_sum_max": -117.38020863384008}, "hist_stats": {"episode_reward": [-114.38529520953784, -73.81229321712102, -115.42986444389817, -65.17151397564479, -72.30188967231918, -41.814428203288024, -68.94894076098878, -84.67875982242678, -98.03907423459012, -94.95926357111773, -67.64210922736483, -68.51275461020232, -89.94023678414604, -74.4591286562427, -93.2980775775833, -65.79688362383078, -99.12467900511953, -55.49057205056669, -50.76634663933105, -131.7798815224666, -68.83782162407876, -91.0617306181406, -28.19283149862183, -55.66195621307273, -43.94597555377842, -74.50853184717391, -131.05019561642976, -91.71956500251814, -67.34143923419698, -120.05883791551906, -55.96397806575766, -66.70680056625903, -80.88365297043725, -97.90004689195088, -91.59127638543322, -76.28631210638517, -68.94024942453355, -52.39977724729095, -96.12719870913244, -118.42375819454568, -50.71606955207909, -98.1355066325273, -78.50471200661957, -92.98477598880986, -144.97945388703772, -76.67702744610202, -75.01986410377054, -68.16623286020062, -55.76675437987526, -55.817967093979675, -66.91207238818404, -84.66177236551492, -53.05239546933123, -91.01846254856643, -89.22573937767002, -170.52279506044485, -94.91293173825787, -69.69100124754144, -53.014624483201715, -145.07929135748802, -56.6713378966996, -52.78384199128386, -86.55885843841835, -56.27689292604626, -76.51827741905026, -89.87577299566365, -81.68022633739041, -52.97627034393238, -38.92486437876044, -78.58911987325108, -48.31866430125684, -127.51784825747107, -51.80392226827515, -126.394528601146, -71.24982873539435, -58.33058782516306, -80.4991256923799, -98.50647874103994, -123.25027022630356, -83.46589172966162, -83.7306268927986, -123.85213630920659, -102.78948437592804, -66.41337767386243, -49.93032283063861, -71.03424226284676, -78.69723935066975, -67.08268279244938, -56.151419751585486, -203.92797221089745, -86.40391897813495, -61.79276753021809, -104.05242734317031, -96.11594980761471, -79.0576330420779, -124.97343339568744, -109.58432635471927, -64.88389388567195, -67.3299394205157, -48.78937430683286], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6081077428913041, "mean_inference_ms": 5.214268144766662, "mean_action_processing_ms": 0.1947662967335962, "mean_env_wait_ms": 1.3527223795175647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -28.19283149862183, "episode_reward_min": -203.92797221089745, "episode_reward_mean": -82.05599155974357, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114.38529520953784, -73.81229321712102, -115.42986444389817, -65.17151397564479, -72.30188967231918, -41.814428203288024, -68.94894076098878, -84.67875982242678, -98.03907423459012, -94.95926357111773, -67.64210922736483, -68.51275461020232, -89.94023678414604, -74.4591286562427, -93.2980775775833, -65.79688362383078, -99.12467900511953, -55.49057205056669, -50.76634663933105, -131.7798815224666, -68.83782162407876, -91.0617306181406, -28.19283149862183, -55.66195621307273, -43.94597555377842, -74.50853184717391, -131.05019561642976, -91.71956500251814, -67.34143923419698, -120.05883791551906, -55.96397806575766, -66.70680056625903, -80.88365297043725, -97.90004689195088, -91.59127638543322, -76.28631210638517, -68.94024942453355, -52.39977724729095, -96.12719870913244, -118.42375819454568, -50.71606955207909, -98.1355066325273, -78.50471200661957, -92.98477598880986, -144.97945388703772, -76.67702744610202, -75.01986410377054, -68.16623286020062, -55.76675437987526, -55.817967093979675, -66.91207238818404, -84.66177236551492, -53.05239546933123, -91.01846254856643, -89.22573937767002, -170.52279506044485, -94.91293173825787, -69.69100124754144, -53.014624483201715, -145.07929135748802, -56.6713378966996, -52.78384199128386, -86.55885843841835, -56.27689292604626, -76.51827741905026, -89.87577299566365, -81.68022633739041, -52.97627034393238, -38.92486437876044, -78.58911987325108, -48.31866430125684, -127.51784825747107, -51.80392226827515, -126.394528601146, -71.24982873539435, -58.33058782516306, -80.4991256923799, -98.50647874103994, -123.25027022630356, -83.46589172966162, -83.7306268927986, -123.85213630920659, -102.78948437592804, -66.41337767386243, -49.93032283063861, -71.03424226284676, -78.69723935066975, -67.08268279244938, -56.151419751585486, -203.92797221089745, -86.40391897813495, -61.79276753021809, -104.05242734317031, -96.11594980761471, -79.0576330420779, -124.97343339568744, -109.58432635471927, -64.88389388567195, -67.3299394205157, -48.78937430683286], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6081077428913041, "mean_inference_ms": 5.214268144766662, "mean_action_processing_ms": 0.1947662967335962, "mean_env_wait_ms": 1.3527223795175647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1092000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1092000, "timers": {"training_iteration_time_ms": 76042.812, "load_time_ms": 31.197, "load_throughput": 448761.791, "learn_time_ms": 68359.411, "learn_throughput": 204.8, "synch_weights_time_ms": 12.444}, "counters": {"num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "done": false, "episodes_total": 1092, "training_iteration": 78, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-33-58", "timestamp": 1693056838, "time_this_iter_s": 75.54175353050232, "time_total_s": 5993.092706680298, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015311EB0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014E9B340>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 5993.092706680298, "timesteps_since_restore": 0, "iterations_since_restore": 78, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 22.01588785046729, "ram_util_percent": 51.8252336448598}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -238.4050369308144, "episode_L1_reward_sum_min": -598.8038388490677, "episode_L1_reward_sum_max": -164.67262694239616, "episode_L2_reward_sum_mean": -136.59691803351043, "episode_L2_reward_sum_min": -222.9019753932953, "episode_L2_reward_sum_max": -117.74758452177048}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.10071419928809283, "policy_loss": 0.07925576033020859, "vf_loss": 0.21458441755172353, "vf_explained_var": 0.4767316785859473, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1106000, "num_env_steps_trained": 1106000, "num_agent_steps_sampled": 1106000, "num_agent_steps_trained": 1106000}, "sampler_results": {"episode_reward_max": -28.19283149862183, "episode_reward_min": -203.92797221089745, "episode_reward_mean": -81.83239737262471, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -238.4050369308144, "episode_L1_reward_sum_min": -598.8038388490677, "episode_L1_reward_sum_max": -164.67262694239616, "episode_L2_reward_sum_mean": -136.59691803351043, "episode_L2_reward_sum_min": -222.9019753932953, "episode_L2_reward_sum_max": -117.74758452177048}, "hist_stats": {"episode_reward": [-93.2980775775833, -65.79688362383078, -99.12467900511953, -55.49057205056669, -50.76634663933105, -131.7798815224666, -68.83782162407876, -91.0617306181406, -28.19283149862183, -55.66195621307273, -43.94597555377842, -74.50853184717391, -131.05019561642976, -91.71956500251814, -67.34143923419698, -120.05883791551906, -55.96397806575766, -66.70680056625903, -80.88365297043725, -97.90004689195088, -91.59127638543322, -76.28631210638517, -68.94024942453355, -52.39977724729095, -96.12719870913244, -118.42375819454568, -50.71606955207909, -98.1355066325273, -78.50471200661957, -92.98477598880986, -144.97945388703772, -76.67702744610202, -75.01986410377054, -68.16623286020062, -55.76675437987526, -55.817967093979675, -66.91207238818404, -84.66177236551492, -53.05239546933123, -91.01846254856643, -89.22573937767002, -170.52279506044485, -94.91293173825787, -69.69100124754144, -53.014624483201715, -145.07929135748802, -56.6713378966996, -52.78384199128386, -86.55885843841835, -56.27689292604626, -76.51827741905026, -89.87577299566365, -81.68022633739041, -52.97627034393238, -38.92486437876044, -78.58911987325108, -48.31866430125684, -127.51784825747107, -51.80392226827515, -126.394528601146, -71.24982873539435, -58.33058782516306, -80.4991256923799, -98.50647874103994, -123.25027022630356, -83.46589172966162, -83.7306268927986, -123.85213630920659, -102.78948437592804, -66.41337767386243, -49.93032283063861, -71.03424226284676, -78.69723935066975, -67.08268279244938, -56.151419751585486, -203.92797221089745, -86.40391897813495, -61.79276753021809, -104.05242734317031, -96.11594980761471, -79.0576330420779, -124.97343339568744, -109.58432635471927, -64.88389388567195, -67.3299394205157, -48.78937430683286, -131.7071752506443, -108.86405688822381, -45.46565693314914, -123.79381773809101, -67.05658592302134, -99.39975799957475, -79.66371957622653, -67.30366028463956, -56.923607007388455, -89.42530225636357, -47.356175358668885, -62.38147862355654, -75.70125249364824, -52.69388734380571], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6079467353677495, "mean_inference_ms": 5.213795983328424, "mean_action_processing_ms": 0.194761626096189, "mean_env_wait_ms": 1.3526253923317184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -28.19283149862183, "episode_reward_min": -203.92797221089745, "episode_reward_mean": -81.83239737262471, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-93.2980775775833, -65.79688362383078, -99.12467900511953, -55.49057205056669, -50.76634663933105, -131.7798815224666, -68.83782162407876, -91.0617306181406, -28.19283149862183, -55.66195621307273, -43.94597555377842, -74.50853184717391, -131.05019561642976, -91.71956500251814, -67.34143923419698, -120.05883791551906, -55.96397806575766, -66.70680056625903, -80.88365297043725, -97.90004689195088, -91.59127638543322, -76.28631210638517, -68.94024942453355, -52.39977724729095, -96.12719870913244, -118.42375819454568, -50.71606955207909, -98.1355066325273, -78.50471200661957, -92.98477598880986, -144.97945388703772, -76.67702744610202, -75.01986410377054, -68.16623286020062, -55.76675437987526, -55.817967093979675, -66.91207238818404, -84.66177236551492, -53.05239546933123, -91.01846254856643, -89.22573937767002, -170.52279506044485, -94.91293173825787, -69.69100124754144, -53.014624483201715, -145.07929135748802, -56.6713378966996, -52.78384199128386, -86.55885843841835, -56.27689292604626, -76.51827741905026, -89.87577299566365, -81.68022633739041, -52.97627034393238, -38.92486437876044, -78.58911987325108, -48.31866430125684, -127.51784825747107, -51.80392226827515, -126.394528601146, -71.24982873539435, -58.33058782516306, -80.4991256923799, -98.50647874103994, -123.25027022630356, -83.46589172966162, -83.7306268927986, -123.85213630920659, -102.78948437592804, -66.41337767386243, -49.93032283063861, -71.03424226284676, -78.69723935066975, -67.08268279244938, -56.151419751585486, -203.92797221089745, -86.40391897813495, -61.79276753021809, -104.05242734317031, -96.11594980761471, -79.0576330420779, -124.97343339568744, -109.58432635471927, -64.88389388567195, -67.3299394205157, -48.78937430683286, -131.7071752506443, -108.86405688822381, -45.46565693314914, -123.79381773809101, -67.05658592302134, -99.39975799957475, -79.66371957622653, -67.30366028463956, -56.923607007388455, -89.42530225636357, -47.356175358668885, -62.38147862355654, -75.70125249364824, -52.69388734380571], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6079467353677495, "mean_inference_ms": 5.213795983328424, "mean_action_processing_ms": 0.194761626096189, "mean_env_wait_ms": 1.3526253923317184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1106000, "num_agent_steps_trained": 1106000, "num_env_steps_sampled": 1106000, "num_env_steps_trained": 1106000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1106000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1106000, "timers": {"training_iteration_time_ms": 76031.181, "load_time_ms": 30.533, "load_throughput": 458515.578, "learn_time_ms": 68345.327, "learn_throughput": 204.842, "synch_weights_time_ms": 12.531}, "counters": {"num_env_steps_sampled": 1106000, "num_env_steps_trained": 1106000, "num_agent_steps_sampled": 1106000, "num_agent_steps_trained": 1106000}, "done": false, "episodes_total": 1106, "training_iteration": 79, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-35-13", "timestamp": 1693056913, "time_this_iter_s": 75.17134594917297, "time_total_s": 6068.264052629471, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270152CF400>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015359310>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 6068.264052629471, "timesteps_since_restore": 0, "iterations_since_restore": 79, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.773584905660375, "ram_util_percent": 51.48301886792453}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -245.8193239339441, "episode_L1_reward_sum_min": -598.8038388490677, "episode_L1_reward_sum_max": -164.6559081748128, "episode_L2_reward_sum_mean": -138.47619898088277, "episode_L2_reward_sum_min": -222.9019753932953, "episode_L2_reward_sum_max": -117.44678499549627}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.10477924299112103, "policy_loss": 0.0800118095609417, "vf_loss": 0.24767429751731534, "vf_explained_var": 0.6536744987523114, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1120000, "num_env_steps_trained": 1120000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "sampler_results": {"episode_reward_max": -38.92486437876044, "episode_reward_min": -203.92797221089745, "episode_reward_mean": -83.91213480528567, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -245.8193239339441, "episode_L1_reward_sum_min": -598.8038388490677, "episode_L1_reward_sum_max": -164.6559081748128, "episode_L2_reward_sum_mean": -138.47619898088277, "episode_L2_reward_sum_min": -222.9019753932953, "episode_L2_reward_sum_max": -117.44678499549627}, "hist_stats": {"episode_reward": [-67.34143923419698, -120.05883791551906, -55.96397806575766, -66.70680056625903, -80.88365297043725, -97.90004689195088, -91.59127638543322, -76.28631210638517, -68.94024942453355, -52.39977724729095, -96.12719870913244, -118.42375819454568, -50.71606955207909, -98.1355066325273, -78.50471200661957, -92.98477598880986, -144.97945388703772, -76.67702744610202, -75.01986410377054, -68.16623286020062, -55.76675437987526, -55.817967093979675, -66.91207238818404, -84.66177236551492, -53.05239546933123, -91.01846254856643, -89.22573937767002, -170.52279506044485, -94.91293173825787, -69.69100124754144, -53.014624483201715, -145.07929135748802, -56.6713378966996, -52.78384199128386, -86.55885843841835, -56.27689292604626, -76.51827741905026, -89.87577299566365, -81.68022633739041, -52.97627034393238, -38.92486437876044, -78.58911987325108, -48.31866430125684, -127.51784825747107, -51.80392226827515, -126.394528601146, -71.24982873539435, -58.33058782516306, -80.4991256923799, -98.50647874103994, -123.25027022630356, -83.46589172966162, -83.7306268927986, -123.85213630920659, -102.78948437592804, -66.41337767386243, -49.93032283063861, -71.03424226284676, -78.69723935066975, -67.08268279244938, -56.151419751585486, -203.92797221089745, -86.40391897813495, -61.79276753021809, -104.05242734317031, -96.11594980761471, -79.0576330420779, -124.97343339568744, -109.58432635471927, -64.88389388567195, -67.3299394205157, -48.78937430683286, -131.7071752506443, -108.86405688822381, -45.46565693314914, -123.79381773809101, -67.05658592302134, -99.39975799957475, -79.66371957622653, -67.30366028463956, -56.923607007388455, -89.42530225636357, -47.356175358668885, -62.38147862355654, -75.70125249364824, -52.69388734380571, -164.35588544758082, -45.82299923165204, -59.129153965240704, -87.95875175721665, -86.92600711407914, -72.87049587955103, -110.74578969525689, -68.41274499357048, -104.95529291424859, -159.52704744004257, -67.06648225688159, -80.40892156629069, -90.6757650488555, -90.35345434834277], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6077900351187937, "mean_inference_ms": 5.213397468637637, "mean_action_processing_ms": 0.1947555987833919, "mean_env_wait_ms": 1.3525501747842503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -38.92486437876044, "episode_reward_min": -203.92797221089745, "episode_reward_mean": -83.91213480528567, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-67.34143923419698, -120.05883791551906, -55.96397806575766, -66.70680056625903, -80.88365297043725, -97.90004689195088, -91.59127638543322, -76.28631210638517, -68.94024942453355, -52.39977724729095, -96.12719870913244, -118.42375819454568, -50.71606955207909, -98.1355066325273, -78.50471200661957, -92.98477598880986, -144.97945388703772, -76.67702744610202, -75.01986410377054, -68.16623286020062, -55.76675437987526, -55.817967093979675, -66.91207238818404, -84.66177236551492, -53.05239546933123, -91.01846254856643, -89.22573937767002, -170.52279506044485, -94.91293173825787, -69.69100124754144, -53.014624483201715, -145.07929135748802, -56.6713378966996, -52.78384199128386, -86.55885843841835, -56.27689292604626, -76.51827741905026, -89.87577299566365, -81.68022633739041, -52.97627034393238, -38.92486437876044, -78.58911987325108, -48.31866430125684, -127.51784825747107, -51.80392226827515, -126.394528601146, -71.24982873539435, -58.33058782516306, -80.4991256923799, -98.50647874103994, -123.25027022630356, -83.46589172966162, -83.7306268927986, -123.85213630920659, -102.78948437592804, -66.41337767386243, -49.93032283063861, -71.03424226284676, -78.69723935066975, -67.08268279244938, -56.151419751585486, -203.92797221089745, -86.40391897813495, -61.79276753021809, -104.05242734317031, -96.11594980761471, -79.0576330420779, -124.97343339568744, -109.58432635471927, -64.88389388567195, -67.3299394205157, -48.78937430683286, -131.7071752506443, -108.86405688822381, -45.46565693314914, -123.79381773809101, -67.05658592302134, -99.39975799957475, -79.66371957622653, -67.30366028463956, -56.923607007388455, -89.42530225636357, -47.356175358668885, -62.38147862355654, -75.70125249364824, -52.69388734380571, -164.35588544758082, -45.82299923165204, -59.129153965240704, -87.95875175721665, -86.92600711407914, -72.87049587955103, -110.74578969525689, -68.41274499357048, -104.95529291424859, -159.52704744004257, -67.06648225688159, -80.40892156629069, -90.6757650488555, -90.35345434834277], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6077900351187937, "mean_inference_ms": 5.213397468637637, "mean_action_processing_ms": 0.1947555987833919, "mean_env_wait_ms": 1.3525501747842503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 1120000, "num_env_steps_trained": 1120000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1120000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 75822.986, "load_time_ms": 31.233, "load_throughput": 448250.335, "learn_time_ms": 68126.528, "learn_throughput": 205.5, "synch_weights_time_ms": 12.725}, "counters": {"num_env_steps_sampled": 1120000, "num_env_steps_trained": 1120000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "episodes_total": 1120, "training_iteration": 80, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-36-28", "timestamp": 1693056988, "time_this_iter_s": 75.27620196342468, "time_total_s": 6143.5402545928955, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270151E61F0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270152D1C40>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 6143.5402545928955, "timesteps_since_restore": 0, "iterations_since_restore": 80, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.70467289719626, "ram_util_percent": 51.450467289719626}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -247.48464975968002, "episode_L1_reward_sum_min": -598.8038388490677, "episode_L1_reward_sum_max": -164.6559081748128, "episode_L2_reward_sum_mean": -138.90691071882844, "episode_L2_reward_sum_min": -222.9019753932953, "episode_L2_reward_sum_max": -117.44678499549627}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.1469576386313257, "policy_loss": 0.12173501951734961, "vf_loss": 0.25222618939295166, "vf_explained_var": 0.7347525765375836, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000}, "sampler_results": {"episode_reward_max": -38.92486437876044, "episode_reward_min": -203.92797221089745, "episode_reward_mean": -84.7090238301267, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -247.48464975968002, "episode_L1_reward_sum_min": -598.8038388490677, "episode_L1_reward_sum_max": -164.6559081748128, "episode_L2_reward_sum_mean": -138.90691071882844, "episode_L2_reward_sum_min": -222.9019753932953, "episode_L2_reward_sum_max": -117.44678499549627}, "hist_stats": {"episode_reward": [-78.50471200661957, -92.98477598880986, -144.97945388703772, -76.67702744610202, -75.01986410377054, -68.16623286020062, -55.76675437987526, -55.817967093979675, -66.91207238818404, -84.66177236551492, -53.05239546933123, -91.01846254856643, -89.22573937767002, -170.52279506044485, -94.91293173825787, -69.69100124754144, -53.014624483201715, -145.07929135748802, -56.6713378966996, -52.78384199128386, -86.55885843841835, -56.27689292604626, -76.51827741905026, -89.87577299566365, -81.68022633739041, -52.97627034393238, -38.92486437876044, -78.58911987325108, -48.31866430125684, -127.51784825747107, -51.80392226827515, -126.394528601146, -71.24982873539435, -58.33058782516306, -80.4991256923799, -98.50647874103994, -123.25027022630356, -83.46589172966162, -83.7306268927986, -123.85213630920659, -102.78948437592804, -66.41337767386243, -49.93032283063861, -71.03424226284676, -78.69723935066975, -67.08268279244938, -56.151419751585486, -203.92797221089745, -86.40391897813495, -61.79276753021809, -104.05242734317031, -96.11594980761471, -79.0576330420779, -124.97343339568744, -109.58432635471927, -64.88389388567195, -67.3299394205157, -48.78937430683286, -131.7071752506443, -108.86405688822381, -45.46565693314914, -123.79381773809101, -67.05658592302134, -99.39975799957475, -79.66371957622653, -67.30366028463956, -56.923607007388455, -89.42530225636357, -47.356175358668885, -62.38147862355654, -75.70125249364824, -52.69388734380571, -164.35588544758082, -45.82299923165204, -59.129153965240704, -87.95875175721665, -86.92600711407914, -72.87049587955103, -110.74578969525689, -68.41274499357048, -104.95529291424859, -159.52704744004257, -67.06648225688159, -80.40892156629069, -90.6757650488555, -90.35345434834277, -82.70614907689081, -76.80618131154007, -59.50405101796044, -74.0173608143992, -114.09033686505798, -160.60385353382432, -78.46037385110824, -57.95268037949256, -112.55669926734011, -51.1723072856335, -62.83558437193767, -67.45784658799388, -125.08929414556597, -97.91108787140523], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6076367958410862, "mean_inference_ms": 5.21294414511171, "mean_action_processing_ms": 0.19474217282940492, "mean_env_wait_ms": 1.3524556955469098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -38.92486437876044, "episode_reward_min": -203.92797221089745, "episode_reward_mean": -84.7090238301267, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-78.50471200661957, -92.98477598880986, -144.97945388703772, -76.67702744610202, -75.01986410377054, -68.16623286020062, -55.76675437987526, -55.817967093979675, -66.91207238818404, -84.66177236551492, -53.05239546933123, -91.01846254856643, -89.22573937767002, -170.52279506044485, -94.91293173825787, -69.69100124754144, -53.014624483201715, -145.07929135748802, -56.6713378966996, -52.78384199128386, -86.55885843841835, -56.27689292604626, -76.51827741905026, -89.87577299566365, -81.68022633739041, -52.97627034393238, -38.92486437876044, -78.58911987325108, -48.31866430125684, -127.51784825747107, -51.80392226827515, -126.394528601146, -71.24982873539435, -58.33058782516306, -80.4991256923799, -98.50647874103994, -123.25027022630356, -83.46589172966162, -83.7306268927986, -123.85213630920659, -102.78948437592804, -66.41337767386243, -49.93032283063861, -71.03424226284676, -78.69723935066975, -67.08268279244938, -56.151419751585486, -203.92797221089745, -86.40391897813495, -61.79276753021809, -104.05242734317031, -96.11594980761471, -79.0576330420779, -124.97343339568744, -109.58432635471927, -64.88389388567195, -67.3299394205157, -48.78937430683286, -131.7071752506443, -108.86405688822381, -45.46565693314914, -123.79381773809101, -67.05658592302134, -99.39975799957475, -79.66371957622653, -67.30366028463956, -56.923607007388455, -89.42530225636357, -47.356175358668885, -62.38147862355654, -75.70125249364824, -52.69388734380571, -164.35588544758082, -45.82299923165204, -59.129153965240704, -87.95875175721665, -86.92600711407914, -72.87049587955103, -110.74578969525689, -68.41274499357048, -104.95529291424859, -159.52704744004257, -67.06648225688159, -80.40892156629069, -90.6757650488555, -90.35345434834277, -82.70614907689081, -76.80618131154007, -59.50405101796044, -74.0173608143992, -114.09033686505798, -160.60385353382432, -78.46037385110824, -57.95268037949256, -112.55669926734011, -51.1723072856335, -62.83558437193767, -67.45784658799388, -125.08929414556597, -97.91108787140523], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6076367958410862, "mean_inference_ms": 5.21294414511171, "mean_action_processing_ms": 0.19474217282940492, "mean_env_wait_ms": 1.3524556955469098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000, "num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1134000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1134000, "timers": {"training_iteration_time_ms": 75570.503, "load_time_ms": 30.933, "load_throughput": 452585.522, "learn_time_ms": 67964.182, "learn_throughput": 205.991, "synch_weights_time_ms": 12.841}, "counters": {"num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000}, "done": false, "episodes_total": 1134, "training_iteration": 81, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-37-44", "timestamp": 1693057064, "time_this_iter_s": 75.26142978668213, "time_total_s": 6218.801684379578, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270152D1AF0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015204160>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 6218.801684379578, "timesteps_since_restore": 0, "iterations_since_restore": 81, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.858490566037737, "ram_util_percent": 51.3867924528302}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -244.14443818502127, "episode_L1_reward_sum_min": -598.8038388490677, "episode_L1_reward_sum_max": -164.6559081748128, "episode_L2_reward_sum_mean": -138.04733956463636, "episode_L2_reward_sum_min": -222.9019753932953, "episode_L2_reward_sum_max": -117.44678499549627}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.16607622967011568, "policy_loss": 0.15041224982966994, "vf_loss": 0.15663981044088465, "vf_explained_var": 0.46258036844401695, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1148000, "num_env_steps_trained": 1148000, "num_agent_steps_sampled": 1148000, "num_agent_steps_trained": 1148000}, "sampler_results": {"episode_reward_max": -38.92486437876044, "episode_reward_min": -203.92797221089745, "episode_reward_mean": -83.22867373700328, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -244.14443818502127, "episode_L1_reward_sum_min": -598.8038388490677, "episode_L1_reward_sum_max": -164.6559081748128, "episode_L2_reward_sum_mean": -138.04733956463636, "episode_L2_reward_sum_min": -222.9019753932953, "episode_L2_reward_sum_max": -117.44678499549627}, "hist_stats": {"episode_reward": [-94.91293173825787, -69.69100124754144, -53.014624483201715, -145.07929135748802, -56.6713378966996, -52.78384199128386, -86.55885843841835, -56.27689292604626, -76.51827741905026, -89.87577299566365, -81.68022633739041, -52.97627034393238, -38.92486437876044, -78.58911987325108, -48.31866430125684, -127.51784825747107, -51.80392226827515, -126.394528601146, -71.24982873539435, -58.33058782516306, -80.4991256923799, -98.50647874103994, -123.25027022630356, -83.46589172966162, -83.7306268927986, -123.85213630920659, -102.78948437592804, -66.41337767386243, -49.93032283063861, -71.03424226284676, -78.69723935066975, -67.08268279244938, -56.151419751585486, -203.92797221089745, -86.40391897813495, -61.79276753021809, -104.05242734317031, -96.11594980761471, -79.0576330420779, -124.97343339568744, -109.58432635471927, -64.88389388567195, -67.3299394205157, -48.78937430683286, -131.7071752506443, -108.86405688822381, -45.46565693314914, -123.79381773809101, -67.05658592302134, -99.39975799957475, -79.66371957622653, -67.30366028463956, -56.923607007388455, -89.42530225636357, -47.356175358668885, -62.38147862355654, -75.70125249364824, -52.69388734380571, -164.35588544758082, -45.82299923165204, -59.129153965240704, -87.95875175721665, -86.92600711407914, -72.87049587955103, -110.74578969525689, -68.41274499357048, -104.95529291424859, -159.52704744004257, -67.06648225688159, -80.40892156629069, -90.6757650488555, -90.35345434834277, -82.70614907689081, -76.80618131154007, -59.50405101796044, -74.0173608143992, -114.09033686505798, -160.60385353382432, -78.46037385110824, -57.95268037949256, -112.55669926734011, -51.1723072856335, -62.83558437193767, -67.45784658799388, -125.08929414556597, -97.91108787140523, -78.95195283600042, -50.05988174322376, -67.43401703308167, -67.84113784847396, -70.84490215846525, -47.48403243881861, -68.12831295287695, -92.8378153870403, -89.93652367951492, -65.77250097464851, -87.81971324277346, -119.83307933557738, -72.82155827379086, -75.50958775947926], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6075032755748302, "mean_inference_ms": 5.212406922652958, "mean_action_processing_ms": 0.1947161971105421, "mean_env_wait_ms": 1.3523379186035123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -38.92486437876044, "episode_reward_min": -203.92797221089745, "episode_reward_mean": -83.22867373700328, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-94.91293173825787, -69.69100124754144, -53.014624483201715, -145.07929135748802, -56.6713378966996, -52.78384199128386, -86.55885843841835, -56.27689292604626, -76.51827741905026, -89.87577299566365, -81.68022633739041, -52.97627034393238, -38.92486437876044, -78.58911987325108, -48.31866430125684, -127.51784825747107, -51.80392226827515, -126.394528601146, -71.24982873539435, -58.33058782516306, -80.4991256923799, -98.50647874103994, -123.25027022630356, -83.46589172966162, -83.7306268927986, -123.85213630920659, -102.78948437592804, -66.41337767386243, -49.93032283063861, -71.03424226284676, -78.69723935066975, -67.08268279244938, -56.151419751585486, -203.92797221089745, -86.40391897813495, -61.79276753021809, -104.05242734317031, -96.11594980761471, -79.0576330420779, -124.97343339568744, -109.58432635471927, -64.88389388567195, -67.3299394205157, -48.78937430683286, -131.7071752506443, -108.86405688822381, -45.46565693314914, -123.79381773809101, -67.05658592302134, -99.39975799957475, -79.66371957622653, -67.30366028463956, -56.923607007388455, -89.42530225636357, -47.356175358668885, -62.38147862355654, -75.70125249364824, -52.69388734380571, -164.35588544758082, -45.82299923165204, -59.129153965240704, -87.95875175721665, -86.92600711407914, -72.87049587955103, -110.74578969525689, -68.41274499357048, -104.95529291424859, -159.52704744004257, -67.06648225688159, -80.40892156629069, -90.6757650488555, -90.35345434834277, -82.70614907689081, -76.80618131154007, -59.50405101796044, -74.0173608143992, -114.09033686505798, -160.60385353382432, -78.46037385110824, -57.95268037949256, -112.55669926734011, -51.1723072856335, -62.83558437193767, -67.45784658799388, -125.08929414556597, -97.91108787140523, -78.95195283600042, -50.05988174322376, -67.43401703308167, -67.84113784847396, -70.84490215846525, -47.48403243881861, -68.12831295287695, -92.8378153870403, -89.93652367951492, -65.77250097464851, -87.81971324277346, -119.83307933557738, -72.82155827379086, -75.50958775947926], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6075032755748302, "mean_inference_ms": 5.212406922652958, "mean_action_processing_ms": 0.1947161971105421, "mean_env_wait_ms": 1.3523379186035123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1148000, "num_agent_steps_trained": 1148000, "num_env_steps_sampled": 1148000, "num_env_steps_trained": 1148000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1148000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1148000, "timers": {"training_iteration_time_ms": 75538.653, "load_time_ms": 29.936, "load_throughput": 467669.135, "learn_time_ms": 67941.59, "learn_throughput": 206.059, "synch_weights_time_ms": 12.618}, "counters": {"num_env_steps_sampled": 1148000, "num_env_steps_trained": 1148000, "num_agent_steps_sampled": 1148000, "num_agent_steps_trained": 1148000}, "done": false, "episodes_total": 1148, "training_iteration": 82, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-38-59", "timestamp": 1693057139, "time_this_iter_s": 75.43411326408386, "time_total_s": 6294.2357976436615, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015443A00>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701535E190>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 6294.2357976436615, "timesteps_since_restore": 0, "iterations_since_restore": 82, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.79532710280374, "ram_util_percent": 50.64953271028037}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -248.38028719246387, "episode_L1_reward_sum_min": -598.8038388490677, "episode_L1_reward_sum_max": -164.6559081748128, "episode_L2_reward_sum_mean": -139.15010935261844, "episode_L2_reward_sum_min": -222.9019753932953, "episode_L2_reward_sum_max": -117.44678499549627}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.09722189427930249, "policy_loss": 0.07559377443114365, "vf_loss": 0.2162811993264082, "vf_explained_var": 0.7317053595626796, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1162000, "num_env_steps_trained": 1162000, "num_agent_steps_sampled": 1162000, "num_agent_steps_trained": 1162000}, "sampler_results": {"episode_reward_max": -40.40281809247618, "episode_reward_min": -203.92797221089745, "episode_reward_mean": -85.06885032668204, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -248.38028719246387, "episode_L1_reward_sum_min": -598.8038388490677, "episode_L1_reward_sum_max": -164.6559081748128, "episode_L2_reward_sum_mean": -139.15010935261844, "episode_L2_reward_sum_min": -222.9019753932953, "episode_L2_reward_sum_max": -117.44678499549627}, "hist_stats": {"episode_reward": [-48.31866430125684, -127.51784825747107, -51.80392226827515, -126.394528601146, -71.24982873539435, -58.33058782516306, -80.4991256923799, -98.50647874103994, -123.25027022630356, -83.46589172966162, -83.7306268927986, -123.85213630920659, -102.78948437592804, -66.41337767386243, -49.93032283063861, -71.03424226284676, -78.69723935066975, -67.08268279244938, -56.151419751585486, -203.92797221089745, -86.40391897813495, -61.79276753021809, -104.05242734317031, -96.11594980761471, -79.0576330420779, -124.97343339568744, -109.58432635471927, -64.88389388567195, -67.3299394205157, -48.78937430683286, -131.7071752506443, -108.86405688822381, -45.46565693314914, -123.79381773809101, -67.05658592302134, -99.39975799957475, -79.66371957622653, -67.30366028463956, -56.923607007388455, -89.42530225636357, -47.356175358668885, -62.38147862355654, -75.70125249364824, -52.69388734380571, -164.35588544758082, -45.82299923165204, -59.129153965240704, -87.95875175721665, -86.92600711407914, -72.87049587955103, -110.74578969525689, -68.41274499357048, -104.95529291424859, -159.52704744004257, -67.06648225688159, -80.40892156629069, -90.6757650488555, -90.35345434834277, -82.70614907689081, -76.80618131154007, -59.50405101796044, -74.0173608143992, -114.09033686505798, -160.60385353382432, -78.46037385110824, -57.95268037949256, -112.55669926734011, -51.1723072856335, -62.83558437193767, -67.45784658799388, -125.08929414556597, -97.91108787140523, -78.95195283600042, -50.05988174322376, -67.43401703308167, -67.84113784847396, -70.84490215846525, -47.48403243881861, -68.12831295287695, -92.8378153870403, -89.93652367951492, -65.77250097464851, -87.81971324277346, -119.83307933557738, -72.82155827379086, -75.50958775947926, -125.3678615576118, -79.9227080675466, -84.3299851646974, -100.03358159534147, -65.21429955444673, -100.55095606530513, -142.08156763733408, -73.35058126905543, -78.9051932354346, -111.82866177247253, -40.40281809247618, -62.89315614982887, -60.97249315673915, -91.71710707656945], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6073511705146839, "mean_inference_ms": 5.211955186465781, "mean_action_processing_ms": 0.1946897161482422, "mean_env_wait_ms": 1.3522554600862196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -40.40281809247618, "episode_reward_min": -203.92797221089745, "episode_reward_mean": -85.06885032668204, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.31866430125684, -127.51784825747107, -51.80392226827515, -126.394528601146, -71.24982873539435, -58.33058782516306, -80.4991256923799, -98.50647874103994, -123.25027022630356, -83.46589172966162, -83.7306268927986, -123.85213630920659, -102.78948437592804, -66.41337767386243, -49.93032283063861, -71.03424226284676, -78.69723935066975, -67.08268279244938, -56.151419751585486, -203.92797221089745, -86.40391897813495, -61.79276753021809, -104.05242734317031, -96.11594980761471, -79.0576330420779, -124.97343339568744, -109.58432635471927, -64.88389388567195, -67.3299394205157, -48.78937430683286, -131.7071752506443, -108.86405688822381, -45.46565693314914, -123.79381773809101, -67.05658592302134, -99.39975799957475, -79.66371957622653, -67.30366028463956, -56.923607007388455, -89.42530225636357, -47.356175358668885, -62.38147862355654, -75.70125249364824, -52.69388734380571, -164.35588544758082, -45.82299923165204, -59.129153965240704, -87.95875175721665, -86.92600711407914, -72.87049587955103, -110.74578969525689, -68.41274499357048, -104.95529291424859, -159.52704744004257, -67.06648225688159, -80.40892156629069, -90.6757650488555, -90.35345434834277, -82.70614907689081, -76.80618131154007, -59.50405101796044, -74.0173608143992, -114.09033686505798, -160.60385353382432, -78.46037385110824, -57.95268037949256, -112.55669926734011, -51.1723072856335, -62.83558437193767, -67.45784658799388, -125.08929414556597, -97.91108787140523, -78.95195283600042, -50.05988174322376, -67.43401703308167, -67.84113784847396, -70.84490215846525, -47.48403243881861, -68.12831295287695, -92.8378153870403, -89.93652367951492, -65.77250097464851, -87.81971324277346, -119.83307933557738, -72.82155827379086, -75.50958775947926, -125.3678615576118, -79.9227080675466, -84.3299851646974, -100.03358159534147, -65.21429955444673, -100.55095606530513, -142.08156763733408, -73.35058126905543, -78.9051932354346, -111.82866177247253, -40.40281809247618, -62.89315614982887, -60.97249315673915, -91.71710707656945], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6073511705146839, "mean_inference_ms": 5.211955186465781, "mean_action_processing_ms": 0.1946897161482422, "mean_env_wait_ms": 1.3522554600862196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1162000, "num_agent_steps_trained": 1162000, "num_env_steps_sampled": 1162000, "num_env_steps_trained": 1162000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1162000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1162000, "timers": {"training_iteration_time_ms": 75409.407, "load_time_ms": 29.933, "load_throughput": 467718.306, "learn_time_ms": 67815.232, "learn_throughput": 206.443, "synch_weights_time_ms": 13.035}, "counters": {"num_env_steps_sampled": 1162000, "num_env_steps_trained": 1162000, "num_agent_steps_sampled": 1162000, "num_agent_steps_trained": 1162000}, "done": false, "episodes_total": 1162, "training_iteration": 83, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-40-14", "timestamp": 1693057214, "time_this_iter_s": 75.21051621437073, "time_total_s": 6369.446313858032, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701534D070>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701545E1F0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 6369.446313858032, "timesteps_since_restore": 0, "iterations_since_restore": 83, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.85377358490566, "ram_util_percent": 50.55188679245285}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -249.96663661777973, "episode_L1_reward_sum_min": -598.8038388490677, "episode_L1_reward_sum_max": -164.6559081748128, "episode_L2_reward_sum_mean": -139.53210424162447, "episode_L2_reward_sum_min": -222.9019753932953, "episode_L2_reward_sum_max": -117.44678499549627}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.08920319453686659, "policy_loss": 0.06466467923737694, "vf_loss": 0.24538513280484153, "vf_explained_var": 0.73603436780074, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "sampler_results": {"episode_reward_max": -39.72080600986414, "episode_reward_min": -203.92797221089745, "episode_reward_mean": -85.30333007466388, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -249.96663661777973, "episode_L1_reward_sum_min": -598.8038388490677, "episode_L1_reward_sum_max": -164.6559081748128, "episode_L2_reward_sum_mean": -139.53210424162447, "episode_L2_reward_sum_min": -222.9019753932953, "episode_L2_reward_sum_max": -117.44678499549627}, "hist_stats": {"episode_reward": [-49.93032283063861, -71.03424226284676, -78.69723935066975, -67.08268279244938, -56.151419751585486, -203.92797221089745, -86.40391897813495, -61.79276753021809, -104.05242734317031, -96.11594980761471, -79.0576330420779, -124.97343339568744, -109.58432635471927, -64.88389388567195, -67.3299394205157, -48.78937430683286, -131.7071752506443, -108.86405688822381, -45.46565693314914, -123.79381773809101, -67.05658592302134, -99.39975799957475, -79.66371957622653, -67.30366028463956, -56.923607007388455, -89.42530225636357, -47.356175358668885, -62.38147862355654, -75.70125249364824, -52.69388734380571, -164.35588544758082, -45.82299923165204, -59.129153965240704, -87.95875175721665, -86.92600711407914, -72.87049587955103, -110.74578969525689, -68.41274499357048, -104.95529291424859, -159.52704744004257, -67.06648225688159, -80.40892156629069, -90.6757650488555, -90.35345434834277, -82.70614907689081, -76.80618131154007, -59.50405101796044, -74.0173608143992, -114.09033686505798, -160.60385353382432, -78.46037385110824, -57.95268037949256, -112.55669926734011, -51.1723072856335, -62.83558437193767, -67.45784658799388, -125.08929414556597, -97.91108787140523, -78.95195283600042, -50.05988174322376, -67.43401703308167, -67.84113784847396, -70.84490215846525, -47.48403243881861, -68.12831295287695, -92.8378153870403, -89.93652367951492, -65.77250097464851, -87.81971324277346, -119.83307933557738, -72.82155827379086, -75.50958775947926, -125.3678615576118, -79.9227080675466, -84.3299851646974, -100.03358159534147, -65.21429955444673, -100.55095606530513, -142.08156763733408, -73.35058126905543, -78.9051932354346, -111.82866177247253, -40.40281809247618, -62.89315614982887, -60.97249315673915, -91.71710707656945, -55.832611534271585, -140.31381779545205, -94.89392769968535, -122.43983947853172, -39.72080600986414, -104.95944826134532, -84.45472655000496, -76.36241678091764, -125.25922415146258, -111.28256328052248, -78.62701476828586, -89.16323468751068, -93.2621310494612, -52.998984380755175], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.607217635098554, "mean_inference_ms": 5.21163890091669, "mean_action_processing_ms": 0.19464968006930503, "mean_env_wait_ms": 1.3522224146211987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -39.72080600986414, "episode_reward_min": -203.92797221089745, "episode_reward_mean": -85.30333007466388, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-49.93032283063861, -71.03424226284676, -78.69723935066975, -67.08268279244938, -56.151419751585486, -203.92797221089745, -86.40391897813495, -61.79276753021809, -104.05242734317031, -96.11594980761471, -79.0576330420779, -124.97343339568744, -109.58432635471927, -64.88389388567195, -67.3299394205157, -48.78937430683286, -131.7071752506443, -108.86405688822381, -45.46565693314914, -123.79381773809101, -67.05658592302134, -99.39975799957475, -79.66371957622653, -67.30366028463956, -56.923607007388455, -89.42530225636357, -47.356175358668885, -62.38147862355654, -75.70125249364824, -52.69388734380571, -164.35588544758082, -45.82299923165204, -59.129153965240704, -87.95875175721665, -86.92600711407914, -72.87049587955103, -110.74578969525689, -68.41274499357048, -104.95529291424859, -159.52704744004257, -67.06648225688159, -80.40892156629069, -90.6757650488555, -90.35345434834277, -82.70614907689081, -76.80618131154007, -59.50405101796044, -74.0173608143992, -114.09033686505798, -160.60385353382432, -78.46037385110824, -57.95268037949256, -112.55669926734011, -51.1723072856335, -62.83558437193767, -67.45784658799388, -125.08929414556597, -97.91108787140523, -78.95195283600042, -50.05988174322376, -67.43401703308167, -67.84113784847396, -70.84490215846525, -47.48403243881861, -68.12831295287695, -92.8378153870403, -89.93652367951492, -65.77250097464851, -87.81971324277346, -119.83307933557738, -72.82155827379086, -75.50958775947926, -125.3678615576118, -79.9227080675466, -84.3299851646974, -100.03358159534147, -65.21429955444673, -100.55095606530513, -142.08156763733408, -73.35058126905543, -78.9051932354346, -111.82866177247253, -40.40281809247618, -62.89315614982887, -60.97249315673915, -91.71710707656945, -55.832611534271585, -140.31381779545205, -94.89392769968535, -122.43983947853172, -39.72080600986414, -104.95944826134532, -84.45472655000496, -76.36241678091764, -125.25922415146258, -111.28256328052248, -78.62701476828586, -89.16323468751068, -93.2621310494612, -52.998984380755175], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.607217635098554, "mean_inference_ms": 5.21163890091669, "mean_action_processing_ms": 0.19464968006930503, "mean_env_wait_ms": 1.3522224146211987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1176000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1176000, "timers": {"training_iteration_time_ms": 75281.324, "load_time_ms": 29.689, "load_throughput": 471554.71, "learn_time_ms": 67683.213, "learn_throughput": 206.846, "synch_weights_time_ms": 12.435}, "counters": {"num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "done": false, "episodes_total": 1176, "training_iteration": 84, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-41-30", "timestamp": 1693057290, "time_this_iter_s": 75.12652277946472, "time_total_s": 6444.572836637497, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015359BB0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270154E91F0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 6444.572836637497, "timesteps_since_restore": 0, "iterations_since_restore": 84, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.753773584905666, "ram_util_percent": 50.5801886792453}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -244.78570353597402, "episode_L1_reward_sum_min": -490.79831613600254, "episode_L1_reward_sum_max": -158.01488749682903, "episode_L2_reward_sum_mean": -138.23923099681735, "episode_L2_reward_sum_min": -199.45562352240086, "episode_L2_reward_sum_max": -115.81345360726118}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.09993354695510893, "policy_loss": 0.07740938208744298, "vf_loss": 0.22524164941626573, "vf_explained_var": 0.6673483411041797, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1190000, "num_env_steps_trained": 1190000, "num_agent_steps_sampled": 1190000, "num_agent_steps_trained": 1190000}, "sampler_results": {"episode_reward_max": -39.72080600986414, "episode_reward_min": -178.91008722547969, "episode_reward_mean": -84.91942870414154, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -244.78570353597402, "episode_L1_reward_sum_min": -490.79831613600254, "episode_L1_reward_sum_max": -158.01488749682903, "episode_L2_reward_sum_mean": -138.23923099681735, "episode_L2_reward_sum_min": -199.45562352240086, "episode_L2_reward_sum_max": -115.81345360726118}, "hist_stats": {"episode_reward": [-67.3299394205157, -48.78937430683286, -131.7071752506443, -108.86405688822381, -45.46565693314914, -123.79381773809101, -67.05658592302134, -99.39975799957475, -79.66371957622653, -67.30366028463956, -56.923607007388455, -89.42530225636357, -47.356175358668885, -62.38147862355654, -75.70125249364824, -52.69388734380571, -164.35588544758082, -45.82299923165204, -59.129153965240704, -87.95875175721665, -86.92600711407914, -72.87049587955103, -110.74578969525689, -68.41274499357048, -104.95529291424859, -159.52704744004257, -67.06648225688159, -80.40892156629069, -90.6757650488555, -90.35345434834277, -82.70614907689081, -76.80618131154007, -59.50405101796044, -74.0173608143992, -114.09033686505798, -160.60385353382432, -78.46037385110824, -57.95268037949256, -112.55669926734011, -51.1723072856335, -62.83558437193767, -67.45784658799388, -125.08929414556597, -97.91108787140523, -78.95195283600042, -50.05988174322376, -67.43401703308167, -67.84113784847396, -70.84490215846525, -47.48403243881861, -68.12831295287695, -92.8378153870403, -89.93652367951492, -65.77250097464851, -87.81971324277346, -119.83307933557738, -72.82155827379086, -75.50958775947926, -125.3678615576118, -79.9227080675466, -84.3299851646974, -100.03358159534147, -65.21429955444673, -100.55095606530513, -142.08156763733408, -73.35058126905543, -78.9051932354346, -111.82866177247253, -40.40281809247618, -62.89315614982887, -60.97249315673915, -91.71710707656945, -55.832611534271585, -140.31381779545205, -94.89392769968535, -122.43983947853172, -39.72080600986414, -104.95944826134532, -84.45472655000496, -76.36241678091764, -125.25922415146258, -111.28256328052248, -78.62701476828586, -89.16323468751068, -93.2621310494612, -52.998984380755175, -52.50957801052798, -75.09044940089314, -83.31576136185262, -121.12305758446008, -178.91008722547969, -83.0220317709339, -70.95056563046418, -136.3377846148248, -45.191477484566335, -96.53279582028071, -54.97770107639048, -66.3843148394209, -86.08069230695375, -64.8717953570993], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6070980083841669, "mean_inference_ms": 5.2113747378755715, "mean_action_processing_ms": 0.19459762243985382, "mean_env_wait_ms": 1.3521989809280128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -39.72080600986414, "episode_reward_min": -178.91008722547969, "episode_reward_mean": -84.91942870414154, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-67.3299394205157, -48.78937430683286, -131.7071752506443, -108.86405688822381, -45.46565693314914, -123.79381773809101, -67.05658592302134, -99.39975799957475, -79.66371957622653, -67.30366028463956, -56.923607007388455, -89.42530225636357, -47.356175358668885, -62.38147862355654, -75.70125249364824, -52.69388734380571, -164.35588544758082, -45.82299923165204, -59.129153965240704, -87.95875175721665, -86.92600711407914, -72.87049587955103, -110.74578969525689, -68.41274499357048, -104.95529291424859, -159.52704744004257, -67.06648225688159, -80.40892156629069, -90.6757650488555, -90.35345434834277, -82.70614907689081, -76.80618131154007, -59.50405101796044, -74.0173608143992, -114.09033686505798, -160.60385353382432, -78.46037385110824, -57.95268037949256, -112.55669926734011, -51.1723072856335, -62.83558437193767, -67.45784658799388, -125.08929414556597, -97.91108787140523, -78.95195283600042, -50.05988174322376, -67.43401703308167, -67.84113784847396, -70.84490215846525, -47.48403243881861, -68.12831295287695, -92.8378153870403, -89.93652367951492, -65.77250097464851, -87.81971324277346, -119.83307933557738, -72.82155827379086, -75.50958775947926, -125.3678615576118, -79.9227080675466, -84.3299851646974, -100.03358159534147, -65.21429955444673, -100.55095606530513, -142.08156763733408, -73.35058126905543, -78.9051932354346, -111.82866177247253, -40.40281809247618, -62.89315614982887, -60.97249315673915, -91.71710707656945, -55.832611534271585, -140.31381779545205, -94.89392769968535, -122.43983947853172, -39.72080600986414, -104.95944826134532, -84.45472655000496, -76.36241678091764, -125.25922415146258, -111.28256328052248, -78.62701476828586, -89.16323468751068, -93.2621310494612, -52.998984380755175, -52.50957801052798, -75.09044940089314, -83.31576136185262, -121.12305758446008, -178.91008722547969, -83.0220317709339, -70.95056563046418, -136.3377846148248, -45.191477484566335, -96.53279582028071, -54.97770107639048, -66.3843148394209, -86.08069230695375, -64.8717953570993], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6070980083841669, "mean_inference_ms": 5.2113747378755715, "mean_action_processing_ms": 0.19459762243985382, "mean_env_wait_ms": 1.3521989809280128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1190000, "num_agent_steps_trained": 1190000, "num_env_steps_sampled": 1190000, "num_env_steps_trained": 1190000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1190000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1190000, "timers": {"training_iteration_time_ms": 75269.82, "load_time_ms": 29.5, "load_throughput": 474569.628, "learn_time_ms": 67683.966, "learn_throughput": 206.844, "synch_weights_time_ms": 12.83}, "counters": {"num_env_steps_sampled": 1190000, "num_env_steps_trained": 1190000, "num_agent_steps_sampled": 1190000, "num_agent_steps_trained": 1190000}, "done": false, "episodes_total": 1190, "training_iteration": 85, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-42-45", "timestamp": 1693057365, "time_this_iter_s": 75.31082606315613, "time_total_s": 6519.883662700653, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015464820>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150EF940>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 6519.883662700653, "timesteps_since_restore": 0, "iterations_since_restore": 85, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.761682242990656, "ram_util_percent": 50.60467289719627}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -248.42244356557728, "episode_L1_reward_sum_min": -490.79831613600254, "episode_L1_reward_sum_max": -158.01488749682903, "episode_L2_reward_sum_mean": -139.09650267824532, "episode_L2_reward_sum_min": -199.45562352240086, "episode_L2_reward_sum_max": -115.81345360726118}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.12747457469482965, "policy_loss": 0.10650384446381833, "vf_loss": 0.20970728409555148, "vf_explained_var": 0.6297977135014632, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1204000, "num_env_steps_trained": 1204000, "num_agent_steps_sampled": 1204000, "num_agent_steps_trained": 1204000}, "sampler_results": {"episode_reward_max": -39.0671682009454, "episode_reward_min": -178.91008722547969, "episode_reward_mean": -85.6021619317765, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -248.42244356557728, "episode_L1_reward_sum_min": -490.79831613600254, "episode_L1_reward_sum_max": -158.01488749682903, "episode_L2_reward_sum_mean": -139.09650267824532, "episode_L2_reward_sum_min": -199.45562352240086, "episode_L2_reward_sum_max": -115.81345360726118}, "hist_stats": {"episode_reward": [-75.70125249364824, -52.69388734380571, -164.35588544758082, -45.82299923165204, -59.129153965240704, -87.95875175721665, -86.92600711407914, -72.87049587955103, -110.74578969525689, -68.41274499357048, -104.95529291424859, -159.52704744004257, -67.06648225688159, -80.40892156629069, -90.6757650488555, -90.35345434834277, -82.70614907689081, -76.80618131154007, -59.50405101796044, -74.0173608143992, -114.09033686505798, -160.60385353382432, -78.46037385110824, -57.95268037949256, -112.55669926734011, -51.1723072856335, -62.83558437193767, -67.45784658799388, -125.08929414556597, -97.91108787140523, -78.95195283600042, -50.05988174322376, -67.43401703308167, -67.84113784847396, -70.84490215846525, -47.48403243881861, -68.12831295287695, -92.8378153870403, -89.93652367951492, -65.77250097464851, -87.81971324277346, -119.83307933557738, -72.82155827379086, -75.50958775947926, -125.3678615576118, -79.9227080675466, -84.3299851646974, -100.03358159534147, -65.21429955444673, -100.55095606530513, -142.08156763733408, -73.35058126905543, -78.9051932354346, -111.82866177247253, -40.40281809247618, -62.89315614982887, -60.97249315673915, -91.71710707656945, -55.832611534271585, -140.31381779545205, -94.89392769968535, -122.43983947853172, -39.72080600986414, -104.95944826134532, -84.45472655000496, -76.36241678091764, -125.25922415146258, -111.28256328052248, -78.62701476828586, -89.16323468751068, -93.2621310494612, -52.998984380755175, -52.50957801052798, -75.09044940089314, -83.31576136185262, -121.12305758446008, -178.91008722547969, -83.0220317709339, -70.95056563046418, -136.3377846148248, -45.191477484566335, -96.53279582028071, -54.97770107639048, -66.3843148394209, -86.08069230695375, -64.8717953570993, -125.42494349531623, -48.731832237629725, -73.73481632544572, -39.0671682009454, -108.01557839124132, -45.47674197365777, -60.77138649943703, -60.36153090020509, -59.5028972527421, -160.10125452887505, -121.85815995826792, -56.46652719747951, -111.50667169008483, -92.71412167906337], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6070219532356614, "mean_inference_ms": 5.211192152414035, "mean_action_processing_ms": 0.1945355683580532, "mean_env_wait_ms": 1.3521958671983476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -39.0671682009454, "episode_reward_min": -178.91008722547969, "episode_reward_mean": -85.6021619317765, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-75.70125249364824, -52.69388734380571, -164.35588544758082, -45.82299923165204, -59.129153965240704, -87.95875175721665, -86.92600711407914, -72.87049587955103, -110.74578969525689, -68.41274499357048, -104.95529291424859, -159.52704744004257, -67.06648225688159, -80.40892156629069, -90.6757650488555, -90.35345434834277, -82.70614907689081, -76.80618131154007, -59.50405101796044, -74.0173608143992, -114.09033686505798, -160.60385353382432, -78.46037385110824, -57.95268037949256, -112.55669926734011, -51.1723072856335, -62.83558437193767, -67.45784658799388, -125.08929414556597, -97.91108787140523, -78.95195283600042, -50.05988174322376, -67.43401703308167, -67.84113784847396, -70.84490215846525, -47.48403243881861, -68.12831295287695, -92.8378153870403, -89.93652367951492, -65.77250097464851, -87.81971324277346, -119.83307933557738, -72.82155827379086, -75.50958775947926, -125.3678615576118, -79.9227080675466, -84.3299851646974, -100.03358159534147, -65.21429955444673, -100.55095606530513, -142.08156763733408, -73.35058126905543, -78.9051932354346, -111.82866177247253, -40.40281809247618, -62.89315614982887, -60.97249315673915, -91.71710707656945, -55.832611534271585, -140.31381779545205, -94.89392769968535, -122.43983947853172, -39.72080600986414, -104.95944826134532, -84.45472655000496, -76.36241678091764, -125.25922415146258, -111.28256328052248, -78.62701476828586, -89.16323468751068, -93.2621310494612, -52.998984380755175, -52.50957801052798, -75.09044940089314, -83.31576136185262, -121.12305758446008, -178.91008722547969, -83.0220317709339, -70.95056563046418, -136.3377846148248, -45.191477484566335, -96.53279582028071, -54.97770107639048, -66.3843148394209, -86.08069230695375, -64.8717953570993, -125.42494349531623, -48.731832237629725, -73.73481632544572, -39.0671682009454, -108.01557839124132, -45.47674197365777, -60.77138649943703, -60.36153090020509, -59.5028972527421, -160.10125452887505, -121.85815995826792, -56.46652719747951, -111.50667169008483, -92.71412167906337], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6070219532356614, "mean_inference_ms": 5.211192152414035, "mean_action_processing_ms": 0.1945355683580532, "mean_env_wait_ms": 1.3521958671983476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1204000, "num_agent_steps_trained": 1204000, "num_env_steps_sampled": 1204000, "num_env_steps_trained": 1204000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1204000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1204000, "timers": {"training_iteration_time_ms": 75312.169, "load_time_ms": 29.802, "load_throughput": 469760.545, "learn_time_ms": 67719.741, "learn_throughput": 206.734, "synch_weights_time_ms": 12.719}, "counters": {"num_env_steps_sampled": 1204000, "num_env_steps_trained": 1204000, "num_agent_steps_sampled": 1204000, "num_agent_steps_trained": 1204000}, "done": false, "episodes_total": 1204, "training_iteration": 86, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-44-01", "timestamp": 1693057441, "time_this_iter_s": 75.54021668434143, "time_total_s": 6595.4238793849945, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701522CD00>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014F036D0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 6595.4238793849945, "timesteps_since_restore": 0, "iterations_since_restore": 86, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 22.143925233644865, "ram_util_percent": 50.66728971962616}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -245.08307149030267, "episode_L1_reward_sum_min": -484.12222703546286, "episode_L1_reward_sum_max": -158.01488749682903, "episode_L2_reward_sum_mean": -138.25844290502368, "episode_L2_reward_sum_min": -198.64337842911482, "episode_L2_reward_sum_max": -115.632952041924}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.09587782260639892, "policy_loss": 0.071055282714083, "vf_loss": 0.24822539345812536, "vf_explained_var": 0.6731842297892021, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1218000, "num_env_steps_trained": 1218000, "num_agent_steps_sampled": 1218000, "num_agent_steps_trained": 1218000}, "sampler_results": {"episode_reward_max": -39.0671682009454, "episode_reward_min": -178.91008722547969, "episode_reward_mean": -85.59432164556398, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -245.08307149030267, "episode_L1_reward_sum_min": -484.12222703546286, "episode_L1_reward_sum_max": -158.01488749682903, "episode_L2_reward_sum_mean": -138.25844290502368, "episode_L2_reward_sum_min": -198.64337842911482, "episode_L2_reward_sum_max": -115.632952041924}, "hist_stats": {"episode_reward": [-90.6757650488555, -90.35345434834277, -82.70614907689081, -76.80618131154007, -59.50405101796044, -74.0173608143992, -114.09033686505798, -160.60385353382432, -78.46037385110824, -57.95268037949256, -112.55669926734011, -51.1723072856335, -62.83558437193767, -67.45784658799388, -125.08929414556597, -97.91108787140523, -78.95195283600042, -50.05988174322376, -67.43401703308167, -67.84113784847396, -70.84490215846525, -47.48403243881861, -68.12831295287695, -92.8378153870403, -89.93652367951492, -65.77250097464851, -87.81971324277346, -119.83307933557738, -72.82155827379086, -75.50958775947926, -125.3678615576118, -79.9227080675466, -84.3299851646974, -100.03358159534147, -65.21429955444673, -100.55095606530513, -142.08156763733408, -73.35058126905543, -78.9051932354346, -111.82866177247253, -40.40281809247618, -62.89315614982887, -60.97249315673915, -91.71710707656945, -55.832611534271585, -140.31381779545205, -94.89392769968535, -122.43983947853172, -39.72080600986414, -104.95944826134532, -84.45472655000496, -76.36241678091764, -125.25922415146258, -111.28256328052248, -78.62701476828586, -89.16323468751068, -93.2621310494612, -52.998984380755175, -52.50957801052798, -75.09044940089314, -83.31576136185262, -121.12305758446008, -178.91008722547969, -83.0220317709339, -70.95056563046418, -136.3377846148248, -45.191477484566335, -96.53279582028071, -54.97770107639048, -66.3843148394209, -86.08069230695375, -64.8717953570993, -125.42494349531623, -48.731832237629725, -73.73481632544572, -39.0671682009454, -108.01557839124132, -45.47674197365777, -60.77138649943703, -60.36153090020509, -59.5028972527421, -160.10125452887505, -121.85815995826792, -56.46652719747951, -111.50667169008483, -92.71412167906337, -67.13483555036156, -111.16332718663391, -97.13362363550243, -108.0880147577371, -47.26132142261647, -127.10843148334048, -59.12105184000916, -160.73788157585437, -56.24314392114272, -99.59564189238509, -81.67832238126321, -71.17330368916997, -65.33435269222285, -84.01743144957506], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6069777711831755, "mean_inference_ms": 5.211034345571745, "mean_action_processing_ms": 0.19446866644882488, "mean_env_wait_ms": 1.3521889003225709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -39.0671682009454, "episode_reward_min": -178.91008722547969, "episode_reward_mean": -85.59432164556398, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-90.6757650488555, -90.35345434834277, -82.70614907689081, -76.80618131154007, -59.50405101796044, -74.0173608143992, -114.09033686505798, -160.60385353382432, -78.46037385110824, -57.95268037949256, -112.55669926734011, -51.1723072856335, -62.83558437193767, -67.45784658799388, -125.08929414556597, -97.91108787140523, -78.95195283600042, -50.05988174322376, -67.43401703308167, -67.84113784847396, -70.84490215846525, -47.48403243881861, -68.12831295287695, -92.8378153870403, -89.93652367951492, -65.77250097464851, -87.81971324277346, -119.83307933557738, -72.82155827379086, -75.50958775947926, -125.3678615576118, -79.9227080675466, -84.3299851646974, -100.03358159534147, -65.21429955444673, -100.55095606530513, -142.08156763733408, -73.35058126905543, -78.9051932354346, -111.82866177247253, -40.40281809247618, -62.89315614982887, -60.97249315673915, -91.71710707656945, -55.832611534271585, -140.31381779545205, -94.89392769968535, -122.43983947853172, -39.72080600986414, -104.95944826134532, -84.45472655000496, -76.36241678091764, -125.25922415146258, -111.28256328052248, -78.62701476828586, -89.16323468751068, -93.2621310494612, -52.998984380755175, -52.50957801052798, -75.09044940089314, -83.31576136185262, -121.12305758446008, -178.91008722547969, -83.0220317709339, -70.95056563046418, -136.3377846148248, -45.191477484566335, -96.53279582028071, -54.97770107639048, -66.3843148394209, -86.08069230695375, -64.8717953570993, -125.42494349531623, -48.731832237629725, -73.73481632544572, -39.0671682009454, -108.01557839124132, -45.47674197365777, -60.77138649943703, -60.36153090020509, -59.5028972527421, -160.10125452887505, -121.85815995826792, -56.46652719747951, -111.50667169008483, -92.71412167906337, -67.13483555036156, -111.16332718663391, -97.13362363550243, -108.0880147577371, -47.26132142261647, -127.10843148334048, -59.12105184000916, -160.73788157585437, -56.24314392114272, -99.59564189238509, -81.67832238126321, -71.17330368916997, -65.33435269222285, -84.01743144957506], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6069777711831755, "mean_inference_ms": 5.211034345571745, "mean_action_processing_ms": 0.19446866644882488, "mean_env_wait_ms": 1.3521889003225709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1218000, "num_agent_steps_trained": 1218000, "num_env_steps_sampled": 1218000, "num_env_steps_trained": 1218000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1218000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1218000, "timers": {"training_iteration_time_ms": 75312.242, "load_time_ms": 29.396, "load_throughput": 476247.781, "learn_time_ms": 67707.592, "learn_throughput": 206.771, "synch_weights_time_ms": 13.655}, "counters": {"num_env_steps_sampled": 1218000, "num_env_steps_trained": 1218000, "num_agent_steps_sampled": 1218000, "num_agent_steps_trained": 1218000}, "done": false, "episodes_total": 1218, "training_iteration": 87, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-45-16", "timestamp": 1693057516, "time_this_iter_s": 75.29251432418823, "time_total_s": 6670.716393709183, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015350670>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701534D880>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 6670.716393709183, "timesteps_since_restore": 0, "iterations_since_restore": 87, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.677570093457945, "ram_util_percent": 50.68411214953271}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -244.89534429207444, "episode_L1_reward_sum_min": -484.12222703546286, "episode_L1_reward_sum_max": -158.01488749682903, "episode_L2_reward_sum_mean": -138.21926794357597, "episode_L2_reward_sum_min": -198.64337842911482, "episode_L2_reward_sum_max": -115.632952041924}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.09380632528504396, "policy_loss": 0.07184980126934264, "vf_loss": 0.21956525573332875, "vf_explained_var": 0.626768583807435, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1232000, "num_env_steps_trained": 1232000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "sampler_results": {"episode_reward_max": -39.0671682009454, "episode_reward_min": -178.91008722547969, "episode_reward_mean": -85.96250660070189, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -244.89534429207444, "episode_L1_reward_sum_min": -484.12222703546286, "episode_L1_reward_sum_max": -158.01488749682903, "episode_L2_reward_sum_mean": -138.21926794357597, "episode_L2_reward_sum_min": -198.64337842911482, "episode_L2_reward_sum_max": -115.632952041924}, "hist_stats": {"episode_reward": [-125.08929414556597, -97.91108787140523, -78.95195283600042, -50.05988174322376, -67.43401703308167, -67.84113784847396, -70.84490215846525, -47.48403243881861, -68.12831295287695, -92.8378153870403, -89.93652367951492, -65.77250097464851, -87.81971324277346, -119.83307933557738, -72.82155827379086, -75.50958775947926, -125.3678615576118, -79.9227080675466, -84.3299851646974, -100.03358159534147, -65.21429955444673, -100.55095606530513, -142.08156763733408, -73.35058126905543, -78.9051932354346, -111.82866177247253, -40.40281809247618, -62.89315614982887, -60.97249315673915, -91.71710707656945, -55.832611534271585, -140.31381779545205, -94.89392769968535, -122.43983947853172, -39.72080600986414, -104.95944826134532, -84.45472655000496, -76.36241678091764, -125.25922415146258, -111.28256328052248, -78.62701476828586, -89.16323468751068, -93.2621310494612, -52.998984380755175, -52.50957801052798, -75.09044940089314, -83.31576136185262, -121.12305758446008, -178.91008722547969, -83.0220317709339, -70.95056563046418, -136.3377846148248, -45.191477484566335, -96.53279582028071, -54.97770107639048, -66.3843148394209, -86.08069230695375, -64.8717953570993, -125.42494349531623, -48.731832237629725, -73.73481632544572, -39.0671682009454, -108.01557839124132, -45.47674197365777, -60.77138649943703, -60.36153090020509, -59.5028972527421, -160.10125452887505, -121.85815995826792, -56.46652719747951, -111.50667169008483, -92.71412167906337, -67.13483555036156, -111.16332718663391, -97.13362363550243, -108.0880147577371, -47.26132142261647, -127.10843148334048, -59.12105184000916, -160.73788157585437, -56.24314392114272, -99.59564189238509, -81.67832238126321, -71.17330368916997, -65.33435269222285, -84.01743144957506, -78.6044123977416, -95.53117973115721, -69.85456838818037, -67.02026138465219, -78.59178251809709, -77.29220646684362, -110.58066146295808, -69.08765171344726, -67.09696169853473, -122.0072064731479, -136.82481078208235, -39.082022681192505, -71.3934818594912, -133.0439317166423], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6069585710748412, "mean_inference_ms": 5.210952776870827, "mean_action_processing_ms": 0.19441615423313258, "mean_env_wait_ms": 1.3521977666961476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -39.0671682009454, "episode_reward_min": -178.91008722547969, "episode_reward_mean": -85.96250660070189, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-125.08929414556597, -97.91108787140523, -78.95195283600042, -50.05988174322376, -67.43401703308167, -67.84113784847396, -70.84490215846525, -47.48403243881861, -68.12831295287695, -92.8378153870403, -89.93652367951492, -65.77250097464851, -87.81971324277346, -119.83307933557738, -72.82155827379086, -75.50958775947926, -125.3678615576118, -79.9227080675466, -84.3299851646974, -100.03358159534147, -65.21429955444673, -100.55095606530513, -142.08156763733408, -73.35058126905543, -78.9051932354346, -111.82866177247253, -40.40281809247618, -62.89315614982887, -60.97249315673915, -91.71710707656945, -55.832611534271585, -140.31381779545205, -94.89392769968535, -122.43983947853172, -39.72080600986414, -104.95944826134532, -84.45472655000496, -76.36241678091764, -125.25922415146258, -111.28256328052248, -78.62701476828586, -89.16323468751068, -93.2621310494612, -52.998984380755175, -52.50957801052798, -75.09044940089314, -83.31576136185262, -121.12305758446008, -178.91008722547969, -83.0220317709339, -70.95056563046418, -136.3377846148248, -45.191477484566335, -96.53279582028071, -54.97770107639048, -66.3843148394209, -86.08069230695375, -64.8717953570993, -125.42494349531623, -48.731832237629725, -73.73481632544572, -39.0671682009454, -108.01557839124132, -45.47674197365777, -60.77138649943703, -60.36153090020509, -59.5028972527421, -160.10125452887505, -121.85815995826792, -56.46652719747951, -111.50667169008483, -92.71412167906337, -67.13483555036156, -111.16332718663391, -97.13362363550243, -108.0880147577371, -47.26132142261647, -127.10843148334048, -59.12105184000916, -160.73788157585437, -56.24314392114272, -99.59564189238509, -81.67832238126321, -71.17330368916997, -65.33435269222285, -84.01743144957506, -78.6044123977416, -95.53117973115721, -69.85456838818037, -67.02026138465219, -78.59178251809709, -77.29220646684362, -110.58066146295808, -69.08765171344726, -67.09696169853473, -122.0072064731479, -136.82481078208235, -39.082022681192505, -71.3934818594912, -133.0439317166423], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6069585710748412, "mean_inference_ms": 5.210952776870827, "mean_action_processing_ms": 0.19441615423313258, "mean_env_wait_ms": 1.3521977666961476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 1232000, "num_env_steps_trained": 1232000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1232000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 75274.933, "load_time_ms": 28.997, "load_throughput": 482800.361, "learn_time_ms": 67671.215, "learn_throughput": 206.883, "synch_weights_time_ms": 13.767}, "counters": {"num_env_steps_sampled": 1232000, "num_env_steps_trained": 1232000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "episodes_total": 1232, "training_iteration": 88, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-46-31", "timestamp": 1693057591, "time_this_iter_s": 75.16866946220398, "time_total_s": 6745.885063171387, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014F1BEB0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014F64CA0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 6745.885063171387, "timesteps_since_restore": 0, "iterations_since_restore": 88, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.678301886792454, "ram_util_percent": 50.6688679245283}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -254.06706840261816, "episode_L1_reward_sum_min": -555.3775699436665, "episode_L1_reward_sum_max": -158.01488749682903, "episode_L2_reward_sum_mean": -140.57375476054847, "episode_L2_reward_sum_min": -217.55130930244923, "episode_L2_reward_sum_max": -115.632952041924}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.09265756504725159, "policy_loss": 0.05896864760544442, "vf_loss": 0.33688917251218364, "vf_explained_var": 0.8243804698802316, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1246000, "num_env_steps_trained": 1246000, "num_agent_steps_sampled": 1246000, "num_agent_steps_trained": 1246000}, "sampler_results": {"episode_reward_max": -39.0671682009454, "episode_reward_min": -208.48046822803823, "episode_reward_mean": -90.09390137089783, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -254.06706840261816, "episode_L1_reward_sum_min": -555.3775699436665, "episode_L1_reward_sum_max": -158.01488749682903, "episode_L2_reward_sum_mean": -140.57375476054847, "episode_L2_reward_sum_min": -217.55130930244923, "episode_L2_reward_sum_max": -115.632952041924}, "hist_stats": {"episode_reward": [-72.82155827379086, -75.50958775947926, -125.3678615576118, -79.9227080675466, -84.3299851646974, -100.03358159534147, -65.21429955444673, -100.55095606530513, -142.08156763733408, -73.35058126905543, -78.9051932354346, -111.82866177247253, -40.40281809247618, -62.89315614982887, -60.97249315673915, -91.71710707656945, -55.832611534271585, -140.31381779545205, -94.89392769968535, -122.43983947853172, -39.72080600986414, -104.95944826134532, -84.45472655000496, -76.36241678091764, -125.25922415146258, -111.28256328052248, -78.62701476828586, -89.16323468751068, -93.2621310494612, -52.998984380755175, -52.50957801052798, -75.09044940089314, -83.31576136185262, -121.12305758446008, -178.91008722547969, -83.0220317709339, -70.95056563046418, -136.3377846148248, -45.191477484566335, -96.53279582028071, -54.97770107639048, -66.3843148394209, -86.08069230695375, -64.8717953570993, -125.42494349531623, -48.731832237629725, -73.73481632544572, -39.0671682009454, -108.01557839124132, -45.47674197365777, -60.77138649943703, -60.36153090020509, -59.5028972527421, -160.10125452887505, -121.85815995826792, -56.46652719747951, -111.50667169008483, -92.71412167906337, -67.13483555036156, -111.16332718663391, -97.13362363550243, -108.0880147577371, -47.26132142261647, -127.10843148334048, -59.12105184000916, -160.73788157585437, -56.24314392114272, -99.59564189238509, -81.67832238126321, -71.17330368916997, -65.33435269222285, -84.01743144957506, -78.6044123977416, -95.53117973115721, -69.85456838818037, -67.02026138465219, -78.59178251809709, -77.29220646684362, -110.58066146295808, -69.08765171344726, -67.09696169853473, -122.0072064731479, -136.82481078208235, -39.082022681192505, -71.3934818594912, -133.0439317166423, -122.4049031787748, -132.1753094408955, -79.15435026746343, -80.97571587227239, -82.46522457701462, -208.48046822803823, -136.3056736332458, -55.23389925343429, -113.31239836488817, -175.97286520697259, -95.99301458647244, -83.41124461756682, -83.19775865095578, -94.0009027890629], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6069060423853216, "mean_inference_ms": 5.210869471160634, "mean_action_processing_ms": 0.19435888405128804, "mean_env_wait_ms": 1.352205084720195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -39.0671682009454, "episode_reward_min": -208.48046822803823, "episode_reward_mean": -90.09390137089783, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-72.82155827379086, -75.50958775947926, -125.3678615576118, -79.9227080675466, -84.3299851646974, -100.03358159534147, -65.21429955444673, -100.55095606530513, -142.08156763733408, -73.35058126905543, -78.9051932354346, -111.82866177247253, -40.40281809247618, -62.89315614982887, -60.97249315673915, -91.71710707656945, -55.832611534271585, -140.31381779545205, -94.89392769968535, -122.43983947853172, -39.72080600986414, -104.95944826134532, -84.45472655000496, -76.36241678091764, -125.25922415146258, -111.28256328052248, -78.62701476828586, -89.16323468751068, -93.2621310494612, -52.998984380755175, -52.50957801052798, -75.09044940089314, -83.31576136185262, -121.12305758446008, -178.91008722547969, -83.0220317709339, -70.95056563046418, -136.3377846148248, -45.191477484566335, -96.53279582028071, -54.97770107639048, -66.3843148394209, -86.08069230695375, -64.8717953570993, -125.42494349531623, -48.731832237629725, -73.73481632544572, -39.0671682009454, -108.01557839124132, -45.47674197365777, -60.77138649943703, -60.36153090020509, -59.5028972527421, -160.10125452887505, -121.85815995826792, -56.46652719747951, -111.50667169008483, -92.71412167906337, -67.13483555036156, -111.16332718663391, -97.13362363550243, -108.0880147577371, -47.26132142261647, -127.10843148334048, -59.12105184000916, -160.73788157585437, -56.24314392114272, -99.59564189238509, -81.67832238126321, -71.17330368916997, -65.33435269222285, -84.01743144957506, -78.6044123977416, -95.53117973115721, -69.85456838818037, -67.02026138465219, -78.59178251809709, -77.29220646684362, -110.58066146295808, -69.08765171344726, -67.09696169853473, -122.0072064731479, -136.82481078208235, -39.082022681192505, -71.3934818594912, -133.0439317166423, -122.4049031787748, -132.1753094408955, -79.15435026746343, -80.97571587227239, -82.46522457701462, -208.48046822803823, -136.3056736332458, -55.23389925343429, -113.31239836488817, -175.97286520697259, -95.99301458647244, -83.41124461756682, -83.19775865095578, -94.0009027890629], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6069060423853216, "mean_inference_ms": 5.210869471160634, "mean_action_processing_ms": 0.19435888405128804, "mean_env_wait_ms": 1.352205084720195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1246000, "num_agent_steps_trained": 1246000, "num_env_steps_sampled": 1246000, "num_env_steps_trained": 1246000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1246000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1246000, "timers": {"training_iteration_time_ms": 75279.554, "load_time_ms": 29.084, "load_throughput": 481370.391, "learn_time_ms": 67659.507, "learn_throughput": 206.918, "synch_weights_time_ms": 13.78}, "counters": {"num_env_steps_sampled": 1246000, "num_env_steps_trained": 1246000, "num_agent_steps_sampled": 1246000, "num_agent_steps_trained": 1246000}, "done": false, "episodes_total": 1246, "training_iteration": 89, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-47-47", "timestamp": 1693057667, "time_this_iter_s": 75.218590259552, "time_total_s": 6821.103653430939, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015657910>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015422040>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 6821.103653430939, "timesteps_since_restore": 0, "iterations_since_restore": 89, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.72616822429907, "ram_util_percent": 50.66635514018691}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -255.672676814273, "episode_L1_reward_sum_min": -583.9469026327133, "episode_L1_reward_sum_max": -158.01488749682903, "episode_L2_reward_sum_mean": -140.97171052753924, "episode_L2_reward_sum_min": -221.39506573975086, "episode_L2_reward_sum_max": -115.632952041924}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.0694071446811788, "policy_loss": 0.04119380211952016, "vf_loss": 0.2821334562468805, "vf_explained_var": 0.6318193766683218, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "sampler_results": {"episode_reward_max": -39.0671682009454, "episode_reward_min": -208.48046822803823, "episode_reward_mean": -91.01646997161124, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -255.672676814273, "episode_L1_reward_sum_min": -583.9469026327133, "episode_L1_reward_sum_max": -158.01488749682903, "episode_L2_reward_sum_mean": -140.97171052753924, "episode_L2_reward_sum_min": -221.39506573975086, "episode_L2_reward_sum_max": -115.632952041924}, "hist_stats": {"episode_reward": [-60.97249315673915, -91.71710707656945, -55.832611534271585, -140.31381779545205, -94.89392769968535, -122.43983947853172, -39.72080600986414, -104.95944826134532, -84.45472655000496, -76.36241678091764, -125.25922415146258, -111.28256328052248, -78.62701476828586, -89.16323468751068, -93.2621310494612, -52.998984380755175, -52.50957801052798, -75.09044940089314, -83.31576136185262, -121.12305758446008, -178.91008722547969, -83.0220317709339, -70.95056563046418, -136.3377846148248, -45.191477484566335, -96.53279582028071, -54.97770107639048, -66.3843148394209, -86.08069230695375, -64.8717953570993, -125.42494349531623, -48.731832237629725, -73.73481632544572, -39.0671682009454, -108.01557839124132, -45.47674197365777, -60.77138649943703, -60.36153090020509, -59.5028972527421, -160.10125452887505, -121.85815995826792, -56.46652719747951, -111.50667169008483, -92.71412167906337, -67.13483555036156, -111.16332718663391, -97.13362363550243, -108.0880147577371, -47.26132142261647, -127.10843148334048, -59.12105184000916, -160.73788157585437, -56.24314392114272, -99.59564189238509, -81.67832238126321, -71.17330368916997, -65.33435269222285, -84.01743144957506, -78.6044123977416, -95.53117973115721, -69.85456838818037, -67.02026138465219, -78.59178251809709, -77.29220646684362, -110.58066146295808, -69.08765171344726, -67.09696169853473, -122.0072064731479, -136.82481078208235, -39.082022681192505, -71.3934818594912, -133.0439317166423, -122.4049031787748, -132.1753094408955, -79.15435026746343, -80.97571587227239, -82.46522457701462, -208.48046822803823, -136.3056736332458, -55.23389925343429, -113.31239836488817, -175.97286520697259, -95.99301458647244, -83.41124461756682, -83.19775865095578, -94.0009027890629, -117.98524501387237, -177.03778421257877, -48.64404289152082, -80.461260307092, -57.35693877036708, -93.98550360856163, -90.56488221037414, -118.4283339662849, -84.11966305420525, -67.4924544713328, -65.38154666242987, -172.6409703960623, -70.47343024709565, -60.897320454389735], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6068647351648565, "mean_inference_ms": 5.210793754302082, "mean_action_processing_ms": 0.1943104966134116, "mean_env_wait_ms": 1.3522030981132287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -39.0671682009454, "episode_reward_min": -208.48046822803823, "episode_reward_mean": -91.01646997161124, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-60.97249315673915, -91.71710707656945, -55.832611534271585, -140.31381779545205, -94.89392769968535, -122.43983947853172, -39.72080600986414, -104.95944826134532, -84.45472655000496, -76.36241678091764, -125.25922415146258, -111.28256328052248, -78.62701476828586, -89.16323468751068, -93.2621310494612, -52.998984380755175, -52.50957801052798, -75.09044940089314, -83.31576136185262, -121.12305758446008, -178.91008722547969, -83.0220317709339, -70.95056563046418, -136.3377846148248, -45.191477484566335, -96.53279582028071, -54.97770107639048, -66.3843148394209, -86.08069230695375, -64.8717953570993, -125.42494349531623, -48.731832237629725, -73.73481632544572, -39.0671682009454, -108.01557839124132, -45.47674197365777, -60.77138649943703, -60.36153090020509, -59.5028972527421, -160.10125452887505, -121.85815995826792, -56.46652719747951, -111.50667169008483, -92.71412167906337, -67.13483555036156, -111.16332718663391, -97.13362363550243, -108.0880147577371, -47.26132142261647, -127.10843148334048, -59.12105184000916, -160.73788157585437, -56.24314392114272, -99.59564189238509, -81.67832238126321, -71.17330368916997, -65.33435269222285, -84.01743144957506, -78.6044123977416, -95.53117973115721, -69.85456838818037, -67.02026138465219, -78.59178251809709, -77.29220646684362, -110.58066146295808, -69.08765171344726, -67.09696169853473, -122.0072064731479, -136.82481078208235, -39.082022681192505, -71.3934818594912, -133.0439317166423, -122.4049031787748, -132.1753094408955, -79.15435026746343, -80.97571587227239, -82.46522457701462, -208.48046822803823, -136.3056736332458, -55.23389925343429, -113.31239836488817, -175.97286520697259, -95.99301458647244, -83.41124461756682, -83.19775865095578, -94.0009027890629, -117.98524501387237, -177.03778421257877, -48.64404289152082, -80.461260307092, -57.35693877036708, -93.98550360856163, -90.56488221037414, -118.4283339662849, -84.11966305420525, -67.4924544713328, -65.38154666242987, -172.6409703960623, -70.47343024709565, -60.897320454389735], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6068647351648565, "mean_inference_ms": 5.210793754302082, "mean_action_processing_ms": 0.1943104966134116, "mean_env_wait_ms": 1.3522030981132287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1260000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 75286.53, "load_time_ms": 28.456, "load_throughput": 491994.286, "learn_time_ms": 67667.037, "learn_throughput": 206.895, "synch_weights_time_ms": 13.477}, "counters": {"num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "episodes_total": 1260, "training_iteration": 90, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-49-02", "timestamp": 1693057742, "time_this_iter_s": 75.34595274925232, "time_total_s": 6896.449606180191, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014F1B340>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701555F880>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 6896.449606180191, "timesteps_since_restore": 0, "iterations_since_restore": 90, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.85377358490566, "ram_util_percent": 50.660377358490564}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -263.7550490150601, "episode_L1_reward_sum_min": -617.4580718278885, "episode_L1_reward_sum_max": -158.01488749682903, "episode_L2_reward_sum_mean": -143.043772193864, "episode_L2_reward_sum_min": -228.33907674252987, "episode_L2_reward_sum_max": -115.632952041924}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.07562283606463928, "policy_loss": 0.03539424068859774, "vf_loss": 0.402285938441327, "vf_explained_var": 0.7889224500261216, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1274000, "num_env_steps_trained": 1274000, "num_agent_steps_sampled": 1274000, "num_agent_steps_trained": 1274000}, "sampler_results": {"episode_reward_max": -39.0671682009454, "episode_reward_min": -231.26047931915073, "episode_reward_mean": -94.1001847616825, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -263.7550490150601, "episode_L1_reward_sum_min": -617.4580718278885, "episode_L1_reward_sum_max": -158.01488749682903, "episode_L2_reward_sum_mean": -143.043772193864, "episode_L2_reward_sum_min": -228.33907674252987, "episode_L2_reward_sum_max": -115.632952041924}, "hist_stats": {"episode_reward": [-93.2621310494612, -52.998984380755175, -52.50957801052798, -75.09044940089314, -83.31576136185262, -121.12305758446008, -178.91008722547969, -83.0220317709339, -70.95056563046418, -136.3377846148248, -45.191477484566335, -96.53279582028071, -54.97770107639048, -66.3843148394209, -86.08069230695375, -64.8717953570993, -125.42494349531623, -48.731832237629725, -73.73481632544572, -39.0671682009454, -108.01557839124132, -45.47674197365777, -60.77138649943703, -60.36153090020509, -59.5028972527421, -160.10125452887505, -121.85815995826792, -56.46652719747951, -111.50667169008483, -92.71412167906337, -67.13483555036156, -111.16332718663391, -97.13362363550243, -108.0880147577371, -47.26132142261647, -127.10843148334048, -59.12105184000916, -160.73788157585437, -56.24314392114272, -99.59564189238509, -81.67832238126321, -71.17330368916997, -65.33435269222285, -84.01743144957506, -78.6044123977416, -95.53117973115721, -69.85456838818037, -67.02026138465219, -78.59178251809709, -77.29220646684362, -110.58066146295808, -69.08765171344726, -67.09696169853473, -122.0072064731479, -136.82481078208235, -39.082022681192505, -71.3934818594912, -133.0439317166423, -122.4049031787748, -132.1753094408955, -79.15435026746343, -80.97571587227239, -82.46522457701462, -208.48046822803823, -136.3056736332458, -55.23389925343429, -113.31239836488817, -175.97286520697259, -95.99301458647244, -83.41124461756682, -83.19775865095578, -94.0009027890629, -117.98524501387237, -177.03778421257877, -48.64404289152082, -80.461260307092, -57.35693877036708, -93.98550360856163, -90.56488221037414, -118.4283339662849, -84.11966305420525, -67.4924544713328, -65.38154666242987, -172.6409703960623, -70.47343024709565, -60.897320454389735, -201.03147182258206, -131.648095660056, -110.77307233236584, -126.26669255628383, -83.52868603200585, -72.37921314944201, -59.988282752407244, -84.02645022100437, -188.4051361999633, -231.26047931915073, -104.06725966609237, -65.80315465460902, -74.49846915871329, -50.694246713612465], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6068176793983076, "mean_inference_ms": 5.2107893597122175, "mean_action_processing_ms": 0.19428004203089885, "mean_env_wait_ms": 1.3522234858026383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -39.0671682009454, "episode_reward_min": -231.26047931915073, "episode_reward_mean": -94.1001847616825, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-93.2621310494612, -52.998984380755175, -52.50957801052798, -75.09044940089314, -83.31576136185262, -121.12305758446008, -178.91008722547969, -83.0220317709339, -70.95056563046418, -136.3377846148248, -45.191477484566335, -96.53279582028071, -54.97770107639048, -66.3843148394209, -86.08069230695375, -64.8717953570993, -125.42494349531623, -48.731832237629725, -73.73481632544572, -39.0671682009454, -108.01557839124132, -45.47674197365777, -60.77138649943703, -60.36153090020509, -59.5028972527421, -160.10125452887505, -121.85815995826792, -56.46652719747951, -111.50667169008483, -92.71412167906337, -67.13483555036156, -111.16332718663391, -97.13362363550243, -108.0880147577371, -47.26132142261647, -127.10843148334048, -59.12105184000916, -160.73788157585437, -56.24314392114272, -99.59564189238509, -81.67832238126321, -71.17330368916997, -65.33435269222285, -84.01743144957506, -78.6044123977416, -95.53117973115721, -69.85456838818037, -67.02026138465219, -78.59178251809709, -77.29220646684362, -110.58066146295808, -69.08765171344726, -67.09696169853473, -122.0072064731479, -136.82481078208235, -39.082022681192505, -71.3934818594912, -133.0439317166423, -122.4049031787748, -132.1753094408955, -79.15435026746343, -80.97571587227239, -82.46522457701462, -208.48046822803823, -136.3056736332458, -55.23389925343429, -113.31239836488817, -175.97286520697259, -95.99301458647244, -83.41124461756682, -83.19775865095578, -94.0009027890629, -117.98524501387237, -177.03778421257877, -48.64404289152082, -80.461260307092, -57.35693877036708, -93.98550360856163, -90.56488221037414, -118.4283339662849, -84.11966305420525, -67.4924544713328, -65.38154666242987, -172.6409703960623, -70.47343024709565, -60.897320454389735, -201.03147182258206, -131.648095660056, -110.77307233236584, -126.26669255628383, -83.52868603200585, -72.37921314944201, -59.988282752407244, -84.02645022100437, -188.4051361999633, -231.26047931915073, -104.06725966609237, -65.80315465460902, -74.49846915871329, -50.694246713612465], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6068176793983076, "mean_inference_ms": 5.2107893597122175, "mean_action_processing_ms": 0.19428004203089885, "mean_env_wait_ms": 1.3522234858026383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1274000, "num_agent_steps_trained": 1274000, "num_env_steps_sampled": 1274000, "num_env_steps_trained": 1274000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1274000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1274000, "timers": {"training_iteration_time_ms": 75286.769, "load_time_ms": 28.755, "load_throughput": 486875.528, "learn_time_ms": 67663.743, "learn_throughput": 206.905, "synch_weights_time_ms": 13.359}, "counters": {"num_env_steps_sampled": 1274000, "num_env_steps_trained": 1274000, "num_agent_steps_sampled": 1274000, "num_agent_steps_trained": 1274000}, "done": false, "episodes_total": 1274, "training_iteration": 91, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-50-17", "timestamp": 1693057817, "time_this_iter_s": 75.26179814338684, "time_total_s": 6971.711404323578, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015309850>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270154E9BB0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 6971.711404323578, "timesteps_since_restore": 0, "iterations_since_restore": 91, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.792523364485984, "ram_util_percent": 50.667289719626154}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -269.8415858957171, "episode_L1_reward_sum_min": -617.4580718278885, "episode_L1_reward_sum_max": -158.01488749682903, "episode_L2_reward_sum_mean": -144.60607744857668, "episode_L2_reward_sum_min": -228.33907674252987, "episode_L2_reward_sum_max": -115.632952041924}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.07241262728380843, "policy_loss": 0.04732701548013727, "vf_loss": 0.2508561109612261, "vf_explained_var": 0.6991876742415467, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1288000, "num_env_steps_trained": 1288000, "num_agent_steps_sampled": 1288000, "num_agent_steps_trained": 1288000}, "sampler_results": {"episode_reward_max": -39.0671682009454, "episode_reward_min": -231.26047931915073, "episode_reward_mean": -94.52967860062978, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -269.8415858957171, "episode_L1_reward_sum_min": -617.4580718278885, "episode_L1_reward_sum_max": -158.01488749682903, "episode_L2_reward_sum_mean": -144.60607744857668, "episode_L2_reward_sum_min": -228.33907674252987, "episode_L2_reward_sum_max": -115.632952041924}, "hist_stats": {"episode_reward": [-86.08069230695375, -64.8717953570993, -125.42494349531623, -48.731832237629725, -73.73481632544572, -39.0671682009454, -108.01557839124132, -45.47674197365777, -60.77138649943703, -60.36153090020509, -59.5028972527421, -160.10125452887505, -121.85815995826792, -56.46652719747951, -111.50667169008483, -92.71412167906337, -67.13483555036156, -111.16332718663391, -97.13362363550243, -108.0880147577371, -47.26132142261647, -127.10843148334048, -59.12105184000916, -160.73788157585437, -56.24314392114272, -99.59564189238509, -81.67832238126321, -71.17330368916997, -65.33435269222285, -84.01743144957506, -78.6044123977416, -95.53117973115721, -69.85456838818037, -67.02026138465219, -78.59178251809709, -77.29220646684362, -110.58066146295808, -69.08765171344726, -67.09696169853473, -122.0072064731479, -136.82481078208235, -39.082022681192505, -71.3934818594912, -133.0439317166423, -122.4049031787748, -132.1753094408955, -79.15435026746343, -80.97571587227239, -82.46522457701462, -208.48046822803823, -136.3056736332458, -55.23389925343429, -113.31239836488817, -175.97286520697259, -95.99301458647244, -83.41124461756682, -83.19775865095578, -94.0009027890629, -117.98524501387237, -177.03778421257877, -48.64404289152082, -80.461260307092, -57.35693877036708, -93.98550360856163, -90.56488221037414, -118.4283339662849, -84.11966305420525, -67.4924544713328, -65.38154666242987, -172.6409703960623, -70.47343024709565, -60.897320454389735, -201.03147182258206, -131.648095660056, -110.77307233236584, -126.26669255628383, -83.52868603200585, -72.37921314944201, -59.988282752407244, -84.02645022100437, -188.4051361999633, -231.26047931915073, -104.06725966609237, -65.80315465460902, -74.49846915871329, -50.694246713612465, -123.09531858881142, -67.30110017904533, -82.0731138932266, -56.09298166179221, -108.74366326504745, -85.31002724050555, -115.16177727934482, -133.54175556719335, -61.03115072962016, -77.91116777854329, -55.285576730854324, -77.66555150040791, -103.9310715947152, -106.41184813592987], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6067822194340512, "mean_inference_ms": 5.210912528934431, "mean_action_processing_ms": 0.19425779040030627, "mean_env_wait_ms": 1.3522723663969796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -39.0671682009454, "episode_reward_min": -231.26047931915073, "episode_reward_mean": -94.52967860062978, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-86.08069230695375, -64.8717953570993, -125.42494349531623, -48.731832237629725, -73.73481632544572, -39.0671682009454, -108.01557839124132, -45.47674197365777, -60.77138649943703, -60.36153090020509, -59.5028972527421, -160.10125452887505, -121.85815995826792, -56.46652719747951, -111.50667169008483, -92.71412167906337, -67.13483555036156, -111.16332718663391, -97.13362363550243, -108.0880147577371, -47.26132142261647, -127.10843148334048, -59.12105184000916, -160.73788157585437, -56.24314392114272, -99.59564189238509, -81.67832238126321, -71.17330368916997, -65.33435269222285, -84.01743144957506, -78.6044123977416, -95.53117973115721, -69.85456838818037, -67.02026138465219, -78.59178251809709, -77.29220646684362, -110.58066146295808, -69.08765171344726, -67.09696169853473, -122.0072064731479, -136.82481078208235, -39.082022681192505, -71.3934818594912, -133.0439317166423, -122.4049031787748, -132.1753094408955, -79.15435026746343, -80.97571587227239, -82.46522457701462, -208.48046822803823, -136.3056736332458, -55.23389925343429, -113.31239836488817, -175.97286520697259, -95.99301458647244, -83.41124461756682, -83.19775865095578, -94.0009027890629, -117.98524501387237, -177.03778421257877, -48.64404289152082, -80.461260307092, -57.35693877036708, -93.98550360856163, -90.56488221037414, -118.4283339662849, -84.11966305420525, -67.4924544713328, -65.38154666242987, -172.6409703960623, -70.47343024709565, -60.897320454389735, -201.03147182258206, -131.648095660056, -110.77307233236584, -126.26669255628383, -83.52868603200585, -72.37921314944201, -59.988282752407244, -84.02645022100437, -188.4051361999633, -231.26047931915073, -104.06725966609237, -65.80315465460902, -74.49846915871329, -50.694246713612465, -123.09531858881142, -67.30110017904533, -82.0731138932266, -56.09298166179221, -108.74366326504745, -85.31002724050555, -115.16177727934482, -133.54175556719335, -61.03115072962016, -77.91116777854329, -55.285576730854324, -77.66555150040791, -103.9310715947152, -106.41184813592987], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6067822194340512, "mean_inference_ms": 5.210912528934431, "mean_action_processing_ms": 0.19425779040030627, "mean_env_wait_ms": 1.3522723663969796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1288000, "num_agent_steps_trained": 1288000, "num_env_steps_sampled": 1288000, "num_env_steps_trained": 1288000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1288000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1288000, "timers": {"training_iteration_time_ms": 75271.878, "load_time_ms": 28.752, "load_throughput": 486922.764, "learn_time_ms": 67627.131, "learn_throughput": 207.018, "synch_weights_time_ms": 13.661}, "counters": {"num_env_steps_sampled": 1288000, "num_env_steps_trained": 1288000, "num_agent_steps_sampled": 1288000, "num_agent_steps_trained": 1288000}, "done": false, "episodes_total": 1288, "training_iteration": 92, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-51-33", "timestamp": 1693057893, "time_this_iter_s": 75.28621101379395, "time_total_s": 7046.997615337372, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015422970>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015309FA0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 7046.997615337372, "timesteps_since_restore": 0, "iterations_since_restore": 92, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.847169811320757, "ram_util_percent": 50.660377358490564}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -271.22337917812166, "episode_L1_reward_sum_min": -617.4580718278885, "episode_L1_reward_sum_max": -158.79001998901367, "episode_L2_reward_sum_mean": -145.01183278903366, "episode_L2_reward_sum_min": -228.33907674252987, "episode_L2_reward_sum_max": -115.632952041924}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.07297591762205226, "policy_loss": 0.044728753004614034, "vf_loss": 0.28247163648243784, "vf_explained_var": 0.6432534491819609, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1302000, "num_env_steps_trained": 1302000, "num_agent_steps_sampled": 1302000, "num_agent_steps_trained": 1302000}, "sampler_results": {"episode_reward_max": -35.65791672236317, "episode_reward_min": -231.26047931915073, "episode_reward_mean": -94.37492388264388, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -271.22337917812166, "episode_L1_reward_sum_min": -617.4580718278885, "episode_L1_reward_sum_max": -158.79001998901367, "episode_L2_reward_sum_mean": -145.01183278903366, "episode_L2_reward_sum_min": -228.33907674252987, "episode_L2_reward_sum_max": -115.632952041924}, "hist_stats": {"episode_reward": [-111.50667169008483, -92.71412167906337, -67.13483555036156, -111.16332718663391, -97.13362363550243, -108.0880147577371, -47.26132142261647, -127.10843148334048, -59.12105184000916, -160.73788157585437, -56.24314392114272, -99.59564189238509, -81.67832238126321, -71.17330368916997, -65.33435269222285, -84.01743144957506, -78.6044123977416, -95.53117973115721, -69.85456838818037, -67.02026138465219, -78.59178251809709, -77.29220646684362, -110.58066146295808, -69.08765171344726, -67.09696169853473, -122.0072064731479, -136.82481078208235, -39.082022681192505, -71.3934818594912, -133.0439317166423, -122.4049031787748, -132.1753094408955, -79.15435026746343, -80.97571587227239, -82.46522457701462, -208.48046822803823, -136.3056736332458, -55.23389925343429, -113.31239836488817, -175.97286520697259, -95.99301458647244, -83.41124461756682, -83.19775865095578, -94.0009027890629, -117.98524501387237, -177.03778421257877, -48.64404289152082, -80.461260307092, -57.35693877036708, -93.98550360856163, -90.56488221037414, -118.4283339662849, -84.11966305420525, -67.4924544713328, -65.38154666242987, -172.6409703960623, -70.47343024709565, -60.897320454389735, -201.03147182258206, -131.648095660056, -110.77307233236584, -126.26669255628383, -83.52868603200585, -72.37921314944201, -59.988282752407244, -84.02645022100437, -188.4051361999633, -231.26047931915073, -104.06725966609237, -65.80315465460902, -74.49846915871329, -50.694246713612465, -123.09531858881142, -67.30110017904533, -82.0731138932266, -56.09298166179221, -108.74366326504745, -85.31002724050555, -115.16177727934482, -133.54175556719335, -61.03115072962016, -77.91116777854329, -55.285576730854324, -77.66555150040791, -103.9310715947152, -106.41184813592987, -88.30469577030672, -112.66252014641141, -143.46997459040134, -35.65791672236317, -45.613994200103704, -97.6860485886367, -78.2444519704846, -62.02288805073687, -67.94582904419926, -96.16994782802244, -92.06918132327637, -48.13515953109143, -71.32998689377169, -55.67725816689861], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6067502193360832, "mean_inference_ms": 5.21111696792385, "mean_action_processing_ms": 0.19425641441976538, "mean_env_wait_ms": 1.3523332681733684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -35.65791672236317, "episode_reward_min": -231.26047931915073, "episode_reward_mean": -94.37492388264388, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-111.50667169008483, -92.71412167906337, -67.13483555036156, -111.16332718663391, -97.13362363550243, -108.0880147577371, -47.26132142261647, -127.10843148334048, -59.12105184000916, -160.73788157585437, -56.24314392114272, -99.59564189238509, -81.67832238126321, -71.17330368916997, -65.33435269222285, -84.01743144957506, -78.6044123977416, -95.53117973115721, -69.85456838818037, -67.02026138465219, -78.59178251809709, -77.29220646684362, -110.58066146295808, -69.08765171344726, -67.09696169853473, -122.0072064731479, -136.82481078208235, -39.082022681192505, -71.3934818594912, -133.0439317166423, -122.4049031787748, -132.1753094408955, -79.15435026746343, -80.97571587227239, -82.46522457701462, -208.48046822803823, -136.3056736332458, -55.23389925343429, -113.31239836488817, -175.97286520697259, -95.99301458647244, -83.41124461756682, -83.19775865095578, -94.0009027890629, -117.98524501387237, -177.03778421257877, -48.64404289152082, -80.461260307092, -57.35693877036708, -93.98550360856163, -90.56488221037414, -118.4283339662849, -84.11966305420525, -67.4924544713328, -65.38154666242987, -172.6409703960623, -70.47343024709565, -60.897320454389735, -201.03147182258206, -131.648095660056, -110.77307233236584, -126.26669255628383, -83.52868603200585, -72.37921314944201, -59.988282752407244, -84.02645022100437, -188.4051361999633, -231.26047931915073, -104.06725966609237, -65.80315465460902, -74.49846915871329, -50.694246713612465, -123.09531858881142, -67.30110017904533, -82.0731138932266, -56.09298166179221, -108.74366326504745, -85.31002724050555, -115.16177727934482, -133.54175556719335, -61.03115072962016, -77.91116777854329, -55.285576730854324, -77.66555150040791, -103.9310715947152, -106.41184813592987, -88.30469577030672, -112.66252014641141, -143.46997459040134, -35.65791672236317, -45.613994200103704, -97.6860485886367, -78.2444519704846, -62.02288805073687, -67.94582904419926, -96.16994782802244, -92.06918132327637, -48.13515953109143, -71.32998689377169, -55.67725816689861], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6067502193360832, "mean_inference_ms": 5.21111696792385, "mean_action_processing_ms": 0.19425641441976538, "mean_env_wait_ms": 1.3523332681733684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1302000, "num_agent_steps_trained": 1302000, "num_env_steps_sampled": 1302000, "num_env_steps_trained": 1302000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1302000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1302000, "timers": {"training_iteration_time_ms": 75293.103, "load_time_ms": 28.6, "load_throughput": 489509.651, "learn_time_ms": 67635.636, "learn_throughput": 206.991, "synch_weights_time_ms": 13.756}, "counters": {"num_env_steps_sampled": 1302000, "num_env_steps_trained": 1302000, "num_agent_steps_sampled": 1302000, "num_agent_steps_trained": 1302000}, "done": false, "episodes_total": 1302, "training_iteration": 93, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-52-48", "timestamp": 1693057968, "time_this_iter_s": 75.4237928390503, "time_total_s": 7122.421408176422, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701543EC70>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701535EB20>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 7122.421408176422, "timesteps_since_restore": 0, "iterations_since_restore": 93, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.78130841121495, "ram_util_percent": 50.67289719626167}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -272.7442846155167, "episode_L1_reward_sum_min": -617.4580718278885, "episode_L1_reward_sum_max": -159.58398754149675, "episode_L2_reward_sum_mean": -145.38043746955694, "episode_L2_reward_sum_min": -228.33907674252987, "episode_L2_reward_sum_max": -116.11759378015995}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.09012159081262157, "policy_loss": 0.06446867705794213, "vf_loss": 0.25652913260878957, "vf_explained_var": 0.6632507957303475, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1316000, "num_env_steps_trained": 1316000, "num_agent_steps_sampled": 1316000, "num_agent_steps_trained": 1316000}, "sampler_results": {"episode_reward_max": -35.65791672236317, "episode_reward_min": -231.26047931915073, "episode_reward_mean": -92.45556660643848, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -272.7442846155167, "episode_L1_reward_sum_min": -617.4580718278885, "episode_L1_reward_sum_max": -159.58398754149675, "episode_L2_reward_sum_mean": -145.38043746955694, "episode_L2_reward_sum_min": -228.33907674252987, "episode_L2_reward_sum_max": -116.11759378015995}, "hist_stats": {"episode_reward": [-65.33435269222285, -84.01743144957506, -78.6044123977416, -95.53117973115721, -69.85456838818037, -67.02026138465219, -78.59178251809709, -77.29220646684362, -110.58066146295808, -69.08765171344726, -67.09696169853473, -122.0072064731479, -136.82481078208235, -39.082022681192505, -71.3934818594912, -133.0439317166423, -122.4049031787748, -132.1753094408955, -79.15435026746343, -80.97571587227239, -82.46522457701462, -208.48046822803823, -136.3056736332458, -55.23389925343429, -113.31239836488817, -175.97286520697259, -95.99301458647244, -83.41124461756682, -83.19775865095578, -94.0009027890629, -117.98524501387237, -177.03778421257877, -48.64404289152082, -80.461260307092, -57.35693877036708, -93.98550360856163, -90.56488221037414, -118.4283339662849, -84.11966305420525, -67.4924544713328, -65.38154666242987, -172.6409703960623, -70.47343024709565, -60.897320454389735, -201.03147182258206, -131.648095660056, -110.77307233236584, -126.26669255628383, -83.52868603200585, -72.37921314944201, -59.988282752407244, -84.02645022100437, -188.4051361999633, -231.26047931915073, -104.06725966609237, -65.80315465460902, -74.49846915871329, -50.694246713612465, -123.09531858881142, -67.30110017904533, -82.0731138932266, -56.09298166179221, -108.74366326504745, -85.31002724050555, -115.16177727934482, -133.54175556719335, -61.03115072962016, -77.91116777854329, -55.285576730854324, -77.66555150040791, -103.9310715947152, -106.41184813592987, -88.30469577030672, -112.66252014641141, -143.46997459040134, -35.65791672236317, -45.613994200103704, -97.6860485886367, -78.2444519704846, -62.02288805073687, -67.94582904419926, -96.16994782802244, -92.06918132327637, -48.13515953109143, -71.32998689377169, -55.67725816689861, -57.095016910678545, -37.06114128555048, -74.30058917847443, -59.08104440498751, -73.22546733703881, -112.0966365144393, -86.95065629323193, -58.69894768161101, -120.0676768845961, -59.782065955869214, -88.36297954015004, -44.957458774845605, -125.7526294139873, -101.29165490916569], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6067107665666721, "mean_inference_ms": 5.211371296597042, "mean_action_processing_ms": 0.1942707399751981, "mean_env_wait_ms": 1.3524045840171257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -35.65791672236317, "episode_reward_min": -231.26047931915073, "episode_reward_mean": -92.45556660643848, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-65.33435269222285, -84.01743144957506, -78.6044123977416, -95.53117973115721, -69.85456838818037, -67.02026138465219, -78.59178251809709, -77.29220646684362, -110.58066146295808, -69.08765171344726, -67.09696169853473, -122.0072064731479, -136.82481078208235, -39.082022681192505, -71.3934818594912, -133.0439317166423, -122.4049031787748, -132.1753094408955, -79.15435026746343, -80.97571587227239, -82.46522457701462, -208.48046822803823, -136.3056736332458, -55.23389925343429, -113.31239836488817, -175.97286520697259, -95.99301458647244, -83.41124461756682, -83.19775865095578, -94.0009027890629, -117.98524501387237, -177.03778421257877, -48.64404289152082, -80.461260307092, -57.35693877036708, -93.98550360856163, -90.56488221037414, -118.4283339662849, -84.11966305420525, -67.4924544713328, -65.38154666242987, -172.6409703960623, -70.47343024709565, -60.897320454389735, -201.03147182258206, -131.648095660056, -110.77307233236584, -126.26669255628383, -83.52868603200585, -72.37921314944201, -59.988282752407244, -84.02645022100437, -188.4051361999633, -231.26047931915073, -104.06725966609237, -65.80315465460902, -74.49846915871329, -50.694246713612465, -123.09531858881142, -67.30110017904533, -82.0731138932266, -56.09298166179221, -108.74366326504745, -85.31002724050555, -115.16177727934482, -133.54175556719335, -61.03115072962016, -77.91116777854329, -55.285576730854324, -77.66555150040791, -103.9310715947152, -106.41184813592987, -88.30469577030672, -112.66252014641141, -143.46997459040134, -35.65791672236317, -45.613994200103704, -97.6860485886367, -78.2444519704846, -62.02288805073687, -67.94582904419926, -96.16994782802244, -92.06918132327637, -48.13515953109143, -71.32998689377169, -55.67725816689861, -57.095016910678545, -37.06114128555048, -74.30058917847443, -59.08104440498751, -73.22546733703881, -112.0966365144393, -86.95065629323193, -58.69894768161101, -120.0676768845961, -59.782065955869214, -88.36297954015004, -44.957458774845605, -125.7526294139873, -101.29165490916569], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6067107665666721, "mean_inference_ms": 5.211371296597042, "mean_action_processing_ms": 0.1942707399751981, "mean_env_wait_ms": 1.3524045840171257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1316000, "num_agent_steps_trained": 1316000, "num_env_steps_sampled": 1316000, "num_env_steps_trained": 1316000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1316000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1316000, "timers": {"training_iteration_time_ms": 75346.903, "load_time_ms": 29.099, "load_throughput": 481119.549, "learn_time_ms": 67683.369, "learn_throughput": 206.845, "synch_weights_time_ms": 14.329}, "counters": {"num_env_steps_sampled": 1316000, "num_env_steps_trained": 1316000, "num_agent_steps_sampled": 1316000, "num_agent_steps_trained": 1316000}, "done": false, "episodes_total": 1316, "training_iteration": 94, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-54-04", "timestamp": 1693058044, "time_this_iter_s": 75.6644995212555, "time_total_s": 7198.085907697678, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014F11460>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270152380A0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 7198.085907697678, "timesteps_since_restore": 0, "iterations_since_restore": 94, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 22.36851851851852, "ram_util_percent": 50.74629629629631}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -277.63657926283776, "episode_L1_reward_sum_min": -617.4580718278885, "episode_L1_reward_sum_max": -159.58398754149675, "episode_L2_reward_sum_mean": -146.6074105449766, "episode_L2_reward_sum_min": -228.33907674252987, "episode_L2_reward_sum_max": -116.11759378015995}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.08345138145694049, "policy_loss": 0.05249741006069606, "vf_loss": 0.3095397145749637, "vf_explained_var": 0.5858011529953392, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1330000, "num_env_steps_trained": 1330000, "num_agent_steps_sampled": 1330000, "num_agent_steps_trained": 1330000}, "sampler_results": {"episode_reward_max": -35.65791672236317, "episode_reward_min": -231.26047931915073, "episode_reward_mean": -93.15465830199317, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -277.63657926283776, "episode_L1_reward_sum_min": -617.4580718278885, "episode_L1_reward_sum_max": -159.58398754149675, "episode_L2_reward_sum_mean": -146.6074105449766, "episode_L2_reward_sum_min": -228.33907674252987, "episode_L2_reward_sum_max": -116.11759378015995}, "hist_stats": {"episode_reward": [-71.3934818594912, -133.0439317166423, -122.4049031787748, -132.1753094408955, -79.15435026746343, -80.97571587227239, -82.46522457701462, -208.48046822803823, -136.3056736332458, -55.23389925343429, -113.31239836488817, -175.97286520697259, -95.99301458647244, -83.41124461756682, -83.19775865095578, -94.0009027890629, -117.98524501387237, -177.03778421257877, -48.64404289152082, -80.461260307092, -57.35693877036708, -93.98550360856163, -90.56488221037414, -118.4283339662849, -84.11966305420525, -67.4924544713328, -65.38154666242987, -172.6409703960623, -70.47343024709565, -60.897320454389735, -201.03147182258206, -131.648095660056, -110.77307233236584, -126.26669255628383, -83.52868603200585, -72.37921314944201, -59.988282752407244, -84.02645022100437, -188.4051361999633, -231.26047931915073, -104.06725966609237, -65.80315465460902, -74.49846915871329, -50.694246713612465, -123.09531858881142, -67.30110017904533, -82.0731138932266, -56.09298166179221, -108.74366326504745, -85.31002724050555, -115.16177727934482, -133.54175556719335, -61.03115072962016, -77.91116777854329, -55.285576730854324, -77.66555150040791, -103.9310715947152, -106.41184813592987, -88.30469577030672, -112.66252014641141, -143.46997459040134, -35.65791672236317, -45.613994200103704, -97.6860485886367, -78.2444519704846, -62.02288805073687, -67.94582904419926, -96.16994782802244, -92.06918132327637, -48.13515953109143, -71.32998689377169, -55.67725816689861, -57.095016910678545, -37.06114128555048, -74.30058917847443, -59.08104440498751, -73.22546733703881, -112.0966365144393, -86.95065629323193, -58.69894768161101, -120.0676768845961, -59.782065955869214, -88.36297954015004, -44.957458774845605, -125.7526294139873, -101.29165490916569, -176.47082974349516, -64.1922046047403, -65.15947199159574, -118.82556597802679, -82.34436994003975, -98.05187073098742, -84.2903977122334, -78.18877260058062, -87.25927148872394, -42.70473661927357, -130.19524771918788, -70.14973852972655, -69.19246617142518, -63.80973556526581], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6066665348293206, "mean_inference_ms": 5.211710136316334, "mean_action_processing_ms": 0.19428772044206893, "mean_env_wait_ms": 1.3525193416100485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -35.65791672236317, "episode_reward_min": -231.26047931915073, "episode_reward_mean": -93.15465830199317, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-71.3934818594912, -133.0439317166423, -122.4049031787748, -132.1753094408955, -79.15435026746343, -80.97571587227239, -82.46522457701462, -208.48046822803823, -136.3056736332458, -55.23389925343429, -113.31239836488817, -175.97286520697259, -95.99301458647244, -83.41124461756682, -83.19775865095578, -94.0009027890629, -117.98524501387237, -177.03778421257877, -48.64404289152082, -80.461260307092, -57.35693877036708, -93.98550360856163, -90.56488221037414, -118.4283339662849, -84.11966305420525, -67.4924544713328, -65.38154666242987, -172.6409703960623, -70.47343024709565, -60.897320454389735, -201.03147182258206, -131.648095660056, -110.77307233236584, -126.26669255628383, -83.52868603200585, -72.37921314944201, -59.988282752407244, -84.02645022100437, -188.4051361999633, -231.26047931915073, -104.06725966609237, -65.80315465460902, -74.49846915871329, -50.694246713612465, -123.09531858881142, -67.30110017904533, -82.0731138932266, -56.09298166179221, -108.74366326504745, -85.31002724050555, -115.16177727934482, -133.54175556719335, -61.03115072962016, -77.91116777854329, -55.285576730854324, -77.66555150040791, -103.9310715947152, -106.41184813592987, -88.30469577030672, -112.66252014641141, -143.46997459040134, -35.65791672236317, -45.613994200103704, -97.6860485886367, -78.2444519704846, -62.02288805073687, -67.94582904419926, -96.16994782802244, -92.06918132327637, -48.13515953109143, -71.32998689377169, -55.67725816689861, -57.095016910678545, -37.06114128555048, -74.30058917847443, -59.08104440498751, -73.22546733703881, -112.0966365144393, -86.95065629323193, -58.69894768161101, -120.0676768845961, -59.782065955869214, -88.36297954015004, -44.957458774845605, -125.7526294139873, -101.29165490916569, -176.47082974349516, -64.1922046047403, -65.15947199159574, -118.82556597802679, -82.34436994003975, -98.05187073098742, -84.2903977122334, -78.18877260058062, -87.25927148872394, -42.70473661927357, -130.19524771918788, -70.14973852972655, -69.19246617142518, -63.80973556526581], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6066665348293206, "mean_inference_ms": 5.211710136316334, "mean_action_processing_ms": 0.19428772044206893, "mean_env_wait_ms": 1.3525193416100485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1330000, "num_agent_steps_trained": 1330000, "num_env_steps_sampled": 1330000, "num_env_steps_trained": 1330000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1330000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1330000, "timers": {"training_iteration_time_ms": 75342.317, "load_time_ms": 29.195, "load_throughput": 479539.67, "learn_time_ms": 67678.256, "learn_throughput": 206.861, "synch_weights_time_ms": 13.631}, "counters": {"num_env_steps_sampled": 1330000, "num_env_steps_trained": 1330000, "num_agent_steps_sampled": 1330000, "num_agent_steps_trained": 1330000}, "done": false, "episodes_total": 1330, "training_iteration": 95, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-55-19", "timestamp": 1693058119, "time_this_iter_s": 75.26491403579712, "time_total_s": 7273.350821733475, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701545ED30>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270153092E0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 7273.350821733475, "timesteps_since_restore": 0, "iterations_since_restore": 95, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.834905660377363, "ram_util_percent": 50.76981132075472}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -270.5536551927775, "episode_L1_reward_sum_min": -617.4580718278885, "episode_L1_reward_sum_max": -159.58398754149675, "episode_L2_reward_sum_mean": -144.74815938577055, "episode_L2_reward_sum_min": -228.33907674252987, "episode_L2_reward_sum_max": -116.11759378015995}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.059807555722203566, "policy_loss": 0.030069666915600007, "vf_loss": 0.2973788920808231, "vf_explained_var": 0.6501443218669773, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "sampler_results": {"episode_reward_max": -35.65791672236317, "episode_reward_min": -231.26047931915073, "episode_reward_mean": -89.66833533916788, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -270.5536551927775, "episode_L1_reward_sum_min": -617.4580718278885, "episode_L1_reward_sum_max": -159.58398754149675, "episode_L2_reward_sum_mean": -144.74815938577055, "episode_L2_reward_sum_min": -228.33907674252987, "episode_L2_reward_sum_max": -116.11759378015995}, "hist_stats": {"episode_reward": [-83.19775865095578, -94.0009027890629, -117.98524501387237, -177.03778421257877, -48.64404289152082, -80.461260307092, -57.35693877036708, -93.98550360856163, -90.56488221037414, -118.4283339662849, -84.11966305420525, -67.4924544713328, -65.38154666242987, -172.6409703960623, -70.47343024709565, -60.897320454389735, -201.03147182258206, -131.648095660056, -110.77307233236584, -126.26669255628383, -83.52868603200585, -72.37921314944201, -59.988282752407244, -84.02645022100437, -188.4051361999633, -231.26047931915073, -104.06725966609237, -65.80315465460902, -74.49846915871329, -50.694246713612465, -123.09531858881142, -67.30110017904533, -82.0731138932266, -56.09298166179221, -108.74366326504745, -85.31002724050555, -115.16177727934482, -133.54175556719335, -61.03115072962016, -77.91116777854329, -55.285576730854324, -77.66555150040791, -103.9310715947152, -106.41184813592987, -88.30469577030672, -112.66252014641141, -143.46997459040134, -35.65791672236317, -45.613994200103704, -97.6860485886367, -78.2444519704846, -62.02288805073687, -67.94582904419926, -96.16994782802244, -92.06918132327637, -48.13515953109143, -71.32998689377169, -55.67725816689861, -57.095016910678545, -37.06114128555048, -74.30058917847443, -59.08104440498751, -73.22546733703881, -112.0966365144393, -86.95065629323193, -58.69894768161101, -120.0676768845961, -59.782065955869214, -88.36297954015004, -44.957458774845605, -125.7526294139873, -101.29165490916569, -176.47082974349516, -64.1922046047403, -65.15947199159574, -118.82556597802679, -82.34436994003975, -98.05187073098742, -84.2903977122334, -78.18877260058062, -87.25927148872394, -42.70473661927357, -130.19524771918788, -70.14973852972655, -69.19246617142518, -63.80973556526581, -89.073187136682, -66.65401960590404, -104.95214503366029, -51.345323297312895, -74.64791970247119, -58.838546707221816, -82.53370005309176, -192.1194734953654, -90.62684801369694, -84.45088304713977, -122.71992355830999, -64.10991410359235, -47.33669329467385, -92.28160747152137], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6066496803290471, "mean_inference_ms": 5.21211984207149, "mean_action_processing_ms": 0.19431573670993987, "mean_env_wait_ms": 1.352648204348856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -35.65791672236317, "episode_reward_min": -231.26047931915073, "episode_reward_mean": -89.66833533916788, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-83.19775865095578, -94.0009027890629, -117.98524501387237, -177.03778421257877, -48.64404289152082, -80.461260307092, -57.35693877036708, -93.98550360856163, -90.56488221037414, -118.4283339662849, -84.11966305420525, -67.4924544713328, -65.38154666242987, -172.6409703960623, -70.47343024709565, -60.897320454389735, -201.03147182258206, -131.648095660056, -110.77307233236584, -126.26669255628383, -83.52868603200585, -72.37921314944201, -59.988282752407244, -84.02645022100437, -188.4051361999633, -231.26047931915073, -104.06725966609237, -65.80315465460902, -74.49846915871329, -50.694246713612465, -123.09531858881142, -67.30110017904533, -82.0731138932266, -56.09298166179221, -108.74366326504745, -85.31002724050555, -115.16177727934482, -133.54175556719335, -61.03115072962016, -77.91116777854329, -55.285576730854324, -77.66555150040791, -103.9310715947152, -106.41184813592987, -88.30469577030672, -112.66252014641141, -143.46997459040134, -35.65791672236317, -45.613994200103704, -97.6860485886367, -78.2444519704846, -62.02288805073687, -67.94582904419926, -96.16994782802244, -92.06918132327637, -48.13515953109143, -71.32998689377169, -55.67725816689861, -57.095016910678545, -37.06114128555048, -74.30058917847443, -59.08104440498751, -73.22546733703881, -112.0966365144393, -86.95065629323193, -58.69894768161101, -120.0676768845961, -59.782065955869214, -88.36297954015004, -44.957458774845605, -125.7526294139873, -101.29165490916569, -176.47082974349516, -64.1922046047403, -65.15947199159574, -118.82556597802679, -82.34436994003975, -98.05187073098742, -84.2903977122334, -78.18877260058062, -87.25927148872394, -42.70473661927357, -130.19524771918788, -70.14973852972655, -69.19246617142518, -63.80973556526581, -89.073187136682, -66.65401960590404, -104.95214503366029, -51.345323297312895, -74.64791970247119, -58.838546707221816, -82.53370005309176, -192.1194734953654, -90.62684801369694, -84.45088304713977, -122.71992355830999, -64.10991410359235, -47.33669329467385, -92.28160747152137], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6066496803290471, "mean_inference_ms": 5.21211984207149, "mean_action_processing_ms": 0.19431573670993987, "mean_env_wait_ms": 1.352648204348856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1344000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 75329.549, "load_time_ms": 29.348, "load_throughput": 477037.054, "learn_time_ms": 67653.271, "learn_throughput": 206.938, "synch_weights_time_ms": 13.547}, "counters": {"num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "episodes_total": 1344, "training_iteration": 96, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-56-35", "timestamp": 1693058195, "time_this_iter_s": 75.41148638725281, "time_total_s": 7348.7623081207275, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270153091C0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270153607C0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 7348.7623081207275, "timesteps_since_restore": 0, "iterations_since_restore": 96, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.789719626168225, "ram_util_percent": 50.74766355140188}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -269.36093995735047, "episode_L1_reward_sum_min": -617.4580718278885, "episode_L1_reward_sum_max": -159.58398754149675, "episode_L2_reward_sum_mean": -144.4049107231945, "episode_L2_reward_sum_min": -228.33907674252987, "episode_L2_reward_sum_max": -116.11759378015995}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.09215100433623778, "policy_loss": 0.06951552957158398, "vf_loss": 0.22635475078943104, "vf_explained_var": 0.5877109791761563, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1358000, "num_env_steps_trained": 1358000, "num_agent_steps_sampled": 1358000, "num_agent_steps_trained": 1358000}, "sampler_results": {"episode_reward_max": -35.65791672236317, "episode_reward_min": -231.26047931915073, "episode_reward_mean": -87.13707693220164, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -269.36093995735047, "episode_L1_reward_sum_min": -617.4580718278885, "episode_L1_reward_sum_max": -159.58398754149675, "episode_L2_reward_sum_mean": -144.4049107231945, "episode_L2_reward_sum_min": -228.33907674252987, "episode_L2_reward_sum_max": -116.11759378015995}, "hist_stats": {"episode_reward": [-70.47343024709565, -60.897320454389735, -201.03147182258206, -131.648095660056, -110.77307233236584, -126.26669255628383, -83.52868603200585, -72.37921314944201, -59.988282752407244, -84.02645022100437, -188.4051361999633, -231.26047931915073, -104.06725966609237, -65.80315465460902, -74.49846915871329, -50.694246713612465, -123.09531858881142, -67.30110017904533, -82.0731138932266, -56.09298166179221, -108.74366326504745, -85.31002724050555, -115.16177727934482, -133.54175556719335, -61.03115072962016, -77.91116777854329, -55.285576730854324, -77.66555150040791, -103.9310715947152, -106.41184813592987, -88.30469577030672, -112.66252014641141, -143.46997459040134, -35.65791672236317, -45.613994200103704, -97.6860485886367, -78.2444519704846, -62.02288805073687, -67.94582904419926, -96.16994782802244, -92.06918132327637, -48.13515953109143, -71.32998689377169, -55.67725816689861, -57.095016910678545, -37.06114128555048, -74.30058917847443, -59.08104440498751, -73.22546733703881, -112.0966365144393, -86.95065629323193, -58.69894768161101, -120.0676768845961, -59.782065955869214, -88.36297954015004, -44.957458774845605, -125.7526294139873, -101.29165490916569, -176.47082974349516, -64.1922046047403, -65.15947199159574, -118.82556597802679, -82.34436994003975, -98.05187073098742, -84.2903977122334, -78.18877260058062, -87.25927148872394, -42.70473661927357, -130.19524771918788, -70.14973852972655, -69.19246617142518, -63.80973556526581, -89.073187136682, -66.65401960590404, -104.95214503366029, -51.345323297312895, -74.64791970247119, -58.838546707221816, -82.53370005309176, -192.1194734953654, -90.62684801369694, -84.45088304713977, -122.71992355830999, -64.10991410359235, -47.33669329467385, -92.28160747152137, -66.43513623205514, -49.407788799600894, -115.55152342582038, -75.9642413891471, -62.258058245890496, -57.6722156997899, -65.91109320478749, -54.90519267438569, -150.18926188245186, -70.79854943095077, -69.05899227223817, -135.68640460821607, -60.67372786336516, -63.659260579379634], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6066202605538458, "mean_inference_ms": 5.212638414566986, "mean_action_processing_ms": 0.19435218282701008, "mean_env_wait_ms": 1.3528098151129995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -35.65791672236317, "episode_reward_min": -231.26047931915073, "episode_reward_mean": -87.13707693220164, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-70.47343024709565, -60.897320454389735, -201.03147182258206, -131.648095660056, -110.77307233236584, -126.26669255628383, -83.52868603200585, -72.37921314944201, -59.988282752407244, -84.02645022100437, -188.4051361999633, -231.26047931915073, -104.06725966609237, -65.80315465460902, -74.49846915871329, -50.694246713612465, -123.09531858881142, -67.30110017904533, -82.0731138932266, -56.09298166179221, -108.74366326504745, -85.31002724050555, -115.16177727934482, -133.54175556719335, -61.03115072962016, -77.91116777854329, -55.285576730854324, -77.66555150040791, -103.9310715947152, -106.41184813592987, -88.30469577030672, -112.66252014641141, -143.46997459040134, -35.65791672236317, -45.613994200103704, -97.6860485886367, -78.2444519704846, -62.02288805073687, -67.94582904419926, -96.16994782802244, -92.06918132327637, -48.13515953109143, -71.32998689377169, -55.67725816689861, -57.095016910678545, -37.06114128555048, -74.30058917847443, -59.08104440498751, -73.22546733703881, -112.0966365144393, -86.95065629323193, -58.69894768161101, -120.0676768845961, -59.782065955869214, -88.36297954015004, -44.957458774845605, -125.7526294139873, -101.29165490916569, -176.47082974349516, -64.1922046047403, -65.15947199159574, -118.82556597802679, -82.34436994003975, -98.05187073098742, -84.2903977122334, -78.18877260058062, -87.25927148872394, -42.70473661927357, -130.19524771918788, -70.14973852972655, -69.19246617142518, -63.80973556526581, -89.073187136682, -66.65401960590404, -104.95214503366029, -51.345323297312895, -74.64791970247119, -58.838546707221816, -82.53370005309176, -192.1194734953654, -90.62684801369694, -84.45088304713977, -122.71992355830999, -64.10991410359235, -47.33669329467385, -92.28160747152137, -66.43513623205514, -49.407788799600894, -115.55152342582038, -75.9642413891471, -62.258058245890496, -57.6722156997899, -65.91109320478749, -54.90519267438569, -150.18926188245186, -70.79854943095077, -69.05899227223817, -135.68640460821607, -60.67372786336516, -63.659260579379634], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6066202605538458, "mean_inference_ms": 5.212638414566986, "mean_action_processing_ms": 0.19435218282701008, "mean_env_wait_ms": 1.3528098151129995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1358000, "num_agent_steps_trained": 1358000, "num_env_steps_sampled": 1358000, "num_env_steps_trained": 1358000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1358000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1358000, "timers": {"training_iteration_time_ms": 75337.047, "load_time_ms": 29.184, "load_throughput": 479714.395, "learn_time_ms": 67648.639, "learn_throughput": 206.952, "synch_weights_time_ms": 12.714}, "counters": {"num_env_steps_sampled": 1358000, "num_env_steps_trained": 1358000, "num_agent_steps_sampled": 1358000, "num_agent_steps_trained": 1358000}, "done": false, "episodes_total": 1358, "training_iteration": 97, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-57-50", "timestamp": 1693058270, "time_this_iter_s": 75.36656665802002, "time_total_s": 7424.128874778748, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150A2790>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014F119A0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 7424.128874778748, "timesteps_since_restore": 0, "iterations_since_restore": 97, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.781308411214948, "ram_util_percent": 50.75327102803739}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -260.33060395725073, "episode_L1_reward_sum_min": -586.6671986281872, "episode_L1_reward_sum_max": -159.58398754149675, "episode_L2_reward_sum_mean": -142.07503449171782, "episode_L2_reward_sum_min": -222.63044029474258, "episode_L2_reward_sum_max": -116.11759378015995}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.0923122555174623, "policy_loss": 0.06704250194050645, "vf_loss": 0.25269753484136265, "vf_explained_var": 0.6697172131619336, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1372000, "num_env_steps_trained": 1372000, "num_agent_steps_sampled": 1372000, "num_agent_steps_trained": 1372000}, "sampler_results": {"episode_reward_max": -35.65791672236317, "episode_reward_min": -192.1194734953654, "episode_reward_mean": -83.7819149190656, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -260.33060395725073, "episode_L1_reward_sum_min": -586.6671986281872, "episode_L1_reward_sum_max": -159.58398754149675, "episode_L2_reward_sum_mean": -142.07503449171782, "episode_L2_reward_sum_min": -222.63044029474258, "episode_L2_reward_sum_max": -116.11759378015995}, "hist_stats": {"episode_reward": [-74.49846915871329, -50.694246713612465, -123.09531858881142, -67.30110017904533, -82.0731138932266, -56.09298166179221, -108.74366326504745, -85.31002724050555, -115.16177727934482, -133.54175556719335, -61.03115072962016, -77.91116777854329, -55.285576730854324, -77.66555150040791, -103.9310715947152, -106.41184813592987, -88.30469577030672, -112.66252014641141, -143.46997459040134, -35.65791672236317, -45.613994200103704, -97.6860485886367, -78.2444519704846, -62.02288805073687, -67.94582904419926, -96.16994782802244, -92.06918132327637, -48.13515953109143, -71.32998689377169, -55.67725816689861, -57.095016910678545, -37.06114128555048, -74.30058917847443, -59.08104440498751, -73.22546733703881, -112.0966365144393, -86.95065629323193, -58.69894768161101, -120.0676768845961, -59.782065955869214, -88.36297954015004, -44.957458774845605, -125.7526294139873, -101.29165490916569, -176.47082974349516, -64.1922046047403, -65.15947199159574, -118.82556597802679, -82.34436994003975, -98.05187073098742, -84.2903977122334, -78.18877260058062, -87.25927148872394, -42.70473661927357, -130.19524771918788, -70.14973852972655, -69.19246617142518, -63.80973556526581, -89.073187136682, -66.65401960590404, -104.95214503366029, -51.345323297312895, -74.64791970247119, -58.838546707221816, -82.53370005309176, -192.1194734953654, -90.62684801369694, -84.45088304713977, -122.71992355830999, -64.10991410359235, -47.33669329467385, -92.28160747152137, -66.43513623205514, -49.407788799600894, -115.55152342582038, -75.9642413891471, -62.258058245890496, -57.6722156997899, -65.91109320478749, -54.90519267438569, -150.18926188245186, -70.79854943095077, -69.05899227223817, -135.68640460821607, -60.67372786336516, -63.659260579379634, -46.53680132022235, -66.3086116143956, -140.3591644794889, -60.830121610781106, -182.7772962164345, -120.1066968091025, -72.98082375626772, -77.32473471847058, -81.96028845222972, -69.92727789691754, -103.10305728619552, -102.10949215332437, -70.8400175907649, -59.86815984924587], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6065960766879804, "mean_inference_ms": 5.21318939747741, "mean_action_processing_ms": 0.19439018530550578, "mean_env_wait_ms": 1.3529922609281744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -35.65791672236317, "episode_reward_min": -192.1194734953654, "episode_reward_mean": -83.7819149190656, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-74.49846915871329, -50.694246713612465, -123.09531858881142, -67.30110017904533, -82.0731138932266, -56.09298166179221, -108.74366326504745, -85.31002724050555, -115.16177727934482, -133.54175556719335, -61.03115072962016, -77.91116777854329, -55.285576730854324, -77.66555150040791, -103.9310715947152, -106.41184813592987, -88.30469577030672, -112.66252014641141, -143.46997459040134, -35.65791672236317, -45.613994200103704, -97.6860485886367, -78.2444519704846, -62.02288805073687, -67.94582904419926, -96.16994782802244, -92.06918132327637, -48.13515953109143, -71.32998689377169, -55.67725816689861, -57.095016910678545, -37.06114128555048, -74.30058917847443, -59.08104440498751, -73.22546733703881, -112.0966365144393, -86.95065629323193, -58.69894768161101, -120.0676768845961, -59.782065955869214, -88.36297954015004, -44.957458774845605, -125.7526294139873, -101.29165490916569, -176.47082974349516, -64.1922046047403, -65.15947199159574, -118.82556597802679, -82.34436994003975, -98.05187073098742, -84.2903977122334, -78.18877260058062, -87.25927148872394, -42.70473661927357, -130.19524771918788, -70.14973852972655, -69.19246617142518, -63.80973556526581, -89.073187136682, -66.65401960590404, -104.95214503366029, -51.345323297312895, -74.64791970247119, -58.838546707221816, -82.53370005309176, -192.1194734953654, -90.62684801369694, -84.45088304713977, -122.71992355830999, -64.10991410359235, -47.33669329467385, -92.28160747152137, -66.43513623205514, -49.407788799600894, -115.55152342582038, -75.9642413891471, -62.258058245890496, -57.6722156997899, -65.91109320478749, -54.90519267438569, -150.18926188245186, -70.79854943095077, -69.05899227223817, -135.68640460821607, -60.67372786336516, -63.659260579379634, -46.53680132022235, -66.3086116143956, -140.3591644794889, -60.830121610781106, -182.7772962164345, -120.1066968091025, -72.98082375626772, -77.32473471847058, -81.96028845222972, -69.92727789691754, -103.10305728619552, -102.10949215332437, -70.8400175907649, -59.86815984924587], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6065960766879804, "mean_inference_ms": 5.21318939747741, "mean_action_processing_ms": 0.19439018530550578, "mean_env_wait_ms": 1.3529922609281744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1372000, "num_agent_steps_trained": 1372000, "num_env_steps_sampled": 1372000, "num_env_steps_trained": 1372000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1372000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1372000, "timers": {"training_iteration_time_ms": 75368.828, "load_time_ms": 29.617, "load_throughput": 472705.3, "learn_time_ms": 67671.346, "learn_throughput": 206.882, "synch_weights_time_ms": 12.692}, "counters": {"num_env_steps_sampled": 1372000, "num_env_steps_trained": 1372000, "num_agent_steps_sampled": 1372000, "num_agent_steps_trained": 1372000}, "done": false, "episodes_total": 1372, "training_iteration": 98, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_14-59-06", "timestamp": 1693058346, "time_this_iter_s": 75.48647499084473, "time_total_s": 7499.615349769592, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014E8A250>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015309130>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 7499.615349769592, "timesteps_since_restore": 0, "iterations_since_restore": 98, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.814018691588785, "ram_util_percent": 50.752336448598136}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -260.5657191731781, "episode_L1_reward_sum_min": -586.6671986281872, "episode_L1_reward_sum_max": -159.58398754149675, "episode_L2_reward_sum_mean": -142.08106714107097, "episode_L2_reward_sum_min": -222.63044029474258, "episode_L2_reward_sum_max": -116.11759378015995}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.11299416207786987, "policy_loss": 0.07774856570895393, "vf_loss": 0.3524559588367334, "vf_explained_var": 0.5387301451752706, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000}, "sampler_results": {"episode_reward_max": -35.65791672236317, "episode_reward_min": -192.1194734953654, "episode_reward_mean": -83.45334501841978, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -260.5657191731781, "episode_L1_reward_sum_min": -586.6671986281872, "episode_L1_reward_sum_max": -159.58398754149675, "episode_L2_reward_sum_mean": -142.08106714107097, "episode_L2_reward_sum_min": -222.63044029474258, "episode_L2_reward_sum_max": -116.11759378015995}, "hist_stats": {"episode_reward": [-103.9310715947152, -106.41184813592987, -88.30469577030672, -112.66252014641141, -143.46997459040134, -35.65791672236317, -45.613994200103704, -97.6860485886367, -78.2444519704846, -62.02288805073687, -67.94582904419926, -96.16994782802244, -92.06918132327637, -48.13515953109143, -71.32998689377169, -55.67725816689861, -57.095016910678545, -37.06114128555048, -74.30058917847443, -59.08104440498751, -73.22546733703881, -112.0966365144393, -86.95065629323193, -58.69894768161101, -120.0676768845961, -59.782065955869214, -88.36297954015004, -44.957458774845605, -125.7526294139873, -101.29165490916569, -176.47082974349516, -64.1922046047403, -65.15947199159574, -118.82556597802679, -82.34436994003975, -98.05187073098742, -84.2903977122334, -78.18877260058062, -87.25927148872394, -42.70473661927357, -130.19524771918788, -70.14973852972655, -69.19246617142518, -63.80973556526581, -89.073187136682, -66.65401960590404, -104.95214503366029, -51.345323297312895, -74.64791970247119, -58.838546707221816, -82.53370005309176, -192.1194734953654, -90.62684801369694, -84.45088304713977, -122.71992355830999, -64.10991410359235, -47.33669329467385, -92.28160747152137, -66.43513623205514, -49.407788799600894, -115.55152342582038, -75.9642413891471, -62.258058245890496, -57.6722156997899, -65.91109320478749, -54.90519267438569, -150.18926188245186, -70.79854943095077, -69.05899227223817, -135.68640460821607, -60.67372786336516, -63.659260579379634, -46.53680132022235, -66.3086116143956, -140.3591644794889, -60.830121610781106, -182.7772962164345, -120.1066968091025, -72.98082375626772, -77.32473471847058, -81.96028845222972, -69.92727789691754, -103.10305728619552, -102.10949215332437, -70.8400175907649, -59.86815984924587, -148.10808185217473, -52.94054763919686, -58.34448326082377, -84.01670394608631, -71.7151332394087, -69.21531893454696, -57.30471780682911, -58.741471722249585, -41.75379306460357, -177.10610721996622, -64.56951859158922, -57.760072562729505, -133.94244251081514, -60.03051787111692], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6065542036726075, "mean_inference_ms": 5.213789236476143, "mean_action_processing_ms": 0.19442767731320912, "mean_env_wait_ms": 1.3531968760092699, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -35.65791672236317, "episode_reward_min": -192.1194734953654, "episode_reward_mean": -83.45334501841978, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-103.9310715947152, -106.41184813592987, -88.30469577030672, -112.66252014641141, -143.46997459040134, -35.65791672236317, -45.613994200103704, -97.6860485886367, -78.2444519704846, -62.02288805073687, -67.94582904419926, -96.16994782802244, -92.06918132327637, -48.13515953109143, -71.32998689377169, -55.67725816689861, -57.095016910678545, -37.06114128555048, -74.30058917847443, -59.08104440498751, -73.22546733703881, -112.0966365144393, -86.95065629323193, -58.69894768161101, -120.0676768845961, -59.782065955869214, -88.36297954015004, -44.957458774845605, -125.7526294139873, -101.29165490916569, -176.47082974349516, -64.1922046047403, -65.15947199159574, -118.82556597802679, -82.34436994003975, -98.05187073098742, -84.2903977122334, -78.18877260058062, -87.25927148872394, -42.70473661927357, -130.19524771918788, -70.14973852972655, -69.19246617142518, -63.80973556526581, -89.073187136682, -66.65401960590404, -104.95214503366029, -51.345323297312895, -74.64791970247119, -58.838546707221816, -82.53370005309176, -192.1194734953654, -90.62684801369694, -84.45088304713977, -122.71992355830999, -64.10991410359235, -47.33669329467385, -92.28160747152137, -66.43513623205514, -49.407788799600894, -115.55152342582038, -75.9642413891471, -62.258058245890496, -57.6722156997899, -65.91109320478749, -54.90519267438569, -150.18926188245186, -70.79854943095077, -69.05899227223817, -135.68640460821607, -60.67372786336516, -63.659260579379634, -46.53680132022235, -66.3086116143956, -140.3591644794889, -60.830121610781106, -182.7772962164345, -120.1066968091025, -72.98082375626772, -77.32473471847058, -81.96028845222972, -69.92727789691754, -103.10305728619552, -102.10949215332437, -70.8400175907649, -59.86815984924587, -148.10808185217473, -52.94054763919686, -58.34448326082377, -84.01670394608631, -71.7151332394087, -69.21531893454696, -57.30471780682911, -58.741471722249585, -41.75379306460357, -177.10610721996622, -64.56951859158922, -57.760072562729505, -133.94244251081514, -60.03051787111692], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6065542036726075, "mean_inference_ms": 5.213789236476143, "mean_action_processing_ms": 0.19442767731320912, "mean_env_wait_ms": 1.3531968760092699, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000, "num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1386000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1386000, "timers": {"training_iteration_time_ms": 75382.636, "load_time_ms": 29.514, "load_throughput": 474354.176, "learn_time_ms": 67671.319, "learn_throughput": 206.882, "synch_weights_time_ms": 13.194}, "counters": {"num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000}, "done": false, "episodes_total": 1386, "training_iteration": 99, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-00-21", "timestamp": 1693058421, "time_this_iter_s": 75.35667657852173, "time_total_s": 7574.972026348114, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150A2940>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270155F7D30>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 7574.972026348114, "timesteps_since_restore": 0, "iterations_since_restore": 99, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.90377358490566, "ram_util_percent": 50.75283018867925}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -262.15841538995505, "episode_L1_reward_sum_min": -586.6671986281872, "episode_L1_reward_sum_max": -167.16701114922762, "episode_L2_reward_sum_mean": -142.42651823736728, "episode_L2_reward_sum_min": -222.63044029474258, "episode_L2_reward_sum_max": -118.36997719109058}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.10119822172067301, "policy_loss": 0.06807432734731189, "vf_loss": 0.33123893925345554, "vf_explained_var": 0.6607491673572073, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1400000, "num_env_steps_trained": 1400000, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000}, "sampler_results": {"episode_reward_max": -37.06114128555048, "episode_reward_min": -192.1194734953654, "episode_reward_mean": -83.74279652867584, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -262.15841538995505, "episode_L1_reward_sum_min": -586.6671986281872, "episode_L1_reward_sum_max": -167.16701114922762, "episode_L2_reward_sum_mean": -142.42651823736728, "episode_L2_reward_sum_min": -222.63044029474258, "episode_L2_reward_sum_max": -118.36997719109058}, "hist_stats": {"episode_reward": [-71.32998689377169, -55.67725816689861, -57.095016910678545, -37.06114128555048, -74.30058917847443, -59.08104440498751, -73.22546733703881, -112.0966365144393, -86.95065629323193, -58.69894768161101, -120.0676768845961, -59.782065955869214, -88.36297954015004, -44.957458774845605, -125.7526294139873, -101.29165490916569, -176.47082974349516, -64.1922046047403, -65.15947199159574, -118.82556597802679, -82.34436994003975, -98.05187073098742, -84.2903977122334, -78.18877260058062, -87.25927148872394, -42.70473661927357, -130.19524771918788, -70.14973852972655, -69.19246617142518, -63.80973556526581, -89.073187136682, -66.65401960590404, -104.95214503366029, -51.345323297312895, -74.64791970247119, -58.838546707221816, -82.53370005309176, -192.1194734953654, -90.62684801369694, -84.45088304713977, -122.71992355830999, -64.10991410359235, -47.33669329467385, -92.28160747152137, -66.43513623205514, -49.407788799600894, -115.55152342582038, -75.9642413891471, -62.258058245890496, -57.6722156997899, -65.91109320478749, -54.90519267438569, -150.18926188245186, -70.79854943095077, -69.05899227223817, -135.68640460821607, -60.67372786336516, -63.659260579379634, -46.53680132022235, -66.3086116143956, -140.3591644794889, -60.830121610781106, -182.7772962164345, -120.1066968091025, -72.98082375626772, -77.32473471847058, -81.96028845222972, -69.92727789691754, -103.10305728619552, -102.10949215332437, -70.8400175907649, -59.86815984924587, -148.10808185217473, -52.94054763919686, -58.34448326082377, -84.01670394608631, -71.7151332394087, -69.21531893454696, -57.30471780682911, -58.741471722249585, -41.75379306460357, -177.10610721996622, -64.56951859158922, -57.760072562729505, -133.94244251081514, -60.03051787111692, -127.62728240781477, -53.50521519127347, -58.640562020576965, -110.05414698171361, -74.44837856351835, -107.4382907975064, -144.8191928671611, -50.33803694227045, -123.89267492676943, -110.184586880776, -53.1907881892518, -41.96919722082219, -86.0103365337559, -65.15198899907328], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6065325032580123, "mean_inference_ms": 5.214374187386315, "mean_action_processing_ms": 0.19446907222147494, "mean_env_wait_ms": 1.353385003111375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -37.06114128555048, "episode_reward_min": -192.1194734953654, "episode_reward_mean": -83.74279652867584, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-71.32998689377169, -55.67725816689861, -57.095016910678545, -37.06114128555048, -74.30058917847443, -59.08104440498751, -73.22546733703881, -112.0966365144393, -86.95065629323193, -58.69894768161101, -120.0676768845961, -59.782065955869214, -88.36297954015004, -44.957458774845605, -125.7526294139873, -101.29165490916569, -176.47082974349516, -64.1922046047403, -65.15947199159574, -118.82556597802679, -82.34436994003975, -98.05187073098742, -84.2903977122334, -78.18877260058062, -87.25927148872394, -42.70473661927357, -130.19524771918788, -70.14973852972655, -69.19246617142518, -63.80973556526581, -89.073187136682, -66.65401960590404, -104.95214503366029, -51.345323297312895, -74.64791970247119, -58.838546707221816, -82.53370005309176, -192.1194734953654, -90.62684801369694, -84.45088304713977, -122.71992355830999, -64.10991410359235, -47.33669329467385, -92.28160747152137, -66.43513623205514, -49.407788799600894, -115.55152342582038, -75.9642413891471, -62.258058245890496, -57.6722156997899, -65.91109320478749, -54.90519267438569, -150.18926188245186, -70.79854943095077, -69.05899227223817, -135.68640460821607, -60.67372786336516, -63.659260579379634, -46.53680132022235, -66.3086116143956, -140.3591644794889, -60.830121610781106, -182.7772962164345, -120.1066968091025, -72.98082375626772, -77.32473471847058, -81.96028845222972, -69.92727789691754, -103.10305728619552, -102.10949215332437, -70.8400175907649, -59.86815984924587, -148.10808185217473, -52.94054763919686, -58.34448326082377, -84.01670394608631, -71.7151332394087, -69.21531893454696, -57.30471780682911, -58.741471722249585, -41.75379306460357, -177.10610721996622, -64.56951859158922, -57.760072562729505, -133.94244251081514, -60.03051787111692, -127.62728240781477, -53.50521519127347, -58.640562020576965, -110.05414698171361, -74.44837856351835, -107.4382907975064, -144.8191928671611, -50.33803694227045, -123.89267492676943, -110.184586880776, -53.1907881892518, -41.96919722082219, -86.0103365337559, -65.15198899907328], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6065325032580123, "mean_inference_ms": 5.214374187386315, "mean_action_processing_ms": 0.19446907222147494, "mean_env_wait_ms": 1.353385003111375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000, "num_env_steps_sampled": 1400000, "num_env_steps_trained": 1400000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1400000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1400000, "timers": {"training_iteration_time_ms": 75385.138, "load_time_ms": 30.013, "load_throughput": 466471.743, "learn_time_ms": 67655.299, "learn_throughput": 206.931, "synch_weights_time_ms": 13.596}, "counters": {"num_env_steps_sampled": 1400000, "num_env_steps_trained": 1400000, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000}, "done": false, "episodes_total": 1400, "training_iteration": 100, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-01-37", "timestamp": 1693058497, "time_this_iter_s": 75.37203574180603, "time_total_s": 7650.34406208992, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270152D10A0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270155F7160>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 7650.34406208992, "timesteps_since_restore": 0, "iterations_since_restore": 100, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.71588785046729, "ram_util_percent": 50.81121495327101}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -270.09154356375336, "episode_L1_reward_sum_min": -586.6671986281872, "episode_L1_reward_sum_max": -160.38428024202585, "episode_L2_reward_sum_mean": -144.4703099244833, "episode_L2_reward_sum_min": -222.63044029474258, "episode_L2_reward_sum_max": -116.58855047821999}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.08255128131737673, "policy_loss": 0.0503438935905442, "vf_loss": 0.32207387667843834, "vf_explained_var": 0.6185830894995619, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1414000, "num_env_steps_trained": 1414000, "num_agent_steps_sampled": 1414000, "num_agent_steps_trained": 1414000}, "sampler_results": {"episode_reward_max": -41.75379306460357, "episode_reward_min": -192.1194734953654, "episode_reward_mean": -87.49424439569131, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -270.09154356375336, "episode_L1_reward_sum_min": -586.6671986281872, "episode_L1_reward_sum_max": -160.38428024202585, "episode_L2_reward_sum_mean": -144.4703099244833, "episode_L2_reward_sum_min": -222.63044029474258, "episode_L2_reward_sum_max": -116.58855047821999}, "hist_stats": {"episode_reward": [-125.7526294139873, -101.29165490916569, -176.47082974349516, -64.1922046047403, -65.15947199159574, -118.82556597802679, -82.34436994003975, -98.05187073098742, -84.2903977122334, -78.18877260058062, -87.25927148872394, -42.70473661927357, -130.19524771918788, -70.14973852972655, -69.19246617142518, -63.80973556526581, -89.073187136682, -66.65401960590404, -104.95214503366029, -51.345323297312895, -74.64791970247119, -58.838546707221816, -82.53370005309176, -192.1194734953654, -90.62684801369694, -84.45088304713977, -122.71992355830999, -64.10991410359235, -47.33669329467385, -92.28160747152137, -66.43513623205514, -49.407788799600894, -115.55152342582038, -75.9642413891471, -62.258058245890496, -57.6722156997899, -65.91109320478749, -54.90519267438569, -150.18926188245186, -70.79854943095077, -69.05899227223817, -135.68640460821607, -60.67372786336516, -63.659260579379634, -46.53680132022235, -66.3086116143956, -140.3591644794889, -60.830121610781106, -182.7772962164345, -120.1066968091025, -72.98082375626772, -77.32473471847058, -81.96028845222972, -69.92727789691754, -103.10305728619552, -102.10949215332437, -70.8400175907649, -59.86815984924587, -148.10808185217473, -52.94054763919686, -58.34448326082377, -84.01670394608631, -71.7151332394087, -69.21531893454696, -57.30471780682911, -58.741471722249585, -41.75379306460357, -177.10610721996622, -64.56951859158922, -57.760072562729505, -133.94244251081514, -60.03051787111692, -127.62728240781477, -53.50521519127347, -58.640562020576965, -110.05414698171361, -74.44837856351835, -107.4382907975064, -144.8191928671611, -50.33803694227045, -123.89267492676943, -110.184586880776, -53.1907881892518, -41.96919722082219, -86.0103365337559, -65.15198899907328, -137.33469675493166, -102.99393509708037, -46.06245366145337, -61.178786625091554, -77.88562513614556, -73.76871953085801, -107.01549264274664, -51.15446167043997, -127.28250492577037, -101.88791425205494, -158.88480934305733, -116.07548327807542, -80.94097959246258, -131.3658500135268], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6065237751477939, "mean_inference_ms": 5.215005403604664, "mean_action_processing_ms": 0.19450562947282599, "mean_env_wait_ms": 1.3535794464602577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -41.75379306460357, "episode_reward_min": -192.1194734953654, "episode_reward_mean": -87.49424439569131, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-125.7526294139873, -101.29165490916569, -176.47082974349516, -64.1922046047403, -65.15947199159574, -118.82556597802679, -82.34436994003975, -98.05187073098742, -84.2903977122334, -78.18877260058062, -87.25927148872394, -42.70473661927357, -130.19524771918788, -70.14973852972655, -69.19246617142518, -63.80973556526581, -89.073187136682, -66.65401960590404, -104.95214503366029, -51.345323297312895, -74.64791970247119, -58.838546707221816, -82.53370005309176, -192.1194734953654, -90.62684801369694, -84.45088304713977, -122.71992355830999, -64.10991410359235, -47.33669329467385, -92.28160747152137, -66.43513623205514, -49.407788799600894, -115.55152342582038, -75.9642413891471, -62.258058245890496, -57.6722156997899, -65.91109320478749, -54.90519267438569, -150.18926188245186, -70.79854943095077, -69.05899227223817, -135.68640460821607, -60.67372786336516, -63.659260579379634, -46.53680132022235, -66.3086116143956, -140.3591644794889, -60.830121610781106, -182.7772962164345, -120.1066968091025, -72.98082375626772, -77.32473471847058, -81.96028845222972, -69.92727789691754, -103.10305728619552, -102.10949215332437, -70.8400175907649, -59.86815984924587, -148.10808185217473, -52.94054763919686, -58.34448326082377, -84.01670394608631, -71.7151332394087, -69.21531893454696, -57.30471780682911, -58.741471722249585, -41.75379306460357, -177.10610721996622, -64.56951859158922, -57.760072562729505, -133.94244251081514, -60.03051787111692, -127.62728240781477, -53.50521519127347, -58.640562020576965, -110.05414698171361, -74.44837856351835, -107.4382907975064, -144.8191928671611, -50.33803694227045, -123.89267492676943, -110.184586880776, -53.1907881892518, -41.96919722082219, -86.0103365337559, -65.15198899907328, -137.33469675493166, -102.99393509708037, -46.06245366145337, -61.178786625091554, -77.88562513614556, -73.76871953085801, -107.01549264274664, -51.15446167043997, -127.28250492577037, -101.88791425205494, -158.88480934305733, -116.07548327807542, -80.94097959246258, -131.3658500135268], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6065237751477939, "mean_inference_ms": 5.215005403604664, "mean_action_processing_ms": 0.19450562947282599, "mean_env_wait_ms": 1.3535794464602577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1414000, "num_agent_steps_trained": 1414000, "num_env_steps_sampled": 1414000, "num_env_steps_trained": 1414000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1414000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1414000, "timers": {"training_iteration_time_ms": 75412.531, "load_time_ms": 30.312, "load_throughput": 461867.804, "learn_time_ms": 67679.675, "learn_throughput": 206.857, "synch_weights_time_ms": 14.094}, "counters": {"num_env_steps_sampled": 1414000, "num_env_steps_trained": 1414000, "num_agent_steps_sampled": 1414000, "num_agent_steps_trained": 1414000}, "done": false, "episodes_total": 1414, "training_iteration": 101, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-02-52", "timestamp": 1693058572, "time_this_iter_s": 75.53576564788818, "time_total_s": 7725.879827737808, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014F11DC0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270155F7CD0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 7725.879827737808, "timesteps_since_restore": 0, "iterations_since_restore": 101, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.959813084112152, "ram_util_percent": 50.9626168224299}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -266.32593820795415, "episode_L1_reward_sum_min": -586.6671986281872, "episode_L1_reward_sum_max": -158.27662391215563, "episode_L2_reward_sum_mean": -143.49575655326248, "episode_L2_reward_sum_min": -222.63044029474258, "episode_L2_reward_sum_max": -115.6362765878439}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.0739541960192208, "policy_loss": 0.05186677845903968, "vf_loss": 0.22087416785446842, "vf_explained_var": 0.7357934322438122, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "sampler_results": {"episode_reward_max": -41.75379306460357, "episode_reward_min": -192.1194734953654, "episode_reward_mean": -84.98837802924749, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -266.32593820795415, "episode_L1_reward_sum_min": -586.6671986281872, "episode_L1_reward_sum_max": -158.27662391215563, "episode_L2_reward_sum_mean": -143.49575655326248, "episode_L2_reward_sum_min": -222.63044029474258, "episode_L2_reward_sum_max": -115.6362765878439}, "hist_stats": {"episode_reward": [-69.19246617142518, -63.80973556526581, -89.073187136682, -66.65401960590404, -104.95214503366029, -51.345323297312895, -74.64791970247119, -58.838546707221816, -82.53370005309176, -192.1194734953654, -90.62684801369694, -84.45088304713977, -122.71992355830999, -64.10991410359235, -47.33669329467385, -92.28160747152137, -66.43513623205514, -49.407788799600894, -115.55152342582038, -75.9642413891471, -62.258058245890496, -57.6722156997899, -65.91109320478749, -54.90519267438569, -150.18926188245186, -70.79854943095077, -69.05899227223817, -135.68640460821607, -60.67372786336516, -63.659260579379634, -46.53680132022235, -66.3086116143956, -140.3591644794889, -60.830121610781106, -182.7772962164345, -120.1066968091025, -72.98082375626772, -77.32473471847058, -81.96028845222972, -69.92727789691754, -103.10305728619552, -102.10949215332437, -70.8400175907649, -59.86815984924587, -148.10808185217473, -52.94054763919686, -58.34448326082377, -84.01670394608631, -71.7151332394087, -69.21531893454696, -57.30471780682911, -58.741471722249585, -41.75379306460357, -177.10610721996622, -64.56951859158922, -57.760072562729505, -133.94244251081514, -60.03051787111692, -127.62728240781477, -53.50521519127347, -58.640562020576965, -110.05414698171361, -74.44837856351835, -107.4382907975064, -144.8191928671611, -50.33803694227045, -123.89267492676943, -110.184586880776, -53.1907881892518, -41.96919722082219, -86.0103365337559, -65.15198899907328, -137.33469675493166, -102.99393509708037, -46.06245366145337, -61.178786625091554, -77.88562513614556, -73.76871953085801, -107.01549264274664, -51.15446167043997, -127.28250492577037, -101.88791425205494, -158.88480934305733, -116.07548327807542, -80.94097959246258, -131.3658500135268, -84.21954835540664, -89.66315799047342, -57.65891208324735, -78.83161068450454, -80.66431988239445, -54.4181817844459, -59.47786794008232, -84.75245524808153, -106.63139512575145, -42.37171009362036, -50.03824547648887, -96.69729408006313, -103.527881600764, -85.33754499205428], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6065173997206482, "mean_inference_ms": 5.215756329658458, "mean_action_processing_ms": 0.19454778789008007, "mean_env_wait_ms": 1.3537971456604134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -41.75379306460357, "episode_reward_min": -192.1194734953654, "episode_reward_mean": -84.98837802924749, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-69.19246617142518, -63.80973556526581, -89.073187136682, -66.65401960590404, -104.95214503366029, -51.345323297312895, -74.64791970247119, -58.838546707221816, -82.53370005309176, -192.1194734953654, -90.62684801369694, -84.45088304713977, -122.71992355830999, -64.10991410359235, -47.33669329467385, -92.28160747152137, -66.43513623205514, -49.407788799600894, -115.55152342582038, -75.9642413891471, -62.258058245890496, -57.6722156997899, -65.91109320478749, -54.90519267438569, -150.18926188245186, -70.79854943095077, -69.05899227223817, -135.68640460821607, -60.67372786336516, -63.659260579379634, -46.53680132022235, -66.3086116143956, -140.3591644794889, -60.830121610781106, -182.7772962164345, -120.1066968091025, -72.98082375626772, -77.32473471847058, -81.96028845222972, -69.92727789691754, -103.10305728619552, -102.10949215332437, -70.8400175907649, -59.86815984924587, -148.10808185217473, -52.94054763919686, -58.34448326082377, -84.01670394608631, -71.7151332394087, -69.21531893454696, -57.30471780682911, -58.741471722249585, -41.75379306460357, -177.10610721996622, -64.56951859158922, -57.760072562729505, -133.94244251081514, -60.03051787111692, -127.62728240781477, -53.50521519127347, -58.640562020576965, -110.05414698171361, -74.44837856351835, -107.4382907975064, -144.8191928671611, -50.33803694227045, -123.89267492676943, -110.184586880776, -53.1907881892518, -41.96919722082219, -86.0103365337559, -65.15198899907328, -137.33469675493166, -102.99393509708037, -46.06245366145337, -61.178786625091554, -77.88562513614556, -73.76871953085801, -107.01549264274664, -51.15446167043997, -127.28250492577037, -101.88791425205494, -158.88480934305733, -116.07548327807542, -80.94097959246258, -131.3658500135268, -84.21954835540664, -89.66315799047342, -57.65891208324735, -78.83161068450454, -80.66431988239445, -54.4181817844459, -59.47786794008232, -84.75245524808153, -106.63139512575145, -42.37171009362036, -50.03824547648887, -96.69729408006313, -103.527881600764, -85.33754499205428], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6065173997206482, "mean_inference_ms": 5.215756329658458, "mean_action_processing_ms": 0.19454778789008007, "mean_env_wait_ms": 1.3537971456604134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000, "num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1428000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1428000, "timers": {"training_iteration_time_ms": 75450.688, "load_time_ms": 31.019, "load_throughput": 451334.945, "learn_time_ms": 67715.507, "learn_throughput": 206.747, "synch_weights_time_ms": 13.994}, "counters": {"num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "done": false, "episodes_total": 1428, "training_iteration": 102, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-04-08", "timestamp": 1693058648, "time_this_iter_s": 75.66671323776245, "time_total_s": 7801.546540975571, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270155F7190>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015359670>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 7801.546540975571, "timesteps_since_restore": 0, "iterations_since_restore": 102, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 22.176415094339625, "ram_util_percent": 51.278301886792455}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -274.833401414603, "episode_L1_reward_sum_min": -626.1262888014317, "episode_L1_reward_sum_max": -158.27662391215563, "episode_L2_reward_sum_mean": -145.58257180072368, "episode_L2_reward_sum_min": -230.30518727004528, "episode_L2_reward_sum_max": -115.6362765878439}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.06788843771090171, "policy_loss": 0.03536524552920902, "vf_loss": 0.32523192145979785, "vf_explained_var": 0.6726835791956741, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1442000, "num_env_steps_trained": 1442000, "num_agent_steps_sampled": 1442000, "num_agent_steps_trained": 1442000}, "sampler_results": {"episode_reward_max": -41.75379306460357, "episode_reward_min": -209.73843399100286, "episode_reward_mean": -87.79139868217614, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -274.833401414603, "episode_L1_reward_sum_min": -626.1262888014317, "episode_L1_reward_sum_max": -158.27662391215563, "episode_L2_reward_sum_mean": -145.58257180072368, "episode_L2_reward_sum_min": -230.30518727004528, "episode_L2_reward_sum_max": -115.6362765878439}, "hist_stats": {"episode_reward": [-47.33669329467385, -92.28160747152137, -66.43513623205514, -49.407788799600894, -115.55152342582038, -75.9642413891471, -62.258058245890496, -57.6722156997899, -65.91109320478749, -54.90519267438569, -150.18926188245186, -70.79854943095077, -69.05899227223817, -135.68640460821607, -60.67372786336516, -63.659260579379634, -46.53680132022235, -66.3086116143956, -140.3591644794889, -60.830121610781106, -182.7772962164345, -120.1066968091025, -72.98082375626772, -77.32473471847058, -81.96028845222972, -69.92727789691754, -103.10305728619552, -102.10949215332437, -70.8400175907649, -59.86815984924587, -148.10808185217473, -52.94054763919686, -58.34448326082377, -84.01670394608631, -71.7151332394087, -69.21531893454696, -57.30471780682911, -58.741471722249585, -41.75379306460357, -177.10610721996622, -64.56951859158922, -57.760072562729505, -133.94244251081514, -60.03051787111692, -127.62728240781477, -53.50521519127347, -58.640562020576965, -110.05414698171361, -74.44837856351835, -107.4382907975064, -144.8191928671611, -50.33803694227045, -123.89267492676943, -110.184586880776, -53.1907881892518, -41.96919722082219, -86.0103365337559, -65.15198899907328, -137.33469675493166, -102.99393509708037, -46.06245366145337, -61.178786625091554, -77.88562513614556, -73.76871953085801, -107.01549264274664, -51.15446167043997, -127.28250492577037, -101.88791425205494, -158.88480934305733, -116.07548327807542, -80.94097959246258, -131.3658500135268, -84.21954835540664, -89.66315799047342, -57.65891208324735, -78.83161068450454, -80.66431988239445, -54.4181817844459, -59.47786794008232, -84.75245524808153, -106.63139512575145, -42.37171009362036, -50.03824547648887, -96.69729408006313, -103.527881600764, -85.33754499205428, -64.59265595427645, -82.98272284146253, -106.35123003660951, -92.92323792041721, -132.4511822700516, -69.38129212589911, -99.21197368542946, -89.01054901804838, -209.73843399100286, -91.64685329514293, -162.08828061078844, -166.82058353411114, -45.811591489469144, -82.36556401129516], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6064865899236475, "mean_inference_ms": 5.216530982329427, "mean_action_processing_ms": 0.19457555859112824, "mean_env_wait_ms": 1.3540296896220887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -41.75379306460357, "episode_reward_min": -209.73843399100286, "episode_reward_mean": -87.79139868217614, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-47.33669329467385, -92.28160747152137, -66.43513623205514, -49.407788799600894, -115.55152342582038, -75.9642413891471, -62.258058245890496, -57.6722156997899, -65.91109320478749, -54.90519267438569, -150.18926188245186, -70.79854943095077, -69.05899227223817, -135.68640460821607, -60.67372786336516, -63.659260579379634, -46.53680132022235, -66.3086116143956, -140.3591644794889, -60.830121610781106, -182.7772962164345, -120.1066968091025, -72.98082375626772, -77.32473471847058, -81.96028845222972, -69.92727789691754, -103.10305728619552, -102.10949215332437, -70.8400175907649, -59.86815984924587, -148.10808185217473, -52.94054763919686, -58.34448326082377, -84.01670394608631, -71.7151332394087, -69.21531893454696, -57.30471780682911, -58.741471722249585, -41.75379306460357, -177.10610721996622, -64.56951859158922, -57.760072562729505, -133.94244251081514, -60.03051787111692, -127.62728240781477, -53.50521519127347, -58.640562020576965, -110.05414698171361, -74.44837856351835, -107.4382907975064, -144.8191928671611, -50.33803694227045, -123.89267492676943, -110.184586880776, -53.1907881892518, -41.96919722082219, -86.0103365337559, -65.15198899907328, -137.33469675493166, -102.99393509708037, -46.06245366145337, -61.178786625091554, -77.88562513614556, -73.76871953085801, -107.01549264274664, -51.15446167043997, -127.28250492577037, -101.88791425205494, -158.88480934305733, -116.07548327807542, -80.94097959246258, -131.3658500135268, -84.21954835540664, -89.66315799047342, -57.65891208324735, -78.83161068450454, -80.66431988239445, -54.4181817844459, -59.47786794008232, -84.75245524808153, -106.63139512575145, -42.37171009362036, -50.03824547648887, -96.69729408006313, -103.527881600764, -85.33754499205428, -64.59265595427645, -82.98272284146253, -106.35123003660951, -92.92323792041721, -132.4511822700516, -69.38129212589911, -99.21197368542946, -89.01054901804838, -209.73843399100286, -91.64685329514293, -162.08828061078844, -166.82058353411114, -45.811591489469144, -82.36556401129516], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6064865899236475, "mean_inference_ms": 5.216530982329427, "mean_action_processing_ms": 0.19457555859112824, "mean_env_wait_ms": 1.3540296896220887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1442000, "num_agent_steps_trained": 1442000, "num_env_steps_sampled": 1442000, "num_env_steps_trained": 1442000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1442000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1442000, "timers": {"training_iteration_time_ms": 75432.101, "load_time_ms": 30.772, "load_throughput": 454955.256, "learn_time_ms": 67699.401, "learn_throughput": 206.797, "synch_weights_time_ms": 14.379}, "counters": {"num_env_steps_sampled": 1442000, "num_env_steps_trained": 1442000, "num_agent_steps_sampled": 1442000, "num_agent_steps_trained": 1442000}, "done": false, "episodes_total": 1442, "training_iteration": 103, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-05-23", "timestamp": 1693058723, "time_this_iter_s": 75.23592209815979, "time_total_s": 7876.7824630737305, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014F037C0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270155F7460>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 7876.7824630737305, "timesteps_since_restore": 0, "iterations_since_restore": 103, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.772897196261685, "ram_util_percent": 51.100934579439254}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -284.7229529491067, "episode_L1_reward_sum_min": -626.1262888014317, "episode_L1_reward_sum_max": -158.27662391215563, "episode_L2_reward_sum_mean": -148.08342662259938, "episode_L2_reward_sum_min": -230.30518727004528, "episode_L2_reward_sum_max": -115.6362765878439}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.03397921358001391, "policy_loss": 0.0053127711742288536, "vf_loss": 0.2866644014592243, "vf_explained_var": 0.7151494281588758, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1456000, "num_env_steps_trained": 1456000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "sampler_results": {"episode_reward_max": -36.59839506845457, "episode_reward_min": -209.73843399100286, "episode_reward_mean": -90.5802390932511, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -284.7229529491067, "episode_L1_reward_sum_min": -626.1262888014317, "episode_L1_reward_sum_max": -158.27662391215563, "episode_L2_reward_sum_mean": -148.08342662259938, "episode_L2_reward_sum_min": -230.30518727004528, "episode_L2_reward_sum_max": -115.6362765878439}, "hist_stats": {"episode_reward": [-60.67372786336516, -63.659260579379634, -46.53680132022235, -66.3086116143956, -140.3591644794889, -60.830121610781106, -182.7772962164345, -120.1066968091025, -72.98082375626772, -77.32473471847058, -81.96028845222972, -69.92727789691754, -103.10305728619552, -102.10949215332437, -70.8400175907649, -59.86815984924587, -148.10808185217473, -52.94054763919686, -58.34448326082377, -84.01670394608631, -71.7151332394087, -69.21531893454696, -57.30471780682911, -58.741471722249585, -41.75379306460357, -177.10610721996622, -64.56951859158922, -57.760072562729505, -133.94244251081514, -60.03051787111692, -127.62728240781477, -53.50521519127347, -58.640562020576965, -110.05414698171361, -74.44837856351835, -107.4382907975064, -144.8191928671611, -50.33803694227045, -123.89267492676943, -110.184586880776, -53.1907881892518, -41.96919722082219, -86.0103365337559, -65.15198899907328, -137.33469675493166, -102.99393509708037, -46.06245366145337, -61.178786625091554, -77.88562513614556, -73.76871953085801, -107.01549264274664, -51.15446167043997, -127.28250492577037, -101.88791425205494, -158.88480934305733, -116.07548327807542, -80.94097959246258, -131.3658500135268, -84.21954835540664, -89.66315799047342, -57.65891208324735, -78.83161068450454, -80.66431988239445, -54.4181817844459, -59.47786794008232, -84.75245524808153, -106.63139512575145, -42.37171009362036, -50.03824547648887, -96.69729408006313, -103.527881600764, -85.33754499205428, -64.59265595427645, -82.98272284146253, -106.35123003660951, -92.92323792041721, -132.4511822700516, -69.38129212589911, -99.21197368542946, -89.01054901804838, -209.73843399100286, -91.64685329514293, -162.08828061078844, -166.82058353411114, -45.811591489469144, -82.36556401129516, -145.99366983809202, -61.82536450696803, -69.33852679344477, -96.9917479091452, -176.98335019832786, -75.67142367473853, -60.6261600636901, -77.82315942524147, -96.23436849418387, -165.03622413546026, -43.46326198564499, -158.29830369585233, -127.45684394978203, -36.59839506845457], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6064785802140298, "mean_inference_ms": 5.217279172065676, "mean_action_processing_ms": 0.1946057329678542, "mean_env_wait_ms": 1.3542524674297425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -36.59839506845457, "episode_reward_min": -209.73843399100286, "episode_reward_mean": -90.5802390932511, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-60.67372786336516, -63.659260579379634, -46.53680132022235, -66.3086116143956, -140.3591644794889, -60.830121610781106, -182.7772962164345, -120.1066968091025, -72.98082375626772, -77.32473471847058, -81.96028845222972, -69.92727789691754, -103.10305728619552, -102.10949215332437, -70.8400175907649, -59.86815984924587, -148.10808185217473, -52.94054763919686, -58.34448326082377, -84.01670394608631, -71.7151332394087, -69.21531893454696, -57.30471780682911, -58.741471722249585, -41.75379306460357, -177.10610721996622, -64.56951859158922, -57.760072562729505, -133.94244251081514, -60.03051787111692, -127.62728240781477, -53.50521519127347, -58.640562020576965, -110.05414698171361, -74.44837856351835, -107.4382907975064, -144.8191928671611, -50.33803694227045, -123.89267492676943, -110.184586880776, -53.1907881892518, -41.96919722082219, -86.0103365337559, -65.15198899907328, -137.33469675493166, -102.99393509708037, -46.06245366145337, -61.178786625091554, -77.88562513614556, -73.76871953085801, -107.01549264274664, -51.15446167043997, -127.28250492577037, -101.88791425205494, -158.88480934305733, -116.07548327807542, -80.94097959246258, -131.3658500135268, -84.21954835540664, -89.66315799047342, -57.65891208324735, -78.83161068450454, -80.66431988239445, -54.4181817844459, -59.47786794008232, -84.75245524808153, -106.63139512575145, -42.37171009362036, -50.03824547648887, -96.69729408006313, -103.527881600764, -85.33754499205428, -64.59265595427645, -82.98272284146253, -106.35123003660951, -92.92323792041721, -132.4511822700516, -69.38129212589911, -99.21197368542946, -89.01054901804838, -209.73843399100286, -91.64685329514293, -162.08828061078844, -166.82058353411114, -45.811591489469144, -82.36556401129516, -145.99366983809202, -61.82536450696803, -69.33852679344477, -96.9917479091452, -176.98335019832786, -75.67142367473853, -60.6261600636901, -77.82315942524147, -96.23436849418387, -165.03622413546026, -43.46326198564499, -158.29830369585233, -127.45684394978203, -36.59839506845457], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6064785802140298, "mean_inference_ms": 5.217279172065676, "mean_action_processing_ms": 0.1946057329678542, "mean_env_wait_ms": 1.3542524674297425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 1456000, "num_env_steps_trained": 1456000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1456000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 75404.961, "load_time_ms": 30.675, "load_throughput": 456393.728, "learn_time_ms": 67671.348, "learn_throughput": 206.882, "synch_weights_time_ms": 13.777}, "counters": {"num_env_steps_sampled": 1456000, "num_env_steps_trained": 1456000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "episodes_total": 1456, "training_iteration": 104, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-06-39", "timestamp": 1693058799, "time_this_iter_s": 75.39312887191772, "time_total_s": 7952.175591945648, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701517AEE0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270153A5F70>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 7952.175591945648, "timesteps_since_restore": 0, "iterations_since_restore": 104, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.819626168224303, "ram_util_percent": 51.074766355140184}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -285.7011931347102, "episode_L1_reward_sum_min": -626.1262888014317, "episode_L1_reward_sum_max": -158.27662391215563, "episode_L2_reward_sum_mean": -148.32273523144423, "episode_L2_reward_sum_min": -230.30518727004528, "episode_L2_reward_sum_max": -115.6362765878439}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.06591657073161218, "policy_loss": 0.035197812813423275, "vf_loss": 0.30718757196792734, "vf_explained_var": 0.6385990847592, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1470000, "num_env_steps_trained": 1470000, "num_agent_steps_sampled": 1470000, "num_agent_steps_trained": 1470000}, "sampler_results": {"episode_reward_max": -36.59839506845457, "episode_reward_min": -209.73843399100286, "episode_reward_mean": -90.64561278852278, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -285.7011931347102, "episode_L1_reward_sum_min": -626.1262888014317, "episode_L1_reward_sum_max": -158.27662391215563, "episode_L2_reward_sum_mean": -148.32273523144423, "episode_L2_reward_sum_min": -230.30518727004528, "episode_L2_reward_sum_max": -115.6362765878439}, "hist_stats": {"episode_reward": [-70.8400175907649, -59.86815984924587, -148.10808185217473, -52.94054763919686, -58.34448326082377, -84.01670394608631, -71.7151332394087, -69.21531893454696, -57.30471780682911, -58.741471722249585, -41.75379306460357, -177.10610721996622, -64.56951859158922, -57.760072562729505, -133.94244251081514, -60.03051787111692, -127.62728240781477, -53.50521519127347, -58.640562020576965, -110.05414698171361, -74.44837856351835, -107.4382907975064, -144.8191928671611, -50.33803694227045, -123.89267492676943, -110.184586880776, -53.1907881892518, -41.96919722082219, -86.0103365337559, -65.15198899907328, -137.33469675493166, -102.99393509708037, -46.06245366145337, -61.178786625091554, -77.88562513614556, -73.76871953085801, -107.01549264274664, -51.15446167043997, -127.28250492577037, -101.88791425205494, -158.88480934305733, -116.07548327807542, -80.94097959246258, -131.3658500135268, -84.21954835540664, -89.66315799047342, -57.65891208324735, -78.83161068450454, -80.66431988239445, -54.4181817844459, -59.47786794008232, -84.75245524808153, -106.63139512575145, -42.37171009362036, -50.03824547648887, -96.69729408006313, -103.527881600764, -85.33754499205428, -64.59265595427645, -82.98272284146253, -106.35123003660951, -92.92323792041721, -132.4511822700516, -69.38129212589911, -99.21197368542946, -89.01054901804838, -209.73843399100286, -91.64685329514293, -162.08828061078844, -166.82058353411114, -45.811591489469144, -82.36556401129516, -145.99366983809202, -61.82536450696803, -69.33852679344477, -96.9917479091452, -176.98335019832786, -75.67142367473853, -60.6261600636901, -77.82315942524147, -96.23436849418387, -165.03622413546026, -43.46326198564499, -158.29830369585233, -127.45684394978203, -36.59839506845457, -54.21633879164814, -63.91123086205547, -134.58764258296185, -65.14270362412962, -73.35973144758567, -188.58550339713724, -141.34486245187827, -103.76207916262001, -95.87380526105014, -46.76436802060915, -95.03294018562657, -56.93246230208955, -56.04030318834392, -79.64075300600724], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6064701794669873, "mean_inference_ms": 5.218001587276881, "mean_action_processing_ms": 0.19463464292416346, "mean_env_wait_ms": 1.3544802338340782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -36.59839506845457, "episode_reward_min": -209.73843399100286, "episode_reward_mean": -90.64561278852278, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-70.8400175907649, -59.86815984924587, -148.10808185217473, -52.94054763919686, -58.34448326082377, -84.01670394608631, -71.7151332394087, -69.21531893454696, -57.30471780682911, -58.741471722249585, -41.75379306460357, -177.10610721996622, -64.56951859158922, -57.760072562729505, -133.94244251081514, -60.03051787111692, -127.62728240781477, -53.50521519127347, -58.640562020576965, -110.05414698171361, -74.44837856351835, -107.4382907975064, -144.8191928671611, -50.33803694227045, -123.89267492676943, -110.184586880776, -53.1907881892518, -41.96919722082219, -86.0103365337559, -65.15198899907328, -137.33469675493166, -102.99393509708037, -46.06245366145337, -61.178786625091554, -77.88562513614556, -73.76871953085801, -107.01549264274664, -51.15446167043997, -127.28250492577037, -101.88791425205494, -158.88480934305733, -116.07548327807542, -80.94097959246258, -131.3658500135268, -84.21954835540664, -89.66315799047342, -57.65891208324735, -78.83161068450454, -80.66431988239445, -54.4181817844459, -59.47786794008232, -84.75245524808153, -106.63139512575145, -42.37171009362036, -50.03824547648887, -96.69729408006313, -103.527881600764, -85.33754499205428, -64.59265595427645, -82.98272284146253, -106.35123003660951, -92.92323792041721, -132.4511822700516, -69.38129212589911, -99.21197368542946, -89.01054901804838, -209.73843399100286, -91.64685329514293, -162.08828061078844, -166.82058353411114, -45.811591489469144, -82.36556401129516, -145.99366983809202, -61.82536450696803, -69.33852679344477, -96.9917479091452, -176.98335019832786, -75.67142367473853, -60.6261600636901, -77.82315942524147, -96.23436849418387, -165.03622413546026, -43.46326198564499, -158.29830369585233, -127.45684394978203, -36.59839506845457, -54.21633879164814, -63.91123086205547, -134.58764258296185, -65.14270362412962, -73.35973144758567, -188.58550339713724, -141.34486245187827, -103.76207916262001, -95.87380526105014, -46.76436802060915, -95.03294018562657, -56.93246230208955, -56.04030318834392, -79.64075300600724], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6064701794669873, "mean_inference_ms": 5.218001587276881, "mean_action_processing_ms": 0.19463464292416346, "mean_env_wait_ms": 1.3544802338340782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1470000, "num_agent_steps_trained": 1470000, "num_env_steps_sampled": 1470000, "num_env_steps_trained": 1470000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1470000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1470000, "timers": {"training_iteration_time_ms": 75417.967, "load_time_ms": 30.768, "load_throughput": 455019.066, "learn_time_ms": 67663.966, "learn_throughput": 206.905, "synch_weights_time_ms": 13.88}, "counters": {"num_env_steps_sampled": 1470000, "num_env_steps_trained": 1470000, "num_agent_steps_sampled": 1470000, "num_agent_steps_trained": 1470000}, "done": false, "episodes_total": 1470, "training_iteration": 105, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-07-54", "timestamp": 1693058874, "time_this_iter_s": 75.39500594139099, "time_total_s": 8027.570597887039, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701534D2B0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015422A00>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 8027.570597887039, "timesteps_since_restore": 0, "iterations_since_restore": 105, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.897169811320758, "ram_util_percent": 51.067924528301894}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -291.09525573350487, "episode_L1_reward_sum_min": -626.1262888014317, "episode_L1_reward_sum_max": -158.27662391215563, "episode_L2_reward_sum_mean": -149.72104065693915, "episode_L2_reward_sum_min": -230.30518727004528, "episode_L2_reward_sum_max": -115.6362765878439}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.04670926694252333, "policy_loss": 0.015228780958065648, "vf_loss": 0.3148048537809627, "vf_explained_var": 0.6848167870270372, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1484000, "num_env_steps_trained": 1484000, "num_agent_steps_sampled": 1484000, "num_agent_steps_trained": 1484000}, "sampler_results": {"episode_reward_max": -36.59839506845457, "episode_reward_min": -213.82438101685366, "episode_reward_mean": -93.37640894252594, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -291.09525573350487, "episode_L1_reward_sum_min": -626.1262888014317, "episode_L1_reward_sum_max": -158.27662391215563, "episode_L2_reward_sum_mean": -149.72104065693915, "episode_L2_reward_sum_min": -230.30518727004528, "episode_L2_reward_sum_max": -115.6362765878439}, "hist_stats": {"episode_reward": [-133.94244251081514, -60.03051787111692, -127.62728240781477, -53.50521519127347, -58.640562020576965, -110.05414698171361, -74.44837856351835, -107.4382907975064, -144.8191928671611, -50.33803694227045, -123.89267492676943, -110.184586880776, -53.1907881892518, -41.96919722082219, -86.0103365337559, -65.15198899907328, -137.33469675493166, -102.99393509708037, -46.06245366145337, -61.178786625091554, -77.88562513614556, -73.76871953085801, -107.01549264274664, -51.15446167043997, -127.28250492577037, -101.88791425205494, -158.88480934305733, -116.07548327807542, -80.94097959246258, -131.3658500135268, -84.21954835540664, -89.66315799047342, -57.65891208324735, -78.83161068450454, -80.66431988239445, -54.4181817844459, -59.47786794008232, -84.75245524808153, -106.63139512575145, -42.37171009362036, -50.03824547648887, -96.69729408006313, -103.527881600764, -85.33754499205428, -64.59265595427645, -82.98272284146253, -106.35123003660951, -92.92323792041721, -132.4511822700516, -69.38129212589911, -99.21197368542946, -89.01054901804838, -209.73843399100286, -91.64685329514293, -162.08828061078844, -166.82058353411114, -45.811591489469144, -82.36556401129516, -145.99366983809202, -61.82536450696803, -69.33852679344477, -96.9917479091452, -176.98335019832786, -75.67142367473853, -60.6261600636901, -77.82315942524147, -96.23436849418387, -165.03622413546026, -43.46326198564499, -158.29830369585233, -127.45684394978203, -36.59839506845457, -54.21633879164814, -63.91123086205547, -134.58764258296185, -65.14270362412962, -73.35973144758567, -188.58550339713724, -141.34486245187827, -103.76207916262001, -95.87380526105014, -46.76436802060915, -95.03294018562657, -56.93246230208955, -56.04030318834392, -79.64075300600724, -74.82403335412307, -98.88656831606455, -79.15651162976484, -66.52930818328954, -74.14128870110977, -73.91098914795799, -213.82438101685366, -127.54429196141218, -84.59320181622748, -116.0434630203915, -96.49477158121312, -58.29895911050093, -66.14686938225077, -114.96910545937405], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6064851719045958, "mean_inference_ms": 5.218737311273633, "mean_action_processing_ms": 0.19465423532124718, "mean_env_wait_ms": 1.354687533995247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -36.59839506845457, "episode_reward_min": -213.82438101685366, "episode_reward_mean": -93.37640894252594, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-133.94244251081514, -60.03051787111692, -127.62728240781477, -53.50521519127347, -58.640562020576965, -110.05414698171361, -74.44837856351835, -107.4382907975064, -144.8191928671611, -50.33803694227045, -123.89267492676943, -110.184586880776, -53.1907881892518, -41.96919722082219, -86.0103365337559, -65.15198899907328, -137.33469675493166, -102.99393509708037, -46.06245366145337, -61.178786625091554, -77.88562513614556, -73.76871953085801, -107.01549264274664, -51.15446167043997, -127.28250492577037, -101.88791425205494, -158.88480934305733, -116.07548327807542, -80.94097959246258, -131.3658500135268, -84.21954835540664, -89.66315799047342, -57.65891208324735, -78.83161068450454, -80.66431988239445, -54.4181817844459, -59.47786794008232, -84.75245524808153, -106.63139512575145, -42.37171009362036, -50.03824547648887, -96.69729408006313, -103.527881600764, -85.33754499205428, -64.59265595427645, -82.98272284146253, -106.35123003660951, -92.92323792041721, -132.4511822700516, -69.38129212589911, -99.21197368542946, -89.01054901804838, -209.73843399100286, -91.64685329514293, -162.08828061078844, -166.82058353411114, -45.811591489469144, -82.36556401129516, -145.99366983809202, -61.82536450696803, -69.33852679344477, -96.9917479091452, -176.98335019832786, -75.67142367473853, -60.6261600636901, -77.82315942524147, -96.23436849418387, -165.03622413546026, -43.46326198564499, -158.29830369585233, -127.45684394978203, -36.59839506845457, -54.21633879164814, -63.91123086205547, -134.58764258296185, -65.14270362412962, -73.35973144758567, -188.58550339713724, -141.34486245187827, -103.76207916262001, -95.87380526105014, -46.76436802060915, -95.03294018562657, -56.93246230208955, -56.04030318834392, -79.64075300600724, -74.82403335412307, -98.88656831606455, -79.15651162976484, -66.52930818328954, -74.14128870110977, -73.91098914795799, -213.82438101685366, -127.54429196141218, -84.59320181622748, -116.0434630203915, -96.49477158121312, -58.29895911050093, -66.14686938225077, -114.96910545937405], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6064851719045958, "mean_inference_ms": 5.218737311273633, "mean_action_processing_ms": 0.19465423532124718, "mean_env_wait_ms": 1.354687533995247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1484000, "num_agent_steps_trained": 1484000, "num_env_steps_sampled": 1484000, "num_env_steps_trained": 1484000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1484000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1484000, "timers": {"training_iteration_time_ms": 75415.054, "load_time_ms": 30.712, "load_throughput": 455852.706, "learn_time_ms": 67661.132, "learn_throughput": 206.913, "synch_weights_time_ms": 14.163}, "counters": {"num_env_steps_sampled": 1484000, "num_env_steps_trained": 1484000, "num_agent_steps_sampled": 1484000, "num_agent_steps_trained": 1484000}, "done": false, "episodes_total": 1484, "training_iteration": 106, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-09-10", "timestamp": 1693058950, "time_this_iter_s": 75.38334798812866, "time_total_s": 8102.953945875168, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701555FDC0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015078550>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 8102.953945875168, "timesteps_since_restore": 0, "iterations_since_restore": 106, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.854205607476633, "ram_util_percent": 51.067289719626174}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -290.34545829489826, "episode_L1_reward_sum_min": -626.1262888014317, "episode_L1_reward_sum_max": -158.27662391215563, "episode_L2_reward_sum_mean": -149.59404087148607, "episode_L2_reward_sum_min": -230.30518727004528, "episode_L2_reward_sum_max": -115.6362765878439}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.06093088140372961, "policy_loss": 0.025709843186617527, "vf_loss": 0.35221037399204486, "vf_explained_var": 0.6657152122553484, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1498000, "num_env_steps_trained": 1498000, "num_agent_steps_sampled": 1498000, "num_agent_steps_trained": 1498000}, "sampler_results": {"episode_reward_max": -36.59839506845457, "episode_reward_min": -213.82438101685366, "episode_reward_mean": -93.77945308243905, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -290.34545829489826, "episode_L1_reward_sum_min": -626.1262888014317, "episode_L1_reward_sum_max": -158.27662391215563, "episode_L2_reward_sum_mean": -149.59404087148607, "episode_L2_reward_sum_min": -230.30518727004528, "episode_L2_reward_sum_max": -115.6362765878439}, "hist_stats": {"episode_reward": [-86.0103365337559, -65.15198899907328, -137.33469675493166, -102.99393509708037, -46.06245366145337, -61.178786625091554, -77.88562513614556, -73.76871953085801, -107.01549264274664, -51.15446167043997, -127.28250492577037, -101.88791425205494, -158.88480934305733, -116.07548327807542, -80.94097959246258, -131.3658500135268, -84.21954835540664, -89.66315799047342, -57.65891208324735, -78.83161068450454, -80.66431988239445, -54.4181817844459, -59.47786794008232, -84.75245524808153, -106.63139512575145, -42.37171009362036, -50.03824547648887, -96.69729408006313, -103.527881600764, -85.33754499205428, -64.59265595427645, -82.98272284146253, -106.35123003660951, -92.92323792041721, -132.4511822700516, -69.38129212589911, -99.21197368542946, -89.01054901804838, -209.73843399100286, -91.64685329514293, -162.08828061078844, -166.82058353411114, -45.811591489469144, -82.36556401129516, -145.99366983809202, -61.82536450696803, -69.33852679344477, -96.9917479091452, -176.98335019832786, -75.67142367473853, -60.6261600636901, -77.82315942524147, -96.23436849418387, -165.03622413546026, -43.46326198564499, -158.29830369585233, -127.45684394978203, -36.59839506845457, -54.21633879164814, -63.91123086205547, -134.58764258296185, -65.14270362412962, -73.35973144758567, -188.58550339713724, -141.34486245187827, -103.76207916262001, -95.87380526105014, -46.76436802060915, -95.03294018562657, -56.93246230208955, -56.04030318834392, -79.64075300600724, -74.82403335412307, -98.88656831606455, -79.15651162976484, -66.52930818328954, -74.14128870110977, -73.91098914795799, -213.82438101685366, -127.54429196141218, -84.59320181622748, -116.0434630203915, -96.49477158121312, -58.29895911050093, -66.14686938225077, -114.96910545937405, -122.11416731012763, -81.1118551112164, -93.44468890380634, -49.599205987158534, -89.7082663084211, -90.02681973075018, -92.50690758914759, -58.956393498416475, -160.51117518210674, -61.59437787348256, -84.93940539490725, -109.08988787405961, -117.2372427802977, -79.54533381880076], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6064888287166437, "mean_inference_ms": 5.219497245121857, "mean_action_processing_ms": 0.19466943567173872, "mean_env_wait_ms": 1.3549220808225393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -36.59839506845457, "episode_reward_min": -213.82438101685366, "episode_reward_mean": -93.77945308243905, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-86.0103365337559, -65.15198899907328, -137.33469675493166, -102.99393509708037, -46.06245366145337, -61.178786625091554, -77.88562513614556, -73.76871953085801, -107.01549264274664, -51.15446167043997, -127.28250492577037, -101.88791425205494, -158.88480934305733, -116.07548327807542, -80.94097959246258, -131.3658500135268, -84.21954835540664, -89.66315799047342, -57.65891208324735, -78.83161068450454, -80.66431988239445, -54.4181817844459, -59.47786794008232, -84.75245524808153, -106.63139512575145, -42.37171009362036, -50.03824547648887, -96.69729408006313, -103.527881600764, -85.33754499205428, -64.59265595427645, -82.98272284146253, -106.35123003660951, -92.92323792041721, -132.4511822700516, -69.38129212589911, -99.21197368542946, -89.01054901804838, -209.73843399100286, -91.64685329514293, -162.08828061078844, -166.82058353411114, -45.811591489469144, -82.36556401129516, -145.99366983809202, -61.82536450696803, -69.33852679344477, -96.9917479091452, -176.98335019832786, -75.67142367473853, -60.6261600636901, -77.82315942524147, -96.23436849418387, -165.03622413546026, -43.46326198564499, -158.29830369585233, -127.45684394978203, -36.59839506845457, -54.21633879164814, -63.91123086205547, -134.58764258296185, -65.14270362412962, -73.35973144758567, -188.58550339713724, -141.34486245187827, -103.76207916262001, -95.87380526105014, -46.76436802060915, -95.03294018562657, -56.93246230208955, -56.04030318834392, -79.64075300600724, -74.82403335412307, -98.88656831606455, -79.15651162976484, -66.52930818328954, -74.14128870110977, -73.91098914795799, -213.82438101685366, -127.54429196141218, -84.59320181622748, -116.0434630203915, -96.49477158121312, -58.29895911050093, -66.14686938225077, -114.96910545937405, -122.11416731012763, -81.1118551112164, -93.44468890380634, -49.599205987158534, -89.7082663084211, -90.02681973075018, -92.50690758914759, -58.956393498416475, -160.51117518210674, -61.59437787348256, -84.93940539490725, -109.08988787405961, -117.2372427802977, -79.54533381880076], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6064888287166437, "mean_inference_ms": 5.219497245121857, "mean_action_processing_ms": 0.19466943567173872, "mean_env_wait_ms": 1.3549220808225393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1498000, "num_agent_steps_trained": 1498000, "num_env_steps_sampled": 1498000, "num_env_steps_trained": 1498000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1498000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1498000, "timers": {"training_iteration_time_ms": 75431.799, "load_time_ms": 30.984, "load_throughput": 451840.604, "learn_time_ms": 67671.667, "learn_throughput": 206.881, "synch_weights_time_ms": 14.262}, "counters": {"num_env_steps_sampled": 1498000, "num_env_steps_trained": 1498000, "num_agent_steps_sampled": 1498000, "num_agent_steps_trained": 1498000}, "done": false, "episodes_total": 1498, "training_iteration": 107, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-10-25", "timestamp": 1693059025, "time_this_iter_s": 75.53402638435364, "time_total_s": 8178.4879722595215, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015309D90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015309DC0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 8178.4879722595215, "timesteps_since_restore": 0, "iterations_since_restore": 107, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.826168224299067, "ram_util_percent": 51.051401869158894}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -288.7925994308293, "episode_L1_reward_sum_min": -626.1262888014317, "episode_L1_reward_sum_max": -158.27662391215563, "episode_L2_reward_sum_mean": -149.140124951005, "episode_L2_reward_sum_min": -230.30518727004528, "episode_L2_reward_sum_max": -115.6362765878439}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.04163354346475951, "policy_loss": 0.015973776618905994, "vf_loss": 0.25659766801650413, "vf_explained_var": 0.6384725207654537, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "sampler_results": {"episode_reward_max": -36.59839506845457, "episode_reward_min": -213.82438101685366, "episode_reward_mean": -93.01035597858943, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -288.7925994308293, "episode_L1_reward_sum_min": -626.1262888014317, "episode_L1_reward_sum_max": -158.27662391215563, "episode_L2_reward_sum_mean": -149.140124951005, "episode_L2_reward_sum_min": -230.30518727004528, "episode_L2_reward_sum_max": -115.6362765878439}, "hist_stats": {"episode_reward": [-80.94097959246258, -131.3658500135268, -84.21954835540664, -89.66315799047342, -57.65891208324735, -78.83161068450454, -80.66431988239445, -54.4181817844459, -59.47786794008232, -84.75245524808153, -106.63139512575145, -42.37171009362036, -50.03824547648887, -96.69729408006313, -103.527881600764, -85.33754499205428, -64.59265595427645, -82.98272284146253, -106.35123003660951, -92.92323792041721, -132.4511822700516, -69.38129212589911, -99.21197368542946, -89.01054901804838, -209.73843399100286, -91.64685329514293, -162.08828061078844, -166.82058353411114, -45.811591489469144, -82.36556401129516, -145.99366983809202, -61.82536450696803, -69.33852679344477, -96.9917479091452, -176.98335019832786, -75.67142367473853, -60.6261600636901, -77.82315942524147, -96.23436849418387, -165.03622413546026, -43.46326198564499, -158.29830369585233, -127.45684394978203, -36.59839506845457, -54.21633879164814, -63.91123086205547, -134.58764258296185, -65.14270362412962, -73.35973144758567, -188.58550339713724, -141.34486245187827, -103.76207916262001, -95.87380526105014, -46.76436802060915, -95.03294018562657, -56.93246230208955, -56.04030318834392, -79.64075300600724, -74.82403335412307, -98.88656831606455, -79.15651162976484, -66.52930818328954, -74.14128870110977, -73.91098914795799, -213.82438101685366, -127.54429196141218, -84.59320181622748, -116.0434630203915, -96.49477158121312, -58.29895911050093, -66.14686938225077, -114.96910545937405, -122.11416731012763, -81.1118551112164, -93.44468890380634, -49.599205987158534, -89.7082663084211, -90.02681973075018, -92.50690758914759, -58.956393498416475, -160.51117518210674, -61.59437787348256, -84.93940539490725, -109.08988787405961, -117.2372427802977, -79.54533381880076, -44.9483969364254, -97.13194669491658, -67.19423427563395, -67.69694873066692, -160.83126510385765, -101.92402080723465, -134.05254473974546, -61.93949659322127, -109.74573287292765, -115.14334009170409, -71.08116966888669, -67.71159440331867, -84.95458091733572, -51.42222622969617], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6064933727335606, "mean_inference_ms": 5.220374512441401, "mean_action_processing_ms": 0.19469117309273723, "mean_env_wait_ms": 1.3551912591589519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -36.59839506845457, "episode_reward_min": -213.82438101685366, "episode_reward_mean": -93.01035597858943, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-80.94097959246258, -131.3658500135268, -84.21954835540664, -89.66315799047342, -57.65891208324735, -78.83161068450454, -80.66431988239445, -54.4181817844459, -59.47786794008232, -84.75245524808153, -106.63139512575145, -42.37171009362036, -50.03824547648887, -96.69729408006313, -103.527881600764, -85.33754499205428, -64.59265595427645, -82.98272284146253, -106.35123003660951, -92.92323792041721, -132.4511822700516, -69.38129212589911, -99.21197368542946, -89.01054901804838, -209.73843399100286, -91.64685329514293, -162.08828061078844, -166.82058353411114, -45.811591489469144, -82.36556401129516, -145.99366983809202, -61.82536450696803, -69.33852679344477, -96.9917479091452, -176.98335019832786, -75.67142367473853, -60.6261600636901, -77.82315942524147, -96.23436849418387, -165.03622413546026, -43.46326198564499, -158.29830369585233, -127.45684394978203, -36.59839506845457, -54.21633879164814, -63.91123086205547, -134.58764258296185, -65.14270362412962, -73.35973144758567, -188.58550339713724, -141.34486245187827, -103.76207916262001, -95.87380526105014, -46.76436802060915, -95.03294018562657, -56.93246230208955, -56.04030318834392, -79.64075300600724, -74.82403335412307, -98.88656831606455, -79.15651162976484, -66.52930818328954, -74.14128870110977, -73.91098914795799, -213.82438101685366, -127.54429196141218, -84.59320181622748, -116.0434630203915, -96.49477158121312, -58.29895911050093, -66.14686938225077, -114.96910545937405, -122.11416731012763, -81.1118551112164, -93.44468890380634, -49.599205987158534, -89.7082663084211, -90.02681973075018, -92.50690758914759, -58.956393498416475, -160.51117518210674, -61.59437787348256, -84.93940539490725, -109.08988787405961, -117.2372427802977, -79.54533381880076, -44.9483969364254, -97.13194669491658, -67.19423427563395, -67.69694873066692, -160.83126510385765, -101.92402080723465, -134.05254473974546, -61.93949659322127, -109.74573287292765, -115.14334009170409, -71.08116966888669, -67.71159440331867, -84.95458091733572, -51.42222622969617], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6064933727335606, "mean_inference_ms": 5.220374512441401, "mean_action_processing_ms": 0.19469117309273723, "mean_env_wait_ms": 1.3551912591589519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000, "num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1512000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1512000, "timers": {"training_iteration_time_ms": 75448.377, "load_time_ms": 30.754, "load_throughput": 455219.779, "learn_time_ms": 67661.703, "learn_throughput": 206.912, "synch_weights_time_ms": 14.263}, "counters": {"num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "done": false, "episodes_total": 1512, "training_iteration": 108, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-11-41", "timestamp": 1693059101, "time_this_iter_s": 75.65324521064758, "time_total_s": 8254.141217470169, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270154E9A00>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270151C0220>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 8254.141217470169, "timesteps_since_restore": 0, "iterations_since_restore": 108, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.759813084112146, "ram_util_percent": 51.0532710280374}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -291.0415082146972, "episode_L1_reward_sum_min": -626.1262888014317, "episode_L1_reward_sum_max": -164.4261323735118, "episode_L2_reward_sum_mean": -149.66977800935507, "episode_L2_reward_sum_min": -230.30518727004528, "episode_L2_reward_sum_max": -117.65874697268009}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.03009372353103441, "policy_loss": 0.005717748365510608, "vf_loss": 0.24375974016161212, "vf_explained_var": 0.6568051798905364, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1526000, "num_env_steps_trained": 1526000, "num_agent_steps_sampled": 1526000, "num_agent_steps_trained": 1526000}, "sampler_results": {"episode_reward_max": -36.59839506845457, "episode_reward_min": -213.82438101685366, "episode_reward_mean": -94.72030745213173, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -291.0415082146972, "episode_L1_reward_sum_min": -626.1262888014317, "episode_L1_reward_sum_max": -164.4261323735118, "episode_L2_reward_sum_mean": -149.66977800935507, "episode_L2_reward_sum_min": -230.30518727004528, "episode_L2_reward_sum_max": -117.65874697268009}, "hist_stats": {"episode_reward": [-103.527881600764, -85.33754499205428, -64.59265595427645, -82.98272284146253, -106.35123003660951, -92.92323792041721, -132.4511822700516, -69.38129212589911, -99.21197368542946, -89.01054901804838, -209.73843399100286, -91.64685329514293, -162.08828061078844, -166.82058353411114, -45.811591489469144, -82.36556401129516, -145.99366983809202, -61.82536450696803, -69.33852679344477, -96.9917479091452, -176.98335019832786, -75.67142367473853, -60.6261600636901, -77.82315942524147, -96.23436849418387, -165.03622413546026, -43.46326198564499, -158.29830369585233, -127.45684394978203, -36.59839506845457, -54.21633879164814, -63.91123086205547, -134.58764258296185, -65.14270362412962, -73.35973144758567, -188.58550339713724, -141.34486245187827, -103.76207916262001, -95.87380526105014, -46.76436802060915, -95.03294018562657, -56.93246230208955, -56.04030318834392, -79.64075300600724, -74.82403335412307, -98.88656831606455, -79.15651162976484, -66.52930818328954, -74.14128870110977, -73.91098914795799, -213.82438101685366, -127.54429196141218, -84.59320181622748, -116.0434630203915, -96.49477158121312, -58.29895911050093, -66.14686938225077, -114.96910545937405, -122.11416731012763, -81.1118551112164, -93.44468890380634, -49.599205987158534, -89.7082663084211, -90.02681973075018, -92.50690758914759, -58.956393498416475, -160.51117518210674, -61.59437787348256, -84.93940539490725, -109.08988787405961, -117.2372427802977, -79.54533381880076, -44.9483969364254, -97.13194669491658, -67.19423427563395, -67.69694873066692, -160.83126510385765, -101.92402080723465, -134.05254473974546, -61.93949659322127, -109.74573287292765, -115.14334009170409, -71.08116966888669, -67.71159440331867, -84.95458091733572, -51.42222622969617, -95.86003956589832, -79.03272106352392, -69.57937225759296, -98.99395489688166, -77.29542717735978, -51.83277633103815, -68.6876975497704, -92.2432807195542, -150.30589562903646, -99.21685828518221, -60.75438597472769, -60.36038932773447, -122.76134627603014, -141.80253065044718], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.606498598115375, "mean_inference_ms": 5.22123449673246, "mean_action_processing_ms": 0.19470184759050288, "mean_env_wait_ms": 1.355447703539572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -36.59839506845457, "episode_reward_min": -213.82438101685366, "episode_reward_mean": -94.72030745213173, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-103.527881600764, -85.33754499205428, -64.59265595427645, -82.98272284146253, -106.35123003660951, -92.92323792041721, -132.4511822700516, -69.38129212589911, -99.21197368542946, -89.01054901804838, -209.73843399100286, -91.64685329514293, -162.08828061078844, -166.82058353411114, -45.811591489469144, -82.36556401129516, -145.99366983809202, -61.82536450696803, -69.33852679344477, -96.9917479091452, -176.98335019832786, -75.67142367473853, -60.6261600636901, -77.82315942524147, -96.23436849418387, -165.03622413546026, -43.46326198564499, -158.29830369585233, -127.45684394978203, -36.59839506845457, -54.21633879164814, -63.91123086205547, -134.58764258296185, -65.14270362412962, -73.35973144758567, -188.58550339713724, -141.34486245187827, -103.76207916262001, -95.87380526105014, -46.76436802060915, -95.03294018562657, -56.93246230208955, -56.04030318834392, -79.64075300600724, -74.82403335412307, -98.88656831606455, -79.15651162976484, -66.52930818328954, -74.14128870110977, -73.91098914795799, -213.82438101685366, -127.54429196141218, -84.59320181622748, -116.0434630203915, -96.49477158121312, -58.29895911050093, -66.14686938225077, -114.96910545937405, -122.11416731012763, -81.1118551112164, -93.44468890380634, -49.599205987158534, -89.7082663084211, -90.02681973075018, -92.50690758914759, -58.956393498416475, -160.51117518210674, -61.59437787348256, -84.93940539490725, -109.08988787405961, -117.2372427802977, -79.54533381880076, -44.9483969364254, -97.13194669491658, -67.19423427563395, -67.69694873066692, -160.83126510385765, -101.92402080723465, -134.05254473974546, -61.93949659322127, -109.74573287292765, -115.14334009170409, -71.08116966888669, -67.71159440331867, -84.95458091733572, -51.42222622969617, -95.86003956589832, -79.03272106352392, -69.57937225759296, -98.99395489688166, -77.29542717735978, -51.83277633103815, -68.6876975497704, -92.2432807195542, -150.30589562903646, -99.21685828518221, -60.75438597472769, -60.36038932773447, -122.76134627603014, -141.80253065044718], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.606498598115375, "mean_inference_ms": 5.22123449673246, "mean_action_processing_ms": 0.19470184759050288, "mean_env_wait_ms": 1.355447703539572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1526000, "num_agent_steps_trained": 1526000, "num_env_steps_sampled": 1526000, "num_env_steps_trained": 1526000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1526000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1526000, "timers": {"training_iteration_time_ms": 75467.593, "load_time_ms": 30.54, "load_throughput": 458414.635, "learn_time_ms": 67688.217, "learn_throughput": 206.831, "synch_weights_time_ms": 13.349}, "counters": {"num_env_steps_sampled": 1526000, "num_env_steps_trained": 1526000, "num_agent_steps_sampled": 1526000, "num_agent_steps_trained": 1526000}, "done": false, "episodes_total": 1526, "training_iteration": 109, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-12-57", "timestamp": 1693059177, "time_this_iter_s": 75.54782700538635, "time_total_s": 8329.689044475555, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015422CA0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014EF5AC0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 8329.689044475555, "timesteps_since_restore": 0, "iterations_since_restore": 109, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.91121495327103, "ram_util_percent": 50.92897196261683}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -279.205058594048, "episode_L1_reward_sum_min": -573.1247818022966, "episode_L1_reward_sum_max": -164.4261323735118, "episode_L2_reward_sum_mean": -146.7575413158536, "episode_L2_reward_sum_min": -220.1990316659212, "episode_L2_reward_sum_max": -117.65874697268009}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.07023522125867505, "policy_loss": 0.045086119961618244, "vf_loss": 0.2514910175538445, "vf_explained_var": 0.6578177881154994, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1540000, "num_env_steps_trained": 1540000, "num_agent_steps_sampled": 1540000, "num_agent_steps_trained": 1540000}, "sampler_results": {"episode_reward_max": -36.59839506845457, "episode_reward_min": -213.82438101685366, "episode_reward_mean": -89.91690434642533, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -279.205058594048, "episode_L1_reward_sum_min": -573.1247818022966, "episode_L1_reward_sum_max": -164.4261323735118, "episode_L2_reward_sum_mean": -146.7575413158536, "episode_L2_reward_sum_min": -220.1990316659212, "episode_L2_reward_sum_max": -117.65874697268009}, "hist_stats": {"episode_reward": [-45.811591489469144, -82.36556401129516, -145.99366983809202, -61.82536450696803, -69.33852679344477, -96.9917479091452, -176.98335019832786, -75.67142367473853, -60.6261600636901, -77.82315942524147, -96.23436849418387, -165.03622413546026, -43.46326198564499, -158.29830369585233, -127.45684394978203, -36.59839506845457, -54.21633879164814, -63.91123086205547, -134.58764258296185, -65.14270362412962, -73.35973144758567, -188.58550339713724, -141.34486245187827, -103.76207916262001, -95.87380526105014, -46.76436802060915, -95.03294018562657, -56.93246230208955, -56.04030318834392, -79.64075300600724, -74.82403335412307, -98.88656831606455, -79.15651162976484, -66.52930818328954, -74.14128870110977, -73.91098914795799, -213.82438101685366, -127.54429196141218, -84.59320181622748, -116.0434630203915, -96.49477158121312, -58.29895911050093, -66.14686938225077, -114.96910545937405, -122.11416731012763, -81.1118551112164, -93.44468890380634, -49.599205987158534, -89.7082663084211, -90.02681973075018, -92.50690758914759, -58.956393498416475, -160.51117518210674, -61.59437787348256, -84.93940539490725, -109.08988787405961, -117.2372427802977, -79.54533381880076, -44.9483969364254, -97.13194669491658, -67.19423427563395, -67.69694873066692, -160.83126510385765, -101.92402080723465, -134.05254473974546, -61.93949659322127, -109.74573287292765, -115.14334009170409, -71.08116966888669, -67.71159440331867, -84.95458091733572, -51.42222622969617, -95.86003956589832, -79.03272106352392, -69.57937225759296, -98.99395489688166, -77.29542717735978, -51.83277633103815, -68.6876975497704, -92.2432807195542, -150.30589562903646, -99.21685828518221, -60.75438597472769, -60.36038932773447, -122.76134627603014, -141.80253065044718, -77.83316160709995, -41.905309791551616, -157.69737979680613, -45.17116659503006, -46.34902778373105, -52.55113490159688, -66.13373329775101, -87.32951714692244, -124.7103051992179, -84.76501649898063, -56.3174050914383, -79.73999418508116, -100.57107514725419, -54.64988426295706], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6065252055513338, "mean_inference_ms": 5.222162695711571, "mean_action_processing_ms": 0.19470959372742258, "mean_env_wait_ms": 1.3557332879007828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -36.59839506845457, "episode_reward_min": -213.82438101685366, "episode_reward_mean": -89.91690434642533, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-45.811591489469144, -82.36556401129516, -145.99366983809202, -61.82536450696803, -69.33852679344477, -96.9917479091452, -176.98335019832786, -75.67142367473853, -60.6261600636901, -77.82315942524147, -96.23436849418387, -165.03622413546026, -43.46326198564499, -158.29830369585233, -127.45684394978203, -36.59839506845457, -54.21633879164814, -63.91123086205547, -134.58764258296185, -65.14270362412962, -73.35973144758567, -188.58550339713724, -141.34486245187827, -103.76207916262001, -95.87380526105014, -46.76436802060915, -95.03294018562657, -56.93246230208955, -56.04030318834392, -79.64075300600724, -74.82403335412307, -98.88656831606455, -79.15651162976484, -66.52930818328954, -74.14128870110977, -73.91098914795799, -213.82438101685366, -127.54429196141218, -84.59320181622748, -116.0434630203915, -96.49477158121312, -58.29895911050093, -66.14686938225077, -114.96910545937405, -122.11416731012763, -81.1118551112164, -93.44468890380634, -49.599205987158534, -89.7082663084211, -90.02681973075018, -92.50690758914759, -58.956393498416475, -160.51117518210674, -61.59437787348256, -84.93940539490725, -109.08988787405961, -117.2372427802977, -79.54533381880076, -44.9483969364254, -97.13194669491658, -67.19423427563395, -67.69694873066692, -160.83126510385765, -101.92402080723465, -134.05254473974546, -61.93949659322127, -109.74573287292765, -115.14334009170409, -71.08116966888669, -67.71159440331867, -84.95458091733572, -51.42222622969617, -95.86003956589832, -79.03272106352392, -69.57937225759296, -98.99395489688166, -77.29542717735978, -51.83277633103815, -68.6876975497704, -92.2432807195542, -150.30589562903646, -99.21685828518221, -60.75438597472769, -60.36038932773447, -122.76134627603014, -141.80253065044718, -77.83316160709995, -41.905309791551616, -157.69737979680613, -45.17116659503006, -46.34902778373105, -52.55113490159688, -66.13373329775101, -87.32951714692244, -124.7103051992179, -84.76501649898063, -56.3174050914383, -79.73999418508116, -100.57107514725419, -54.64988426295706], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6065252055513338, "mean_inference_ms": 5.222162695711571, "mean_action_processing_ms": 0.19470959372742258, "mean_env_wait_ms": 1.3557332879007828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1540000, "num_agent_steps_trained": 1540000, "num_env_steps_sampled": 1540000, "num_env_steps_trained": 1540000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1540000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1540000, "timers": {"training_iteration_time_ms": 75502.708, "load_time_ms": 30.238, "load_throughput": 462999.66, "learn_time_ms": 67722.088, "learn_throughput": 206.727, "synch_weights_time_ms": 13.663}, "counters": {"num_env_steps_sampled": 1540000, "num_env_steps_trained": 1540000, "num_agent_steps_sampled": 1540000, "num_agent_steps_trained": 1540000}, "done": false, "episodes_total": 1540, "training_iteration": 110, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-14-13", "timestamp": 1693059253, "time_this_iter_s": 75.72212386131287, "time_total_s": 8405.411168336868, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015204A00>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015238400>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 8405.411168336868, "timesteps_since_restore": 0, "iterations_since_restore": 110, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 22.125233644859815, "ram_util_percent": 50.64579439252336}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -270.70819573640824, "episode_L1_reward_sum_min": -573.1247818022966, "episode_L1_reward_sum_max": -165.02914453297853, "episode_L2_reward_sum_mean": -144.62750539280475, "episode_L2_reward_sum_min": -220.1990316659212, "episode_L2_reward_sum_max": -116.72802575677633}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.05911557122091514, "policy_loss": 0.035572297575523305, "vf_loss": 0.23543273088077493, "vf_explained_var": 0.537176213269371, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1554000, "num_env_steps_trained": 1554000, "num_agent_steps_sampled": 1554000, "num_agent_steps_trained": 1554000}, "sampler_results": {"episode_reward_max": -36.59839506845457, "episode_reward_min": -213.82438101685366, "episode_reward_mean": -87.61573829040593, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -270.70819573640824, "episode_L1_reward_sum_min": -573.1247818022966, "episode_L1_reward_sum_max": -165.02914453297853, "episode_L2_reward_sum_mean": -144.62750539280475, "episode_L2_reward_sum_min": -220.1990316659212, "episode_L2_reward_sum_max": -116.72802575677633}, "hist_stats": {"episode_reward": [-127.45684394978203, -36.59839506845457, -54.21633879164814, -63.91123086205547, -134.58764258296185, -65.14270362412962, -73.35973144758567, -188.58550339713724, -141.34486245187827, -103.76207916262001, -95.87380526105014, -46.76436802060915, -95.03294018562657, -56.93246230208955, -56.04030318834392, -79.64075300600724, -74.82403335412307, -98.88656831606455, -79.15651162976484, -66.52930818328954, -74.14128870110977, -73.91098914795799, -213.82438101685366, -127.54429196141218, -84.59320181622748, -116.0434630203915, -96.49477158121312, -58.29895911050093, -66.14686938225077, -114.96910545937405, -122.11416731012763, -81.1118551112164, -93.44468890380634, -49.599205987158534, -89.7082663084211, -90.02681973075018, -92.50690758914759, -58.956393498416475, -160.51117518210674, -61.59437787348256, -84.93940539490725, -109.08988787405961, -117.2372427802977, -79.54533381880076, -44.9483969364254, -97.13194669491658, -67.19423427563395, -67.69694873066692, -160.83126510385765, -101.92402080723465, -134.05254473974546, -61.93949659322127, -109.74573287292765, -115.14334009170409, -71.08116966888669, -67.71159440331867, -84.95458091733572, -51.42222622969617, -95.86003956589832, -79.03272106352392, -69.57937225759296, -98.99395489688166, -77.29542717735978, -51.83277633103815, -68.6876975497704, -92.2432807195542, -150.30589562903646, -99.21685828518221, -60.75438597472769, -60.36038932773447, -122.76134627603014, -141.80253065044718, -77.83316160709995, -41.905309791551616, -157.69737979680613, -45.17116659503006, -46.34902778373105, -52.55113490159688, -66.13373329775101, -87.32951714692244, -124.7103051992179, -84.76501649898063, -56.3174050914383, -79.73999418508116, -100.57107514725419, -54.64988426295706, -47.82815640428911, -102.4989259114955, -147.76142255546796, -107.58087644142181, -82.95527807183434, -64.40345599635828, -46.175026682984985, -57.740584991719274, -82.3307610473659, -81.11801869947202, -55.89898771852779, -61.714781405556195, -71.45123466965705, -116.88860002346182], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6065755604703896, "mean_inference_ms": 5.2231700514090775, "mean_action_processing_ms": 0.19471142431838423, "mean_env_wait_ms": 1.356041148812065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -36.59839506845457, "episode_reward_min": -213.82438101685366, "episode_reward_mean": -87.61573829040593, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-127.45684394978203, -36.59839506845457, -54.21633879164814, -63.91123086205547, -134.58764258296185, -65.14270362412962, -73.35973144758567, -188.58550339713724, -141.34486245187827, -103.76207916262001, -95.87380526105014, -46.76436802060915, -95.03294018562657, -56.93246230208955, -56.04030318834392, -79.64075300600724, -74.82403335412307, -98.88656831606455, -79.15651162976484, -66.52930818328954, -74.14128870110977, -73.91098914795799, -213.82438101685366, -127.54429196141218, -84.59320181622748, -116.0434630203915, -96.49477158121312, -58.29895911050093, -66.14686938225077, -114.96910545937405, -122.11416731012763, -81.1118551112164, -93.44468890380634, -49.599205987158534, -89.7082663084211, -90.02681973075018, -92.50690758914759, -58.956393498416475, -160.51117518210674, -61.59437787348256, -84.93940539490725, -109.08988787405961, -117.2372427802977, -79.54533381880076, -44.9483969364254, -97.13194669491658, -67.19423427563395, -67.69694873066692, -160.83126510385765, -101.92402080723465, -134.05254473974546, -61.93949659322127, -109.74573287292765, -115.14334009170409, -71.08116966888669, -67.71159440331867, -84.95458091733572, -51.42222622969617, -95.86003956589832, -79.03272106352392, -69.57937225759296, -98.99395489688166, -77.29542717735978, -51.83277633103815, -68.6876975497704, -92.2432807195542, -150.30589562903646, -99.21685828518221, -60.75438597472769, -60.36038932773447, -122.76134627603014, -141.80253065044718, -77.83316160709995, -41.905309791551616, -157.69737979680613, -45.17116659503006, -46.34902778373105, -52.55113490159688, -66.13373329775101, -87.32951714692244, -124.7103051992179, -84.76501649898063, -56.3174050914383, -79.73999418508116, -100.57107514725419, -54.64988426295706, -47.82815640428911, -102.4989259114955, -147.76142255546796, -107.58087644142181, -82.95527807183434, -64.40345599635828, -46.175026682984985, -57.740584991719274, -82.3307610473659, -81.11801869947202, -55.89898771852779, -61.714781405556195, -71.45123466965705, -116.88860002346182], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6065755604703896, "mean_inference_ms": 5.2231700514090775, "mean_action_processing_ms": 0.19471142431838423, "mean_env_wait_ms": 1.356041148812065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1554000, "num_agent_steps_trained": 1554000, "num_env_steps_sampled": 1554000, "num_env_steps_trained": 1554000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1554000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1554000, "timers": {"training_iteration_time_ms": 75491.693, "load_time_ms": 29.936, "load_throughput": 467667.273, "learn_time_ms": 67699.595, "learn_throughput": 206.796, "synch_weights_time_ms": 13.068}, "counters": {"num_env_steps_sampled": 1554000, "num_env_steps_trained": 1554000, "num_agent_steps_sampled": 1554000, "num_agent_steps_trained": 1554000}, "done": false, "episodes_total": 1554, "training_iteration": 111, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-15-28", "timestamp": 1693059328, "time_this_iter_s": 75.4255862236023, "time_total_s": 8480.83675456047, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015204220>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015464820>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 8480.83675456047, "timesteps_since_restore": 0, "iterations_since_restore": 111, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.755140186915888, "ram_util_percent": 50.66168224299065}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -267.58561003677545, "episode_L1_reward_sum_min": -573.1247818022966, "episode_L1_reward_sum_max": -165.02914453297853, "episode_L2_reward_sum_mean": -143.881838401258, "episode_L2_reward_sum_min": -220.1990316659212, "episode_L2_reward_sum_max": -116.72802575677633}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.05140445142535976, "policy_loss": 0.025170363589293428, "vf_loss": 0.2623408701160763, "vf_explained_var": 0.6637781472117813, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1568000, "num_env_steps_trained": 1568000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "sampler_results": {"episode_reward_max": -41.905309791551616, "episode_reward_min": -213.82438101685366, "episode_reward_mean": -86.45910405900342, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -267.58561003677545, "episode_L1_reward_sum_min": -573.1247818022966, "episode_L1_reward_sum_max": -165.02914453297853, "episode_L2_reward_sum_mean": -143.881838401258, "episode_L2_reward_sum_min": -220.1990316659212, "episode_L2_reward_sum_max": -116.72802575677633}, "hist_stats": {"episode_reward": [-56.04030318834392, -79.64075300600724, -74.82403335412307, -98.88656831606455, -79.15651162976484, -66.52930818328954, -74.14128870110977, -73.91098914795799, -213.82438101685366, -127.54429196141218, -84.59320181622748, -116.0434630203915, -96.49477158121312, -58.29895911050093, -66.14686938225077, -114.96910545937405, -122.11416731012763, -81.1118551112164, -93.44468890380634, -49.599205987158534, -89.7082663084211, -90.02681973075018, -92.50690758914759, -58.956393498416475, -160.51117518210674, -61.59437787348256, -84.93940539490725, -109.08988787405961, -117.2372427802977, -79.54533381880076, -44.9483969364254, -97.13194669491658, -67.19423427563395, -67.69694873066692, -160.83126510385765, -101.92402080723465, -134.05254473974546, -61.93949659322127, -109.74573287292765, -115.14334009170409, -71.08116966888669, -67.71159440331867, -84.95458091733572, -51.42222622969617, -95.86003956589832, -79.03272106352392, -69.57937225759296, -98.99395489688166, -77.29542717735978, -51.83277633103815, -68.6876975497704, -92.2432807195542, -150.30589562903646, -99.21685828518221, -60.75438597472769, -60.36038932773447, -122.76134627603014, -141.80253065044718, -77.83316160709995, -41.905309791551616, -157.69737979680613, -45.17116659503006, -46.34902778373105, -52.55113490159688, -66.13373329775101, -87.32951714692244, -124.7103051992179, -84.76501649898063, -56.3174050914383, -79.73999418508116, -100.57107514725419, -54.64988426295706, -47.82815640428911, -102.4989259114955, -147.76142255546796, -107.58087644142181, -82.95527807183434, -64.40345599635828, -46.175026682984985, -57.740584991719274, -82.3307610473659, -81.11801869947202, -55.89898771852779, -61.714781405556195, -71.45123466965705, -116.88860002346182, -58.05542439577223, -78.16238794658517, -55.06564605075815, -58.367839090951236, -46.03881040732875, -80.90703040591697, -52.6334342249437, -125.81249411241839, -143.76288723533227, -162.89284702651528, -83.0097661163224, -80.4330922469956, -76.78546238956874, -65.97836231796991], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6066543300066018, "mean_inference_ms": 5.22412842884435, "mean_action_processing_ms": 0.19470174720382138, "mean_env_wait_ms": 1.3563254830320253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -41.905309791551616, "episode_reward_min": -213.82438101685366, "episode_reward_mean": -86.45910405900342, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-56.04030318834392, -79.64075300600724, -74.82403335412307, -98.88656831606455, -79.15651162976484, -66.52930818328954, -74.14128870110977, -73.91098914795799, -213.82438101685366, -127.54429196141218, -84.59320181622748, -116.0434630203915, -96.49477158121312, -58.29895911050093, -66.14686938225077, -114.96910545937405, -122.11416731012763, -81.1118551112164, -93.44468890380634, -49.599205987158534, -89.7082663084211, -90.02681973075018, -92.50690758914759, -58.956393498416475, -160.51117518210674, -61.59437787348256, -84.93940539490725, -109.08988787405961, -117.2372427802977, -79.54533381880076, -44.9483969364254, -97.13194669491658, -67.19423427563395, -67.69694873066692, -160.83126510385765, -101.92402080723465, -134.05254473974546, -61.93949659322127, -109.74573287292765, -115.14334009170409, -71.08116966888669, -67.71159440331867, -84.95458091733572, -51.42222622969617, -95.86003956589832, -79.03272106352392, -69.57937225759296, -98.99395489688166, -77.29542717735978, -51.83277633103815, -68.6876975497704, -92.2432807195542, -150.30589562903646, -99.21685828518221, -60.75438597472769, -60.36038932773447, -122.76134627603014, -141.80253065044718, -77.83316160709995, -41.905309791551616, -157.69737979680613, -45.17116659503006, -46.34902778373105, -52.55113490159688, -66.13373329775101, -87.32951714692244, -124.7103051992179, -84.76501649898063, -56.3174050914383, -79.73999418508116, -100.57107514725419, -54.64988426295706, -47.82815640428911, -102.4989259114955, -147.76142255546796, -107.58087644142181, -82.95527807183434, -64.40345599635828, -46.175026682984985, -57.740584991719274, -82.3307610473659, -81.11801869947202, -55.89898771852779, -61.714781405556195, -71.45123466965705, -116.88860002346182, -58.05542439577223, -78.16238794658517, -55.06564605075815, -58.367839090951236, -46.03881040732875, -80.90703040591697, -52.6334342249437, -125.81249411241839, -143.76288723533227, -162.89284702651528, -83.0097661163224, -80.4330922469956, -76.78546238956874, -65.97836231796991], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6066543300066018, "mean_inference_ms": 5.22412842884435, "mean_action_processing_ms": 0.19470174720382138, "mean_env_wait_ms": 1.3563254830320253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 1568000, "num_env_steps_trained": 1568000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1568000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 75448.818, "load_time_ms": 29.736, "load_throughput": 470807.24, "learn_time_ms": 67665.652, "learn_throughput": 206.9, "synch_weights_time_ms": 12.966}, "counters": {"num_env_steps_sampled": 1568000, "num_env_steps_trained": 1568000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "episodes_total": 1568, "training_iteration": 112, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-16-44", "timestamp": 1693059404, "time_this_iter_s": 75.23802280426025, "time_total_s": 8556.07477736473, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015204880>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701536D370>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 8556.07477736473, "timesteps_since_restore": 0, "iterations_since_restore": 112, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.6811320754717, "ram_util_percent": 50.655660377358494}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -277.3976199053973, "episode_L1_reward_sum_min": -581.7255594283342, "episode_L1_reward_sum_max": -165.02914453297853, "episode_L2_reward_sum_mean": -146.3306427165866, "episode_L2_reward_sum_min": -220.98004054278135, "episode_L2_reward_sum_max": -116.72802575677633}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.04694363167710648, "policy_loss": 0.01804205380406982, "vf_loss": 0.28901578729186, "vf_explained_var": 0.7626248456445741, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1582000, "num_env_steps_trained": 1582000, "num_agent_steps_sampled": 1582000, "num_agent_steps_trained": 1582000}, "sampler_results": {"episode_reward_max": -41.905309791551616, "episode_reward_min": -196.9279957941202, "episode_reward_mean": -89.63172613404686, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -277.3976199053973, "episode_L1_reward_sum_min": -581.7255594283342, "episode_L1_reward_sum_max": -165.02914453297853, "episode_L2_reward_sum_mean": -146.3306427165866, "episode_L2_reward_sum_min": -220.98004054278135, "episode_L2_reward_sum_max": -116.72802575677633}, "hist_stats": {"episode_reward": [-66.14686938225077, -114.96910545937405, -122.11416731012763, -81.1118551112164, -93.44468890380634, -49.599205987158534, -89.7082663084211, -90.02681973075018, -92.50690758914759, -58.956393498416475, -160.51117518210674, -61.59437787348256, -84.93940539490725, -109.08988787405961, -117.2372427802977, -79.54533381880076, -44.9483969364254, -97.13194669491658, -67.19423427563395, -67.69694873066692, -160.83126510385765, -101.92402080723465, -134.05254473974546, -61.93949659322127, -109.74573287292765, -115.14334009170409, -71.08116966888669, -67.71159440331867, -84.95458091733572, -51.42222622969617, -95.86003956589832, -79.03272106352392, -69.57937225759296, -98.99395489688166, -77.29542717735978, -51.83277633103815, -68.6876975497704, -92.2432807195542, -150.30589562903646, -99.21685828518221, -60.75438597472769, -60.36038932773447, -122.76134627603014, -141.80253065044718, -77.83316160709995, -41.905309791551616, -157.69737979680613, -45.17116659503006, -46.34902778373105, -52.55113490159688, -66.13373329775101, -87.32951714692244, -124.7103051992179, -84.76501649898063, -56.3174050914383, -79.73999418508116, -100.57107514725419, -54.64988426295706, -47.82815640428911, -102.4989259114955, -147.76142255546796, -107.58087644142181, -82.95527807183434, -64.40345599635828, -46.175026682984985, -57.740584991719274, -82.3307610473659, -81.11801869947202, -55.89898771852779, -61.714781405556195, -71.45123466965705, -116.88860002346182, -58.05542439577223, -78.16238794658517, -55.06564605075815, -58.367839090951236, -46.03881040732875, -80.90703040591697, -52.6334342249437, -125.81249411241839, -143.76288723533227, -162.89284702651528, -83.0097661163224, -80.4330922469956, -76.78546238956874, -65.97836231796991, -124.66184295764637, -177.68793578549628, -109.27331044527473, -90.17675644308895, -136.59426069092518, -136.2212873166814, -45.229652726093846, -71.59850867393726, -94.86216631235617, -82.74714176803413, -143.45457079549507, -196.9279957941202, -95.83673910047186, -111.91886272798297], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6067342683135554, "mean_inference_ms": 5.225168023304244, "mean_action_processing_ms": 0.19470338997740883, "mean_env_wait_ms": 1.3566417106376423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -41.905309791551616, "episode_reward_min": -196.9279957941202, "episode_reward_mean": -89.63172613404686, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-66.14686938225077, -114.96910545937405, -122.11416731012763, -81.1118551112164, -93.44468890380634, -49.599205987158534, -89.7082663084211, -90.02681973075018, -92.50690758914759, -58.956393498416475, -160.51117518210674, -61.59437787348256, -84.93940539490725, -109.08988787405961, -117.2372427802977, -79.54533381880076, -44.9483969364254, -97.13194669491658, -67.19423427563395, -67.69694873066692, -160.83126510385765, -101.92402080723465, -134.05254473974546, -61.93949659322127, -109.74573287292765, -115.14334009170409, -71.08116966888669, -67.71159440331867, -84.95458091733572, -51.42222622969617, -95.86003956589832, -79.03272106352392, -69.57937225759296, -98.99395489688166, -77.29542717735978, -51.83277633103815, -68.6876975497704, -92.2432807195542, -150.30589562903646, -99.21685828518221, -60.75438597472769, -60.36038932773447, -122.76134627603014, -141.80253065044718, -77.83316160709995, -41.905309791551616, -157.69737979680613, -45.17116659503006, -46.34902778373105, -52.55113490159688, -66.13373329775101, -87.32951714692244, -124.7103051992179, -84.76501649898063, -56.3174050914383, -79.73999418508116, -100.57107514725419, -54.64988426295706, -47.82815640428911, -102.4989259114955, -147.76142255546796, -107.58087644142181, -82.95527807183434, -64.40345599635828, -46.175026682984985, -57.740584991719274, -82.3307610473659, -81.11801869947202, -55.89898771852779, -61.714781405556195, -71.45123466965705, -116.88860002346182, -58.05542439577223, -78.16238794658517, -55.06564605075815, -58.367839090951236, -46.03881040732875, -80.90703040591697, -52.6334342249437, -125.81249411241839, -143.76288723533227, -162.89284702651528, -83.0097661163224, -80.4330922469956, -76.78546238956874, -65.97836231796991, -124.66184295764637, -177.68793578549628, -109.27331044527473, -90.17675644308895, -136.59426069092518, -136.2212873166814, -45.229652726093846, -71.59850867393726, -94.86216631235617, -82.74714176803413, -143.45457079549507, -196.9279957941202, -95.83673910047186, -111.91886272798297], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6067342683135554, "mean_inference_ms": 5.225168023304244, "mean_action_processing_ms": 0.19470338997740883, "mean_env_wait_ms": 1.3566417106376423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1582000, "num_agent_steps_trained": 1582000, "num_env_steps_sampled": 1582000, "num_env_steps_trained": 1582000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1582000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1582000, "timers": {"training_iteration_time_ms": 75461.504, "load_time_ms": 30.434, "load_throughput": 460010.56, "learn_time_ms": 67659.517, "learn_throughput": 206.918, "synch_weights_time_ms": 12.168}, "counters": {"num_env_steps_sampled": 1582000, "num_env_steps_trained": 1582000, "num_agent_steps_sampled": 1582000, "num_agent_steps_trained": 1582000}, "done": false, "episodes_total": 1582, "training_iteration": 113, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-17-59", "timestamp": 1693059479, "time_this_iter_s": 75.3638219833374, "time_total_s": 8631.438599348068, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015350340>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701542A130>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 8631.438599348068, "timesteps_since_restore": 0, "iterations_since_restore": 113, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.860377358490563, "ram_util_percent": 50.65849056603773}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -276.3297456462681, "episode_L1_reward_sum_min": -581.7255594283342, "episode_L1_reward_sum_max": -165.02914453297853, "episode_L2_reward_sum_mean": -146.03276867583395, "episode_L2_reward_sum_min": -220.98004054278135, "episode_L2_reward_sum_max": -116.72802575677633}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.07683540267607297, "policy_loss": 0.05408116329582063, "vf_loss": 0.2275423956138536, "vf_explained_var": 0.739744543293376, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1596000, "num_env_steps_trained": 1596000, "num_agent_steps_sampled": 1596000, "num_agent_steps_trained": 1596000}, "sampler_results": {"episode_reward_max": -41.905309791551616, "episode_reward_min": -196.9279957941202, "episode_reward_mean": -89.48515580579938, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -276.3297456462681, "episode_L1_reward_sum_min": -581.7255594283342, "episode_L1_reward_sum_max": -165.02914453297853, "episode_L2_reward_sum_mean": -146.03276867583395, "episode_L2_reward_sum_min": -220.98004054278135, "episode_L2_reward_sum_max": -116.72802575677633}, "hist_stats": {"episode_reward": [-117.2372427802977, -79.54533381880076, -44.9483969364254, -97.13194669491658, -67.19423427563395, -67.69694873066692, -160.83126510385765, -101.92402080723465, -134.05254473974546, -61.93949659322127, -109.74573287292765, -115.14334009170409, -71.08116966888669, -67.71159440331867, -84.95458091733572, -51.42222622969617, -95.86003956589832, -79.03272106352392, -69.57937225759296, -98.99395489688166, -77.29542717735978, -51.83277633103815, -68.6876975497704, -92.2432807195542, -150.30589562903646, -99.21685828518221, -60.75438597472769, -60.36038932773447, -122.76134627603014, -141.80253065044718, -77.83316160709995, -41.905309791551616, -157.69737979680613, -45.17116659503006, -46.34902778373105, -52.55113490159688, -66.13373329775101, -87.32951714692244, -124.7103051992179, -84.76501649898063, -56.3174050914383, -79.73999418508116, -100.57107514725419, -54.64988426295706, -47.82815640428911, -102.4989259114955, -147.76142255546796, -107.58087644142181, -82.95527807183434, -64.40345599635828, -46.175026682984985, -57.740584991719274, -82.3307610473659, -81.11801869947202, -55.89898771852779, -61.714781405556195, -71.45123466965705, -116.88860002346182, -58.05542439577223, -78.16238794658517, -55.06564605075815, -58.367839090951236, -46.03881040732875, -80.90703040591697, -52.6334342249437, -125.81249411241839, -143.76288723533227, -162.89284702651528, -83.0097661163224, -80.4330922469956, -76.78546238956874, -65.97836231796991, -124.66184295764637, -177.68793578549628, -109.27331044527473, -90.17675644308895, -136.59426069092518, -136.2212873166814, -45.229652726093846, -71.59850867393726, -94.86216631235617, -82.74714176803413, -143.45457079549507, -196.9279957941202, -95.83673910047186, -111.91886272798297, -125.34161505287568, -99.87646644760535, -58.32743437256334, -79.43607228754071, -88.14778249878246, -78.98624683725268, -47.293044455016705, -122.92734673717203, -65.41189424410311, -72.61939139554612, -117.60213956387261, -66.41816117889687, -146.60314908794138, -91.07134862131007], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6068031743861768, "mean_inference_ms": 5.2263071006846715, "mean_action_processing_ms": 0.19471622270237254, "mean_env_wait_ms": 1.356988712402333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -41.905309791551616, "episode_reward_min": -196.9279957941202, "episode_reward_mean": -89.48515580579938, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-117.2372427802977, -79.54533381880076, -44.9483969364254, -97.13194669491658, -67.19423427563395, -67.69694873066692, -160.83126510385765, -101.92402080723465, -134.05254473974546, -61.93949659322127, -109.74573287292765, -115.14334009170409, -71.08116966888669, -67.71159440331867, -84.95458091733572, -51.42222622969617, -95.86003956589832, -79.03272106352392, -69.57937225759296, -98.99395489688166, -77.29542717735978, -51.83277633103815, -68.6876975497704, -92.2432807195542, -150.30589562903646, -99.21685828518221, -60.75438597472769, -60.36038932773447, -122.76134627603014, -141.80253065044718, -77.83316160709995, -41.905309791551616, -157.69737979680613, -45.17116659503006, -46.34902778373105, -52.55113490159688, -66.13373329775101, -87.32951714692244, -124.7103051992179, -84.76501649898063, -56.3174050914383, -79.73999418508116, -100.57107514725419, -54.64988426295706, -47.82815640428911, -102.4989259114955, -147.76142255546796, -107.58087644142181, -82.95527807183434, -64.40345599635828, -46.175026682984985, -57.740584991719274, -82.3307610473659, -81.11801869947202, -55.89898771852779, -61.714781405556195, -71.45123466965705, -116.88860002346182, -58.05542439577223, -78.16238794658517, -55.06564605075815, -58.367839090951236, -46.03881040732875, -80.90703040591697, -52.6334342249437, -125.81249411241839, -143.76288723533227, -162.89284702651528, -83.0097661163224, -80.4330922469956, -76.78546238956874, -65.97836231796991, -124.66184295764637, -177.68793578549628, -109.27331044527473, -90.17675644308895, -136.59426069092518, -136.2212873166814, -45.229652726093846, -71.59850867393726, -94.86216631235617, -82.74714176803413, -143.45457079549507, -196.9279957941202, -95.83673910047186, -111.91886272798297, -125.34161505287568, -99.87646644760535, -58.32743437256334, -79.43607228754071, -88.14778249878246, -78.98624683725268, -47.293044455016705, -122.92734673717203, -65.41189424410311, -72.61939139554612, -117.60213956387261, -66.41816117889687, -146.60314908794138, -91.07134862131007], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6068031743861768, "mean_inference_ms": 5.2263071006846715, "mean_action_processing_ms": 0.19471622270237254, "mean_env_wait_ms": 1.356988712402333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1596000, "num_agent_steps_trained": 1596000, "num_env_steps_sampled": 1596000, "num_env_steps_trained": 1596000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1596000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1596000, "timers": {"training_iteration_time_ms": 75468.086, "load_time_ms": 30.434, "load_throughput": 460007.317, "learn_time_ms": 67645.839, "learn_throughput": 206.96, "synch_weights_time_ms": 12.268}, "counters": {"num_env_steps_sampled": 1596000, "num_env_steps_trained": 1596000, "num_agent_steps_sampled": 1596000, "num_agent_steps_trained": 1596000}, "done": false, "episodes_total": 1596, "training_iteration": 114, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-19-15", "timestamp": 1693059555, "time_this_iter_s": 75.4589467048645, "time_total_s": 8706.897546052933, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701534D7C0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701545E520>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 8706.897546052933, "timesteps_since_restore": 0, "iterations_since_restore": 114, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.869158878504678, "ram_util_percent": 50.6626168224299}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -267.3813052739203, "episode_L1_reward_sum_min": -581.7255594283342, "episode_L1_reward_sum_max": -165.02914453297853, "episode_L2_reward_sum_mean": -143.77281706914306, "episode_L2_reward_sum_min": -220.98004054278135, "episode_L2_reward_sum_max": -116.72802575677633}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.04401330188598959, "policy_loss": 0.01825897557538294, "vf_loss": 0.25754325451130894, "vf_explained_var": 0.5717379278790804, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1610000, "num_env_steps_trained": 1610000, "num_agent_steps_sampled": 1610000, "num_agent_steps_trained": 1610000}, "sampler_results": {"episode_reward_max": -41.905309791551616, "episode_reward_min": -196.9279957941202, "episode_reward_mean": -88.44657523198681, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -267.3813052739203, "episode_L1_reward_sum_min": -581.7255594283342, "episode_L1_reward_sum_max": -165.02914453297853, "episode_L2_reward_sum_mean": -143.77281706914306, "episode_L2_reward_sum_min": -220.98004054278135, "episode_L2_reward_sum_max": -116.72802575677633}, "hist_stats": {"episode_reward": [-84.95458091733572, -51.42222622969617, -95.86003956589832, -79.03272106352392, -69.57937225759296, -98.99395489688166, -77.29542717735978, -51.83277633103815, -68.6876975497704, -92.2432807195542, -150.30589562903646, -99.21685828518221, -60.75438597472769, -60.36038932773447, -122.76134627603014, -141.80253065044718, -77.83316160709995, -41.905309791551616, -157.69737979680613, -45.17116659503006, -46.34902778373105, -52.55113490159688, -66.13373329775101, -87.32951714692244, -124.7103051992179, -84.76501649898063, -56.3174050914383, -79.73999418508116, -100.57107514725419, -54.64988426295706, -47.82815640428911, -102.4989259114955, -147.76142255546796, -107.58087644142181, -82.95527807183434, -64.40345599635828, -46.175026682984985, -57.740584991719274, -82.3307610473659, -81.11801869947202, -55.89898771852779, -61.714781405556195, -71.45123466965705, -116.88860002346182, -58.05542439577223, -78.16238794658517, -55.06564605075815, -58.367839090951236, -46.03881040732875, -80.90703040591697, -52.6334342249437, -125.81249411241839, -143.76288723533227, -162.89284702651528, -83.0097661163224, -80.4330922469956, -76.78546238956874, -65.97836231796991, -124.66184295764637, -177.68793578549628, -109.27331044527473, -90.17675644308895, -136.59426069092518, -136.2212873166814, -45.229652726093846, -71.59850867393726, -94.86216631235617, -82.74714176803413, -143.45457079549507, -196.9279957941202, -95.83673910047186, -111.91886272798297, -125.34161505287568, -99.87646644760535, -58.32743437256334, -79.43607228754071, -88.14778249878246, -78.98624683725268, -47.293044455016705, -122.92734673717203, -65.41189424410311, -72.61939139554612, -117.60213956387261, -66.41816117889687, -146.60314908794138, -91.07134862131007, -73.53487926709282, -66.56856538802883, -67.25542862800182, -89.76681336480263, -47.09752765555157, -65.4325180018055, -123.02027486485655, -85.9483856557534, -148.40601486721962, -108.41980981774358, -68.08968607602642, -50.52997244822118, -113.40996197731684, -84.84537212396005], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6068648500207011, "mean_inference_ms": 5.227469794745608, "mean_action_processing_ms": 0.19473181720483526, "mean_env_wait_ms": 1.3573459577617797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -41.905309791551616, "episode_reward_min": -196.9279957941202, "episode_reward_mean": -88.44657523198681, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-84.95458091733572, -51.42222622969617, -95.86003956589832, -79.03272106352392, -69.57937225759296, -98.99395489688166, -77.29542717735978, -51.83277633103815, -68.6876975497704, -92.2432807195542, -150.30589562903646, -99.21685828518221, -60.75438597472769, -60.36038932773447, -122.76134627603014, -141.80253065044718, -77.83316160709995, -41.905309791551616, -157.69737979680613, -45.17116659503006, -46.34902778373105, -52.55113490159688, -66.13373329775101, -87.32951714692244, -124.7103051992179, -84.76501649898063, -56.3174050914383, -79.73999418508116, -100.57107514725419, -54.64988426295706, -47.82815640428911, -102.4989259114955, -147.76142255546796, -107.58087644142181, -82.95527807183434, -64.40345599635828, -46.175026682984985, -57.740584991719274, -82.3307610473659, -81.11801869947202, -55.89898771852779, -61.714781405556195, -71.45123466965705, -116.88860002346182, -58.05542439577223, -78.16238794658517, -55.06564605075815, -58.367839090951236, -46.03881040732875, -80.90703040591697, -52.6334342249437, -125.81249411241839, -143.76288723533227, -162.89284702651528, -83.0097661163224, -80.4330922469956, -76.78546238956874, -65.97836231796991, -124.66184295764637, -177.68793578549628, -109.27331044527473, -90.17675644308895, -136.59426069092518, -136.2212873166814, -45.229652726093846, -71.59850867393726, -94.86216631235617, -82.74714176803413, -143.45457079549507, -196.9279957941202, -95.83673910047186, -111.91886272798297, -125.34161505287568, -99.87646644760535, -58.32743437256334, -79.43607228754071, -88.14778249878246, -78.98624683725268, -47.293044455016705, -122.92734673717203, -65.41189424410311, -72.61939139554612, -117.60213956387261, -66.41816117889687, -146.60314908794138, -91.07134862131007, -73.53487926709282, -66.56856538802883, -67.25542862800182, -89.76681336480263, -47.09752765555157, -65.4325180018055, -123.02027486485655, -85.9483856557534, -148.40601486721962, -108.41980981774358, -68.08968607602642, -50.52997244822118, -113.40996197731684, -84.84537212396005], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6068648500207011, "mean_inference_ms": 5.227469794745608, "mean_action_processing_ms": 0.19473181720483526, "mean_env_wait_ms": 1.3573459577617797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1610000, "num_agent_steps_trained": 1610000, "num_env_steps_sampled": 1610000, "num_env_steps_trained": 1610000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1610000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1610000, "timers": {"training_iteration_time_ms": 75473.644, "load_time_ms": 30.437, "load_throughput": 459966.599, "learn_time_ms": 67649.067, "learn_throughput": 206.95, "synch_weights_time_ms": 12.265}, "counters": {"num_env_steps_sampled": 1610000, "num_env_steps_trained": 1610000, "num_agent_steps_sampled": 1610000, "num_agent_steps_trained": 1610000}, "done": false, "episodes_total": 1610, "training_iteration": 115, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-20-30", "timestamp": 1693059630, "time_this_iter_s": 75.45156788825989, "time_total_s": 8782.349113941193, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270156AAFA0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701535EB80>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 8782.349113941193, "timesteps_since_restore": 0, "iterations_since_restore": 115, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.817757009345794, "ram_util_percent": 50.67196261682243}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -276.10706440798936, "episode_L1_reward_sum_min": -581.7255594283342, "episode_L1_reward_sum_max": -165.02914453297853, "episode_L2_reward_sum_mean": -146.00734733574092, "episode_L2_reward_sum_min": -220.98004054278135, "episode_L2_reward_sum_max": -116.72802575677633}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.037517932735386145, "policy_loss": 0.012038578473880922, "vf_loss": 0.2547935455983681, "vf_explained_var": 0.6929809527142058, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1624000, "num_env_steps_trained": 1624000, "num_agent_steps_sampled": 1624000, "num_agent_steps_trained": 1624000}, "sampler_results": {"episode_reward_max": -41.905309791551616, "episode_reward_min": -196.9279957941202, "episode_reward_mean": -90.95161380872194, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -276.10706440798936, "episode_L1_reward_sum_min": -581.7255594283342, "episode_L1_reward_sum_max": -165.02914453297853, "episode_L2_reward_sum_mean": -146.00734733574092, "episode_L2_reward_sum_min": -220.98004054278135, "episode_L2_reward_sum_max": -116.72802575677633}, "hist_stats": {"episode_reward": [-122.76134627603014, -141.80253065044718, -77.83316160709995, -41.905309791551616, -157.69737979680613, -45.17116659503006, -46.34902778373105, -52.55113490159688, -66.13373329775101, -87.32951714692244, -124.7103051992179, -84.76501649898063, -56.3174050914383, -79.73999418508116, -100.57107514725419, -54.64988426295706, -47.82815640428911, -102.4989259114955, -147.76142255546796, -107.58087644142181, -82.95527807183434, -64.40345599635828, -46.175026682984985, -57.740584991719274, -82.3307610473659, -81.11801869947202, -55.89898771852779, -61.714781405556195, -71.45123466965705, -116.88860002346182, -58.05542439577223, -78.16238794658517, -55.06564605075815, -58.367839090951236, -46.03881040732875, -80.90703040591697, -52.6334342249437, -125.81249411241839, -143.76288723533227, -162.89284702651528, -83.0097661163224, -80.4330922469956, -76.78546238956874, -65.97836231796991, -124.66184295764637, -177.68793578549628, -109.27331044527473, -90.17675644308895, -136.59426069092518, -136.2212873166814, -45.229652726093846, -71.59850867393726, -94.86216631235617, -82.74714176803413, -143.45457079549507, -196.9279957941202, -95.83673910047186, -111.91886272798297, -125.34161505287568, -99.87646644760535, -58.32743437256334, -79.43607228754071, -88.14778249878246, -78.98624683725268, -47.293044455016705, -122.92734673717203, -65.41189424410311, -72.61939139554612, -117.60213956387261, -66.41816117889687, -146.60314908794138, -91.07134862131007, -73.53487926709282, -66.56856538802883, -67.25542862800182, -89.76681336480263, -47.09752765555157, -65.4325180018055, -123.02027486485655, -85.9483856557534, -148.40601486721962, -108.41980981774358, -68.08968607602642, -50.52997244822118, -113.40996197731684, -84.84537212396005, -106.30836811890326, -57.72329824729276, -66.63108592967765, -49.05027659691956, -56.66175638870847, -67.39267929504327, -79.84072039656579, -136.72900617621033, -139.47130126519718, -96.76880570560778, -84.78912360323905, -104.71394679206449, -184.55890421641868, -160.40419086699535], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6069343114672968, "mean_inference_ms": 5.2287035329614335, "mean_action_processing_ms": 0.1947530722201374, "mean_env_wait_ms": 1.3577268328378267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -41.905309791551616, "episode_reward_min": -196.9279957941202, "episode_reward_mean": -90.95161380872194, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-122.76134627603014, -141.80253065044718, -77.83316160709995, -41.905309791551616, -157.69737979680613, -45.17116659503006, -46.34902778373105, -52.55113490159688, -66.13373329775101, -87.32951714692244, -124.7103051992179, -84.76501649898063, -56.3174050914383, -79.73999418508116, -100.57107514725419, -54.64988426295706, -47.82815640428911, -102.4989259114955, -147.76142255546796, -107.58087644142181, -82.95527807183434, -64.40345599635828, -46.175026682984985, -57.740584991719274, -82.3307610473659, -81.11801869947202, -55.89898771852779, -61.714781405556195, -71.45123466965705, -116.88860002346182, -58.05542439577223, -78.16238794658517, -55.06564605075815, -58.367839090951236, -46.03881040732875, -80.90703040591697, -52.6334342249437, -125.81249411241839, -143.76288723533227, -162.89284702651528, -83.0097661163224, -80.4330922469956, -76.78546238956874, -65.97836231796991, -124.66184295764637, -177.68793578549628, -109.27331044527473, -90.17675644308895, -136.59426069092518, -136.2212873166814, -45.229652726093846, -71.59850867393726, -94.86216631235617, -82.74714176803413, -143.45457079549507, -196.9279957941202, -95.83673910047186, -111.91886272798297, -125.34161505287568, -99.87646644760535, -58.32743437256334, -79.43607228754071, -88.14778249878246, -78.98624683725268, -47.293044455016705, -122.92734673717203, -65.41189424410311, -72.61939139554612, -117.60213956387261, -66.41816117889687, -146.60314908794138, -91.07134862131007, -73.53487926709282, -66.56856538802883, -67.25542862800182, -89.76681336480263, -47.09752765555157, -65.4325180018055, -123.02027486485655, -85.9483856557534, -148.40601486721962, -108.41980981774358, -68.08968607602642, -50.52997244822118, -113.40996197731684, -84.84537212396005, -106.30836811890326, -57.72329824729276, -66.63108592967765, -49.05027659691956, -56.66175638870847, -67.39267929504327, -79.84072039656579, -136.72900617621033, -139.47130126519718, -96.76880570560778, -84.78912360323905, -104.71394679206449, -184.55890421641868, -160.40419086699535], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6069343114672968, "mean_inference_ms": 5.2287035329614335, "mean_action_processing_ms": 0.1947530722201374, "mean_env_wait_ms": 1.3577268328378267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1624000, "num_agent_steps_trained": 1624000, "num_env_steps_sampled": 1624000, "num_env_steps_trained": 1624000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1624000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1624000, "timers": {"training_iteration_time_ms": 75495.222, "load_time_ms": 30.653, "load_throughput": 456718.532, "learn_time_ms": 67644.289, "learn_throughput": 206.965, "synch_weights_time_ms": 11.966}, "counters": {"num_env_steps_sampled": 1624000, "num_env_steps_trained": 1624000, "num_agent_steps_sampled": 1624000, "num_agent_steps_trained": 1624000}, "done": false, "episodes_total": 1624, "training_iteration": 116, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-21-46", "timestamp": 1693059706, "time_this_iter_s": 75.5990662574768, "time_total_s": 8857.94818019867, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270154E9220>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270154220A0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 8857.94818019867, "timesteps_since_restore": 0, "iterations_since_restore": 116, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.89252336448598, "ram_util_percent": 50.67009345794392}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -275.50057529203593, "episode_L1_reward_sum_min": -581.7255594283342, "episode_L1_reward_sum_max": -165.02914453297853, "episode_L2_reward_sum_mean": -145.87095189101993, "episode_L2_reward_sum_min": -220.98004054278135, "episode_L2_reward_sum_max": -116.72802575677633}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.0418232501836095, "policy_loss": 0.020115877442261197, "vf_loss": 0.21707372321807503, "vf_explained_var": 0.6079320589640013, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1638000, "num_env_steps_trained": 1638000, "num_agent_steps_sampled": 1638000, "num_agent_steps_trained": 1638000}, "sampler_results": {"episode_reward_max": -41.414157785187214, "episode_reward_min": -196.9279957941202, "episode_reward_mean": -90.47853468681076, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -275.50057529203593, "episode_L1_reward_sum_min": -581.7255594283342, "episode_L1_reward_sum_max": -165.02914453297853, "episode_L2_reward_sum_mean": -145.87095189101993, "episode_L2_reward_sum_min": -220.98004054278135, "episode_L2_reward_sum_max": -116.72802575677633}, "hist_stats": {"episode_reward": [-100.57107514725419, -54.64988426295706, -47.82815640428911, -102.4989259114955, -147.76142255546796, -107.58087644142181, -82.95527807183434, -64.40345599635828, -46.175026682984985, -57.740584991719274, -82.3307610473659, -81.11801869947202, -55.89898771852779, -61.714781405556195, -71.45123466965705, -116.88860002346182, -58.05542439577223, -78.16238794658517, -55.06564605075815, -58.367839090951236, -46.03881040732875, -80.90703040591697, -52.6334342249437, -125.81249411241839, -143.76288723533227, -162.89284702651528, -83.0097661163224, -80.4330922469956, -76.78546238956874, -65.97836231796991, -124.66184295764637, -177.68793578549628, -109.27331044527473, -90.17675644308895, -136.59426069092518, -136.2212873166814, -45.229652726093846, -71.59850867393726, -94.86216631235617, -82.74714176803413, -143.45457079549507, -196.9279957941202, -95.83673910047186, -111.91886272798297, -125.34161505287568, -99.87646644760535, -58.32743437256334, -79.43607228754071, -88.14778249878246, -78.98624683725268, -47.293044455016705, -122.92734673717203, -65.41189424410311, -72.61939139554612, -117.60213956387261, -66.41816117889687, -146.60314908794138, -91.07134862131007, -73.53487926709282, -66.56856538802883, -67.25542862800182, -89.76681336480263, -47.09752765555157, -65.4325180018055, -123.02027486485655, -85.9483856557534, -148.40601486721962, -108.41980981774358, -68.08968607602642, -50.52997244822118, -113.40996197731684, -84.84537212396005, -106.30836811890326, -57.72329824729276, -66.63108592967765, -49.05027659691956, -56.66175638870847, -67.39267929504327, -79.84072039656579, -136.72900617621033, -139.47130126519718, -96.76880570560778, -84.78912360323905, -104.71394679206449, -184.55890421641868, -160.40419086699535, -72.16311191461111, -142.33337830748036, -55.40810751706854, -101.92208462421655, -66.71969435122568, -62.39127831421515, -63.948175742412126, -85.34819441982724, -71.78916653402844, -100.68556178427025, -41.414157785187214, -87.8604244737917, -90.04004669217362, -95.73573417005659], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6069994419365716, "mean_inference_ms": 5.2299980253401825, "mean_action_processing_ms": 0.19478257368174132, "mean_env_wait_ms": 1.3581152309383555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -41.414157785187214, "episode_reward_min": -196.9279957941202, "episode_reward_mean": -90.47853468681076, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-100.57107514725419, -54.64988426295706, -47.82815640428911, -102.4989259114955, -147.76142255546796, -107.58087644142181, -82.95527807183434, -64.40345599635828, -46.175026682984985, -57.740584991719274, -82.3307610473659, -81.11801869947202, -55.89898771852779, -61.714781405556195, -71.45123466965705, -116.88860002346182, -58.05542439577223, -78.16238794658517, -55.06564605075815, -58.367839090951236, -46.03881040732875, -80.90703040591697, -52.6334342249437, -125.81249411241839, -143.76288723533227, -162.89284702651528, -83.0097661163224, -80.4330922469956, -76.78546238956874, -65.97836231796991, -124.66184295764637, -177.68793578549628, -109.27331044527473, -90.17675644308895, -136.59426069092518, -136.2212873166814, -45.229652726093846, -71.59850867393726, -94.86216631235617, -82.74714176803413, -143.45457079549507, -196.9279957941202, -95.83673910047186, -111.91886272798297, -125.34161505287568, -99.87646644760535, -58.32743437256334, -79.43607228754071, -88.14778249878246, -78.98624683725268, -47.293044455016705, -122.92734673717203, -65.41189424410311, -72.61939139554612, -117.60213956387261, -66.41816117889687, -146.60314908794138, -91.07134862131007, -73.53487926709282, -66.56856538802883, -67.25542862800182, -89.76681336480263, -47.09752765555157, -65.4325180018055, -123.02027486485655, -85.9483856557534, -148.40601486721962, -108.41980981774358, -68.08968607602642, -50.52997244822118, -113.40996197731684, -84.84537212396005, -106.30836811890326, -57.72329824729276, -66.63108592967765, -49.05027659691956, -56.66175638870847, -67.39267929504327, -79.84072039656579, -136.72900617621033, -139.47130126519718, -96.76880570560778, -84.78912360323905, -104.71394679206449, -184.55890421641868, -160.40419086699535, -72.16311191461111, -142.33337830748036, -55.40810751706854, -101.92208462421655, -66.71969435122568, -62.39127831421515, -63.948175742412126, -85.34819441982724, -71.78916653402844, -100.68556178427025, -41.414157785187214, -87.8604244737917, -90.04004669217362, -95.73573417005659], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6069994419365716, "mean_inference_ms": 5.2299980253401825, "mean_action_processing_ms": 0.19478257368174132, "mean_env_wait_ms": 1.3581152309383555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1638000, "num_agent_steps_trained": 1638000, "num_env_steps_sampled": 1638000, "num_env_steps_trained": 1638000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1638000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1638000, "timers": {"training_iteration_time_ms": 75482.708, "load_time_ms": 31.345, "load_throughput": 446639.01, "learn_time_ms": 67617.449, "learn_throughput": 207.047, "synch_weights_time_ms": 12.177}, "counters": {"num_env_steps_sampled": 1638000, "num_env_steps_trained": 1638000, "num_agent_steps_sampled": 1638000, "num_agent_steps_trained": 1638000}, "done": false, "episodes_total": 1638, "training_iteration": 117, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-23-01", "timestamp": 1693059781, "time_this_iter_s": 75.40890336036682, "time_total_s": 8933.357083559036, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701543EEE0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701542A7C0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 8933.357083559036, "timesteps_since_restore": 0, "iterations_since_restore": 117, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.91775700934579, "ram_util_percent": 50.692523364485986}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -280.6101607425511, "episode_L1_reward_sum_min": -581.7255594283342, "episode_L1_reward_sum_max": -166.69479939341545, "episode_L2_reward_sum_mean": -147.17664837867022, "episode_L2_reward_sum_min": -220.98004054278135, "episode_L2_reward_sum_max": -118.30073269456625}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.023238546360157614, "policy_loss": -0.00390845695424273, "vf_loss": 0.2714700289826851, "vf_explained_var": 0.5224767400588027, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1652000, "num_env_steps_trained": 1652000, "num_agent_steps_sampled": 1652000, "num_agent_steps_trained": 1652000}, "sampler_results": {"episode_reward_max": -37.605456625782, "episode_reward_min": -196.9279957941202, "episode_reward_mean": -93.05792920377094, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -280.6101607425511, "episode_L1_reward_sum_min": -581.7255594283342, "episode_L1_reward_sum_max": -166.69479939341545, "episode_L2_reward_sum_mean": -147.17664837867022, "episode_L2_reward_sum_min": -220.98004054278135, "episode_L2_reward_sum_max": -118.30073269456625}, "hist_stats": {"episode_reward": [-71.45123466965705, -116.88860002346182, -58.05542439577223, -78.16238794658517, -55.06564605075815, -58.367839090951236, -46.03881040732875, -80.90703040591697, -52.6334342249437, -125.81249411241839, -143.76288723533227, -162.89284702651528, -83.0097661163224, -80.4330922469956, -76.78546238956874, -65.97836231796991, -124.66184295764637, -177.68793578549628, -109.27331044527473, -90.17675644308895, -136.59426069092518, -136.2212873166814, -45.229652726093846, -71.59850867393726, -94.86216631235617, -82.74714176803413, -143.45457079549507, -196.9279957941202, -95.83673910047186, -111.91886272798297, -125.34161505287568, -99.87646644760535, -58.32743437256334, -79.43607228754071, -88.14778249878246, -78.98624683725268, -47.293044455016705, -122.92734673717203, -65.41189424410311, -72.61939139554612, -117.60213956387261, -66.41816117889687, -146.60314908794138, -91.07134862131007, -73.53487926709282, -66.56856538802883, -67.25542862800182, -89.76681336480263, -47.09752765555157, -65.4325180018055, -123.02027486485655, -85.9483856557534, -148.40601486721962, -108.41980981774358, -68.08968607602642, -50.52997244822118, -113.40996197731684, -84.84537212396005, -106.30836811890326, -57.72329824729276, -66.63108592967765, -49.05027659691956, -56.66175638870847, -67.39267929504327, -79.84072039656579, -136.72900617621033, -139.47130126519718, -96.76880570560778, -84.78912360323905, -104.71394679206449, -184.55890421641868, -160.40419086699535, -72.16311191461111, -142.33337830748036, -55.40810751706854, -101.92208462421655, -66.71969435122568, -62.39127831421515, -63.948175742412126, -85.34819441982724, -71.78916653402844, -100.68556178427025, -41.414157785187214, -87.8604244737917, -90.04004669217362, -95.73573417005659, -49.213422066521595, -156.11534277859252, -63.64520573884876, -37.605456625782, -164.24679582519354, -132.1584936533239, -110.57201792601424, -95.11131206174845, -101.24094602363041, -79.81481583279074, -81.6466881611093, -99.81708389060131, -97.72647657840496, -82.2526298701633], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6070403106755125, "mean_inference_ms": 5.231356120961198, "mean_action_processing_ms": 0.19482528813798175, "mean_env_wait_ms": 1.3585239538960594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -37.605456625782, "episode_reward_min": -196.9279957941202, "episode_reward_mean": -93.05792920377094, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-71.45123466965705, -116.88860002346182, -58.05542439577223, -78.16238794658517, -55.06564605075815, -58.367839090951236, -46.03881040732875, -80.90703040591697, -52.6334342249437, -125.81249411241839, -143.76288723533227, -162.89284702651528, -83.0097661163224, -80.4330922469956, -76.78546238956874, -65.97836231796991, -124.66184295764637, -177.68793578549628, -109.27331044527473, -90.17675644308895, -136.59426069092518, -136.2212873166814, -45.229652726093846, -71.59850867393726, -94.86216631235617, -82.74714176803413, -143.45457079549507, -196.9279957941202, -95.83673910047186, -111.91886272798297, -125.34161505287568, -99.87646644760535, -58.32743437256334, -79.43607228754071, -88.14778249878246, -78.98624683725268, -47.293044455016705, -122.92734673717203, -65.41189424410311, -72.61939139554612, -117.60213956387261, -66.41816117889687, -146.60314908794138, -91.07134862131007, -73.53487926709282, -66.56856538802883, -67.25542862800182, -89.76681336480263, -47.09752765555157, -65.4325180018055, -123.02027486485655, -85.9483856557534, -148.40601486721962, -108.41980981774358, -68.08968607602642, -50.52997244822118, -113.40996197731684, -84.84537212396005, -106.30836811890326, -57.72329824729276, -66.63108592967765, -49.05027659691956, -56.66175638870847, -67.39267929504327, -79.84072039656579, -136.72900617621033, -139.47130126519718, -96.76880570560778, -84.78912360323905, -104.71394679206449, -184.55890421641868, -160.40419086699535, -72.16311191461111, -142.33337830748036, -55.40810751706854, -101.92208462421655, -66.71969435122568, -62.39127831421515, -63.948175742412126, -85.34819441982724, -71.78916653402844, -100.68556178427025, -41.414157785187214, -87.8604244737917, -90.04004669217362, -95.73573417005659, -49.213422066521595, -156.11534277859252, -63.64520573884876, -37.605456625782, -164.24679582519354, -132.1584936533239, -110.57201792601424, -95.11131206174845, -101.24094602363041, -79.81481583279074, -81.6466881611093, -99.81708389060131, -97.72647657840496, -82.2526298701633], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6070403106755125, "mean_inference_ms": 5.231356120961198, "mean_action_processing_ms": 0.19482528813798175, "mean_env_wait_ms": 1.3585239538960594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1652000, "num_agent_steps_trained": 1652000, "num_env_steps_sampled": 1652000, "num_env_steps_trained": 1652000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1652000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1652000, "timers": {"training_iteration_time_ms": 75510.144, "load_time_ms": 31.342, "load_throughput": 446679.441, "learn_time_ms": 67645.641, "learn_throughput": 206.961, "synch_weights_time_ms": 12.385}, "counters": {"num_env_steps_sampled": 1652000, "num_env_steps_trained": 1652000, "num_agent_steps_sampled": 1652000, "num_agent_steps_trained": 1652000}, "done": false, "episodes_total": 1652, "training_iteration": 118, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-24-17", "timestamp": 1693059857, "time_this_iter_s": 75.92661166191101, "time_total_s": 9009.283695220947, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015309460>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015309370>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 9009.283695220947, "timesteps_since_restore": 0, "iterations_since_restore": 118, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 22.153271028037384, "ram_util_percent": 50.74205607476636}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -277.389001519531, "episode_L1_reward_sum_min": -581.7255594283342, "episode_L1_reward_sum_max": -160.77581455558538, "episode_L2_reward_sum_mean": -146.34559894993902, "episode_L2_reward_sum_min": -220.98004054278135, "episode_L2_reward_sum_max": -116.65848581492901}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.058003686828856885, "policy_loss": 0.035895642880043745, "vf_loss": 0.22108044315688125, "vf_explained_var": 0.5517593478101762, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1666000, "num_env_steps_trained": 1666000, "num_agent_steps_sampled": 1666000, "num_agent_steps_trained": 1666000}, "sampler_results": {"episode_reward_max": -37.605456625782, "episode_reward_min": -196.9279957941202, "episode_reward_mean": -92.36723876266778, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -277.389001519531, "episode_L1_reward_sum_min": -581.7255594283342, "episode_L1_reward_sum_max": -160.77581455558538, "episode_L2_reward_sum_mean": -146.34559894993902, "episode_L2_reward_sum_min": -220.98004054278135, "episode_L2_reward_sum_max": -116.65848581492901}, "hist_stats": {"episode_reward": [-76.78546238956874, -65.97836231796991, -124.66184295764637, -177.68793578549628, -109.27331044527473, -90.17675644308895, -136.59426069092518, -136.2212873166814, -45.229652726093846, -71.59850867393726, -94.86216631235617, -82.74714176803413, -143.45457079549507, -196.9279957941202, -95.83673910047186, -111.91886272798297, -125.34161505287568, -99.87646644760535, -58.32743437256334, -79.43607228754071, -88.14778249878246, -78.98624683725268, -47.293044455016705, -122.92734673717203, -65.41189424410311, -72.61939139554612, -117.60213956387261, -66.41816117889687, -146.60314908794138, -91.07134862131007, -73.53487926709282, -66.56856538802883, -67.25542862800182, -89.76681336480263, -47.09752765555157, -65.4325180018055, -123.02027486485655, -85.9483856557534, -148.40601486721962, -108.41980981774358, -68.08968607602642, -50.52997244822118, -113.40996197731684, -84.84537212396005, -106.30836811890326, -57.72329824729276, -66.63108592967765, -49.05027659691956, -56.66175638870847, -67.39267929504327, -79.84072039656579, -136.72900617621033, -139.47130126519718, -96.76880570560778, -84.78912360323905, -104.71394679206449, -184.55890421641868, -160.40419086699535, -72.16311191461111, -142.33337830748036, -55.40810751706854, -101.92208462421655, -66.71969435122568, -62.39127831421515, -63.948175742412126, -85.34819441982724, -71.78916653402844, -100.68556178427025, -41.414157785187214, -87.8604244737917, -90.04004669217362, -95.73573417005659, -49.213422066521595, -156.11534277859252, -63.64520573884876, -37.605456625782, -164.24679582519354, -132.1584936533239, -110.57201792601424, -95.11131206174845, -101.24094602363041, -79.81481583279074, -81.6466881611093, -99.81708389060131, -97.72647657840496, -82.2526298701633, -106.21077811875206, -69.7549183100345, -62.38459533770097, -78.77306405168974, -50.89724351256122, -85.8976263500877, -50.877891961824574, -119.34379364600464, -61.671416587543796, -57.964365411654306, -60.82962239848478, -103.01263207043819, -150.4233481456105, -86.37115394025597], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6070701690840139, "mean_inference_ms": 5.232783052680194, "mean_action_processing_ms": 0.19487598003498793, "mean_env_wait_ms": 1.3589501644610074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -37.605456625782, "episode_reward_min": -196.9279957941202, "episode_reward_mean": -92.36723876266778, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-76.78546238956874, -65.97836231796991, -124.66184295764637, -177.68793578549628, -109.27331044527473, -90.17675644308895, -136.59426069092518, -136.2212873166814, -45.229652726093846, -71.59850867393726, -94.86216631235617, -82.74714176803413, -143.45457079549507, -196.9279957941202, -95.83673910047186, -111.91886272798297, -125.34161505287568, -99.87646644760535, -58.32743437256334, -79.43607228754071, -88.14778249878246, -78.98624683725268, -47.293044455016705, -122.92734673717203, -65.41189424410311, -72.61939139554612, -117.60213956387261, -66.41816117889687, -146.60314908794138, -91.07134862131007, -73.53487926709282, -66.56856538802883, -67.25542862800182, -89.76681336480263, -47.09752765555157, -65.4325180018055, -123.02027486485655, -85.9483856557534, -148.40601486721962, -108.41980981774358, -68.08968607602642, -50.52997244822118, -113.40996197731684, -84.84537212396005, -106.30836811890326, -57.72329824729276, -66.63108592967765, -49.05027659691956, -56.66175638870847, -67.39267929504327, -79.84072039656579, -136.72900617621033, -139.47130126519718, -96.76880570560778, -84.78912360323905, -104.71394679206449, -184.55890421641868, -160.40419086699535, -72.16311191461111, -142.33337830748036, -55.40810751706854, -101.92208462421655, -66.71969435122568, -62.39127831421515, -63.948175742412126, -85.34819441982724, -71.78916653402844, -100.68556178427025, -41.414157785187214, -87.8604244737917, -90.04004669217362, -95.73573417005659, -49.213422066521595, -156.11534277859252, -63.64520573884876, -37.605456625782, -164.24679582519354, -132.1584936533239, -110.57201792601424, -95.11131206174845, -101.24094602363041, -79.81481583279074, -81.6466881611093, -99.81708389060131, -97.72647657840496, -82.2526298701633, -106.21077811875206, -69.7549183100345, -62.38459533770097, -78.77306405168974, -50.89724351256122, -85.8976263500877, -50.877891961824574, -119.34379364600464, -61.671416587543796, -57.964365411654306, -60.82962239848478, -103.01263207043819, -150.4233481456105, -86.37115394025597], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6070701690840139, "mean_inference_ms": 5.232783052680194, "mean_action_processing_ms": 0.19487598003498793, "mean_env_wait_ms": 1.3589501644610074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1666000, "num_agent_steps_trained": 1666000, "num_env_steps_sampled": 1666000, "num_env_steps_trained": 1666000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1666000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1666000, "timers": {"training_iteration_time_ms": 75486.769, "load_time_ms": 31.15, "load_throughput": 449440.85, "learn_time_ms": 67618.956, "learn_throughput": 207.043, "synch_weights_time_ms": 12.707}, "counters": {"num_env_steps_sampled": 1666000, "num_env_steps_trained": 1666000, "num_agent_steps_sampled": 1666000, "num_agent_steps_trained": 1666000}, "done": false, "episodes_total": 1666, "training_iteration": 119, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-25-33", "timestamp": 1693059933, "time_this_iter_s": 75.31411480903625, "time_total_s": 9084.597810029984, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701522C580>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270152CFEE0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 9084.597810029984, "timesteps_since_restore": 0, "iterations_since_restore": 119, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.84953271028037, "ram_util_percent": 50.7392523364486}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -262.48546198524537, "episode_L1_reward_sum_min": -534.227633446455, "episode_L1_reward_sum_max": -160.77581455558538, "episode_L2_reward_sum_mean": -142.59247868455947, "episode_L2_reward_sum_min": -210.79784727841616, "episode_L2_reward_sum_max": -116.65848581492901}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.04075332167328416, "policy_loss": 0.02087026684776853, "vf_loss": 0.19883054484910717, "vf_explained_var": 0.6114738507219303, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1680000, "num_env_steps_trained": 1680000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "sampler_results": {"episode_reward_max": -37.605456625782, "episode_reward_min": -184.55890421641868, "episode_reward_mean": -86.96934316742474, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -262.48546198524537, "episode_L1_reward_sum_min": -534.227633446455, "episode_L1_reward_sum_max": -160.77581455558538, "episode_L2_reward_sum_mean": -142.59247868455947, "episode_L2_reward_sum_min": -210.79784727841616, "episode_L2_reward_sum_max": -116.65848581492901}, "hist_stats": {"episode_reward": [-95.83673910047186, -111.91886272798297, -125.34161505287568, -99.87646644760535, -58.32743437256334, -79.43607228754071, -88.14778249878246, -78.98624683725268, -47.293044455016705, -122.92734673717203, -65.41189424410311, -72.61939139554612, -117.60213956387261, -66.41816117889687, -146.60314908794138, -91.07134862131007, -73.53487926709282, -66.56856538802883, -67.25542862800182, -89.76681336480263, -47.09752765555157, -65.4325180018055, -123.02027486485655, -85.9483856557534, -148.40601486721962, -108.41980981774358, -68.08968607602642, -50.52997244822118, -113.40996197731684, -84.84537212396005, -106.30836811890326, -57.72329824729276, -66.63108592967765, -49.05027659691956, -56.66175638870847, -67.39267929504327, -79.84072039656579, -136.72900617621033, -139.47130126519718, -96.76880570560778, -84.78912360323905, -104.71394679206449, -184.55890421641868, -160.40419086699535, -72.16311191461111, -142.33337830748036, -55.40810751706854, -101.92208462421655, -66.71969435122568, -62.39127831421515, -63.948175742412126, -85.34819441982724, -71.78916653402844, -100.68556178427025, -41.414157785187214, -87.8604244737917, -90.04004669217362, -95.73573417005659, -49.213422066521595, -156.11534277859252, -63.64520573884876, -37.605456625782, -164.24679582519354, -132.1584936533239, -110.57201792601424, -95.11131206174845, -101.24094602363041, -79.81481583279074, -81.6466881611093, -99.81708389060131, -97.72647657840496, -82.2526298701633, -106.21077811875206, -69.7549183100345, -62.38459533770097, -78.77306405168974, -50.89724351256122, -85.8976263500877, -50.877891961824574, -119.34379364600464, -61.671416587543796, -57.964365411654306, -60.82962239848478, -103.01263207043819, -150.4233481456105, -86.37115394025597, -60.082772049547096, -64.61298865919518, -58.397318097784726, -57.585408128353606, -43.097197455262204, -51.312026808339795, -81.08880913086132, -80.69827355326306, -65.66112200252448, -141.33568607270237, -41.43507440757715, -98.8370208336772, -64.30822596253309, -103.95777173076331], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6071009171649251, "mean_inference_ms": 5.234286211668669, "mean_action_processing_ms": 0.19493427659907225, "mean_env_wait_ms": 1.3593863954055354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -37.605456625782, "episode_reward_min": -184.55890421641868, "episode_reward_mean": -86.96934316742474, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-95.83673910047186, -111.91886272798297, -125.34161505287568, -99.87646644760535, -58.32743437256334, -79.43607228754071, -88.14778249878246, -78.98624683725268, -47.293044455016705, -122.92734673717203, -65.41189424410311, -72.61939139554612, -117.60213956387261, -66.41816117889687, -146.60314908794138, -91.07134862131007, -73.53487926709282, -66.56856538802883, -67.25542862800182, -89.76681336480263, -47.09752765555157, -65.4325180018055, -123.02027486485655, -85.9483856557534, -148.40601486721962, -108.41980981774358, -68.08968607602642, -50.52997244822118, -113.40996197731684, -84.84537212396005, -106.30836811890326, -57.72329824729276, -66.63108592967765, -49.05027659691956, -56.66175638870847, -67.39267929504327, -79.84072039656579, -136.72900617621033, -139.47130126519718, -96.76880570560778, -84.78912360323905, -104.71394679206449, -184.55890421641868, -160.40419086699535, -72.16311191461111, -142.33337830748036, -55.40810751706854, -101.92208462421655, -66.71969435122568, -62.39127831421515, -63.948175742412126, -85.34819441982724, -71.78916653402844, -100.68556178427025, -41.414157785187214, -87.8604244737917, -90.04004669217362, -95.73573417005659, -49.213422066521595, -156.11534277859252, -63.64520573884876, -37.605456625782, -164.24679582519354, -132.1584936533239, -110.57201792601424, -95.11131206174845, -101.24094602363041, -79.81481583279074, -81.6466881611093, -99.81708389060131, -97.72647657840496, -82.2526298701633, -106.21077811875206, -69.7549183100345, -62.38459533770097, -78.77306405168974, -50.89724351256122, -85.8976263500877, -50.877891961824574, -119.34379364600464, -61.671416587543796, -57.964365411654306, -60.82962239848478, -103.01263207043819, -150.4233481456105, -86.37115394025597, -60.082772049547096, -64.61298865919518, -58.397318097784726, -57.585408128353606, -43.097197455262204, -51.312026808339795, -81.08880913086132, -80.69827355326306, -65.66112200252448, -141.33568607270237, -41.43507440757715, -98.8370208336772, -64.30822596253309, -103.95777173076331], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6071009171649251, "mean_inference_ms": 5.234286211668669, "mean_action_processing_ms": 0.19493427659907225, "mean_env_wait_ms": 1.3593863954055354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000, "num_env_steps_sampled": 1680000, "num_env_steps_trained": 1680000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1680000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1680000, "timers": {"training_iteration_time_ms": 75452.555, "load_time_ms": 31.281, "load_throughput": 447559.174, "learn_time_ms": 67577.69, "learn_throughput": 207.169, "synch_weights_time_ms": 12.396}, "counters": {"num_env_steps_sampled": 1680000, "num_env_steps_trained": 1680000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "done": false, "episodes_total": 1680, "training_iteration": 120, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-26-48", "timestamp": 1693060008, "time_this_iter_s": 75.38008403778076, "time_total_s": 9159.977894067764, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150A2CD0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701534D8B0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 9159.977894067764, "timesteps_since_restore": 0, "iterations_since_restore": 120, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.809345794392524, "ram_util_percent": 50.76074766355141}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -272.22926567263903, "episode_L1_reward_sum_min": -534.227633446455, "episode_L1_reward_sum_max": -160.77581455558538, "episode_L2_reward_sum_mean": -145.0031105682254, "episode_L2_reward_sum_min": -210.79784727841616, "episode_L2_reward_sum_max": -116.65848581492901}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.029989151429737546, "policy_loss": -0.0054931277524174, "vf_loss": 0.35482279549873197, "vf_explained_var": 0.74984191155728, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1694000, "num_env_steps_trained": 1694000, "num_agent_steps_sampled": 1694000, "num_agent_steps_trained": 1694000}, "sampler_results": {"episode_reward_max": -37.605456625782, "episode_reward_min": -184.55890421641868, "episode_reward_mean": -88.63487158852155, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -272.22926567263903, "episode_L1_reward_sum_min": -534.227633446455, "episode_L1_reward_sum_max": -160.77581455558538, "episode_L2_reward_sum_mean": -145.0031105682254, "episode_L2_reward_sum_min": -210.79784727841616, "episode_L2_reward_sum_max": -116.65848581492901}, "hist_stats": {"episode_reward": [-146.60314908794138, -91.07134862131007, -73.53487926709282, -66.56856538802883, -67.25542862800182, -89.76681336480263, -47.09752765555157, -65.4325180018055, -123.02027486485655, -85.9483856557534, -148.40601486721962, -108.41980981774358, -68.08968607602642, -50.52997244822118, -113.40996197731684, -84.84537212396005, -106.30836811890326, -57.72329824729276, -66.63108592967765, -49.05027659691956, -56.66175638870847, -67.39267929504327, -79.84072039656579, -136.72900617621033, -139.47130126519718, -96.76880570560778, -84.78912360323905, -104.71394679206449, -184.55890421641868, -160.40419086699535, -72.16311191461111, -142.33337830748036, -55.40810751706854, -101.92208462421655, -66.71969435122568, -62.39127831421515, -63.948175742412126, -85.34819441982724, -71.78916653402844, -100.68556178427025, -41.414157785187214, -87.8604244737917, -90.04004669217362, -95.73573417005659, -49.213422066521595, -156.11534277859252, -63.64520573884876, -37.605456625782, -164.24679582519354, -132.1584936533239, -110.57201792601424, -95.11131206174845, -101.24094602363041, -79.81481583279074, -81.6466881611093, -99.81708389060131, -97.72647657840496, -82.2526298701633, -106.21077811875206, -69.7549183100345, -62.38459533770097, -78.77306405168974, -50.89724351256122, -85.8976263500877, -50.877891961824574, -119.34379364600464, -61.671416587543796, -57.964365411654306, -60.82962239848478, -103.01263207043819, -150.4233481456105, -86.37115394025597, -60.082772049547096, -64.61298865919518, -58.397318097784726, -57.585408128353606, -43.097197455262204, -51.312026808339795, -81.08880913086132, -80.69827355326306, -65.66112200252448, -141.33568607270237, -41.43507440757715, -98.8370208336772, -64.30822596253309, -103.95777173076331, -97.86694279241769, -113.41405701551548, -162.81185196765364, -80.15471058394171, -136.63750412460115, -58.96716256255399, -45.88924686603258, -108.76799612433933, -64.61616732074978, -142.72803323120084, -98.05823822941193, -114.06167863307729, -107.05651733341537, -65.66593222445107], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6071374366289877, "mean_inference_ms": 5.235872453320134, "mean_action_processing_ms": 0.19499238566048782, "mean_env_wait_ms": 1.3598465569892888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -37.605456625782, "episode_reward_min": -184.55890421641868, "episode_reward_mean": -88.63487158852155, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-146.60314908794138, -91.07134862131007, -73.53487926709282, -66.56856538802883, -67.25542862800182, -89.76681336480263, -47.09752765555157, -65.4325180018055, -123.02027486485655, -85.9483856557534, -148.40601486721962, -108.41980981774358, -68.08968607602642, -50.52997244822118, -113.40996197731684, -84.84537212396005, -106.30836811890326, -57.72329824729276, -66.63108592967765, -49.05027659691956, -56.66175638870847, -67.39267929504327, -79.84072039656579, -136.72900617621033, -139.47130126519718, -96.76880570560778, -84.78912360323905, -104.71394679206449, -184.55890421641868, -160.40419086699535, -72.16311191461111, -142.33337830748036, -55.40810751706854, -101.92208462421655, -66.71969435122568, -62.39127831421515, -63.948175742412126, -85.34819441982724, -71.78916653402844, -100.68556178427025, -41.414157785187214, -87.8604244737917, -90.04004669217362, -95.73573417005659, -49.213422066521595, -156.11534277859252, -63.64520573884876, -37.605456625782, -164.24679582519354, -132.1584936533239, -110.57201792601424, -95.11131206174845, -101.24094602363041, -79.81481583279074, -81.6466881611093, -99.81708389060131, -97.72647657840496, -82.2526298701633, -106.21077811875206, -69.7549183100345, -62.38459533770097, -78.77306405168974, -50.89724351256122, -85.8976263500877, -50.877891961824574, -119.34379364600464, -61.671416587543796, -57.964365411654306, -60.82962239848478, -103.01263207043819, -150.4233481456105, -86.37115394025597, -60.082772049547096, -64.61298865919518, -58.397318097784726, -57.585408128353606, -43.097197455262204, -51.312026808339795, -81.08880913086132, -80.69827355326306, -65.66112200252448, -141.33568607270237, -41.43507440757715, -98.8370208336772, -64.30822596253309, -103.95777173076331, -97.86694279241769, -113.41405701551548, -162.81185196765364, -80.15471058394171, -136.63750412460115, -58.96716256255399, -45.88924686603258, -108.76799612433933, -64.61616732074978, -142.72803323120084, -98.05823822941193, -114.06167863307729, -107.05651733341537, -65.66593222445107], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6071374366289877, "mean_inference_ms": 5.235872453320134, "mean_action_processing_ms": 0.19499238566048782, "mean_env_wait_ms": 1.3598465569892888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1694000, "num_agent_steps_trained": 1694000, "num_env_steps_sampled": 1694000, "num_env_steps_trained": 1694000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1694000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1694000, "timers": {"training_iteration_time_ms": 75481.66, "load_time_ms": 30.884, "load_throughput": 453303.154, "learn_time_ms": 67576.262, "learn_throughput": 207.173, "synch_weights_time_ms": 12.895}, "counters": {"num_env_steps_sampled": 1694000, "num_env_steps_trained": 1694000, "num_agent_steps_sampled": 1694000, "num_agent_steps_trained": 1694000}, "done": false, "episodes_total": 1694, "training_iteration": 121, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-28-04", "timestamp": 1693060084, "time_this_iter_s": 75.7166223526001, "time_total_s": 9235.694516420364, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015435370>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150E8340>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 9235.694516420364, "timesteps_since_restore": 0, "iterations_since_restore": 121, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.858878504672894, "ram_util_percent": 50.74112149532711}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -278.4475058210641, "episode_L1_reward_sum_min": -534.227633446455, "episode_L1_reward_sum_max": -160.77581455558538, "episode_L2_reward_sum_mean": -146.61054128602146, "episode_L2_reward_sum_min": -210.79784727841616, "episode_L2_reward_sum_max": -116.65848581492901}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.030667460872641997, "policy_loss": 0.006624990248877302, "vf_loss": 0.24042469580808185, "vf_explained_var": 0.6600033062598343, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1708000, "num_env_steps_trained": 1708000, "num_agent_steps_sampled": 1708000, "num_agent_steps_trained": 1708000}, "sampler_results": {"episode_reward_max": -37.605456625782, "episode_reward_min": -184.55890421641868, "episode_reward_mean": -88.46307249113585, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -278.4475058210641, "episode_L1_reward_sum_min": -534.227633446455, "episode_L1_reward_sum_max": -160.77581455558538, "episode_L2_reward_sum_mean": -146.61054128602146, "episode_L2_reward_sum_min": -210.79784727841616, "episode_L2_reward_sum_max": -116.65848581492901}, "hist_stats": {"episode_reward": [-113.40996197731684, -84.84537212396005, -106.30836811890326, -57.72329824729276, -66.63108592967765, -49.05027659691956, -56.66175638870847, -67.39267929504327, -79.84072039656579, -136.72900617621033, -139.47130126519718, -96.76880570560778, -84.78912360323905, -104.71394679206449, -184.55890421641868, -160.40419086699535, -72.16311191461111, -142.33337830748036, -55.40810751706854, -101.92208462421655, -66.71969435122568, -62.39127831421515, -63.948175742412126, -85.34819441982724, -71.78916653402844, -100.68556178427025, -41.414157785187214, -87.8604244737917, -90.04004669217362, -95.73573417005659, -49.213422066521595, -156.11534277859252, -63.64520573884876, -37.605456625782, -164.24679582519354, -132.1584936533239, -110.57201792601424, -95.11131206174845, -101.24094602363041, -79.81481583279074, -81.6466881611093, -99.81708389060131, -97.72647657840496, -82.2526298701633, -106.21077811875206, -69.7549183100345, -62.38459533770097, -78.77306405168974, -50.89724351256122, -85.8976263500877, -50.877891961824574, -119.34379364600464, -61.671416587543796, -57.964365411654306, -60.82962239848478, -103.01263207043819, -150.4233481456105, -86.37115394025597, -60.082772049547096, -64.61298865919518, -58.397318097784726, -57.585408128353606, -43.097197455262204, -51.312026808339795, -81.08880913086132, -80.69827355326306, -65.66112200252448, -141.33568607270237, -41.43507440757715, -98.8370208336772, -64.30822596253309, -103.95777173076331, -97.86694279241769, -113.41405701551548, -162.81185196765364, -80.15471058394171, -136.63750412460115, -58.96716256255399, -45.88924686603258, -108.76799612433933, -64.61616732074978, -142.72803323120084, -98.05823822941193, -114.06167863307729, -107.05651733341537, -65.66593222445107, -74.86558347541133, -100.65744351236073, -139.19881324641017, -58.68423600878737, -130.95751684532777, -101.39793589089182, -60.19818675448983, -56.15421641764491, -50.86469720931247, -114.16048186393134, -132.32729194422348, -46.25159125408564, -76.90684880883303, -71.93962077407643], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6072141619588092, "mean_inference_ms": 5.23743722875819, "mean_action_processing_ms": 0.19504973527056538, "mean_env_wait_ms": 1.3602846507239803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -37.605456625782, "episode_reward_min": -184.55890421641868, "episode_reward_mean": -88.46307249113585, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113.40996197731684, -84.84537212396005, -106.30836811890326, -57.72329824729276, -66.63108592967765, -49.05027659691956, -56.66175638870847, -67.39267929504327, -79.84072039656579, -136.72900617621033, -139.47130126519718, -96.76880570560778, -84.78912360323905, -104.71394679206449, -184.55890421641868, -160.40419086699535, -72.16311191461111, -142.33337830748036, -55.40810751706854, -101.92208462421655, -66.71969435122568, -62.39127831421515, -63.948175742412126, -85.34819441982724, -71.78916653402844, -100.68556178427025, -41.414157785187214, -87.8604244737917, -90.04004669217362, -95.73573417005659, -49.213422066521595, -156.11534277859252, -63.64520573884876, -37.605456625782, -164.24679582519354, -132.1584936533239, -110.57201792601424, -95.11131206174845, -101.24094602363041, -79.81481583279074, -81.6466881611093, -99.81708389060131, -97.72647657840496, -82.2526298701633, -106.21077811875206, -69.7549183100345, -62.38459533770097, -78.77306405168974, -50.89724351256122, -85.8976263500877, -50.877891961824574, -119.34379364600464, -61.671416587543796, -57.964365411654306, -60.82962239848478, -103.01263207043819, -150.4233481456105, -86.37115394025597, -60.082772049547096, -64.61298865919518, -58.397318097784726, -57.585408128353606, -43.097197455262204, -51.312026808339795, -81.08880913086132, -80.69827355326306, -65.66112200252448, -141.33568607270237, -41.43507440757715, -98.8370208336772, -64.30822596253309, -103.95777173076331, -97.86694279241769, -113.41405701551548, -162.81185196765364, -80.15471058394171, -136.63750412460115, -58.96716256255399, -45.88924686603258, -108.76799612433933, -64.61616732074978, -142.72803323120084, -98.05823822941193, -114.06167863307729, -107.05651733341537, -65.66593222445107, -74.86558347541133, -100.65744351236073, -139.19881324641017, -58.68423600878737, -130.95751684532777, -101.39793589089182, -60.19818675448983, -56.15421641764491, -50.86469720931247, -114.16048186393134, -132.32729194422348, -46.25159125408564, -76.90684880883303, -71.93962077407643], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6072141619588092, "mean_inference_ms": 5.23743722875819, "mean_action_processing_ms": 0.19504973527056538, "mean_env_wait_ms": 1.3602846507239803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1708000, "num_agent_steps_trained": 1708000, "num_env_steps_sampled": 1708000, "num_env_steps_trained": 1708000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1708000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1708000, "timers": {"training_iteration_time_ms": 75525.926, "load_time_ms": 30.825, "load_throughput": 454178.985, "learn_time_ms": 67603.976, "learn_throughput": 207.088, "synch_weights_time_ms": 12.907}, "counters": {"num_env_steps_sampled": 1708000, "num_env_steps_trained": 1708000, "num_agent_steps_sampled": 1708000, "num_agent_steps_trained": 1708000}, "done": false, "episodes_total": 1708, "training_iteration": 122, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-29-20", "timestamp": 1693060160, "time_this_iter_s": 75.68162083625793, "time_total_s": 9311.376137256622, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701545E9A0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270152CF610>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 9311.376137256622, "timesteps_since_restore": 0, "iterations_since_restore": 122, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.90093457943925, "ram_util_percent": 50.76635514018691}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -278.84704175673426, "episode_L1_reward_sum_min": -534.227633446455, "episode_L1_reward_sum_max": -160.77581455558538, "episode_L2_reward_sum_mean": -146.66897020921112, "episode_L2_reward_sum_min": -210.79784727841616, "episode_L2_reward_sum_max": -116.65848581492901}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.04339750997685979, "policy_loss": 0.02345132890296094, "vf_loss": 0.19946181570291105, "vf_explained_var": 0.6840455493134726, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1722000, "num_env_steps_trained": 1722000, "num_agent_steps_sampled": 1722000, "num_agent_steps_trained": 1722000}, "sampler_results": {"episode_reward_max": -37.605456625782, "episode_reward_min": -184.55890421641868, "episode_reward_mean": -88.30121100164402, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -278.84704175673426, "episode_L1_reward_sum_min": -534.227633446455, "episode_L1_reward_sum_max": -160.77581455558538, "episode_L2_reward_sum_mean": -146.66897020921112, "episode_L2_reward_sum_min": -210.79784727841616, "episode_L2_reward_sum_max": -116.65848581492901}, "hist_stats": {"episode_reward": [-184.55890421641868, -160.40419086699535, -72.16311191461111, -142.33337830748036, -55.40810751706854, -101.92208462421655, -66.71969435122568, -62.39127831421515, -63.948175742412126, -85.34819441982724, -71.78916653402844, -100.68556178427025, -41.414157785187214, -87.8604244737917, -90.04004669217362, -95.73573417005659, -49.213422066521595, -156.11534277859252, -63.64520573884876, -37.605456625782, -164.24679582519354, -132.1584936533239, -110.57201792601424, -95.11131206174845, -101.24094602363041, -79.81481583279074, -81.6466881611093, -99.81708389060131, -97.72647657840496, -82.2526298701633, -106.21077811875206, -69.7549183100345, -62.38459533770097, -78.77306405168974, -50.89724351256122, -85.8976263500877, -50.877891961824574, -119.34379364600464, -61.671416587543796, -57.964365411654306, -60.82962239848478, -103.01263207043819, -150.4233481456105, -86.37115394025597, -60.082772049547096, -64.61298865919518, -58.397318097784726, -57.585408128353606, -43.097197455262204, -51.312026808339795, -81.08880913086132, -80.69827355326306, -65.66112200252448, -141.33568607270237, -41.43507440757715, -98.8370208336772, -64.30822596253309, -103.95777173076331, -97.86694279241769, -113.41405701551548, -162.81185196765364, -80.15471058394171, -136.63750412460115, -58.96716256255399, -45.88924686603258, -108.76799612433933, -64.61616732074978, -142.72803323120084, -98.05823822941193, -114.06167863307729, -107.05651733341537, -65.66593222445107, -74.86558347541133, -100.65744351236073, -139.19881324641017, -58.68423600878737, -130.95751684532777, -101.39793589089182, -60.19818675448983, -56.15421641764491, -50.86469720931247, -114.16048186393134, -132.32729194422348, -46.25159125408564, -76.90684880883303, -71.93962077407643, -136.9949797119245, -123.32381107945524, -102.31403786162194, -100.17736329578649, -50.96889160824811, -57.6599127953252, -69.40564135275805, -87.84057963390197, -67.1763200746996, -117.6454692496906, -58.10181744539388, -68.58324236912847, -121.81410587941723, -66.14338131017085], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6072654555565906, "mean_inference_ms": 5.239040449106303, "mean_action_processing_ms": 0.19510511765739585, "mean_env_wait_ms": 1.3607346994222689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -37.605456625782, "episode_reward_min": -184.55890421641868, "episode_reward_mean": -88.30121100164402, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-184.55890421641868, -160.40419086699535, -72.16311191461111, -142.33337830748036, -55.40810751706854, -101.92208462421655, -66.71969435122568, -62.39127831421515, -63.948175742412126, -85.34819441982724, -71.78916653402844, -100.68556178427025, -41.414157785187214, -87.8604244737917, -90.04004669217362, -95.73573417005659, -49.213422066521595, -156.11534277859252, -63.64520573884876, -37.605456625782, -164.24679582519354, -132.1584936533239, -110.57201792601424, -95.11131206174845, -101.24094602363041, -79.81481583279074, -81.6466881611093, -99.81708389060131, -97.72647657840496, -82.2526298701633, -106.21077811875206, -69.7549183100345, -62.38459533770097, -78.77306405168974, -50.89724351256122, -85.8976263500877, -50.877891961824574, -119.34379364600464, -61.671416587543796, -57.964365411654306, -60.82962239848478, -103.01263207043819, -150.4233481456105, -86.37115394025597, -60.082772049547096, -64.61298865919518, -58.397318097784726, -57.585408128353606, -43.097197455262204, -51.312026808339795, -81.08880913086132, -80.69827355326306, -65.66112200252448, -141.33568607270237, -41.43507440757715, -98.8370208336772, -64.30822596253309, -103.95777173076331, -97.86694279241769, -113.41405701551548, -162.81185196765364, -80.15471058394171, -136.63750412460115, -58.96716256255399, -45.88924686603258, -108.76799612433933, -64.61616732074978, -142.72803323120084, -98.05823822941193, -114.06167863307729, -107.05651733341537, -65.66593222445107, -74.86558347541133, -100.65744351236073, -139.19881324641017, -58.68423600878737, -130.95751684532777, -101.39793589089182, -60.19818675448983, -56.15421641764491, -50.86469720931247, -114.16048186393134, -132.32729194422348, -46.25159125408564, -76.90684880883303, -71.93962077407643, -136.9949797119245, -123.32381107945524, -102.31403786162194, -100.17736329578649, -50.96889160824811, -57.6599127953252, -69.40564135275805, -87.84057963390197, -67.1763200746996, -117.6454692496906, -58.10181744539388, -68.58324236912847, -121.81410587941723, -66.14338131017085], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6072654555565906, "mean_inference_ms": 5.239040449106303, "mean_action_processing_ms": 0.19510511765739585, "mean_env_wait_ms": 1.3607346994222689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1722000, "num_agent_steps_trained": 1722000, "num_env_steps_sampled": 1722000, "num_env_steps_trained": 1722000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1722000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1722000, "timers": {"training_iteration_time_ms": 75559.314, "load_time_ms": 30.027, "load_throughput": 466244.698, "learn_time_ms": 67633.939, "learn_throughput": 206.997, "synch_weights_time_ms": 13.206}, "counters": {"num_env_steps_sampled": 1722000, "num_env_steps_trained": 1722000, "num_agent_steps_sampled": 1722000, "num_agent_steps_trained": 1722000}, "done": false, "episodes_total": 1722, "training_iteration": 123, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-30-36", "timestamp": 1693060236, "time_this_iter_s": 75.69764065742493, "time_total_s": 9387.073777914047, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014F64C10>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701534DCD0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 9387.073777914047, "timesteps_since_restore": 0, "iterations_since_restore": 123, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.913084112149534, "ram_util_percent": 50.764485981308404}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -276.92287837974726, "episode_L1_reward_sum_min": -526.3859815895557, "episode_L1_reward_sum_max": -160.77581455558538, "episode_L2_reward_sum_mean": -146.14780744187533, "episode_L2_reward_sum_min": -207.8457384929061, "episode_L2_reward_sum_max": -116.65848581492901}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.014663422790187347, "policy_loss": -0.010825249435928164, "vf_loss": 0.25488670868906715, "vf_explained_var": 0.717284956126792, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1736000, "num_env_steps_trained": 1736000, "num_agent_steps_sampled": 1736000, "num_agent_steps_trained": 1736000}, "sampler_results": {"episode_reward_max": -37.605456625782, "episode_reward_min": -164.24679582519354, "episode_reward_mean": -87.86839100272208, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -276.92287837974726, "episode_L1_reward_sum_min": -526.3859815895557, "episode_L1_reward_sum_max": -160.77581455558538, "episode_L2_reward_sum_mean": -146.14780744187533, "episode_L2_reward_sum_min": -207.8457384929061, "episode_L2_reward_sum_max": -116.65848581492901}, "hist_stats": {"episode_reward": [-90.04004669217362, -95.73573417005659, -49.213422066521595, -156.11534277859252, -63.64520573884876, -37.605456625782, -164.24679582519354, -132.1584936533239, -110.57201792601424, -95.11131206174845, -101.24094602363041, -79.81481583279074, -81.6466881611093, -99.81708389060131, -97.72647657840496, -82.2526298701633, -106.21077811875206, -69.7549183100345, -62.38459533770097, -78.77306405168974, -50.89724351256122, -85.8976263500877, -50.877891961824574, -119.34379364600464, -61.671416587543796, -57.964365411654306, -60.82962239848478, -103.01263207043819, -150.4233481456105, -86.37115394025597, -60.082772049547096, -64.61298865919518, -58.397318097784726, -57.585408128353606, -43.097197455262204, -51.312026808339795, -81.08880913086132, -80.69827355326306, -65.66112200252448, -141.33568607270237, -41.43507440757715, -98.8370208336772, -64.30822596253309, -103.95777173076331, -97.86694279241769, -113.41405701551548, -162.81185196765364, -80.15471058394171, -136.63750412460115, -58.96716256255399, -45.88924686603258, -108.76799612433933, -64.61616732074978, -142.72803323120084, -98.05823822941193, -114.06167863307729, -107.05651733341537, -65.66593222445107, -74.86558347541133, -100.65744351236073, -139.19881324641017, -58.68423600878737, -130.95751684532777, -101.39793589089182, -60.19818675448983, -56.15421641764491, -50.86469720931247, -114.16048186393134, -132.32729194422348, -46.25159125408564, -76.90684880883303, -71.93962077407643, -136.9949797119245, -123.32381107945524, -102.31403786162194, -100.17736329578649, -50.96889160824811, -57.6599127953252, -69.40564135275805, -87.84057963390197, -67.1763200746996, -117.6454692496906, -58.10181744539388, -68.58324236912847, -121.81410587941723, -66.14338131017085, -96.71695640747099, -112.04110644490035, -96.17389032835125, -90.87953893278751, -66.53454119282799, -40.49912958558102, -98.40434904549457, -141.32586807231687, -55.193628967539716, -66.63124971434843, -77.25352593627554, -95.521036605101, -54.18351643065337, -162.3060932959052], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6073160475460773, "mean_inference_ms": 5.240637945451039, "mean_action_processing_ms": 0.19516357500256792, "mean_env_wait_ms": 1.3611704120842478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -37.605456625782, "episode_reward_min": -164.24679582519354, "episode_reward_mean": -87.86839100272208, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-90.04004669217362, -95.73573417005659, -49.213422066521595, -156.11534277859252, -63.64520573884876, -37.605456625782, -164.24679582519354, -132.1584936533239, -110.57201792601424, -95.11131206174845, -101.24094602363041, -79.81481583279074, -81.6466881611093, -99.81708389060131, -97.72647657840496, -82.2526298701633, -106.21077811875206, -69.7549183100345, -62.38459533770097, -78.77306405168974, -50.89724351256122, -85.8976263500877, -50.877891961824574, -119.34379364600464, -61.671416587543796, -57.964365411654306, -60.82962239848478, -103.01263207043819, -150.4233481456105, -86.37115394025597, -60.082772049547096, -64.61298865919518, -58.397318097784726, -57.585408128353606, -43.097197455262204, -51.312026808339795, -81.08880913086132, -80.69827355326306, -65.66112200252448, -141.33568607270237, -41.43507440757715, -98.8370208336772, -64.30822596253309, -103.95777173076331, -97.86694279241769, -113.41405701551548, -162.81185196765364, -80.15471058394171, -136.63750412460115, -58.96716256255399, -45.88924686603258, -108.76799612433933, -64.61616732074978, -142.72803323120084, -98.05823822941193, -114.06167863307729, -107.05651733341537, -65.66593222445107, -74.86558347541133, -100.65744351236073, -139.19881324641017, -58.68423600878737, -130.95751684532777, -101.39793589089182, -60.19818675448983, -56.15421641764491, -50.86469720931247, -114.16048186393134, -132.32729194422348, -46.25159125408564, -76.90684880883303, -71.93962077407643, -136.9949797119245, -123.32381107945524, -102.31403786162194, -100.17736329578649, -50.96889160824811, -57.6599127953252, -69.40564135275805, -87.84057963390197, -67.1763200746996, -117.6454692496906, -58.10181744539388, -68.58324236912847, -121.81410587941723, -66.14338131017085, -96.71695640747099, -112.04110644490035, -96.17389032835125, -90.87953893278751, -66.53454119282799, -40.49912958558102, -98.40434904549457, -141.32586807231687, -55.193628967539716, -66.63124971434843, -77.25352593627554, -95.521036605101, -54.18351643065337, -162.3060932959052], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6073160475460773, "mean_inference_ms": 5.240637945451039, "mean_action_processing_ms": 0.19516357500256792, "mean_env_wait_ms": 1.3611704120842478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1736000, "num_agent_steps_trained": 1736000, "num_env_steps_sampled": 1736000, "num_env_steps_trained": 1736000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1736000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1736000, "timers": {"training_iteration_time_ms": 75556.411, "load_time_ms": 30.423, "load_throughput": 460174.587, "learn_time_ms": 67631.154, "learn_throughput": 207.005, "synch_weights_time_ms": 13.13}, "counters": {"num_env_steps_sampled": 1736000, "num_env_steps_trained": 1736000, "num_agent_steps_sampled": 1736000, "num_agent_steps_trained": 1736000}, "done": false, "episodes_total": 1736, "training_iteration": 124, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-31-51", "timestamp": 1693060311, "time_this_iter_s": 75.42996501922607, "time_total_s": 9462.503742933273, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015350C10>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015422220>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 9462.503742933273, "timesteps_since_restore": 0, "iterations_since_restore": 124, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.88130841121495, "ram_util_percent": 50.768224299065416}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -270.64382695399223, "episode_L1_reward_sum_min": -513.0295210331678, "episode_L1_reward_sum_max": -160.77581455558538, "episode_L2_reward_sum_mean": -144.6040888185054, "episode_L2_reward_sum_min": -204.41162967681885, "episode_L2_reward_sum_max": -116.65848581492901}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.05243898474768479, "policy_loss": 0.028371280853525416, "vf_loss": 0.2406770373949572, "vf_explained_var": 0.737589937056043, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1750000, "num_env_steps_trained": 1750000, "num_agent_steps_sampled": 1750000, "num_agent_steps_trained": 1750000}, "sampler_results": {"episode_reward_max": -40.49912958558102, "episode_reward_min": -162.81185196765364, "episode_reward_mean": -86.29782322721074, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -270.64382695399223, "episode_L1_reward_sum_min": -513.0295210331678, "episode_L1_reward_sum_max": -160.77581455558538, "episode_L2_reward_sum_mean": -144.6040888185054, "episode_L2_reward_sum_min": -204.41162967681885, "episode_L2_reward_sum_max": -116.65848581492901}, "hist_stats": {"episode_reward": [-97.72647657840496, -82.2526298701633, -106.21077811875206, -69.7549183100345, -62.38459533770097, -78.77306405168974, -50.89724351256122, -85.8976263500877, -50.877891961824574, -119.34379364600464, -61.671416587543796, -57.964365411654306, -60.82962239848478, -103.01263207043819, -150.4233481456105, -86.37115394025597, -60.082772049547096, -64.61298865919518, -58.397318097784726, -57.585408128353606, -43.097197455262204, -51.312026808339795, -81.08880913086132, -80.69827355326306, -65.66112200252448, -141.33568607270237, -41.43507440757715, -98.8370208336772, -64.30822596253309, -103.95777173076331, -97.86694279241769, -113.41405701551548, -162.81185196765364, -80.15471058394171, -136.63750412460115, -58.96716256255399, -45.88924686603258, -108.76799612433933, -64.61616732074978, -142.72803323120084, -98.05823822941193, -114.06167863307729, -107.05651733341537, -65.66593222445107, -74.86558347541133, -100.65744351236073, -139.19881324641017, -58.68423600878737, -130.95751684532777, -101.39793589089182, -60.19818675448983, -56.15421641764491, -50.86469720931247, -114.16048186393134, -132.32729194422348, -46.25159125408564, -76.90684880883303, -71.93962077407643, -136.9949797119245, -123.32381107945524, -102.31403786162194, -100.17736329578649, -50.96889160824811, -57.6599127953252, -69.40564135275805, -87.84057963390197, -67.1763200746996, -117.6454692496906, -58.10181744539388, -68.58324236912847, -121.81410587941723, -66.14338131017085, -96.71695640747099, -112.04110644490035, -96.17389032835125, -90.87953893278751, -66.53454119282799, -40.49912958558102, -98.40434904549457, -141.32586807231687, -55.193628967539716, -66.63124971434843, -77.25352593627554, -95.521036605101, -54.18351643065337, -162.3060932959052, -52.548165725812, -44.12349344921858, -90.874714110901, -109.5095312319975, -77.51981253425052, -62.13586135036931, -71.15287540533684, -87.29655932388219, -99.55341129055203, -97.74949806670948, -128.2165073983646, -136.1447951418151, -79.39453245699448, -63.68682640904942], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6073805113580818, "mean_inference_ms": 5.242264816982661, "mean_action_processing_ms": 0.19522651470369987, "mean_env_wait_ms": 1.3616016385533138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -40.49912958558102, "episode_reward_min": -162.81185196765364, "episode_reward_mean": -86.29782322721074, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-97.72647657840496, -82.2526298701633, -106.21077811875206, -69.7549183100345, -62.38459533770097, -78.77306405168974, -50.89724351256122, -85.8976263500877, -50.877891961824574, -119.34379364600464, -61.671416587543796, -57.964365411654306, -60.82962239848478, -103.01263207043819, -150.4233481456105, -86.37115394025597, -60.082772049547096, -64.61298865919518, -58.397318097784726, -57.585408128353606, -43.097197455262204, -51.312026808339795, -81.08880913086132, -80.69827355326306, -65.66112200252448, -141.33568607270237, -41.43507440757715, -98.8370208336772, -64.30822596253309, -103.95777173076331, -97.86694279241769, -113.41405701551548, -162.81185196765364, -80.15471058394171, -136.63750412460115, -58.96716256255399, -45.88924686603258, -108.76799612433933, -64.61616732074978, -142.72803323120084, -98.05823822941193, -114.06167863307729, -107.05651733341537, -65.66593222445107, -74.86558347541133, -100.65744351236073, -139.19881324641017, -58.68423600878737, -130.95751684532777, -101.39793589089182, -60.19818675448983, -56.15421641764491, -50.86469720931247, -114.16048186393134, -132.32729194422348, -46.25159125408564, -76.90684880883303, -71.93962077407643, -136.9949797119245, -123.32381107945524, -102.31403786162194, -100.17736329578649, -50.96889160824811, -57.6599127953252, -69.40564135275805, -87.84057963390197, -67.1763200746996, -117.6454692496906, -58.10181744539388, -68.58324236912847, -121.81410587941723, -66.14338131017085, -96.71695640747099, -112.04110644490035, -96.17389032835125, -90.87953893278751, -66.53454119282799, -40.49912958558102, -98.40434904549457, -141.32586807231687, -55.193628967539716, -66.63124971434843, -77.25352593627554, -95.521036605101, -54.18351643065337, -162.3060932959052, -52.548165725812, -44.12349344921858, -90.874714110901, -109.5095312319975, -77.51981253425052, -62.13586135036931, -71.15287540533684, -87.29655932388219, -99.55341129055203, -97.74949806670948, -128.2165073983646, -136.1447951418151, -79.39453245699448, -63.68682640904942], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6073805113580818, "mean_inference_ms": 5.242264816982661, "mean_action_processing_ms": 0.19522651470369987, "mean_env_wait_ms": 1.3616016385533138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1750000, "num_agent_steps_trained": 1750000, "num_env_steps_sampled": 1750000, "num_env_steps_trained": 1750000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1750000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1750000, "timers": {"training_iteration_time_ms": 75563.249, "load_time_ms": 29.935, "load_throughput": 467679.937, "learn_time_ms": 67631.902, "learn_throughput": 207.003, "synch_weights_time_ms": 13.332}, "counters": {"num_env_steps_sampled": 1750000, "num_env_steps_trained": 1750000, "num_agent_steps_sampled": 1750000, "num_agent_steps_trained": 1750000}, "done": false, "episodes_total": 1750, "training_iteration": 125, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-33-07", "timestamp": 1693060387, "time_this_iter_s": 75.51893067359924, "time_total_s": 9538.022673606873, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701535EE80>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701534DFD0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 9538.022673606873, "timesteps_since_restore": 0, "iterations_since_restore": 125, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.94392523364486, "ram_util_percent": 51.012149532710275}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -272.8020372007042, "episode_L1_reward_sum_min": -513.0295210331678, "episode_L1_reward_sum_max": -162.44079718738794, "episode_L2_reward_sum_mean": -145.10318913802504, "episode_L2_reward_sum_min": -204.41162967681885, "episode_L2_reward_sum_max": -117.09639371186495}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.04776387549256484, "policy_loss": 0.02751175142882618, "vf_loss": 0.2025212374115009, "vf_explained_var": 0.5815071244973214, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1764000, "num_env_steps_trained": 1764000, "num_agent_steps_sampled": 1764000, "num_agent_steps_trained": 1764000}, "sampler_results": {"episode_reward_max": -40.49912958558102, "episode_reward_min": -162.81185196765364, "episode_reward_mean": -85.90750319953851, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -272.8020372007042, "episode_L1_reward_sum_min": -513.0295210331678, "episode_L1_reward_sum_max": -162.44079718738794, "episode_L2_reward_sum_mean": -145.10318913802504, "episode_L2_reward_sum_min": -204.41162967681885, "episode_L2_reward_sum_max": -117.09639371186495}, "hist_stats": {"episode_reward": [-150.4233481456105, -86.37115394025597, -60.082772049547096, -64.61298865919518, -58.397318097784726, -57.585408128353606, -43.097197455262204, -51.312026808339795, -81.08880913086132, -80.69827355326306, -65.66112200252448, -141.33568607270237, -41.43507440757715, -98.8370208336772, -64.30822596253309, -103.95777173076331, -97.86694279241769, -113.41405701551548, -162.81185196765364, -80.15471058394171, -136.63750412460115, -58.96716256255399, -45.88924686603258, -108.76799612433933, -64.61616732074978, -142.72803323120084, -98.05823822941193, -114.06167863307729, -107.05651733341537, -65.66593222445107, -74.86558347541133, -100.65744351236073, -139.19881324641017, -58.68423600878737, -130.95751684532777, -101.39793589089182, -60.19818675448983, -56.15421641764491, -50.86469720931247, -114.16048186393134, -132.32729194422348, -46.25159125408564, -76.90684880883303, -71.93962077407643, -136.9949797119245, -123.32381107945524, -102.31403786162194, -100.17736329578649, -50.96889160824811, -57.6599127953252, -69.40564135275805, -87.84057963390197, -67.1763200746996, -117.6454692496906, -58.10181744539388, -68.58324236912847, -121.81410587941723, -66.14338131017085, -96.71695640747099, -112.04110644490035, -96.17389032835125, -90.87953893278751, -66.53454119282799, -40.49912958558102, -98.40434904549457, -141.32586807231687, -55.193628967539716, -66.63124971434843, -77.25352593627554, -95.521036605101, -54.18351643065337, -162.3060932959052, -52.548165725812, -44.12349344921858, -90.874714110901, -109.5095312319975, -77.51981253425052, -62.13586135036931, -71.15287540533684, -87.29655932388219, -99.55341129055203, -97.74949806670948, -128.2165073983646, -136.1447951418151, -79.39453245699448, -63.68682640904942, -55.8421924247205, -71.73670071640848, -140.73667628309852, -59.02479045530576, -74.47668895437985, -83.83717527516619, -85.26287368510562, -73.11051732668868, -118.9956394844888, -57.513933679909584, -49.26005797907387, -54.24746714592313, -68.70162290902556, -55.81871511882605], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.607433645998239, "mean_inference_ms": 5.2439825784899075, "mean_action_processing_ms": 0.195291716045631, "mean_env_wait_ms": 1.3620656166211795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -40.49912958558102, "episode_reward_min": -162.81185196765364, "episode_reward_mean": -85.90750319953851, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-150.4233481456105, -86.37115394025597, -60.082772049547096, -64.61298865919518, -58.397318097784726, -57.585408128353606, -43.097197455262204, -51.312026808339795, -81.08880913086132, -80.69827355326306, -65.66112200252448, -141.33568607270237, -41.43507440757715, -98.8370208336772, -64.30822596253309, -103.95777173076331, -97.86694279241769, -113.41405701551548, -162.81185196765364, -80.15471058394171, -136.63750412460115, -58.96716256255399, -45.88924686603258, -108.76799612433933, -64.61616732074978, -142.72803323120084, -98.05823822941193, -114.06167863307729, -107.05651733341537, -65.66593222445107, -74.86558347541133, -100.65744351236073, -139.19881324641017, -58.68423600878737, -130.95751684532777, -101.39793589089182, -60.19818675448983, -56.15421641764491, -50.86469720931247, -114.16048186393134, -132.32729194422348, -46.25159125408564, -76.90684880883303, -71.93962077407643, -136.9949797119245, -123.32381107945524, -102.31403786162194, -100.17736329578649, -50.96889160824811, -57.6599127953252, -69.40564135275805, -87.84057963390197, -67.1763200746996, -117.6454692496906, -58.10181744539388, -68.58324236912847, -121.81410587941723, -66.14338131017085, -96.71695640747099, -112.04110644490035, -96.17389032835125, -90.87953893278751, -66.53454119282799, -40.49912958558102, -98.40434904549457, -141.32586807231687, -55.193628967539716, -66.63124971434843, -77.25352593627554, -95.521036605101, -54.18351643065337, -162.3060932959052, -52.548165725812, -44.12349344921858, -90.874714110901, -109.5095312319975, -77.51981253425052, -62.13586135036931, -71.15287540533684, -87.29655932388219, -99.55341129055203, -97.74949806670948, -128.2165073983646, -136.1447951418151, -79.39453245699448, -63.68682640904942, -55.8421924247205, -71.73670071640848, -140.73667628309852, -59.02479045530576, -74.47668895437985, -83.83717527516619, -85.26287368510562, -73.11051732668868, -118.9956394844888, -57.513933679909584, -49.26005797907387, -54.24746714592313, -68.70162290902556, -55.81871511882605], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.607433645998239, "mean_inference_ms": 5.2439825784899075, "mean_action_processing_ms": 0.195291716045631, "mean_env_wait_ms": 1.3620656166211795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1764000, "num_agent_steps_trained": 1764000, "num_env_steps_sampled": 1764000, "num_env_steps_trained": 1764000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1764000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1764000, "timers": {"training_iteration_time_ms": 75608.098, "load_time_ms": 29.322, "load_throughput": 477454.412, "learn_time_ms": 67671.633, "learn_throughput": 206.881, "synch_weights_time_ms": 13.534}, "counters": {"num_env_steps_sampled": 1764000, "num_env_steps_trained": 1764000, "num_agent_steps_sampled": 1764000, "num_agent_steps_trained": 1764000}, "done": false, "episodes_total": 1764, "training_iteration": 126, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-34-23", "timestamp": 1693060463, "time_this_iter_s": 76.04759788513184, "time_total_s": 9614.070271492004, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150EF940>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270153119D0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 9614.070271492004, "timesteps_since_restore": 0, "iterations_since_restore": 126, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 22.131481481481487, "ram_util_percent": 51.385185185185165}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -274.48438865959645, "episode_L1_reward_sum_min": -548.2689509093761, "episode_L1_reward_sum_max": -162.44079718738794, "episode_L2_reward_sum_mean": -145.56382742680609, "episode_L2_reward_sum_min": -213.42243077605963, "episode_L2_reward_sum_max": -117.09639371186495}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.05428289834921605, "policy_loss": 0.03232843203014031, "vf_loss": 0.21954466218638902, "vf_explained_var": 0.5398382567206528, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1778000, "num_env_steps_trained": 1778000, "num_agent_steps_sampled": 1778000, "num_agent_steps_trained": 1778000}, "sampler_results": {"episode_reward_max": -40.49912958558102, "episode_reward_min": -163.4337987615628, "episode_reward_mean": -86.61393009554358, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -274.48438865959645, "episode_L1_reward_sum_min": -548.2689509093761, "episode_L1_reward_sum_max": -162.44079718738794, "episode_L2_reward_sum_mean": -145.56382742680609, "episode_L2_reward_sum_min": -213.42243077605963, "episode_L2_reward_sum_max": -117.09639371186495}, "hist_stats": {"episode_reward": [-64.30822596253309, -103.95777173076331, -97.86694279241769, -113.41405701551548, -162.81185196765364, -80.15471058394171, -136.63750412460115, -58.96716256255399, -45.88924686603258, -108.76799612433933, -64.61616732074978, -142.72803323120084, -98.05823822941193, -114.06167863307729, -107.05651733341537, -65.66593222445107, -74.86558347541133, -100.65744351236073, -139.19881324641017, -58.68423600878737, -130.95751684532777, -101.39793589089182, -60.19818675448983, -56.15421641764491, -50.86469720931247, -114.16048186393134, -132.32729194422348, -46.25159125408564, -76.90684880883303, -71.93962077407643, -136.9949797119245, -123.32381107945524, -102.31403786162194, -100.17736329578649, -50.96889160824811, -57.6599127953252, -69.40564135275805, -87.84057963390197, -67.1763200746996, -117.6454692496906, -58.10181744539388, -68.58324236912847, -121.81410587941723, -66.14338131017085, -96.71695640747099, -112.04110644490035, -96.17389032835125, -90.87953893278751, -66.53454119282799, -40.49912958558102, -98.40434904549457, -141.32586807231687, -55.193628967539716, -66.63124971434843, -77.25352593627554, -95.521036605101, -54.18351643065337, -162.3060932959052, -52.548165725812, -44.12349344921858, -90.874714110901, -109.5095312319975, -77.51981253425052, -62.13586135036931, -71.15287540533684, -87.29655932388219, -99.55341129055203, -97.74949806670948, -128.2165073983646, -136.1447951418151, -79.39453245699448, -63.68682640904942, -55.8421924247205, -71.73670071640848, -140.73667628309852, -59.02479045530576, -74.47668895437985, -83.83717527516619, -85.26287368510562, -73.11051732668868, -118.9956394844888, -57.513933679909584, -49.26005797907387, -54.24746714592313, -68.70162290902556, -55.81871511882605, -108.33613988207257, -70.0608898291893, -86.847818217474, -163.4337987615628, -64.13255239994638, -72.61860290179317, -53.79815917782933, -49.27802622595511, -49.97205668879865, -103.15554053244665, -110.47015833323545, -58.65690300702069, -76.49890815216067, -84.32133477598036], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6074848532364684, "mean_inference_ms": 5.24572266478188, "mean_action_processing_ms": 0.19535780041917244, "mean_env_wait_ms": 1.362534563583989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -40.49912958558102, "episode_reward_min": -163.4337987615628, "episode_reward_mean": -86.61393009554358, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.30822596253309, -103.95777173076331, -97.86694279241769, -113.41405701551548, -162.81185196765364, -80.15471058394171, -136.63750412460115, -58.96716256255399, -45.88924686603258, -108.76799612433933, -64.61616732074978, -142.72803323120084, -98.05823822941193, -114.06167863307729, -107.05651733341537, -65.66593222445107, -74.86558347541133, -100.65744351236073, -139.19881324641017, -58.68423600878737, -130.95751684532777, -101.39793589089182, -60.19818675448983, -56.15421641764491, -50.86469720931247, -114.16048186393134, -132.32729194422348, -46.25159125408564, -76.90684880883303, -71.93962077407643, -136.9949797119245, -123.32381107945524, -102.31403786162194, -100.17736329578649, -50.96889160824811, -57.6599127953252, -69.40564135275805, -87.84057963390197, -67.1763200746996, -117.6454692496906, -58.10181744539388, -68.58324236912847, -121.81410587941723, -66.14338131017085, -96.71695640747099, -112.04110644490035, -96.17389032835125, -90.87953893278751, -66.53454119282799, -40.49912958558102, -98.40434904549457, -141.32586807231687, -55.193628967539716, -66.63124971434843, -77.25352593627554, -95.521036605101, -54.18351643065337, -162.3060932959052, -52.548165725812, -44.12349344921858, -90.874714110901, -109.5095312319975, -77.51981253425052, -62.13586135036931, -71.15287540533684, -87.29655932388219, -99.55341129055203, -97.74949806670948, -128.2165073983646, -136.1447951418151, -79.39453245699448, -63.68682640904942, -55.8421924247205, -71.73670071640848, -140.73667628309852, -59.02479045530576, -74.47668895437985, -83.83717527516619, -85.26287368510562, -73.11051732668868, -118.9956394844888, -57.513933679909584, -49.26005797907387, -54.24746714592313, -68.70162290902556, -55.81871511882605, -108.33613988207257, -70.0608898291893, -86.847818217474, -163.4337987615628, -64.13255239994638, -72.61860290179317, -53.79815917782933, -49.27802622595511, -49.97205668879865, -103.15554053244665, -110.47015833323545, -58.65690300702069, -76.49890815216067, -84.32133477598036], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6074848532364684, "mean_inference_ms": 5.24572266478188, "mean_action_processing_ms": 0.19535780041917244, "mean_env_wait_ms": 1.362534563583989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1778000, "num_agent_steps_trained": 1778000, "num_env_steps_sampled": 1778000, "num_env_steps_trained": 1778000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1778000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1778000, "timers": {"training_iteration_time_ms": 75633.595, "load_time_ms": 29.419, "load_throughput": 475877.647, "learn_time_ms": 67689.556, "learn_throughput": 206.827, "synch_weights_time_ms": 14.022}, "counters": {"num_env_steps_sampled": 1778000, "num_env_steps_trained": 1778000, "num_agent_steps_sampled": 1778000, "num_agent_steps_trained": 1778000}, "done": false, "episodes_total": 1778, "training_iteration": 127, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-35-39", "timestamp": 1693060539, "time_this_iter_s": 75.66380977630615, "time_total_s": 9689.73408126831, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701534D490>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150EF400>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 9689.73408126831, "timesteps_since_restore": 0, "iterations_since_restore": 127, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.80747663551402, "ram_util_percent": 51.34766355140186}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -264.9681841752678, "episode_L1_reward_sum_min": -548.2689509093761, "episode_L1_reward_sum_max": -156.073422588408, "episode_L2_reward_sum_mean": -143.19389004468917, "episode_L2_reward_sum_min": -213.42243077605963, "episode_L2_reward_sum_max": -115.03417106717825}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.05201904396401956, "policy_loss": 0.03200247651205586, "vf_loss": 0.20016567148578462, "vf_explained_var": 0.6630645905441217, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1792000, "num_env_steps_trained": 1792000, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 1792000}, "sampler_results": {"episode_reward_max": -40.28888397462597, "episode_reward_min": -163.4337987615628, "episode_reward_mean": -83.26390161773142, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -264.9681841752678, "episode_L1_reward_sum_min": -548.2689509093761, "episode_L1_reward_sum_max": -156.073422588408, "episode_L2_reward_sum_mean": -143.19389004468917, "episode_L2_reward_sum_min": -213.42243077605963, "episode_L2_reward_sum_max": -115.03417106717825}, "hist_stats": {"episode_reward": [-107.05651733341537, -65.66593222445107, -74.86558347541133, -100.65744351236073, -139.19881324641017, -58.68423600878737, -130.95751684532777, -101.39793589089182, -60.19818675448983, -56.15421641764491, -50.86469720931247, -114.16048186393134, -132.32729194422348, -46.25159125408564, -76.90684880883303, -71.93962077407643, -136.9949797119245, -123.32381107945524, -102.31403786162194, -100.17736329578649, -50.96889160824811, -57.6599127953252, -69.40564135275805, -87.84057963390197, -67.1763200746996, -117.6454692496906, -58.10181744539388, -68.58324236912847, -121.81410587941723, -66.14338131017085, -96.71695640747099, -112.04110644490035, -96.17389032835125, -90.87953893278751, -66.53454119282799, -40.49912958558102, -98.40434904549457, -141.32586807231687, -55.193628967539716, -66.63124971434843, -77.25352593627554, -95.521036605101, -54.18351643065337, -162.3060932959052, -52.548165725812, -44.12349344921858, -90.874714110901, -109.5095312319975, -77.51981253425052, -62.13586135036931, -71.15287540533684, -87.29655932388219, -99.55341129055203, -97.74949806670948, -128.2165073983646, -136.1447951418151, -79.39453245699448, -63.68682640904942, -55.8421924247205, -71.73670071640848, -140.73667628309852, -59.02479045530576, -74.47668895437985, -83.83717527516619, -85.26287368510562, -73.11051732668868, -118.9956394844888, -57.513933679909584, -49.26005797907387, -54.24746714592313, -68.70162290902556, -55.81871511882605, -108.33613988207257, -70.0608898291893, -86.847818217474, -163.4337987615628, -64.13255239994638, -72.61860290179317, -53.79815917782933, -49.27802622595511, -49.97205668879865, -103.15554053244665, -110.47015833323545, -58.65690300702069, -76.49890815216067, -84.32133477598036, -71.5868226299639, -49.92652780872658, -67.555746049188, -65.35961829018669, -40.28888397462597, -161.85837541365, -46.381971687827495, -86.55436944006412, -83.93179674923695, -106.79344954891359, -51.82693864102484, -104.21670358106486, -73.24696645660634, -47.708569092496134], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6075351411867531, "mean_inference_ms": 5.247415083085201, "mean_action_processing_ms": 0.19542584699234883, "mean_env_wait_ms": 1.3629961565271629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -40.28888397462597, "episode_reward_min": -163.4337987615628, "episode_reward_mean": -83.26390161773142, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-107.05651733341537, -65.66593222445107, -74.86558347541133, -100.65744351236073, -139.19881324641017, -58.68423600878737, -130.95751684532777, -101.39793589089182, -60.19818675448983, -56.15421641764491, -50.86469720931247, -114.16048186393134, -132.32729194422348, -46.25159125408564, -76.90684880883303, -71.93962077407643, -136.9949797119245, -123.32381107945524, -102.31403786162194, -100.17736329578649, -50.96889160824811, -57.6599127953252, -69.40564135275805, -87.84057963390197, -67.1763200746996, -117.6454692496906, -58.10181744539388, -68.58324236912847, -121.81410587941723, -66.14338131017085, -96.71695640747099, -112.04110644490035, -96.17389032835125, -90.87953893278751, -66.53454119282799, -40.49912958558102, -98.40434904549457, -141.32586807231687, -55.193628967539716, -66.63124971434843, -77.25352593627554, -95.521036605101, -54.18351643065337, -162.3060932959052, -52.548165725812, -44.12349344921858, -90.874714110901, -109.5095312319975, -77.51981253425052, -62.13586135036931, -71.15287540533684, -87.29655932388219, -99.55341129055203, -97.74949806670948, -128.2165073983646, -136.1447951418151, -79.39453245699448, -63.68682640904942, -55.8421924247205, -71.73670071640848, -140.73667628309852, -59.02479045530576, -74.47668895437985, -83.83717527516619, -85.26287368510562, -73.11051732668868, -118.9956394844888, -57.513933679909584, -49.26005797907387, -54.24746714592313, -68.70162290902556, -55.81871511882605, -108.33613988207257, -70.0608898291893, -86.847818217474, -163.4337987615628, -64.13255239994638, -72.61860290179317, -53.79815917782933, -49.27802622595511, -49.97205668879865, -103.15554053244665, -110.47015833323545, -58.65690300702069, -76.49890815216067, -84.32133477598036, -71.5868226299639, -49.92652780872658, -67.555746049188, -65.35961829018669, -40.28888397462597, -161.85837541365, -46.381971687827495, -86.55436944006412, -83.93179674923695, -106.79344954891359, -51.82693864102484, -104.21670358106486, -73.24696645660634, -47.708569092496134], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6075351411867531, "mean_inference_ms": 5.247415083085201, "mean_action_processing_ms": 0.19542584699234883, "mean_env_wait_ms": 1.3629961565271629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 1792000, "num_env_steps_sampled": 1792000, "num_env_steps_trained": 1792000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1792000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1792000, "timers": {"training_iteration_time_ms": 75601.531, "load_time_ms": 29.721, "load_throughput": 471049.709, "learn_time_ms": 67650.235, "learn_throughput": 206.947, "synch_weights_time_ms": 14.016}, "counters": {"num_env_steps_sampled": 1792000, "num_env_steps_trained": 1792000, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 1792000}, "done": false, "episodes_total": 1792, "training_iteration": 128, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-36-54", "timestamp": 1693060614, "time_this_iter_s": 75.60601997375488, "time_total_s": 9765.340101242065, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701534D820>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270151C05E0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 9765.340101242065, "timesteps_since_restore": 0, "iterations_since_restore": 128, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.789719626168228, "ram_util_percent": 51.35514018691588}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -259.0534783463925, "episode_L1_reward_sum_min": -593.7152251005173, "episode_L1_reward_sum_max": -156.073422588408, "episode_L2_reward_sum_mean": -141.68943393714727, "episode_L2_reward_sum_min": -222.17583675682545, "episode_L2_reward_sum_max": -115.03417106717825}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.0447654837797302, "policy_loss": 0.02531474070247922, "vf_loss": 0.1945074267640129, "vf_explained_var": 0.607752917878667, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1806000, "num_env_steps_trained": 1806000, "num_agent_steps_sampled": 1806000, "num_agent_steps_trained": 1806000}, "sampler_results": {"episode_reward_max": -34.48488007079348, "episode_reward_min": -185.69742541305098, "episode_reward_mean": -82.73556025485685, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -259.0534783463925, "episode_L1_reward_sum_min": -593.7152251005173, "episode_L1_reward_sum_max": -156.073422588408, "episode_L2_reward_sum_mean": -141.68943393714727, "episode_L2_reward_sum_min": -222.17583675682545, "episode_L2_reward_sum_max": -115.03417106717825}, "hist_stats": {"episode_reward": [-76.90684880883303, -71.93962077407643, -136.9949797119245, -123.32381107945524, -102.31403786162194, -100.17736329578649, -50.96889160824811, -57.6599127953252, -69.40564135275805, -87.84057963390197, -67.1763200746996, -117.6454692496906, -58.10181744539388, -68.58324236912847, -121.81410587941723, -66.14338131017085, -96.71695640747099, -112.04110644490035, -96.17389032835125, -90.87953893278751, -66.53454119282799, -40.49912958558102, -98.40434904549457, -141.32586807231687, -55.193628967539716, -66.63124971434843, -77.25352593627554, -95.521036605101, -54.18351643065337, -162.3060932959052, -52.548165725812, -44.12349344921858, -90.874714110901, -109.5095312319975, -77.51981253425052, -62.13586135036931, -71.15287540533684, -87.29655932388219, -99.55341129055203, -97.74949806670948, -128.2165073983646, -136.1447951418151, -79.39453245699448, -63.68682640904942, -55.8421924247205, -71.73670071640848, -140.73667628309852, -59.02479045530576, -74.47668895437985, -83.83717527516619, -85.26287368510562, -73.11051732668868, -118.9956394844888, -57.513933679909584, -49.26005797907387, -54.24746714592313, -68.70162290902556, -55.81871511882605, -108.33613988207257, -70.0608898291893, -86.847818217474, -163.4337987615628, -64.13255239994638, -72.61860290179317, -53.79815917782933, -49.27802622595511, -49.97205668879865, -103.15554053244665, -110.47015833323545, -58.65690300702069, -76.49890815216067, -84.32133477598036, -71.5868226299639, -49.92652780872658, -67.555746049188, -65.35961829018669, -40.28888397462597, -161.85837541365, -46.381971687827495, -86.55436944006412, -83.93179674923695, -106.79344954891359, -51.82693864102484, -104.21670358106486, -73.24696645660634, -47.708569092496134, -104.81315541146648, -64.9420032489086, -34.48488007079348, -45.01047770284981, -88.7276235553688, -77.78085986062577, -81.95888519331297, -87.33172687200963, -68.0168917541805, -124.93407827938431, -77.9836630921832, -84.86705166348649, -59.05758557566361, -185.69742541305098], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6075458745905629, "mean_inference_ms": 5.249199985685367, "mean_action_processing_ms": 0.19549764001469064, "mean_env_wait_ms": 1.3634981350790827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -34.48488007079348, "episode_reward_min": -185.69742541305098, "episode_reward_mean": -82.73556025485685, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-76.90684880883303, -71.93962077407643, -136.9949797119245, -123.32381107945524, -102.31403786162194, -100.17736329578649, -50.96889160824811, -57.6599127953252, -69.40564135275805, -87.84057963390197, -67.1763200746996, -117.6454692496906, -58.10181744539388, -68.58324236912847, -121.81410587941723, -66.14338131017085, -96.71695640747099, -112.04110644490035, -96.17389032835125, -90.87953893278751, -66.53454119282799, -40.49912958558102, -98.40434904549457, -141.32586807231687, -55.193628967539716, -66.63124971434843, -77.25352593627554, -95.521036605101, -54.18351643065337, -162.3060932959052, -52.548165725812, -44.12349344921858, -90.874714110901, -109.5095312319975, -77.51981253425052, -62.13586135036931, -71.15287540533684, -87.29655932388219, -99.55341129055203, -97.74949806670948, -128.2165073983646, -136.1447951418151, -79.39453245699448, -63.68682640904942, -55.8421924247205, -71.73670071640848, -140.73667628309852, -59.02479045530576, -74.47668895437985, -83.83717527516619, -85.26287368510562, -73.11051732668868, -118.9956394844888, -57.513933679909584, -49.26005797907387, -54.24746714592313, -68.70162290902556, -55.81871511882605, -108.33613988207257, -70.0608898291893, -86.847818217474, -163.4337987615628, -64.13255239994638, -72.61860290179317, -53.79815917782933, -49.27802622595511, -49.97205668879865, -103.15554053244665, -110.47015833323545, -58.65690300702069, -76.49890815216067, -84.32133477598036, -71.5868226299639, -49.92652780872658, -67.555746049188, -65.35961829018669, -40.28888397462597, -161.85837541365, -46.381971687827495, -86.55436944006412, -83.93179674923695, -106.79344954891359, -51.82693864102484, -104.21670358106486, -73.24696645660634, -47.708569092496134, -104.81315541146648, -64.9420032489086, -34.48488007079348, -45.01047770284981, -88.7276235553688, -77.78085986062577, -81.95888519331297, -87.33172687200963, -68.0168917541805, -124.93407827938431, -77.9836630921832, -84.86705166348649, -59.05758557566361, -185.69742541305098], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6075458745905629, "mean_inference_ms": 5.249199985685367, "mean_action_processing_ms": 0.19549764001469064, "mean_env_wait_ms": 1.3634981350790827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1806000, "num_agent_steps_trained": 1806000, "num_env_steps_sampled": 1806000, "num_env_steps_trained": 1806000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1806000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1806000, "timers": {"training_iteration_time_ms": 75648.114, "load_time_ms": 29.91, "load_throughput": 468063.539, "learn_time_ms": 67658.989, "learn_throughput": 206.92, "synch_weights_time_ms": 13.994}, "counters": {"num_env_steps_sampled": 1806000, "num_env_steps_trained": 1806000, "num_agent_steps_sampled": 1806000, "num_agent_steps_trained": 1806000}, "done": false, "episodes_total": 1806, "training_iteration": 129, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-38-10", "timestamp": 1693060690, "time_this_iter_s": 75.77987957000732, "time_total_s": 9841.119980812073, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014F64C10>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701542AA30>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 9841.119980812073, "timesteps_since_restore": 0, "iterations_since_restore": 129, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.91308411214953, "ram_util_percent": 51.35607476635513}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -259.69532026298344, "episode_L1_reward_sum_min": -593.7152251005173, "episode_L1_reward_sum_max": -156.073422588408, "episode_L2_reward_sum_mean": -141.9150187408179, "episode_L2_reward_sum_min": -222.17583675682545, "episode_L2_reward_sum_max": -115.03417106717825}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.04242844089943295, "policy_loss": 0.016672687561667062, "vf_loss": 0.257557541774831, "vf_explained_var": 0.6552334273916213, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1820000, "num_env_steps_trained": 1820000, "num_agent_steps_sampled": 1820000, "num_agent_steps_trained": 1820000}, "sampler_results": {"episode_reward_max": -34.48488007079348, "episode_reward_min": -185.69742541305098, "episode_reward_mean": -82.4275411650444, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -259.69532026298344, "episode_L1_reward_sum_min": -593.7152251005173, "episode_L1_reward_sum_max": -156.073422588408, "episode_L2_reward_sum_mean": -141.9150187408179, "episode_L2_reward_sum_min": -222.17583675682545, "episode_L2_reward_sum_max": -115.03417106717825}, "hist_stats": {"episode_reward": [-121.81410587941723, -66.14338131017085, -96.71695640747099, -112.04110644490035, -96.17389032835125, -90.87953893278751, -66.53454119282799, -40.49912958558102, -98.40434904549457, -141.32586807231687, -55.193628967539716, -66.63124971434843, -77.25352593627554, -95.521036605101, -54.18351643065337, -162.3060932959052, -52.548165725812, -44.12349344921858, -90.874714110901, -109.5095312319975, -77.51981253425052, -62.13586135036931, -71.15287540533684, -87.29655932388219, -99.55341129055203, -97.74949806670948, -128.2165073983646, -136.1447951418151, -79.39453245699448, -63.68682640904942, -55.8421924247205, -71.73670071640848, -140.73667628309852, -59.02479045530576, -74.47668895437985, -83.83717527516619, -85.26287368510562, -73.11051732668868, -118.9956394844888, -57.513933679909584, -49.26005797907387, -54.24746714592313, -68.70162290902556, -55.81871511882605, -108.33613988207257, -70.0608898291893, -86.847818217474, -163.4337987615628, -64.13255239994638, -72.61860290179317, -53.79815917782933, -49.27802622595511, -49.97205668879865, -103.15554053244665, -110.47015833323545, -58.65690300702069, -76.49890815216067, -84.32133477598036, -71.5868226299639, -49.92652780872658, -67.555746049188, -65.35961829018669, -40.28888397462597, -161.85837541365, -46.381971687827495, -86.55436944006412, -83.93179674923695, -106.79344954891359, -51.82693864102484, -104.21670358106486, -73.24696645660634, -47.708569092496134, -104.81315541146648, -64.9420032489086, -34.48488007079348, -45.01047770284981, -88.7276235553688, -77.78085986062577, -81.95888519331297, -87.33172687200963, -68.0168917541805, -124.93407827938431, -77.9836630921832, -84.86705166348649, -59.05758557566361, -185.69742541305098, -53.069485006591634, -98.68218695080583, -97.00478763686334, -66.37039782758464, -83.86016717506934, -103.02881064705953, -65.8678893307795, -47.24824541853938, -59.74078034099182, -62.6744009477907, -57.943911596962735, -71.86199480000778, -172.67998198777897, -118.20358741277504], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6075994503355947, "mean_inference_ms": 5.251185257716357, "mean_action_processing_ms": 0.1955842476183174, "mean_env_wait_ms": 1.3640493248856083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -34.48488007079348, "episode_reward_min": -185.69742541305098, "episode_reward_mean": -82.4275411650444, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-121.81410587941723, -66.14338131017085, -96.71695640747099, -112.04110644490035, -96.17389032835125, -90.87953893278751, -66.53454119282799, -40.49912958558102, -98.40434904549457, -141.32586807231687, -55.193628967539716, -66.63124971434843, -77.25352593627554, -95.521036605101, -54.18351643065337, -162.3060932959052, -52.548165725812, -44.12349344921858, -90.874714110901, -109.5095312319975, -77.51981253425052, -62.13586135036931, -71.15287540533684, -87.29655932388219, -99.55341129055203, -97.74949806670948, -128.2165073983646, -136.1447951418151, -79.39453245699448, -63.68682640904942, -55.8421924247205, -71.73670071640848, -140.73667628309852, -59.02479045530576, -74.47668895437985, -83.83717527516619, -85.26287368510562, -73.11051732668868, -118.9956394844888, -57.513933679909584, -49.26005797907387, -54.24746714592313, -68.70162290902556, -55.81871511882605, -108.33613988207257, -70.0608898291893, -86.847818217474, -163.4337987615628, -64.13255239994638, -72.61860290179317, -53.79815917782933, -49.27802622595511, -49.97205668879865, -103.15554053244665, -110.47015833323545, -58.65690300702069, -76.49890815216067, -84.32133477598036, -71.5868226299639, -49.92652780872658, -67.555746049188, -65.35961829018669, -40.28888397462597, -161.85837541365, -46.381971687827495, -86.55436944006412, -83.93179674923695, -106.79344954891359, -51.82693864102484, -104.21670358106486, -73.24696645660634, -47.708569092496134, -104.81315541146648, -64.9420032489086, -34.48488007079348, -45.01047770284981, -88.7276235553688, -77.78085986062577, -81.95888519331297, -87.33172687200963, -68.0168917541805, -124.93407827938431, -77.9836630921832, -84.86705166348649, -59.05758557566361, -185.69742541305098, -53.069485006591634, -98.68218695080583, -97.00478763686334, -66.37039782758464, -83.86016717506934, -103.02881064705953, -65.8678893307795, -47.24824541853938, -59.74078034099182, -62.6744009477907, -57.943911596962735, -71.86199480000778, -172.67998198777897, -118.20358741277504], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6075994503355947, "mean_inference_ms": 5.251185257716357, "mean_action_processing_ms": 0.1955842476183174, "mean_env_wait_ms": 1.3640493248856083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1820000, "num_agent_steps_trained": 1820000, "num_env_steps_sampled": 1820000, "num_env_steps_trained": 1820000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1820000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1820000, "timers": {"training_iteration_time_ms": 75708.393, "load_time_ms": 29.515, "load_throughput": 474334.634, "learn_time_ms": 67678.537, "learn_throughput": 206.86, "synch_weights_time_ms": 13.601}, "counters": {"num_env_steps_sampled": 1820000, "num_env_steps_trained": 1820000, "num_agent_steps_sampled": 1820000, "num_agent_steps_trained": 1820000}, "done": false, "episodes_total": 1820, "training_iteration": 130, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-39-26", "timestamp": 1693060766, "time_this_iter_s": 75.98279738426208, "time_total_s": 9917.102778196335, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270151E6970>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701545E280>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 9917.102778196335, "timesteps_since_restore": 0, "iterations_since_restore": 130, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 22.70092592592593, "ram_util_percent": 51.61296296296296}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -260.2035811970383, "episode_L1_reward_sum_min": -593.7152251005173, "episode_L1_reward_sum_max": -156.073422588408, "episode_L2_reward_sum_mean": -142.065010144189, "episode_L2_reward_sum_min": -222.17583675682545, "episode_L2_reward_sum_max": -115.03417106717825}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.03824342361319841, "policy_loss": 0.014920886366919388, "vf_loss": 0.23322537433028973, "vf_explained_var": 0.6727334335446358, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1834000, "num_env_steps_trained": 1834000, "num_agent_steps_sampled": 1834000, "num_agent_steps_trained": 1834000}, "sampler_results": {"episode_reward_max": -34.48488007079348, "episode_reward_min": -202.07480905249636, "episode_reward_mean": -82.25267597491003, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -260.2035811970383, "episode_L1_reward_sum_min": -593.7152251005173, "episode_L1_reward_sum_max": -156.073422588408, "episode_L2_reward_sum_mean": -142.065010144189, "episode_L2_reward_sum_min": -222.17583675682545, "episode_L2_reward_sum_max": -115.03417106717825}, "hist_stats": {"episode_reward": [-54.18351643065337, -162.3060932959052, -52.548165725812, -44.12349344921858, -90.874714110901, -109.5095312319975, -77.51981253425052, -62.13586135036931, -71.15287540533684, -87.29655932388219, -99.55341129055203, -97.74949806670948, -128.2165073983646, -136.1447951418151, -79.39453245699448, -63.68682640904942, -55.8421924247205, -71.73670071640848, -140.73667628309852, -59.02479045530576, -74.47668895437985, -83.83717527516619, -85.26287368510562, -73.11051732668868, -118.9956394844888, -57.513933679909584, -49.26005797907387, -54.24746714592313, -68.70162290902556, -55.81871511882605, -108.33613988207257, -70.0608898291893, -86.847818217474, -163.4337987615628, -64.13255239994638, -72.61860290179317, -53.79815917782933, -49.27802622595511, -49.97205668879865, -103.15554053244665, -110.47015833323545, -58.65690300702069, -76.49890815216067, -84.32133477598036, -71.5868226299639, -49.92652780872658, -67.555746049188, -65.35961829018669, -40.28888397462597, -161.85837541365, -46.381971687827495, -86.55436944006412, -83.93179674923695, -106.79344954891359, -51.82693864102484, -104.21670358106486, -73.24696645660634, -47.708569092496134, -104.81315541146648, -64.9420032489086, -34.48488007079348, -45.01047770284981, -88.7276235553688, -77.78085986062577, -81.95888519331297, -87.33172687200963, -68.0168917541805, -124.93407827938431, -77.9836630921832, -84.86705166348649, -59.05758557566361, -185.69742541305098, -53.069485006591634, -98.68218695080583, -97.00478763686334, -66.37039782758464, -83.86016717506934, -103.02881064705953, -65.8678893307795, -47.24824541853938, -59.74078034099182, -62.6744009477907, -57.943911596962735, -71.86199480000778, -172.67998198777897, -118.20358741277504, -78.17617869900465, -70.55712386957596, -202.07480905249636, -76.67770154237058, -45.68754612699523, -74.84980252588056, -55.159515254341756, -109.40165423959482, -111.61467850012576, -62.151994498022205, -107.63165540201975, -60.946282454449005, -80.01482755158051, -72.70201969268861], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6076726432643386, "mean_inference_ms": 5.253280159015999, "mean_action_processing_ms": 0.1956664306408716, "mean_env_wait_ms": 1.364641237255271, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -34.48488007079348, "episode_reward_min": -202.07480905249636, "episode_reward_mean": -82.25267597491003, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.18351643065337, -162.3060932959052, -52.548165725812, -44.12349344921858, -90.874714110901, -109.5095312319975, -77.51981253425052, -62.13586135036931, -71.15287540533684, -87.29655932388219, -99.55341129055203, -97.74949806670948, -128.2165073983646, -136.1447951418151, -79.39453245699448, -63.68682640904942, -55.8421924247205, -71.73670071640848, -140.73667628309852, -59.02479045530576, -74.47668895437985, -83.83717527516619, -85.26287368510562, -73.11051732668868, -118.9956394844888, -57.513933679909584, -49.26005797907387, -54.24746714592313, -68.70162290902556, -55.81871511882605, -108.33613988207257, -70.0608898291893, -86.847818217474, -163.4337987615628, -64.13255239994638, -72.61860290179317, -53.79815917782933, -49.27802622595511, -49.97205668879865, -103.15554053244665, -110.47015833323545, -58.65690300702069, -76.49890815216067, -84.32133477598036, -71.5868226299639, -49.92652780872658, -67.555746049188, -65.35961829018669, -40.28888397462597, -161.85837541365, -46.381971687827495, -86.55436944006412, -83.93179674923695, -106.79344954891359, -51.82693864102484, -104.21670358106486, -73.24696645660634, -47.708569092496134, -104.81315541146648, -64.9420032489086, -34.48488007079348, -45.01047770284981, -88.7276235553688, -77.78085986062577, -81.95888519331297, -87.33172687200963, -68.0168917541805, -124.93407827938431, -77.9836630921832, -84.86705166348649, -59.05758557566361, -185.69742541305098, -53.069485006591634, -98.68218695080583, -97.00478763686334, -66.37039782758464, -83.86016717506934, -103.02881064705953, -65.8678893307795, -47.24824541853938, -59.74078034099182, -62.6744009477907, -57.943911596962735, -71.86199480000778, -172.67998198777897, -118.20358741277504, -78.17617869900465, -70.55712386957596, -202.07480905249636, -76.67770154237058, -45.68754612699523, -74.84980252588056, -55.159515254341756, -109.40165423959482, -111.61467850012576, -62.151994498022205, -107.63165540201975, -60.946282454449005, -80.01482755158051, -72.70201969268861], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6076726432643386, "mean_inference_ms": 5.253280159015999, "mean_action_processing_ms": 0.1956664306408716, "mean_env_wait_ms": 1.364641237255271, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1834000, "num_agent_steps_trained": 1834000, "num_env_steps_sampled": 1834000, "num_env_steps_trained": 1834000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1834000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1834000, "timers": {"training_iteration_time_ms": 75700.072, "load_time_ms": 29.515, "load_throughput": 474332.718, "learn_time_ms": 67676.565, "learn_throughput": 206.866, "synch_weights_time_ms": 13.302}, "counters": {"num_env_steps_sampled": 1834000, "num_env_steps_trained": 1834000, "num_agent_steps_sampled": 1834000, "num_agent_steps_trained": 1834000}, "done": false, "episodes_total": 1834, "training_iteration": 131, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-40-42", "timestamp": 1693060842, "time_this_iter_s": 75.63347744941711, "time_total_s": 9992.736255645752, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270153DBD30>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701516FEB0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 9992.736255645752, "timesteps_since_restore": 0, "iterations_since_restore": 131, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.92990654205607, "ram_util_percent": 51.5551401869159}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -261.16869440086185, "episode_L1_reward_sum_min": -593.7152251005173, "episode_L1_reward_sum_max": -156.073422588408, "episode_L2_reward_sum_mean": -142.32464838817717, "episode_L2_reward_sum_min": -222.17583675682545, "episode_L2_reward_sum_max": -115.03417106717825}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.05606545628476174, "policy_loss": 0.02251170081296771, "vf_loss": 0.3355375536245871, "vf_explained_var": 0.6916857194692019, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1848000, "num_env_steps_trained": 1848000, "num_agent_steps_sampled": 1848000, "num_agent_steps_trained": 1848000}, "sampler_results": {"episode_reward_max": -34.48488007079348, "episode_reward_min": -202.07480905249636, "episode_reward_mean": -81.37515921887999, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -261.16869440086185, "episode_L1_reward_sum_min": -593.7152251005173, "episode_L1_reward_sum_max": -156.073422588408, "episode_L2_reward_sum_mean": -142.32464838817717, "episode_L2_reward_sum_min": -222.17583675682545, "episode_L2_reward_sum_max": -115.03417106717825}, "hist_stats": {"episode_reward": [-79.39453245699448, -63.68682640904942, -55.8421924247205, -71.73670071640848, -140.73667628309852, -59.02479045530576, -74.47668895437985, -83.83717527516619, -85.26287368510562, -73.11051732668868, -118.9956394844888, -57.513933679909584, -49.26005797907387, -54.24746714592313, -68.70162290902556, -55.81871511882605, -108.33613988207257, -70.0608898291893, -86.847818217474, -163.4337987615628, -64.13255239994638, -72.61860290179317, -53.79815917782933, -49.27802622595511, -49.97205668879865, -103.15554053244665, -110.47015833323545, -58.65690300702069, -76.49890815216067, -84.32133477598036, -71.5868226299639, -49.92652780872658, -67.555746049188, -65.35961829018669, -40.28888397462597, -161.85837541365, -46.381971687827495, -86.55436944006412, -83.93179674923695, -106.79344954891359, -51.82693864102484, -104.21670358106486, -73.24696645660634, -47.708569092496134, -104.81315541146648, -64.9420032489086, -34.48488007079348, -45.01047770284981, -88.7276235553688, -77.78085986062577, -81.95888519331297, -87.33172687200963, -68.0168917541805, -124.93407827938431, -77.9836630921832, -84.86705166348649, -59.05758557566361, -185.69742541305098, -53.069485006591634, -98.68218695080583, -97.00478763686334, -66.37039782758464, -83.86016717506934, -103.02881064705953, -65.8678893307795, -47.24824541853938, -59.74078034099182, -62.6744009477907, -57.943911596962735, -71.86199480000778, -172.67998198777897, -118.20358741277504, -78.17617869900465, -70.55712386957596, -202.07480905249636, -76.67770154237058, -45.68754612699523, -74.84980252588056, -55.159515254341756, -109.40165423959482, -111.61467850012576, -62.151994498022205, -107.63165540201975, -60.946282454449005, -80.01482755158051, -72.70201969268861, -37.80678076269139, -45.223373512460114, -121.26496218562161, -77.47572524446406, -71.36495542732754, -90.06057866050108, -91.96019750523028, -70.39379934887704, -103.25151023799687, -160.72391768166347, -118.52509640782642, -37.25513128215738, -48.93983087857369, -111.31730001737152], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6077361795413939, "mean_inference_ms": 5.255413760873933, "mean_action_processing_ms": 0.195739706098463, "mean_env_wait_ms": 1.3652500965547056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -34.48488007079348, "episode_reward_min": -202.07480905249636, "episode_reward_mean": -81.37515921887999, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-79.39453245699448, -63.68682640904942, -55.8421924247205, -71.73670071640848, -140.73667628309852, -59.02479045530576, -74.47668895437985, -83.83717527516619, -85.26287368510562, -73.11051732668868, -118.9956394844888, -57.513933679909584, -49.26005797907387, -54.24746714592313, -68.70162290902556, -55.81871511882605, -108.33613988207257, -70.0608898291893, -86.847818217474, -163.4337987615628, -64.13255239994638, -72.61860290179317, -53.79815917782933, -49.27802622595511, -49.97205668879865, -103.15554053244665, -110.47015833323545, -58.65690300702069, -76.49890815216067, -84.32133477598036, -71.5868226299639, -49.92652780872658, -67.555746049188, -65.35961829018669, -40.28888397462597, -161.85837541365, -46.381971687827495, -86.55436944006412, -83.93179674923695, -106.79344954891359, -51.82693864102484, -104.21670358106486, -73.24696645660634, -47.708569092496134, -104.81315541146648, -64.9420032489086, -34.48488007079348, -45.01047770284981, -88.7276235553688, -77.78085986062577, -81.95888519331297, -87.33172687200963, -68.0168917541805, -124.93407827938431, -77.9836630921832, -84.86705166348649, -59.05758557566361, -185.69742541305098, -53.069485006591634, -98.68218695080583, -97.00478763686334, -66.37039782758464, -83.86016717506934, -103.02881064705953, -65.8678893307795, -47.24824541853938, -59.74078034099182, -62.6744009477907, -57.943911596962735, -71.86199480000778, -172.67998198777897, -118.20358741277504, -78.17617869900465, -70.55712386957596, -202.07480905249636, -76.67770154237058, -45.68754612699523, -74.84980252588056, -55.159515254341756, -109.40165423959482, -111.61467850012576, -62.151994498022205, -107.63165540201975, -60.946282454449005, -80.01482755158051, -72.70201969268861, -37.80678076269139, -45.223373512460114, -121.26496218562161, -77.47572524446406, -71.36495542732754, -90.06057866050108, -91.96019750523028, -70.39379934887704, -103.25151023799687, -160.72391768166347, -118.52509640782642, -37.25513128215738, -48.93983087857369, -111.31730001737152], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6077361795413939, "mean_inference_ms": 5.255413760873933, "mean_action_processing_ms": 0.195739706098463, "mean_env_wait_ms": 1.3652500965547056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1848000, "num_agent_steps_trained": 1848000, "num_env_steps_sampled": 1848000, "num_env_steps_trained": 1848000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1848000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1848000, "timers": {"training_iteration_time_ms": 75693.34, "load_time_ms": 29.178, "load_throughput": 479811.998, "learn_time_ms": 67649.155, "learn_throughput": 206.95, "synch_weights_time_ms": 13.202}, "counters": {"num_env_steps_sampled": 1848000, "num_env_steps_trained": 1848000, "num_agent_steps_sampled": 1848000, "num_agent_steps_trained": 1848000}, "done": false, "episodes_total": 1848, "training_iteration": 132, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-41-58", "timestamp": 1693060918, "time_this_iter_s": 75.61430501937866, "time_total_s": 10068.35056066513, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015729700>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701542A520>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 10068.35056066513, "timesteps_since_restore": 0, "iterations_since_restore": 132, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.817757009345794, "ram_util_percent": 51.43177570093457}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -262.691720219329, "episode_L1_reward_sum_min": -593.7152251005173, "episode_L1_reward_sum_max": -156.073422588408, "episode_L2_reward_sum_mean": -142.69713104322554, "episode_L2_reward_sum_min": -222.17583675682545, "episode_L2_reward_sum_max": -115.03417106717825}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.05069988195203751, "policy_loss": 0.024495705909482798, "vf_loss": 0.26204176110317895, "vf_explained_var": 0.7146013478744667, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1862000, "num_env_steps_trained": 1862000, "num_agent_steps_sampled": 1862000, "num_agent_steps_trained": 1862000}, "sampler_results": {"episode_reward_max": -34.48488007079348, "episode_reward_min": -202.07480905249636, "episode_reward_mean": -82.6896078699378, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -262.691720219329, "episode_L1_reward_sum_min": -593.7152251005173, "episode_L1_reward_sum_max": -156.073422588408, "episode_L2_reward_sum_mean": -142.69713104322554, "episode_L2_reward_sum_min": -222.17583675682545, "episode_L2_reward_sum_max": -115.03417106717825}, "hist_stats": {"episode_reward": [-68.70162290902556, -55.81871511882605, -108.33613988207257, -70.0608898291893, -86.847818217474, -163.4337987615628, -64.13255239994638, -72.61860290179317, -53.79815917782933, -49.27802622595511, -49.97205668879865, -103.15554053244665, -110.47015833323545, -58.65690300702069, -76.49890815216067, -84.32133477598036, -71.5868226299639, -49.92652780872658, -67.555746049188, -65.35961829018669, -40.28888397462597, -161.85837541365, -46.381971687827495, -86.55436944006412, -83.93179674923695, -106.79344954891359, -51.82693864102484, -104.21670358106486, -73.24696645660634, -47.708569092496134, -104.81315541146648, -64.9420032489086, -34.48488007079348, -45.01047770284981, -88.7276235553688, -77.78085986062577, -81.95888519331297, -87.33172687200963, -68.0168917541805, -124.93407827938431, -77.9836630921832, -84.86705166348649, -59.05758557566361, -185.69742541305098, -53.069485006591634, -98.68218695080583, -97.00478763686334, -66.37039782758464, -83.86016717506934, -103.02881064705953, -65.8678893307795, -47.24824541853938, -59.74078034099182, -62.6744009477907, -57.943911596962735, -71.86199480000778, -172.67998198777897, -118.20358741277504, -78.17617869900465, -70.55712386957596, -202.07480905249636, -76.67770154237058, -45.68754612699523, -74.84980252588056, -55.159515254341756, -109.40165423959482, -111.61467850012576, -62.151994498022205, -107.63165540201975, -60.946282454449005, -80.01482755158051, -72.70201969268861, -37.80678076269139, -45.223373512460114, -121.26496218562161, -77.47572524446406, -71.36495542732754, -90.06057866050108, -91.96019750523028, -70.39379934887704, -103.25151023799687, -160.72391768166347, -118.52509640782642, -37.25513128215738, -48.93983087857369, -111.31730001737152, -64.85378224705283, -56.55925442138837, -161.14948343244862, -138.40752031162654, -46.497928609989856, -36.72878882320287, -136.55554682730002, -74.67356528856709, -54.47266772448187, -126.41692716069329, -78.29102184779927, -54.75733799690517, -50.36896281589452, -118.83814987474427], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6078244862209801, "mean_inference_ms": 5.257526497472322, "mean_action_processing_ms": 0.19581214260198457, "mean_env_wait_ms": 1.3658446345578088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -34.48488007079348, "episode_reward_min": -202.07480905249636, "episode_reward_mean": -82.6896078699378, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-68.70162290902556, -55.81871511882605, -108.33613988207257, -70.0608898291893, -86.847818217474, -163.4337987615628, -64.13255239994638, -72.61860290179317, -53.79815917782933, -49.27802622595511, -49.97205668879865, -103.15554053244665, -110.47015833323545, -58.65690300702069, -76.49890815216067, -84.32133477598036, -71.5868226299639, -49.92652780872658, -67.555746049188, -65.35961829018669, -40.28888397462597, -161.85837541365, -46.381971687827495, -86.55436944006412, -83.93179674923695, -106.79344954891359, -51.82693864102484, -104.21670358106486, -73.24696645660634, -47.708569092496134, -104.81315541146648, -64.9420032489086, -34.48488007079348, -45.01047770284981, -88.7276235553688, -77.78085986062577, -81.95888519331297, -87.33172687200963, -68.0168917541805, -124.93407827938431, -77.9836630921832, -84.86705166348649, -59.05758557566361, -185.69742541305098, -53.069485006591634, -98.68218695080583, -97.00478763686334, -66.37039782758464, -83.86016717506934, -103.02881064705953, -65.8678893307795, -47.24824541853938, -59.74078034099182, -62.6744009477907, -57.943911596962735, -71.86199480000778, -172.67998198777897, -118.20358741277504, -78.17617869900465, -70.55712386957596, -202.07480905249636, -76.67770154237058, -45.68754612699523, -74.84980252588056, -55.159515254341756, -109.40165423959482, -111.61467850012576, -62.151994498022205, -107.63165540201975, -60.946282454449005, -80.01482755158051, -72.70201969268861, -37.80678076269139, -45.223373512460114, -121.26496218562161, -77.47572524446406, -71.36495542732754, -90.06057866050108, -91.96019750523028, -70.39379934887704, -103.25151023799687, -160.72391768166347, -118.52509640782642, -37.25513128215738, -48.93983087857369, -111.31730001737152, -64.85378224705283, -56.55925442138837, -161.14948343244862, -138.40752031162654, -46.497928609989856, -36.72878882320287, -136.55554682730002, -74.67356528856709, -54.47266772448187, -126.41692716069329, -78.29102184779927, -54.75733799690517, -50.36896281589452, -118.83814987474427], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6078244862209801, "mean_inference_ms": 5.257526497472322, "mean_action_processing_ms": 0.19581214260198457, "mean_env_wait_ms": 1.3658446345578088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1862000, "num_agent_steps_trained": 1862000, "num_env_steps_sampled": 1862000, "num_env_steps_trained": 1862000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1862000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1862000, "timers": {"training_iteration_time_ms": 75692.648, "load_time_ms": 29.275, "load_throughput": 478228.997, "learn_time_ms": 67636.633, "learn_throughput": 206.988, "synch_weights_time_ms": 13.701}, "counters": {"num_env_steps_sampled": 1862000, "num_env_steps_trained": 1862000, "num_agent_steps_sampled": 1862000, "num_agent_steps_trained": 1862000}, "done": false, "episodes_total": 1862, "training_iteration": 133, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-43-14", "timestamp": 1693060994, "time_this_iter_s": 75.69074869155884, "time_total_s": 10144.04130935669, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270152F7700>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014F64E20>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 10144.04130935669, "timesteps_since_restore": 0, "iterations_since_restore": 133, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.771962616822428, "ram_util_percent": 51.08598130841121}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -263.5510842645168, "episode_L1_reward_sum_min": -608.9797656536102, "episode_L1_reward_sum_max": -156.073422588408, "episode_L2_reward_sum_mean": -142.94391832083463, "episode_L2_reward_sum_min": -225.24333268404007, "episode_L2_reward_sum_max": -115.03417106717825}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.055407462671059934, "policy_loss": 0.033106260807224674, "vf_loss": 0.22301201147046795, "vf_explained_var": 0.5938000404601725, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1876000, "num_env_steps_trained": 1876000, "num_agent_steps_sampled": 1876000, "num_agent_steps_trained": 1876000}, "sampler_results": {"episode_reward_max": -34.48488007079348, "episode_reward_min": -203.96278207814166, "episode_reward_mean": -82.6207849074205, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -263.5510842645168, "episode_L1_reward_sum_min": -608.9797656536102, "episode_L1_reward_sum_max": -156.073422588408, "episode_L2_reward_sum_mean": -142.94391832083463, "episode_L2_reward_sum_min": -225.24333268404007, "episode_L2_reward_sum_max": -115.03417106717825}, "hist_stats": {"episode_reward": [-76.49890815216067, -84.32133477598036, -71.5868226299639, -49.92652780872658, -67.555746049188, -65.35961829018669, -40.28888397462597, -161.85837541365, -46.381971687827495, -86.55436944006412, -83.93179674923695, -106.79344954891359, -51.82693864102484, -104.21670358106486, -73.24696645660634, -47.708569092496134, -104.81315541146648, -64.9420032489086, -34.48488007079348, -45.01047770284981, -88.7276235553688, -77.78085986062577, -81.95888519331297, -87.33172687200963, -68.0168917541805, -124.93407827938431, -77.9836630921832, -84.86705166348649, -59.05758557566361, -185.69742541305098, -53.069485006591634, -98.68218695080583, -97.00478763686334, -66.37039782758464, -83.86016717506934, -103.02881064705953, -65.8678893307795, -47.24824541853938, -59.74078034099182, -62.6744009477907, -57.943911596962735, -71.86199480000778, -172.67998198777897, -118.20358741277504, -78.17617869900465, -70.55712386957596, -202.07480905249636, -76.67770154237058, -45.68754612699523, -74.84980252588056, -55.159515254341756, -109.40165423959482, -111.61467850012576, -62.151994498022205, -107.63165540201975, -60.946282454449005, -80.01482755158051, -72.70201969268861, -37.80678076269139, -45.223373512460114, -121.26496218562161, -77.47572524446406, -71.36495542732754, -90.06057866050108, -91.96019750523028, -70.39379934887704, -103.25151023799687, -160.72391768166347, -118.52509640782642, -37.25513128215738, -48.93983087857369, -111.31730001737152, -64.85378224705283, -56.55925442138837, -161.14948343244862, -138.40752031162654, -46.497928609989856, -36.72878882320287, -136.55554682730002, -74.67356528856709, -54.47266772448187, -126.41692716069329, -78.29102184779927, -54.75733799690517, -50.36896281589452, -118.83814987474427, -53.685237399676076, -94.97443164410659, -63.5942949886299, -79.60421823397238, -69.7488720649945, -64.68661473978004, -67.33335428117437, -63.546951803174125, -86.87989140421422, -70.45013284219714, -68.53962314147057, -203.96278207814166, -64.07559829558258, -57.316684816330884], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6079394774538979, "mean_inference_ms": 5.25970528523719, "mean_action_processing_ms": 0.19587803857364924, "mean_env_wait_ms": 1.3664704217349137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -34.48488007079348, "episode_reward_min": -203.96278207814166, "episode_reward_mean": -82.6207849074205, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-76.49890815216067, -84.32133477598036, -71.5868226299639, -49.92652780872658, -67.555746049188, -65.35961829018669, -40.28888397462597, -161.85837541365, -46.381971687827495, -86.55436944006412, -83.93179674923695, -106.79344954891359, -51.82693864102484, -104.21670358106486, -73.24696645660634, -47.708569092496134, -104.81315541146648, -64.9420032489086, -34.48488007079348, -45.01047770284981, -88.7276235553688, -77.78085986062577, -81.95888519331297, -87.33172687200963, -68.0168917541805, -124.93407827938431, -77.9836630921832, -84.86705166348649, -59.05758557566361, -185.69742541305098, -53.069485006591634, -98.68218695080583, -97.00478763686334, -66.37039782758464, -83.86016717506934, -103.02881064705953, -65.8678893307795, -47.24824541853938, -59.74078034099182, -62.6744009477907, -57.943911596962735, -71.86199480000778, -172.67998198777897, -118.20358741277504, -78.17617869900465, -70.55712386957596, -202.07480905249636, -76.67770154237058, -45.68754612699523, -74.84980252588056, -55.159515254341756, -109.40165423959482, -111.61467850012576, -62.151994498022205, -107.63165540201975, -60.946282454449005, -80.01482755158051, -72.70201969268861, -37.80678076269139, -45.223373512460114, -121.26496218562161, -77.47572524446406, -71.36495542732754, -90.06057866050108, -91.96019750523028, -70.39379934887704, -103.25151023799687, -160.72391768166347, -118.52509640782642, -37.25513128215738, -48.93983087857369, -111.31730001737152, -64.85378224705283, -56.55925442138837, -161.14948343244862, -138.40752031162654, -46.497928609989856, -36.72878882320287, -136.55554682730002, -74.67356528856709, -54.47266772448187, -126.41692716069329, -78.29102184779927, -54.75733799690517, -50.36896281589452, -118.83814987474427, -53.685237399676076, -94.97443164410659, -63.5942949886299, -79.60421823397238, -69.7488720649945, -64.68661473978004, -67.33335428117437, -63.546951803174125, -86.87989140421422, -70.45013284219714, -68.53962314147057, -203.96278207814166, -64.07559829558258, -57.316684816330884], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6079394774538979, "mean_inference_ms": 5.25970528523719, "mean_action_processing_ms": 0.19587803857364924, "mean_env_wait_ms": 1.3664704217349137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1876000, "num_agent_steps_trained": 1876000, "num_env_steps_sampled": 1876000, "num_env_steps_trained": 1876000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1876000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1876000, "timers": {"training_iteration_time_ms": 75738.135, "load_time_ms": 29.299, "load_throughput": 477838.279, "learn_time_ms": 67663.725, "learn_throughput": 206.906, "synch_weights_time_ms": 13.385}, "counters": {"num_env_steps_sampled": 1876000, "num_env_steps_trained": 1876000, "num_agent_steps_sampled": 1876000, "num_agent_steps_trained": 1876000}, "done": false, "episodes_total": 1876, "training_iteration": 134, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-44-30", "timestamp": 1693061070, "time_this_iter_s": 75.88684725761414, "time_total_s": 10219.928156614304, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015309070>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014F117F0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 10219.928156614304, "timesteps_since_restore": 0, "iterations_since_restore": 134, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 22.228703703703705, "ram_util_percent": 50.88796296296295}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -267.36423250034454, "episode_L1_reward_sum_min": -608.9797656536102, "episode_L1_reward_sum_max": -158.21348464488983, "episode_L2_reward_sum_mean": -143.87514788098633, "episode_L2_reward_sum_min": -225.24333268404007, "episode_L2_reward_sum_max": -116.14738522469997}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.0632672380376224, "policy_loss": 0.03943587398279167, "vf_loss": 0.23831361784407262, "vf_explained_var": 0.6065308317051503, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1890000, "num_env_steps_trained": 1890000, "num_agent_steps_sampled": 1890000, "num_agent_steps_trained": 1890000}, "sampler_results": {"episode_reward_max": -34.48488007079348, "episode_reward_min": -203.96278207814166, "episode_reward_mean": -84.89373548258283, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -267.36423250034454, "episode_L1_reward_sum_min": -608.9797656536102, "episode_L1_reward_sum_max": -158.21348464488983, "episode_L2_reward_sum_mean": -143.87514788098633, "episode_L2_reward_sum_min": -225.24333268404007, "episode_L2_reward_sum_max": -116.14738522469997}, "hist_stats": {"episode_reward": [-73.24696645660634, -47.708569092496134, -104.81315541146648, -64.9420032489086, -34.48488007079348, -45.01047770284981, -88.7276235553688, -77.78085986062577, -81.95888519331297, -87.33172687200963, -68.0168917541805, -124.93407827938431, -77.9836630921832, -84.86705166348649, -59.05758557566361, -185.69742541305098, -53.069485006591634, -98.68218695080583, -97.00478763686334, -66.37039782758464, -83.86016717506934, -103.02881064705953, -65.8678893307795, -47.24824541853938, -59.74078034099182, -62.6744009477907, -57.943911596962735, -71.86199480000778, -172.67998198777897, -118.20358741277504, -78.17617869900465, -70.55712386957596, -202.07480905249636, -76.67770154237058, -45.68754612699523, -74.84980252588056, -55.159515254341756, -109.40165423959482, -111.61467850012576, -62.151994498022205, -107.63165540201975, -60.946282454449005, -80.01482755158051, -72.70201969268861, -37.80678076269139, -45.223373512460114, -121.26496218562161, -77.47572524446406, -71.36495542732754, -90.06057866050108, -91.96019750523028, -70.39379934887704, -103.25151023799687, -160.72391768166347, -118.52509640782642, -37.25513128215738, -48.93983087857369, -111.31730001737152, -64.85378224705283, -56.55925442138837, -161.14948343244862, -138.40752031162654, -46.497928609989856, -36.72878882320287, -136.55554682730002, -74.67356528856709, -54.47266772448187, -126.41692716069329, -78.29102184779927, -54.75733799690517, -50.36896281589452, -118.83814987474427, -53.685237399676076, -94.97443164410659, -63.5942949886299, -79.60421823397238, -69.7488720649945, -64.68661473978004, -67.33335428117437, -63.546951803174125, -86.87989140421422, -70.45013284219714, -68.53962314147057, -203.96278207814166, -64.07559829558258, -57.316684816330884, -88.05879000750097, -93.34001138347195, -72.69304274975542, -67.95254924218841, -66.24304430999626, -201.7929761770562, -149.7574891079618, -58.682733059960114, -143.56368142544642, -61.78548064862536, -41.649020002613014, -86.34752124257095, -68.18909139888254, -124.34107350281761], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6080351710643424, "mean_inference_ms": 5.26195921153478, "mean_action_processing_ms": 0.19594198091745618, "mean_env_wait_ms": 1.3671216254196705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -34.48488007079348, "episode_reward_min": -203.96278207814166, "episode_reward_mean": -84.89373548258283, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-73.24696645660634, -47.708569092496134, -104.81315541146648, -64.9420032489086, -34.48488007079348, -45.01047770284981, -88.7276235553688, -77.78085986062577, -81.95888519331297, -87.33172687200963, -68.0168917541805, -124.93407827938431, -77.9836630921832, -84.86705166348649, -59.05758557566361, -185.69742541305098, -53.069485006591634, -98.68218695080583, -97.00478763686334, -66.37039782758464, -83.86016717506934, -103.02881064705953, -65.8678893307795, -47.24824541853938, -59.74078034099182, -62.6744009477907, -57.943911596962735, -71.86199480000778, -172.67998198777897, -118.20358741277504, -78.17617869900465, -70.55712386957596, -202.07480905249636, -76.67770154237058, -45.68754612699523, -74.84980252588056, -55.159515254341756, -109.40165423959482, -111.61467850012576, -62.151994498022205, -107.63165540201975, -60.946282454449005, -80.01482755158051, -72.70201969268861, -37.80678076269139, -45.223373512460114, -121.26496218562161, -77.47572524446406, -71.36495542732754, -90.06057866050108, -91.96019750523028, -70.39379934887704, -103.25151023799687, -160.72391768166347, -118.52509640782642, -37.25513128215738, -48.93983087857369, -111.31730001737152, -64.85378224705283, -56.55925442138837, -161.14948343244862, -138.40752031162654, -46.497928609989856, -36.72878882320287, -136.55554682730002, -74.67356528856709, -54.47266772448187, -126.41692716069329, -78.29102184779927, -54.75733799690517, -50.36896281589452, -118.83814987474427, -53.685237399676076, -94.97443164410659, -63.5942949886299, -79.60421823397238, -69.7488720649945, -64.68661473978004, -67.33335428117437, -63.546951803174125, -86.87989140421422, -70.45013284219714, -68.53962314147057, -203.96278207814166, -64.07559829558258, -57.316684816330884, -88.05879000750097, -93.34001138347195, -72.69304274975542, -67.95254924218841, -66.24304430999626, -201.7929761770562, -149.7574891079618, -58.682733059960114, -143.56368142544642, -61.78548064862536, -41.649020002613014, -86.34752124257095, -68.18909139888254, -124.34107350281761], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6080351710643424, "mean_inference_ms": 5.26195921153478, "mean_action_processing_ms": 0.19594198091745618, "mean_env_wait_ms": 1.3671216254196705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1890000, "num_agent_steps_trained": 1890000, "num_env_steps_sampled": 1890000, "num_env_steps_trained": 1890000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1890000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1890000, "timers": {"training_iteration_time_ms": 75770.738, "load_time_ms": 29.285, "load_throughput": 478053.406, "learn_time_ms": 67675.68, "learn_throughput": 206.869, "synch_weights_time_ms": 12.787}, "counters": {"num_env_steps_sampled": 1890000, "num_env_steps_trained": 1890000, "num_agent_steps_sampled": 1890000, "num_agent_steps_trained": 1890000}, "done": false, "episodes_total": 1890, "training_iteration": 135, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-45-45", "timestamp": 1693061145, "time_this_iter_s": 75.84595513343811, "time_total_s": 10295.774111747742, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015078430>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014E81940>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 10295.774111747742, "timesteps_since_restore": 0, "iterations_since_restore": 135, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.794392523364486, "ram_util_percent": 50.91682242990654}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -277.47211929634216, "episode_L1_reward_sum_min": -608.9797656536102, "episode_L1_reward_sum_max": -158.21348464488983, "episode_L2_reward_sum_mean": -146.42382740333676, "episode_L2_reward_sum_min": -225.24333268404007, "episode_L2_reward_sum_max": -116.14738522469997}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.059979211479624726, "policy_loss": 0.03734150728682217, "vf_loss": 0.22637703822484345, "vf_explained_var": 0.7681042455412723, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1904000, "num_env_steps_trained": 1904000, "num_agent_steps_sampled": 1904000, "num_agent_steps_trained": 1904000}, "sampler_results": {"episode_reward_max": -36.72878882320287, "episode_reward_min": -203.96278207814166, "episode_reward_mean": -87.43538723631558, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -277.47211929634216, "episode_L1_reward_sum_min": -608.9797656536102, "episode_L1_reward_sum_max": -158.21348464488983, "episode_L2_reward_sum_mean": -146.42382740333676, "episode_L2_reward_sum_min": -225.24333268404007, "episode_L2_reward_sum_max": -116.14738522469997}, "hist_stats": {"episode_reward": [-59.05758557566361, -185.69742541305098, -53.069485006591634, -98.68218695080583, -97.00478763686334, -66.37039782758464, -83.86016717506934, -103.02881064705953, -65.8678893307795, -47.24824541853938, -59.74078034099182, -62.6744009477907, -57.943911596962735, -71.86199480000778, -172.67998198777897, -118.20358741277504, -78.17617869900465, -70.55712386957596, -202.07480905249636, -76.67770154237058, -45.68754612699523, -74.84980252588056, -55.159515254341756, -109.40165423959482, -111.61467850012576, -62.151994498022205, -107.63165540201975, -60.946282454449005, -80.01482755158051, -72.70201969268861, -37.80678076269139, -45.223373512460114, -121.26496218562161, -77.47572524446406, -71.36495542732754, -90.06057866050108, -91.96019750523028, -70.39379934887704, -103.25151023799687, -160.72391768166347, -118.52509640782642, -37.25513128215738, -48.93983087857369, -111.31730001737152, -64.85378224705283, -56.55925442138837, -161.14948343244862, -138.40752031162654, -46.497928609989856, -36.72878882320287, -136.55554682730002, -74.67356528856709, -54.47266772448187, -126.41692716069329, -78.29102184779927, -54.75733799690517, -50.36896281589452, -118.83814987474427, -53.685237399676076, -94.97443164410659, -63.5942949886299, -79.60421823397238, -69.7488720649945, -64.68661473978004, -67.33335428117437, -63.546951803174125, -86.87989140421422, -70.45013284219714, -68.53962314147057, -203.96278207814166, -64.07559829558258, -57.316684816330884, -88.05879000750097, -93.34001138347195, -72.69304274975542, -67.95254924218841, -66.24304430999626, -201.7929761770562, -149.7574891079618, -58.682733059960114, -143.56368142544642, -61.78548064862536, -41.649020002613014, -86.34752124257095, -68.18909139888254, -124.34107350281761, -72.24159551375654, -136.40422604493992, -84.30267150698744, -129.97295836469792, -125.85345737553855, -77.85139911209347, -95.82097583869012, -87.36594105798223, -83.10276770940774, -153.8039768680924, -49.601991673777825, -64.46914519794014, -63.97323892489761, -91.20766243814391], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6081410248184291, "mean_inference_ms": 5.264234080218288, "mean_action_processing_ms": 0.19600551406160158, "mean_env_wait_ms": 1.3677801583433007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -36.72878882320287, "episode_reward_min": -203.96278207814166, "episode_reward_mean": -87.43538723631558, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-59.05758557566361, -185.69742541305098, -53.069485006591634, -98.68218695080583, -97.00478763686334, -66.37039782758464, -83.86016717506934, -103.02881064705953, -65.8678893307795, -47.24824541853938, -59.74078034099182, -62.6744009477907, -57.943911596962735, -71.86199480000778, -172.67998198777897, -118.20358741277504, -78.17617869900465, -70.55712386957596, -202.07480905249636, -76.67770154237058, -45.68754612699523, -74.84980252588056, -55.159515254341756, -109.40165423959482, -111.61467850012576, -62.151994498022205, -107.63165540201975, -60.946282454449005, -80.01482755158051, -72.70201969268861, -37.80678076269139, -45.223373512460114, -121.26496218562161, -77.47572524446406, -71.36495542732754, -90.06057866050108, -91.96019750523028, -70.39379934887704, -103.25151023799687, -160.72391768166347, -118.52509640782642, -37.25513128215738, -48.93983087857369, -111.31730001737152, -64.85378224705283, -56.55925442138837, -161.14948343244862, -138.40752031162654, -46.497928609989856, -36.72878882320287, -136.55554682730002, -74.67356528856709, -54.47266772448187, -126.41692716069329, -78.29102184779927, -54.75733799690517, -50.36896281589452, -118.83814987474427, -53.685237399676076, -94.97443164410659, -63.5942949886299, -79.60421823397238, -69.7488720649945, -64.68661473978004, -67.33335428117437, -63.546951803174125, -86.87989140421422, -70.45013284219714, -68.53962314147057, -203.96278207814166, -64.07559829558258, -57.316684816330884, -88.05879000750097, -93.34001138347195, -72.69304274975542, -67.95254924218841, -66.24304430999626, -201.7929761770562, -149.7574891079618, -58.682733059960114, -143.56368142544642, -61.78548064862536, -41.649020002613014, -86.34752124257095, -68.18909139888254, -124.34107350281761, -72.24159551375654, -136.40422604493992, -84.30267150698744, -129.97295836469792, -125.85345737553855, -77.85139911209347, -95.82097583869012, -87.36594105798223, -83.10276770940774, -153.8039768680924, -49.601991673777825, -64.46914519794014, -63.97323892489761, -91.20766243814391], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6081410248184291, "mean_inference_ms": 5.264234080218288, "mean_action_processing_ms": 0.19600551406160158, "mean_env_wait_ms": 1.3677801583433007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1904000, "num_agent_steps_trained": 1904000, "num_env_steps_sampled": 1904000, "num_env_steps_trained": 1904000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1904000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1904000, "timers": {"training_iteration_time_ms": 75743.916, "load_time_ms": 29.291, "load_throughput": 477956.128, "learn_time_ms": 67641.119, "learn_throughput": 206.975, "synch_weights_time_ms": 12.288}, "counters": {"num_env_steps_sampled": 1904000, "num_env_steps_trained": 1904000, "num_agent_steps_sampled": 1904000, "num_agent_steps_trained": 1904000}, "done": false, "episodes_total": 1904, "training_iteration": 136, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-47-01", "timestamp": 1693061221, "time_this_iter_s": 75.78036570549011, "time_total_s": 10371.554477453232, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150E86D0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015350BE0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 10371.554477453232, "timesteps_since_restore": 0, "iterations_since_restore": 136, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 21.771962616822428, "ram_util_percent": 50.935514018691585}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -280.05471527181567, "episode_L1_reward_sum_min": -608.9797656536102, "episode_L1_reward_sum_max": -158.21348464488983, "episode_L2_reward_sum_mean": -147.0590396667272, "episode_L2_reward_sum_min": -225.24333268404007, "episode_L2_reward_sum_max": -116.14024414122105}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.08189337038942383, "policy_loss": 0.0586478514604006, "vf_loss": 0.23245518389326156, "vf_explained_var": 0.6003164636132158, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1918000, "num_env_steps_trained": 1918000, "num_agent_steps_sampled": 1918000, "num_agent_steps_trained": 1918000}, "sampler_results": {"episode_reward_max": -36.72878882320287, "episode_reward_min": -206.2412308613192, "episode_reward_mean": -88.44654169072213, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -280.05471527181567, "episode_L1_reward_sum_min": -608.9797656536102, "episode_L1_reward_sum_max": -158.21348464488983, "episode_L2_reward_sum_mean": -147.0590396667272, "episode_L2_reward_sum_min": -225.24333268404007, "episode_L2_reward_sum_max": -116.14024414122105}, "hist_stats": {"episode_reward": [-172.67998198777897, -118.20358741277504, -78.17617869900465, -70.55712386957596, -202.07480905249636, -76.67770154237058, -45.68754612699523, -74.84980252588056, -55.159515254341756, -109.40165423959482, -111.61467850012576, -62.151994498022205, -107.63165540201975, -60.946282454449005, -80.01482755158051, -72.70201969268861, -37.80678076269139, -45.223373512460114, -121.26496218562161, -77.47572524446406, -71.36495542732754, -90.06057866050108, -91.96019750523028, -70.39379934887704, -103.25151023799687, -160.72391768166347, -118.52509640782642, -37.25513128215738, -48.93983087857369, -111.31730001737152, -64.85378224705283, -56.55925442138837, -161.14948343244862, -138.40752031162654, -46.497928609989856, -36.72878882320287, -136.55554682730002, -74.67356528856709, -54.47266772448187, -126.41692716069329, -78.29102184779927, -54.75733799690517, -50.36896281589452, -118.83814987474427, -53.685237399676076, -94.97443164410659, -63.5942949886299, -79.60421823397238, -69.7488720649945, -64.68661473978004, -67.33335428117437, -63.546951803174125, -86.87989140421422, -70.45013284219714, -68.53962314147057, -203.96278207814166, -64.07559829558258, -57.316684816330884, -88.05879000750097, -93.34001138347195, -72.69304274975542, -67.95254924218841, -66.24304430999626, -201.7929761770562, -149.7574891079618, -58.682733059960114, -143.56368142544642, -61.78548064862536, -41.649020002613014, -86.34752124257095, -68.18909139888254, -124.34107350281761, -72.24159551375654, -136.40422604493992, -84.30267150698744, -129.97295836469792, -125.85345737553855, -77.85139911209347, -95.82097583869012, -87.36594105798223, -83.10276770940774, -153.8039768680924, -49.601991673777825, -64.46914519794014, -63.97323892489761, -91.20766243814391, -82.57546279143841, -101.21234650621247, -69.34589592457431, -84.0401185232329, -74.82976791068559, -89.58117550983471, -116.81452174297618, -102.29204041171738, -62.31198560232518, -58.0666161110193, -206.2412308613192, -63.80026559478113, -47.2562845408298, -54.85580207747231], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6082431525659553, "mean_inference_ms": 5.26650777365941, "mean_action_processing_ms": 0.19606745178775384, "mean_env_wait_ms": 1.3684329324669442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -36.72878882320287, "episode_reward_min": -206.2412308613192, "episode_reward_mean": -88.44654169072213, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-172.67998198777897, -118.20358741277504, -78.17617869900465, -70.55712386957596, -202.07480905249636, -76.67770154237058, -45.68754612699523, -74.84980252588056, -55.159515254341756, -109.40165423959482, -111.61467850012576, -62.151994498022205, -107.63165540201975, -60.946282454449005, -80.01482755158051, -72.70201969268861, -37.80678076269139, -45.223373512460114, -121.26496218562161, -77.47572524446406, -71.36495542732754, -90.06057866050108, -91.96019750523028, -70.39379934887704, -103.25151023799687, -160.72391768166347, -118.52509640782642, -37.25513128215738, -48.93983087857369, -111.31730001737152, -64.85378224705283, -56.55925442138837, -161.14948343244862, -138.40752031162654, -46.497928609989856, -36.72878882320287, -136.55554682730002, -74.67356528856709, -54.47266772448187, -126.41692716069329, -78.29102184779927, -54.75733799690517, -50.36896281589452, -118.83814987474427, -53.685237399676076, -94.97443164410659, -63.5942949886299, -79.60421823397238, -69.7488720649945, -64.68661473978004, -67.33335428117437, -63.546951803174125, -86.87989140421422, -70.45013284219714, -68.53962314147057, -203.96278207814166, -64.07559829558258, -57.316684816330884, -88.05879000750097, -93.34001138347195, -72.69304274975542, -67.95254924218841, -66.24304430999626, -201.7929761770562, -149.7574891079618, -58.682733059960114, -143.56368142544642, -61.78548064862536, -41.649020002613014, -86.34752124257095, -68.18909139888254, -124.34107350281761, -72.24159551375654, -136.40422604493992, -84.30267150698744, -129.97295836469792, -125.85345737553855, -77.85139911209347, -95.82097583869012, -87.36594105798223, -83.10276770940774, -153.8039768680924, -49.601991673777825, -64.46914519794014, -63.97323892489761, -91.20766243814391, -82.57546279143841, -101.21234650621247, -69.34589592457431, -84.0401185232329, -74.82976791068559, -89.58117550983471, -116.81452174297618, -102.29204041171738, -62.31198560232518, -58.0666161110193, -206.2412308613192, -63.80026559478113, -47.2562845408298, -54.85580207747231], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6082431525659553, "mean_inference_ms": 5.26650777365941, "mean_action_processing_ms": 0.19606745178775384, "mean_env_wait_ms": 1.3684329324669442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1918000, "num_agent_steps_trained": 1918000, "num_env_steps_sampled": 1918000, "num_env_steps_trained": 1918000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1918000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1918000, "timers": {"training_iteration_time_ms": 75780.702, "load_time_ms": 28.723, "load_throughput": 487407.769, "learn_time_ms": 67646.91, "learn_throughput": 206.957, "synch_weights_time_ms": 11.501}, "counters": {"num_env_steps_sampled": 1918000, "num_env_steps_trained": 1918000, "num_agent_steps_sampled": 1918000, "num_agent_steps_trained": 1918000}, "done": false, "episodes_total": 1918, "training_iteration": 137, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-48-17", "timestamp": 1693061297, "time_this_iter_s": 76.03272223472595, "time_total_s": 10447.587199687958, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150A2640>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701545E8B0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 10447.587199687958, "timesteps_since_restore": 0, "iterations_since_restore": 137, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 22.138888888888886, "ram_util_percent": 50.93888888888888}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -272.7874606448412, "episode_L1_reward_sum_min": -608.9797656536102, "episode_L1_reward_sum_max": -158.21348464488983, "episode_L2_reward_sum_mean": -145.2266350450367, "episode_L2_reward_sum_min": -225.24333268404007, "episode_L2_reward_sum_max": -116.14024414122105}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.0618651078965078, "policy_loss": 0.038190702923550555, "vf_loss": 0.23674404852471087, "vf_explained_var": 0.6407049168897755, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1932000, "num_env_steps_trained": 1932000, "num_agent_steps_sampled": 1932000, "num_agent_steps_trained": 1932000}, "sampler_results": {"episode_reward_max": -36.72878882320287, "episode_reward_min": -206.2412308613192, "episode_reward_mean": -86.49750385402196, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -272.7874606448412, "episode_L1_reward_sum_min": -608.9797656536102, "episode_L1_reward_sum_max": -158.21348464488983, "episode_L2_reward_sum_mean": -145.2266350450367, "episode_L2_reward_sum_min": -225.24333268404007, "episode_L2_reward_sum_max": -116.14024414122105}, "hist_stats": {"episode_reward": [-80.01482755158051, -72.70201969268861, -37.80678076269139, -45.223373512460114, -121.26496218562161, -77.47572524446406, -71.36495542732754, -90.06057866050108, -91.96019750523028, -70.39379934887704, -103.25151023799687, -160.72391768166347, -118.52509640782642, -37.25513128215738, -48.93983087857369, -111.31730001737152, -64.85378224705283, -56.55925442138837, -161.14948343244862, -138.40752031162654, -46.497928609989856, -36.72878882320287, -136.55554682730002, -74.67356528856709, -54.47266772448187, -126.41692716069329, -78.29102184779927, -54.75733799690517, -50.36896281589452, -118.83814987474427, -53.685237399676076, -94.97443164410659, -63.5942949886299, -79.60421823397238, -69.7488720649945, -64.68661473978004, -67.33335428117437, -63.546951803174125, -86.87989140421422, -70.45013284219714, -68.53962314147057, -203.96278207814166, -64.07559829558258, -57.316684816330884, -88.05879000750097, -93.34001138347195, -72.69304274975542, -67.95254924218841, -66.24304430999626, -201.7929761770562, -149.7574891079618, -58.682733059960114, -143.56368142544642, -61.78548064862536, -41.649020002613014, -86.34752124257095, -68.18909139888254, -124.34107350281761, -72.24159551375654, -136.40422604493992, -84.30267150698744, -129.97295836469792, -125.85345737553855, -77.85139911209347, -95.82097583869012, -87.36594105798223, -83.10276770940774, -153.8039768680924, -49.601991673777825, -64.46914519794014, -63.97323892489761, -91.20766243814391, -82.57546279143841, -101.21234650621247, -69.34589592457431, -84.0401185232329, -74.82976791068559, -89.58117550983471, -116.81452174297618, -102.29204041171738, -62.31198560232518, -58.0666161110193, -206.2412308613192, -63.80026559478113, -47.2562845408298, -54.85580207747231, -68.8647876128281, -56.042789818304406, -131.93676325555361, -73.184336742259, -134.48454382661276, -72.10203262432415, -92.54913295099776, -73.34430280790765, -56.01565974548645, -111.36413943916067, -75.1717381670429, -70.55127238990633, -40.591903069695434, -94.70532544533566], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6083443486832778, "mean_inference_ms": 5.268909828035929, "mean_action_processing_ms": 0.19614015007564548, "mean_env_wait_ms": 1.369132318347061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -36.72878882320287, "episode_reward_min": -206.2412308613192, "episode_reward_mean": -86.49750385402196, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-80.01482755158051, -72.70201969268861, -37.80678076269139, -45.223373512460114, -121.26496218562161, -77.47572524446406, -71.36495542732754, -90.06057866050108, -91.96019750523028, -70.39379934887704, -103.25151023799687, -160.72391768166347, -118.52509640782642, -37.25513128215738, -48.93983087857369, -111.31730001737152, -64.85378224705283, -56.55925442138837, -161.14948343244862, -138.40752031162654, -46.497928609989856, -36.72878882320287, -136.55554682730002, -74.67356528856709, -54.47266772448187, -126.41692716069329, -78.29102184779927, -54.75733799690517, -50.36896281589452, -118.83814987474427, -53.685237399676076, -94.97443164410659, -63.5942949886299, -79.60421823397238, -69.7488720649945, -64.68661473978004, -67.33335428117437, -63.546951803174125, -86.87989140421422, -70.45013284219714, -68.53962314147057, -203.96278207814166, -64.07559829558258, -57.316684816330884, -88.05879000750097, -93.34001138347195, -72.69304274975542, -67.95254924218841, -66.24304430999626, -201.7929761770562, -149.7574891079618, -58.682733059960114, -143.56368142544642, -61.78548064862536, -41.649020002613014, -86.34752124257095, -68.18909139888254, -124.34107350281761, -72.24159551375654, -136.40422604493992, -84.30267150698744, -129.97295836469792, -125.85345737553855, -77.85139911209347, -95.82097583869012, -87.36594105798223, -83.10276770940774, -153.8039768680924, -49.601991673777825, -64.46914519794014, -63.97323892489761, -91.20766243814391, -82.57546279143841, -101.21234650621247, -69.34589592457431, -84.0401185232329, -74.82976791068559, -89.58117550983471, -116.81452174297618, -102.29204041171738, -62.31198560232518, -58.0666161110193, -206.2412308613192, -63.80026559478113, -47.2562845408298, -54.85580207747231, -68.8647876128281, -56.042789818304406, -131.93676325555361, -73.184336742259, -134.48454382661276, -72.10203262432415, -92.54913295099776, -73.34430280790765, -56.01565974548645, -111.36413943916067, -75.1717381670429, -70.55127238990633, -40.591903069695434, -94.70532544533566], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6083443486832778, "mean_inference_ms": 5.268909828035929, "mean_action_processing_ms": 0.19614015007564548, "mean_env_wait_ms": 1.369132318347061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1932000, "num_agent_steps_trained": 1932000, "num_env_steps_sampled": 1932000, "num_env_steps_trained": 1932000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1932000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1932000, "timers": {"training_iteration_time_ms": 75835.403, "load_time_ms": 28.344, "load_throughput": 493927.76, "learn_time_ms": 67668.214, "learn_throughput": 206.892, "synch_weights_time_ms": 10.896}, "counters": {"num_env_steps_sampled": 1932000, "num_env_steps_trained": 1932000, "num_agent_steps_sampled": 1932000, "num_agent_steps_trained": 1932000}, "done": false, "episodes_total": 1932, "training_iteration": 138, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-49-34", "timestamp": 1693061374, "time_this_iter_s": 76.15397548675537, "time_total_s": 10523.741175174713, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150E8610>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015360D90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 10523.741175174713, "timesteps_since_restore": 0, "iterations_since_restore": 138, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 22.08425925925926, "ram_util_percent": 50.93425925925926}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -266.7048533564806, "episode_L1_reward_sum_min": -608.9797656536102, "episode_L1_reward_sum_max": -158.21348464488983, "episode_L2_reward_sum_mean": -143.683161521703, "episode_L2_reward_sum_min": -225.24333268404007, "episode_L2_reward_sum_max": -116.14024414122105}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.0890313837516271, "policy_loss": 0.07401525369967973, "vf_loss": 0.1501612955498161, "vf_explained_var": 0.6711084255220469, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1946000, "num_env_steps_trained": 1946000, "num_agent_steps_sampled": 1946000, "num_agent_steps_trained": 1946000}, "sampler_results": {"episode_reward_max": -36.72878882320287, "episode_reward_min": -206.2412308613192, "episode_reward_mean": -84.55979851399435, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -266.7048533564806, "episode_L1_reward_sum_min": -608.9797656536102, "episode_L1_reward_sum_max": -158.21348464488983, "episode_L2_reward_sum_mean": -143.683161521703, "episode_L2_reward_sum_min": -225.24333268404007, "episode_L2_reward_sum_max": -116.14024414122105}, "hist_stats": {"episode_reward": [-48.93983087857369, -111.31730001737152, -64.85378224705283, -56.55925442138837, -161.14948343244862, -138.40752031162654, -46.497928609989856, -36.72878882320287, -136.55554682730002, -74.67356528856709, -54.47266772448187, -126.41692716069329, -78.29102184779927, -54.75733799690517, -50.36896281589452, -118.83814987474427, -53.685237399676076, -94.97443164410659, -63.5942949886299, -79.60421823397238, -69.7488720649945, -64.68661473978004, -67.33335428117437, -63.546951803174125, -86.87989140421422, -70.45013284219714, -68.53962314147057, -203.96278207814166, -64.07559829558258, -57.316684816330884, -88.05879000750097, -93.34001138347195, -72.69304274975542, -67.95254924218841, -66.24304430999626, -201.7929761770562, -149.7574891079618, -58.682733059960114, -143.56368142544642, -61.78548064862536, -41.649020002613014, -86.34752124257095, -68.18909139888254, -124.34107350281761, -72.24159551375654, -136.40422604493992, -84.30267150698744, -129.97295836469792, -125.85345737553855, -77.85139911209347, -95.82097583869012, -87.36594105798223, -83.10276770940774, -153.8039768680924, -49.601991673777825, -64.46914519794014, -63.97323892489761, -91.20766243814391, -82.57546279143841, -101.21234650621247, -69.34589592457431, -84.0401185232329, -74.82976791068559, -89.58117550983471, -116.81452174297618, -102.29204041171738, -62.31198560232518, -58.0666161110193, -206.2412308613192, -63.80026559478113, -47.2562845408298, -54.85580207747231, -68.8647876128281, -56.042789818304406, -131.93676325555361, -73.184336742259, -134.48454382661276, -72.10203262432415, -92.54913295099776, -73.34430280790765, -56.01565974548645, -111.36413943916067, -75.1717381670429, -70.55127238990633, -40.591903069695434, -94.70532544533566, -104.23471292689128, -41.697031560811894, -54.75357487309945, -97.06310520850793, -45.98834766809154, -43.29213474762758, -74.1234016265719, -82.85670162098498, -70.9258912326785, -104.05085338301164, -91.33796527554307, -68.0312488271314, -53.08356517949149, -52.813807367880955], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6084633314549714, "mean_inference_ms": 5.271519197080533, "mean_action_processing_ms": 0.19621231920287424, "mean_env_wait_ms": 1.3698861108510374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -36.72878882320287, "episode_reward_min": -206.2412308613192, "episode_reward_mean": -84.55979851399435, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.93983087857369, -111.31730001737152, -64.85378224705283, -56.55925442138837, -161.14948343244862, -138.40752031162654, -46.497928609989856, -36.72878882320287, -136.55554682730002, -74.67356528856709, -54.47266772448187, -126.41692716069329, -78.29102184779927, -54.75733799690517, -50.36896281589452, -118.83814987474427, -53.685237399676076, -94.97443164410659, -63.5942949886299, -79.60421823397238, -69.7488720649945, -64.68661473978004, -67.33335428117437, -63.546951803174125, -86.87989140421422, -70.45013284219714, -68.53962314147057, -203.96278207814166, -64.07559829558258, -57.316684816330884, -88.05879000750097, -93.34001138347195, -72.69304274975542, -67.95254924218841, -66.24304430999626, -201.7929761770562, -149.7574891079618, -58.682733059960114, -143.56368142544642, -61.78548064862536, -41.649020002613014, -86.34752124257095, -68.18909139888254, -124.34107350281761, -72.24159551375654, -136.40422604493992, -84.30267150698744, -129.97295836469792, -125.85345737553855, -77.85139911209347, -95.82097583869012, -87.36594105798223, -83.10276770940774, -153.8039768680924, -49.601991673777825, -64.46914519794014, -63.97323892489761, -91.20766243814391, -82.57546279143841, -101.21234650621247, -69.34589592457431, -84.0401185232329, -74.82976791068559, -89.58117550983471, -116.81452174297618, -102.29204041171738, -62.31198560232518, -58.0666161110193, -206.2412308613192, -63.80026559478113, -47.2562845408298, -54.85580207747231, -68.8647876128281, -56.042789818304406, -131.93676325555361, -73.184336742259, -134.48454382661276, -72.10203262432415, -92.54913295099776, -73.34430280790765, -56.01565974548645, -111.36413943916067, -75.1717381670429, -70.55127238990633, -40.591903069695434, -94.70532544533566, -104.23471292689128, -41.697031560811894, -54.75357487309945, -97.06310520850793, -45.98834766809154, -43.29213474762758, -74.1234016265719, -82.85670162098498, -70.9258912326785, -104.05085338301164, -91.33796527554307, -68.0312488271314, -53.08356517949149, -52.813807367880955], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6084633314549714, "mean_inference_ms": 5.271519197080533, "mean_action_processing_ms": 0.19621231920287424, "mean_env_wait_ms": 1.3698861108510374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1946000, "num_agent_steps_trained": 1946000, "num_env_steps_sampled": 1946000, "num_env_steps_trained": 1946000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1946000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1946000, "timers": {"training_iteration_time_ms": 75870.376, "load_time_ms": 28.574, "load_throughput": 489953.216, "learn_time_ms": 67677.38, "learn_throughput": 206.864, "synch_weights_time_ms": 10.512}, "counters": {"num_env_steps_sampled": 1946000, "num_env_steps_trained": 1946000, "num_agent_steps_sampled": 1946000, "num_agent_steps_trained": 1946000}, "done": false, "episodes_total": 1946, "training_iteration": 139, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-50-50", "timestamp": 1693061450, "time_this_iter_s": 76.13061213493347, "time_total_s": 10599.871787309647, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014E814C0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701543E8E0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 10599.871787309647, "timesteps_since_restore": 0, "iterations_since_restore": 139, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 22.173148148148147, "ram_util_percent": 50.94166666666666}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -267.9918412442505, "episode_L1_reward_sum_min": -608.9797656536102, "episode_L1_reward_sum_max": -159.85538267344236, "episode_L2_reward_sum_mean": -144.07856579951942, "episode_L2_reward_sum_min": -225.24333268404007, "episode_L2_reward_sum_max": -116.14024414122105}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.062452799457888536, "policy_loss": 0.03636404662860132, "vf_loss": 0.26088752700664514, "vf_explained_var": 0.6857211879864642, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1960000, "num_env_steps_trained": 1960000, "num_agent_steps_sampled": 1960000, "num_agent_steps_trained": 1960000}, "sampler_results": {"episode_reward_max": -40.591903069695434, "episode_reward_min": -206.2412308613192, "episode_reward_mean": -85.11987705611804, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -267.9918412442505, "episode_L1_reward_sum_min": -608.9797656536102, "episode_L1_reward_sum_max": -159.85538267344236, "episode_L2_reward_sum_mean": -144.07856579951942, "episode_L2_reward_sum_min": -225.24333268404007, "episode_L2_reward_sum_max": -116.14024414122105}, "hist_stats": {"episode_reward": [-50.36896281589452, -118.83814987474427, -53.685237399676076, -94.97443164410659, -63.5942949886299, -79.60421823397238, -69.7488720649945, -64.68661473978004, -67.33335428117437, -63.546951803174125, -86.87989140421422, -70.45013284219714, -68.53962314147057, -203.96278207814166, -64.07559829558258, -57.316684816330884, -88.05879000750097, -93.34001138347195, -72.69304274975542, -67.95254924218841, -66.24304430999626, -201.7929761770562, -149.7574891079618, -58.682733059960114, -143.56368142544642, -61.78548064862536, -41.649020002613014, -86.34752124257095, -68.18909139888254, -124.34107350281761, -72.24159551375654, -136.40422604493992, -84.30267150698744, -129.97295836469792, -125.85345737553855, -77.85139911209347, -95.82097583869012, -87.36594105798223, -83.10276770940774, -153.8039768680924, -49.601991673777825, -64.46914519794014, -63.97323892489761, -91.20766243814391, -82.57546279143841, -101.21234650621247, -69.34589592457431, -84.0401185232329, -74.82976791068559, -89.58117550983471, -116.81452174297618, -102.29204041171738, -62.31198560232518, -58.0666161110193, -206.2412308613192, -63.80026559478113, -47.2562845408298, -54.85580207747231, -68.8647876128281, -56.042789818304406, -131.93676325555361, -73.184336742259, -134.48454382661276, -72.10203262432415, -92.54913295099776, -73.34430280790765, -56.01565974548645, -111.36413943916067, -75.1717381670429, -70.55127238990633, -40.591903069695434, -94.70532544533566, -104.23471292689128, -41.697031560811894, -54.75357487309945, -97.06310520850793, -45.98834766809154, -43.29213474762758, -74.1234016265719, -82.85670162098498, -70.9258912326785, -104.05085338301164, -91.33796527554307, -68.0312488271314, -53.08356517949149, -52.813807367880955, -71.42125564886776, -107.13839231887455, -59.62389296954646, -50.13778365982059, -80.28531059823665, -103.5477467590279, -84.32312167660758, -58.3568078022281, -116.20876285537048, -110.49941270911508, -80.32157230032269, -82.36590331367974, -154.73243043568934, -86.66641675238226], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.608581609514174, "mean_inference_ms": 5.274436845651701, "mean_action_processing_ms": 0.19629261013891416, "mean_env_wait_ms": 1.370724394213477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -40.591903069695434, "episode_reward_min": -206.2412308613192, "episode_reward_mean": -85.11987705611804, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.36896281589452, -118.83814987474427, -53.685237399676076, -94.97443164410659, -63.5942949886299, -79.60421823397238, -69.7488720649945, -64.68661473978004, -67.33335428117437, -63.546951803174125, -86.87989140421422, -70.45013284219714, -68.53962314147057, -203.96278207814166, -64.07559829558258, -57.316684816330884, -88.05879000750097, -93.34001138347195, -72.69304274975542, -67.95254924218841, -66.24304430999626, -201.7929761770562, -149.7574891079618, -58.682733059960114, -143.56368142544642, -61.78548064862536, -41.649020002613014, -86.34752124257095, -68.18909139888254, -124.34107350281761, -72.24159551375654, -136.40422604493992, -84.30267150698744, -129.97295836469792, -125.85345737553855, -77.85139911209347, -95.82097583869012, -87.36594105798223, -83.10276770940774, -153.8039768680924, -49.601991673777825, -64.46914519794014, -63.97323892489761, -91.20766243814391, -82.57546279143841, -101.21234650621247, -69.34589592457431, -84.0401185232329, -74.82976791068559, -89.58117550983471, -116.81452174297618, -102.29204041171738, -62.31198560232518, -58.0666161110193, -206.2412308613192, -63.80026559478113, -47.2562845408298, -54.85580207747231, -68.8647876128281, -56.042789818304406, -131.93676325555361, -73.184336742259, -134.48454382661276, -72.10203262432415, -92.54913295099776, -73.34430280790765, -56.01565974548645, -111.36413943916067, -75.1717381670429, -70.55127238990633, -40.591903069695434, -94.70532544533566, -104.23471292689128, -41.697031560811894, -54.75357487309945, -97.06310520850793, -45.98834766809154, -43.29213474762758, -74.1234016265719, -82.85670162098498, -70.9258912326785, -104.05085338301164, -91.33796527554307, -68.0312488271314, -53.08356517949149, -52.813807367880955, -71.42125564886776, -107.13839231887455, -59.62389296954646, -50.13778365982059, -80.28531059823665, -103.5477467590279, -84.32312167660758, -58.3568078022281, -116.20876285537048, -110.49941270911508, -80.32157230032269, -82.36590331367974, -154.73243043568934, -86.66641675238226], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.608581609514174, "mean_inference_ms": 5.274436845651701, "mean_action_processing_ms": 0.19629261013891416, "mean_env_wait_ms": 1.370724394213477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1960000, "num_agent_steps_trained": 1960000, "num_env_steps_sampled": 1960000, "num_env_steps_trained": 1960000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1960000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1960000, "timers": {"training_iteration_time_ms": 75911.941, "load_time_ms": 28.163, "load_throughput": 497098.067, "learn_time_ms": 67694.655, "learn_throughput": 206.811, "synch_weights_time_ms": 10.303}, "counters": {"num_env_steps_sampled": 1960000, "num_env_steps_trained": 1960000, "num_agent_steps_sampled": 1960000, "num_agent_steps_trained": 1960000}, "done": false, "episodes_total": 1960, "training_iteration": 140, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-52-06", "timestamp": 1693061526, "time_this_iter_s": 76.39941549301147, "time_total_s": 10676.271202802658, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270153A5CD0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701516F430>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 10676.271202802658, "timesteps_since_restore": 0, "iterations_since_restore": 140, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 22.049074074074074, "ram_util_percent": 50.95370370370371}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -270.5071534413099, "episode_L1_reward_sum_min": -587.0970830619335, "episode_L1_reward_sum_max": -159.85538267344236, "episode_L2_reward_sum_mean": -144.69805931821466, "episode_L2_reward_sum_min": -223.51687595248222, "episode_L2_reward_sum_max": -116.14024414122105}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.0612209145341537, "policy_loss": 0.03345414938167056, "vf_loss": 0.2776676329910785, "vf_explained_var": 0.599282747678796, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1974000, "num_env_steps_trained": 1974000, "num_agent_steps_sampled": 1974000, "num_agent_steps_trained": 1974000}, "sampler_results": {"episode_reward_max": -40.591903069695434, "episode_reward_min": -206.2412308613192, "episode_reward_mean": -87.23496649074427, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -270.5071534413099, "episode_L1_reward_sum_min": -587.0970830619335, "episode_L1_reward_sum_max": -159.85538267344236, "episode_L2_reward_sum_mean": -144.69805931821466, "episode_L2_reward_sum_min": -223.51687595248222, "episode_L2_reward_sum_max": -116.14024414122105}, "hist_stats": {"episode_reward": [-64.07559829558258, -57.316684816330884, -88.05879000750097, -93.34001138347195, -72.69304274975542, -67.95254924218841, -66.24304430999626, -201.7929761770562, -149.7574891079618, -58.682733059960114, -143.56368142544642, -61.78548064862536, -41.649020002613014, -86.34752124257095, -68.18909139888254, -124.34107350281761, -72.24159551375654, -136.40422604493992, -84.30267150698744, -129.97295836469792, -125.85345737553855, -77.85139911209347, -95.82097583869012, -87.36594105798223, -83.10276770940774, -153.8039768680924, -49.601991673777825, -64.46914519794014, -63.97323892489761, -91.20766243814391, -82.57546279143841, -101.21234650621247, -69.34589592457431, -84.0401185232329, -74.82976791068559, -89.58117550983471, -116.81452174297618, -102.29204041171738, -62.31198560232518, -58.0666161110193, -206.2412308613192, -63.80026559478113, -47.2562845408298, -54.85580207747231, -68.8647876128281, -56.042789818304406, -131.93676325555361, -73.184336742259, -134.48454382661276, -72.10203262432415, -92.54913295099776, -73.34430280790765, -56.01565974548645, -111.36413943916067, -75.1717381670429, -70.55127238990633, -40.591903069695434, -94.70532544533566, -104.23471292689128, -41.697031560811894, -54.75357487309945, -97.06310520850793, -45.98834766809154, -43.29213474762758, -74.1234016265719, -82.85670162098498, -70.9258912326785, -104.05085338301164, -91.33796527554307, -68.0312488271314, -53.08356517949149, -52.813807367880955, -71.42125564886776, -107.13839231887455, -59.62389296954646, -50.13778365982059, -80.28531059823665, -103.5477467590279, -84.32312167660758, -58.3568078022281, -116.20876285537048, -110.49941270911508, -80.32157230032269, -82.36590331367974, -154.73243043568934, -86.66641675238226, -109.08284892950658, -66.07991277440082, -56.57537166398017, -100.26319436977583, -71.22741670144964, -104.01486820469921, -72.95432780317257, -180.03979981727724, -106.66433874684405, -114.78897107214178, -44.131711132365695, -92.00187482861922, -80.21001317521537, -169.68781155534458], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6087098093987495, "mean_inference_ms": 5.277774555001422, "mean_action_processing_ms": 0.1963885087956728, "mean_env_wait_ms": 1.371659167735155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -40.591903069695434, "episode_reward_min": -206.2412308613192, "episode_reward_mean": -87.23496649074427, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.07559829558258, -57.316684816330884, -88.05879000750097, -93.34001138347195, -72.69304274975542, -67.95254924218841, -66.24304430999626, -201.7929761770562, -149.7574891079618, -58.682733059960114, -143.56368142544642, -61.78548064862536, -41.649020002613014, -86.34752124257095, -68.18909139888254, -124.34107350281761, -72.24159551375654, -136.40422604493992, -84.30267150698744, -129.97295836469792, -125.85345737553855, -77.85139911209347, -95.82097583869012, -87.36594105798223, -83.10276770940774, -153.8039768680924, -49.601991673777825, -64.46914519794014, -63.97323892489761, -91.20766243814391, -82.57546279143841, -101.21234650621247, -69.34589592457431, -84.0401185232329, -74.82976791068559, -89.58117550983471, -116.81452174297618, -102.29204041171738, -62.31198560232518, -58.0666161110193, -206.2412308613192, -63.80026559478113, -47.2562845408298, -54.85580207747231, -68.8647876128281, -56.042789818304406, -131.93676325555361, -73.184336742259, -134.48454382661276, -72.10203262432415, -92.54913295099776, -73.34430280790765, -56.01565974548645, -111.36413943916067, -75.1717381670429, -70.55127238990633, -40.591903069695434, -94.70532544533566, -104.23471292689128, -41.697031560811894, -54.75357487309945, -97.06310520850793, -45.98834766809154, -43.29213474762758, -74.1234016265719, -82.85670162098498, -70.9258912326785, -104.05085338301164, -91.33796527554307, -68.0312488271314, -53.08356517949149, -52.813807367880955, -71.42125564886776, -107.13839231887455, -59.62389296954646, -50.13778365982059, -80.28531059823665, -103.5477467590279, -84.32312167660758, -58.3568078022281, -116.20876285537048, -110.49941270911508, -80.32157230032269, -82.36590331367974, -154.73243043568934, -86.66641675238226, -109.08284892950658, -66.07991277440082, -56.57537166398017, -100.26319436977583, -71.22741670144964, -104.01486820469921, -72.95432780317257, -180.03979981727724, -106.66433874684405, -114.78897107214178, -44.131711132365695, -92.00187482861922, -80.21001317521537, -169.68781155534458], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6087098093987495, "mean_inference_ms": 5.277774555001422, "mean_action_processing_ms": 0.1963885087956728, "mean_env_wait_ms": 1.371659167735155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1974000, "num_agent_steps_trained": 1974000, "num_env_steps_sampled": 1974000, "num_env_steps_trained": 1974000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1974000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1974000, "timers": {"training_iteration_time_ms": 76017.495, "load_time_ms": 28.263, "load_throughput": 495344.825, "learn_time_ms": 67736.725, "learn_throughput": 206.683, "synch_weights_time_ms": 9.904}, "counters": {"num_env_steps_sampled": 1974000, "num_env_steps_trained": 1974000, "num_agent_steps_sampled": 1974000, "num_agent_steps_trained": 1974000}, "done": false, "episodes_total": 1974, "training_iteration": 141, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-53-23", "timestamp": 1693061603, "time_this_iter_s": 76.68998599052429, "time_total_s": 10752.961188793182, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015360C70>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701545EEE0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 10752.961188793182, "timesteps_since_restore": 0, "iterations_since_restore": 141, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 22.175, "ram_util_percent": 50.95555555555556}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -275.161669292897, "episode_L1_reward_sum_min": -578.7626157701015, "episode_L1_reward_sum_max": -159.85538267344236, "episode_L2_reward_sum_mean": -145.8348927514255, "episode_L2_reward_sum_min": -221.9684522151947, "episode_L2_reward_sum_max": -116.14024414122105}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.042131478733664816, "policy_loss": 0.015789379573181855, "vf_loss": 0.2634209918983068, "vf_explained_var": 0.8174103971862008, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 1988000, "num_env_steps_trained": 1988000, "num_agent_steps_sampled": 1988000, "num_agent_steps_trained": 1988000}, "sampler_results": {"episode_reward_max": -40.591903069695434, "episode_reward_min": -206.2412308613192, "episode_reward_mean": -88.78806593857308, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -275.161669292897, "episode_L1_reward_sum_min": -578.7626157701015, "episode_L1_reward_sum_max": -159.85538267344236, "episode_L2_reward_sum_mean": -145.8348927514255, "episode_L2_reward_sum_min": -221.9684522151947, "episode_L2_reward_sum_max": -116.14024414122105}, "hist_stats": {"episode_reward": [-68.18909139888254, -124.34107350281761, -72.24159551375654, -136.40422604493992, -84.30267150698744, -129.97295836469792, -125.85345737553855, -77.85139911209347, -95.82097583869012, -87.36594105798223, -83.10276770940774, -153.8039768680924, -49.601991673777825, -64.46914519794014, -63.97323892489761, -91.20766243814391, -82.57546279143841, -101.21234650621247, -69.34589592457431, -84.0401185232329, -74.82976791068559, -89.58117550983471, -116.81452174297618, -102.29204041171738, -62.31198560232518, -58.0666161110193, -206.2412308613192, -63.80026559478113, -47.2562845408298, -54.85580207747231, -68.8647876128281, -56.042789818304406, -131.93676325555361, -73.184336742259, -134.48454382661276, -72.10203262432415, -92.54913295099776, -73.34430280790765, -56.01565974548645, -111.36413943916067, -75.1717381670429, -70.55127238990633, -40.591903069695434, -94.70532544533566, -104.23471292689128, -41.697031560811894, -54.75357487309945, -97.06310520850793, -45.98834766809154, -43.29213474762758, -74.1234016265719, -82.85670162098498, -70.9258912326785, -104.05085338301164, -91.33796527554307, -68.0312488271314, -53.08356517949149, -52.813807367880955, -71.42125564886776, -107.13839231887455, -59.62389296954646, -50.13778365982059, -80.28531059823665, -103.5477467590279, -84.32312167660758, -58.3568078022281, -116.20876285537048, -110.49941270911508, -80.32157230032269, -82.36590331367974, -154.73243043568934, -86.66641675238226, -109.08284892950658, -66.07991277440082, -56.57537166398017, -100.26319436977583, -71.22741670144964, -104.01486820469921, -72.95432780317257, -180.03979981727724, -106.66433874684405, -114.78897107214178, -44.131711132365695, -92.00187482861922, -80.21001317521537, -169.68781155534458, -92.91908922362933, -63.9088931418059, -170.99866432763517, -137.7248329669305, -113.1327724318259, -63.76289737421357, -71.5843393734837, -64.82810892010609, -46.18493030456102, -77.34127682225544, -140.73009472032612, -157.433813823156, -72.86841563298921, -135.15043818902646], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6088822422738981, "mean_inference_ms": 5.281543309361785, "mean_action_processing_ms": 0.19650150397218405, "mean_env_wait_ms": 1.3727074802009582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -40.591903069695434, "episode_reward_min": -206.2412308613192, "episode_reward_mean": -88.78806593857308, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-68.18909139888254, -124.34107350281761, -72.24159551375654, -136.40422604493992, -84.30267150698744, -129.97295836469792, -125.85345737553855, -77.85139911209347, -95.82097583869012, -87.36594105798223, -83.10276770940774, -153.8039768680924, -49.601991673777825, -64.46914519794014, -63.97323892489761, -91.20766243814391, -82.57546279143841, -101.21234650621247, -69.34589592457431, -84.0401185232329, -74.82976791068559, -89.58117550983471, -116.81452174297618, -102.29204041171738, -62.31198560232518, -58.0666161110193, -206.2412308613192, -63.80026559478113, -47.2562845408298, -54.85580207747231, -68.8647876128281, -56.042789818304406, -131.93676325555361, -73.184336742259, -134.48454382661276, -72.10203262432415, -92.54913295099776, -73.34430280790765, -56.01565974548645, -111.36413943916067, -75.1717381670429, -70.55127238990633, -40.591903069695434, -94.70532544533566, -104.23471292689128, -41.697031560811894, -54.75357487309945, -97.06310520850793, -45.98834766809154, -43.29213474762758, -74.1234016265719, -82.85670162098498, -70.9258912326785, -104.05085338301164, -91.33796527554307, -68.0312488271314, -53.08356517949149, -52.813807367880955, -71.42125564886776, -107.13839231887455, -59.62389296954646, -50.13778365982059, -80.28531059823665, -103.5477467590279, -84.32312167660758, -58.3568078022281, -116.20876285537048, -110.49941270911508, -80.32157230032269, -82.36590331367974, -154.73243043568934, -86.66641675238226, -109.08284892950658, -66.07991277440082, -56.57537166398017, -100.26319436977583, -71.22741670144964, -104.01486820469921, -72.95432780317257, -180.03979981727724, -106.66433874684405, -114.78897107214178, -44.131711132365695, -92.00187482861922, -80.21001317521537, -169.68781155534458, -92.91908922362933, -63.9088931418059, -170.99866432763517, -137.7248329669305, -113.1327724318259, -63.76289737421357, -71.5843393734837, -64.82810892010609, -46.18493030456102, -77.34127682225544, -140.73009472032612, -157.433813823156, -72.86841563298921, -135.15043818902646], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6088822422738981, "mean_inference_ms": 5.281543309361785, "mean_action_processing_ms": 0.19650150397218405, "mean_env_wait_ms": 1.3727074802009582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 1988000, "num_agent_steps_trained": 1988000, "num_env_steps_sampled": 1988000, "num_env_steps_trained": 1988000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 1988000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 1988000, "timers": {"training_iteration_time_ms": 76149.164, "load_time_ms": 28.354, "load_throughput": 493753.325, "learn_time_ms": 67810.872, "learn_throughput": 206.457, "synch_weights_time_ms": 9.402}, "counters": {"num_env_steps_sampled": 1988000, "num_env_steps_trained": 1988000, "num_agent_steps_sampled": 1988000, "num_agent_steps_trained": 1988000}, "done": false, "episodes_total": 1988, "training_iteration": 142, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-54-40", "timestamp": 1693061680, "time_this_iter_s": 76.93103551864624, "time_total_s": 10829.892224311829, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014E8A070>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701517A910>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 10829.892224311829, "timesteps_since_restore": 0, "iterations_since_restore": 142, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 22.49724770642202, "ram_util_percent": 50.951376146788995}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -272.5732896216959, "episode_L1_reward_sum_min": -578.7626157701015, "episode_L1_reward_sum_max": -159.85538267344236, "episode_L2_reward_sum_mean": -145.16462206050753, "episode_L2_reward_sum_min": -221.9684522151947, "episode_L2_reward_sum_max": -116.14024414122105}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.11209250833909722, "policy_loss": 0.08608127945728423, "vf_loss": 0.26011229551271997, "vf_explained_var": 0.6710816574256115, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2002000, "num_env_steps_trained": 2002000, "num_agent_steps_sampled": 2002000, "num_agent_steps_trained": 2002000}, "sampler_results": {"episode_reward_max": -40.591903069695434, "episode_reward_min": -206.2412308613192, "episode_reward_mean": -87.09043168396686, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -272.5732896216959, "episode_L1_reward_sum_min": -578.7626157701015, "episode_L1_reward_sum_max": -159.85538267344236, "episode_L2_reward_sum_mean": -145.16462206050753, "episode_L2_reward_sum_min": -221.9684522151947, "episode_L2_reward_sum_max": -116.14024414122105}, "hist_stats": {"episode_reward": [-63.97323892489761, -91.20766243814391, -82.57546279143841, -101.21234650621247, -69.34589592457431, -84.0401185232329, -74.82976791068559, -89.58117550983471, -116.81452174297618, -102.29204041171738, -62.31198560232518, -58.0666161110193, -206.2412308613192, -63.80026559478113, -47.2562845408298, -54.85580207747231, -68.8647876128281, -56.042789818304406, -131.93676325555361, -73.184336742259, -134.48454382661276, -72.10203262432415, -92.54913295099776, -73.34430280790765, -56.01565974548645, -111.36413943916067, -75.1717381670429, -70.55127238990633, -40.591903069695434, -94.70532544533566, -104.23471292689128, -41.697031560811894, -54.75357487309945, -97.06310520850793, -45.98834766809154, -43.29213474762758, -74.1234016265719, -82.85670162098498, -70.9258912326785, -104.05085338301164, -91.33796527554307, -68.0312488271314, -53.08356517949149, -52.813807367880955, -71.42125564886776, -107.13839231887455, -59.62389296954646, -50.13778365982059, -80.28531059823665, -103.5477467590279, -84.32312167660758, -58.3568078022281, -116.20876285537048, -110.49941270911508, -80.32157230032269, -82.36590331367974, -154.73243043568934, -86.66641675238226, -109.08284892950658, -66.07991277440082, -56.57537166398017, -100.26319436977583, -71.22741670144964, -104.01486820469921, -72.95432780317257, -180.03979981727724, -106.66433874684405, -114.78897107214178, -44.131711132365695, -92.00187482861922, -80.21001317521537, -169.68781155534458, -92.91908922362933, -63.9088931418059, -170.99866432763517, -137.7248329669305, -113.1327724318259, -63.76289737421357, -71.5843393734837, -64.82810892010609, -46.18493030456102, -77.34127682225544, -140.73009472032612, -157.433813823156, -72.86841563298921, -135.15043818902646, -54.28110692915294, -90.34704927497506, -131.405714388976, -48.97645319640299, -72.88520921822855, -90.64992814351457, -109.67516511543239, -72.11539076883658, -83.41885637355587, -86.58414911190894, -56.45854042471383, -79.71238061431082, -116.25321274000355, -90.79468940497121], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6090855403121113, "mean_inference_ms": 5.285873314833535, "mean_action_processing_ms": 0.19663260195591217, "mean_env_wait_ms": 1.3739027540258781, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -40.591903069695434, "episode_reward_min": -206.2412308613192, "episode_reward_mean": -87.09043168396686, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-63.97323892489761, -91.20766243814391, -82.57546279143841, -101.21234650621247, -69.34589592457431, -84.0401185232329, -74.82976791068559, -89.58117550983471, -116.81452174297618, -102.29204041171738, -62.31198560232518, -58.0666161110193, -206.2412308613192, -63.80026559478113, -47.2562845408298, -54.85580207747231, -68.8647876128281, -56.042789818304406, -131.93676325555361, -73.184336742259, -134.48454382661276, -72.10203262432415, -92.54913295099776, -73.34430280790765, -56.01565974548645, -111.36413943916067, -75.1717381670429, -70.55127238990633, -40.591903069695434, -94.70532544533566, -104.23471292689128, -41.697031560811894, -54.75357487309945, -97.06310520850793, -45.98834766809154, -43.29213474762758, -74.1234016265719, -82.85670162098498, -70.9258912326785, -104.05085338301164, -91.33796527554307, -68.0312488271314, -53.08356517949149, -52.813807367880955, -71.42125564886776, -107.13839231887455, -59.62389296954646, -50.13778365982059, -80.28531059823665, -103.5477467590279, -84.32312167660758, -58.3568078022281, -116.20876285537048, -110.49941270911508, -80.32157230032269, -82.36590331367974, -154.73243043568934, -86.66641675238226, -109.08284892950658, -66.07991277440082, -56.57537166398017, -100.26319436977583, -71.22741670144964, -104.01486820469921, -72.95432780317257, -180.03979981727724, -106.66433874684405, -114.78897107214178, -44.131711132365695, -92.00187482861922, -80.21001317521537, -169.68781155534458, -92.91908922362933, -63.9088931418059, -170.99866432763517, -137.7248329669305, -113.1327724318259, -63.76289737421357, -71.5843393734837, -64.82810892010609, -46.18493030456102, -77.34127682225544, -140.73009472032612, -157.433813823156, -72.86841563298921, -135.15043818902646, -54.28110692915294, -90.34704927497506, -131.405714388976, -48.97645319640299, -72.88520921822855, -90.64992814351457, -109.67516511543239, -72.11539076883658, -83.41885637355587, -86.58414911190894, -56.45854042471383, -79.71238061431082, -116.25321274000355, -90.79468940497121], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6090855403121113, "mean_inference_ms": 5.285873314833535, "mean_action_processing_ms": 0.19663260195591217, "mean_env_wait_ms": 1.3739027540258781, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2002000, "num_agent_steps_trained": 2002000, "num_env_steps_sampled": 2002000, "num_env_steps_trained": 2002000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2002000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2002000, "timers": {"training_iteration_time_ms": 76301.332, "load_time_ms": 28.756, "load_throughput": 486848.079, "learn_time_ms": 67870.052, "learn_throughput": 206.277, "synch_weights_time_ms": 8.214}, "counters": {"num_env_steps_sampled": 2002000, "num_env_steps_trained": 2002000, "num_agent_steps_sampled": 2002000, "num_agent_steps_trained": 2002000}, "done": false, "episodes_total": 2002, "training_iteration": 143, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-55-57", "timestamp": 1693061757, "time_this_iter_s": 77.21349263191223, "time_total_s": 10907.10571694374, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270152CFA60>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701534D2E0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 10907.10571694374, "timesteps_since_restore": 0, "iterations_since_restore": 143, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 22.342201834862387, "ram_util_percent": 50.95412844036698}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -273.88741871058943, "episode_L1_reward_sum_min": -590.6295767426491, "episode_L1_reward_sum_max": -165.90791337192059, "episode_L2_reward_sum_mean": -145.4918495564908, "episode_L2_reward_sum_min": -223.13590919971466, "episode_L2_reward_sum_max": -117.79196697473526}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.0411073567591025, "policy_loss": 0.014873455625905084, "vf_loss": 0.26233900942434973, "vf_explained_var": 0.6312020742353589, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2016000, "num_env_steps_trained": 2016000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "sampler_results": {"episode_reward_max": -40.591903069695434, "episode_reward_min": -214.33942665866434, "episode_reward_mean": -89.48360705471073, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -273.88741871058943, "episode_L1_reward_sum_min": -590.6295767426491, "episode_L1_reward_sum_max": -165.90791337192059, "episode_L2_reward_sum_mean": -145.4918495564908, "episode_L2_reward_sum_min": -223.13590919971466, "episode_L2_reward_sum_max": -117.79196697473526}, "hist_stats": {"episode_reward": [-47.2562845408298, -54.85580207747231, -68.8647876128281, -56.042789818304406, -131.93676325555361, -73.184336742259, -134.48454382661276, -72.10203262432415, -92.54913295099776, -73.34430280790765, -56.01565974548645, -111.36413943916067, -75.1717381670429, -70.55127238990633, -40.591903069695434, -94.70532544533566, -104.23471292689128, -41.697031560811894, -54.75357487309945, -97.06310520850793, -45.98834766809154, -43.29213474762758, -74.1234016265719, -82.85670162098498, -70.9258912326785, -104.05085338301164, -91.33796527554307, -68.0312488271314, -53.08356517949149, -52.813807367880955, -71.42125564886776, -107.13839231887455, -59.62389296954646, -50.13778365982059, -80.28531059823665, -103.5477467590279, -84.32312167660758, -58.3568078022281, -116.20876285537048, -110.49941270911508, -80.32157230032269, -82.36590331367974, -154.73243043568934, -86.66641675238226, -109.08284892950658, -66.07991277440082, -56.57537166398017, -100.26319436977583, -71.22741670144964, -104.01486820469921, -72.95432780317257, -180.03979981727724, -106.66433874684405, -114.78897107214178, -44.131711132365695, -92.00187482861922, -80.21001317521537, -169.68781155534458, -92.91908922362933, -63.9088931418059, -170.99866432763517, -137.7248329669305, -113.1327724318259, -63.76289737421357, -71.5843393734837, -64.82810892010609, -46.18493030456102, -77.34127682225544, -140.73009472032612, -157.433813823156, -72.86841563298921, -135.15043818902646, -54.28110692915294, -90.34704927497506, -131.405714388976, -48.97645319640299, -72.88520921822855, -90.64992814351457, -109.67516511543239, -72.11539076883658, -83.41885637355587, -86.58414911190894, -56.45854042471383, -79.71238061431082, -116.25321274000355, -90.79468940497121, -128.76194733841558, -75.17301640343948, -102.1360739915461, -78.82001692507296, -69.6412203983211, -56.55891472605132, -214.33942665866434, -126.21635177190409, -79.19127178168226, -113.02618433643858, -52.550634645213066, -169.85474770777682, -148.6339255339407, -90.70613370907658], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.609314330393572, "mean_inference_ms": 5.290670288778987, "mean_action_processing_ms": 0.19678109674322258, "mean_env_wait_ms": 1.3752174640242303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -40.591903069695434, "episode_reward_min": -214.33942665866434, "episode_reward_mean": -89.48360705471073, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-47.2562845408298, -54.85580207747231, -68.8647876128281, -56.042789818304406, -131.93676325555361, -73.184336742259, -134.48454382661276, -72.10203262432415, -92.54913295099776, -73.34430280790765, -56.01565974548645, -111.36413943916067, -75.1717381670429, -70.55127238990633, -40.591903069695434, -94.70532544533566, -104.23471292689128, -41.697031560811894, -54.75357487309945, -97.06310520850793, -45.98834766809154, -43.29213474762758, -74.1234016265719, -82.85670162098498, -70.9258912326785, -104.05085338301164, -91.33796527554307, -68.0312488271314, -53.08356517949149, -52.813807367880955, -71.42125564886776, -107.13839231887455, -59.62389296954646, -50.13778365982059, -80.28531059823665, -103.5477467590279, -84.32312167660758, -58.3568078022281, -116.20876285537048, -110.49941270911508, -80.32157230032269, -82.36590331367974, -154.73243043568934, -86.66641675238226, -109.08284892950658, -66.07991277440082, -56.57537166398017, -100.26319436977583, -71.22741670144964, -104.01486820469921, -72.95432780317257, -180.03979981727724, -106.66433874684405, -114.78897107214178, -44.131711132365695, -92.00187482861922, -80.21001317521537, -169.68781155534458, -92.91908922362933, -63.9088931418059, -170.99866432763517, -137.7248329669305, -113.1327724318259, -63.76289737421357, -71.5843393734837, -64.82810892010609, -46.18493030456102, -77.34127682225544, -140.73009472032612, -157.433813823156, -72.86841563298921, -135.15043818902646, -54.28110692915294, -90.34704927497506, -131.405714388976, -48.97645319640299, -72.88520921822855, -90.64992814351457, -109.67516511543239, -72.11539076883658, -83.41885637355587, -86.58414911190894, -56.45854042471383, -79.71238061431082, -116.25321274000355, -90.79468940497121, -128.76194733841558, -75.17301640343948, -102.1360739915461, -78.82001692507296, -69.6412203983211, -56.55891472605132, -214.33942665866434, -126.21635177190409, -79.19127178168226, -113.02618433643858, -52.550634645213066, -169.85474770777682, -148.6339255339407, -90.70613370907658], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.609314330393572, "mean_inference_ms": 5.290670288778987, "mean_action_processing_ms": 0.19678109674322258, "mean_env_wait_ms": 1.3752174640242303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000, "num_env_steps_sampled": 2016000, "num_env_steps_trained": 2016000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2016000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2016000, "timers": {"training_iteration_time_ms": 76429.795, "load_time_ms": 28.153, "load_throughput": 497288.351, "learn_time_ms": 67911.802, "learn_throughput": 206.15, "synch_weights_time_ms": 8.01}, "counters": {"num_env_steps_sampled": 2016000, "num_env_steps_trained": 2016000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "done": false, "episodes_total": 2016, "training_iteration": 144, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-57-15", "timestamp": 1693061835, "time_this_iter_s": 77.17041635513306, "time_total_s": 10984.276133298874, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270151C0160>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014E9B0D0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 10984.276133298874, "timesteps_since_restore": 0, "iterations_since_restore": 144, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 22.76909090909091, "ram_util_percent": 50.95818181818182}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -276.2177177841961, "episode_L1_reward_sum_min": -590.6295767426491, "episode_L1_reward_sum_max": -166.80767907202244, "episode_L2_reward_sum_mean": -146.12632131688298, "episode_L2_reward_sum_min": -223.13590919971466, "episode_L2_reward_sum_max": -118.16632403433323}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.13179301356701775, "policy_loss": 0.10187686207884378, "vf_loss": 0.2991615187646487, "vf_explained_var": 0.7197834854876554, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2030000, "num_env_steps_trained": 2030000, "num_agent_steps_sampled": 2030000, "num_agent_steps_trained": 2030000}, "sampler_results": {"episode_reward_max": -40.591903069695434, "episode_reward_min": -214.33942665866434, "episode_reward_mean": -90.19430240501379, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -276.2177177841961, "episode_L1_reward_sum_min": -590.6295767426491, "episode_L1_reward_sum_max": -166.80767907202244, "episode_L2_reward_sum_mean": -146.12632131688298, "episode_L2_reward_sum_min": -223.13590919971466, "episode_L2_reward_sum_max": -118.16632403433323}, "hist_stats": {"episode_reward": [-40.591903069695434, -94.70532544533566, -104.23471292689128, -41.697031560811894, -54.75357487309945, -97.06310520850793, -45.98834766809154, -43.29213474762758, -74.1234016265719, -82.85670162098498, -70.9258912326785, -104.05085338301164, -91.33796527554307, -68.0312488271314, -53.08356517949149, -52.813807367880955, -71.42125564886776, -107.13839231887455, -59.62389296954646, -50.13778365982059, -80.28531059823665, -103.5477467590279, -84.32312167660758, -58.3568078022281, -116.20876285537048, -110.49941270911508, -80.32157230032269, -82.36590331367974, -154.73243043568934, -86.66641675238226, -109.08284892950658, -66.07991277440082, -56.57537166398017, -100.26319436977583, -71.22741670144964, -104.01486820469921, -72.95432780317257, -180.03979981727724, -106.66433874684405, -114.78897107214178, -44.131711132365695, -92.00187482861922, -80.21001317521537, -169.68781155534458, -92.91908922362933, -63.9088931418059, -170.99866432763517, -137.7248329669305, -113.1327724318259, -63.76289737421357, -71.5843393734837, -64.82810892010609, -46.18493030456102, -77.34127682225544, -140.73009472032612, -157.433813823156, -72.86841563298921, -135.15043818902646, -54.28110692915294, -90.34704927497506, -131.405714388976, -48.97645319640299, -72.88520921822855, -90.64992814351457, -109.67516511543239, -72.11539076883658, -83.41885637355587, -86.58414911190894, -56.45854042471383, -79.71238061431082, -116.25321274000355, -90.79468940497121, -128.76194733841558, -75.17301640343948, -102.1360739915461, -78.82001692507296, -69.6412203983211, -56.55891472605132, -214.33942665866434, -126.21635177190409, -79.19127178168226, -113.02618433643858, -52.550634645213066, -169.85474770777682, -148.6339255339407, -90.70613370907658, -127.31616032875178, -49.210841607759825, -80.14398998932649, -110.80259606377125, -109.01889529192681, -125.20876328803043, -55.63162422357053, -74.9457000090834, -69.83402250888241, -57.237113120105, -100.65269771020625, -73.61268287006087, -67.54358739578, -87.63444662173694], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6095753523720611, "mean_inference_ms": 5.2960664178057675, "mean_action_processing_ms": 0.19694607061723168, "mean_env_wait_ms": 1.376689521510957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -40.591903069695434, "episode_reward_min": -214.33942665866434, "episode_reward_mean": -90.19430240501379, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-40.591903069695434, -94.70532544533566, -104.23471292689128, -41.697031560811894, -54.75357487309945, -97.06310520850793, -45.98834766809154, -43.29213474762758, -74.1234016265719, -82.85670162098498, -70.9258912326785, -104.05085338301164, -91.33796527554307, -68.0312488271314, -53.08356517949149, -52.813807367880955, -71.42125564886776, -107.13839231887455, -59.62389296954646, -50.13778365982059, -80.28531059823665, -103.5477467590279, -84.32312167660758, -58.3568078022281, -116.20876285537048, -110.49941270911508, -80.32157230032269, -82.36590331367974, -154.73243043568934, -86.66641675238226, -109.08284892950658, -66.07991277440082, -56.57537166398017, -100.26319436977583, -71.22741670144964, -104.01486820469921, -72.95432780317257, -180.03979981727724, -106.66433874684405, -114.78897107214178, -44.131711132365695, -92.00187482861922, -80.21001317521537, -169.68781155534458, -92.91908922362933, -63.9088931418059, -170.99866432763517, -137.7248329669305, -113.1327724318259, -63.76289737421357, -71.5843393734837, -64.82810892010609, -46.18493030456102, -77.34127682225544, -140.73009472032612, -157.433813823156, -72.86841563298921, -135.15043818902646, -54.28110692915294, -90.34704927497506, -131.405714388976, -48.97645319640299, -72.88520921822855, -90.64992814351457, -109.67516511543239, -72.11539076883658, -83.41885637355587, -86.58414911190894, -56.45854042471383, -79.71238061431082, -116.25321274000355, -90.79468940497121, -128.76194733841558, -75.17301640343948, -102.1360739915461, -78.82001692507296, -69.6412203983211, -56.55891472605132, -214.33942665866434, -126.21635177190409, -79.19127178168226, -113.02618433643858, -52.550634645213066, -169.85474770777682, -148.6339255339407, -90.70613370907658, -127.31616032875178, -49.210841607759825, -80.14398998932649, -110.80259606377125, -109.01889529192681, -125.20876328803043, -55.63162422357053, -74.9457000090834, -69.83402250888241, -57.237113120105, -100.65269771020625, -73.61268287006087, -67.54358739578, -87.63444662173694], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6095753523720611, "mean_inference_ms": 5.2960664178057675, "mean_action_processing_ms": 0.19694607061723168, "mean_env_wait_ms": 1.376689521510957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2030000, "num_agent_steps_trained": 2030000, "num_env_steps_sampled": 2030000, "num_env_steps_trained": 2030000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2030000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2030000, "timers": {"training_iteration_time_ms": 76601.494, "load_time_ms": 28.651, "load_throughput": 488631.43, "learn_time_ms": 67971.071, "learn_throughput": 205.97, "synch_weights_time_ms": 8.015}, "counters": {"num_env_steps_sampled": 2030000, "num_env_steps_trained": 2030000, "num_agent_steps_sampled": 2030000, "num_agent_steps_trained": 2030000}, "done": false, "episodes_total": 2030, "training_iteration": 145, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-58-32", "timestamp": 1693061912, "time_this_iter_s": 77.56294322013855, "time_total_s": 11061.839076519012, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150A2FA0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270152CF130>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 11061.839076519012, "timesteps_since_restore": 0, "iterations_since_restore": 145, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 22.715454545454545, "ram_util_percent": 51.000000000000014}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -282.63089202441273, "episode_L1_reward_sum_min": -590.6295767426491, "episode_L1_reward_sum_max": -166.80767907202244, "episode_L2_reward_sum_mean": -147.72676837198435, "episode_L2_reward_sum_min": -223.13590919971466, "episode_L2_reward_sum_max": -118.16632403433323}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.10793287250373336, "policy_loss": 0.08247160510286505, "vf_loss": 0.2546126752212088, "vf_explained_var": 0.6410824735284832, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2044000, "num_env_steps_trained": 2044000, "num_agent_steps_sampled": 2044000, "num_agent_steps_trained": 2044000}, "sampler_results": {"episode_reward_max": -44.131711132365695, "episode_reward_min": -214.33942665866434, "episode_reward_mean": -92.35857111236777, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -282.63089202441273, "episode_L1_reward_sum_min": -590.6295767426491, "episode_L1_reward_sum_max": -166.80767907202244, "episode_L2_reward_sum_mean": -147.72676837198435, "episode_L2_reward_sum_min": -223.13590919971466, "episode_L2_reward_sum_max": -118.16632403433323}, "hist_stats": {"episode_reward": [-53.08356517949149, -52.813807367880955, -71.42125564886776, -107.13839231887455, -59.62389296954646, -50.13778365982059, -80.28531059823665, -103.5477467590279, -84.32312167660758, -58.3568078022281, -116.20876285537048, -110.49941270911508, -80.32157230032269, -82.36590331367974, -154.73243043568934, -86.66641675238226, -109.08284892950658, -66.07991277440082, -56.57537166398017, -100.26319436977583, -71.22741670144964, -104.01486820469921, -72.95432780317257, -180.03979981727724, -106.66433874684405, -114.78897107214178, -44.131711132365695, -92.00187482861922, -80.21001317521537, -169.68781155534458, -92.91908922362933, -63.9088931418059, -170.99866432763517, -137.7248329669305, -113.1327724318259, -63.76289737421357, -71.5843393734837, -64.82810892010609, -46.18493030456102, -77.34127682225544, -140.73009472032612, -157.433813823156, -72.86841563298921, -135.15043818902646, -54.28110692915294, -90.34704927497506, -131.405714388976, -48.97645319640299, -72.88520921822855, -90.64992814351457, -109.67516511543239, -72.11539076883658, -83.41885637355587, -86.58414911190894, -56.45854042471383, -79.71238061431082, -116.25321274000355, -90.79468940497121, -128.76194733841558, -75.17301640343948, -102.1360739915461, -78.82001692507296, -69.6412203983211, -56.55891472605132, -214.33942665866434, -126.21635177190409, -79.19127178168226, -113.02618433643858, -52.550634645213066, -169.85474770777682, -148.6339255339407, -90.70613370907658, -127.31616032875178, -49.210841607759825, -80.14398998932649, -110.80259606377125, -109.01889529192681, -125.20876328803043, -55.63162422357053, -74.9457000090834, -69.83402250888241, -57.237113120105, -100.65269771020625, -73.61268287006087, -67.54358739578, -87.63444662173694, -90.11059963575343, -141.3690673011639, -67.66504309086136, -52.659051510291995, -48.52177380794827, -58.858887008093525, -140.0317982881726, -76.0887395783668, -64.33812659332557, -70.01330629202639, -57.84296331512136, -57.1409416471575, -167.31634390531502, -138.1224262277833], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6098872400051427, "mean_inference_ms": 5.302121374431838, "mean_action_processing_ms": 0.19713661416265274, "mean_env_wait_ms": 1.3783299127723294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -44.131711132365695, "episode_reward_min": -214.33942665866434, "episode_reward_mean": -92.35857111236777, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-53.08356517949149, -52.813807367880955, -71.42125564886776, -107.13839231887455, -59.62389296954646, -50.13778365982059, -80.28531059823665, -103.5477467590279, -84.32312167660758, -58.3568078022281, -116.20876285537048, -110.49941270911508, -80.32157230032269, -82.36590331367974, -154.73243043568934, -86.66641675238226, -109.08284892950658, -66.07991277440082, -56.57537166398017, -100.26319436977583, -71.22741670144964, -104.01486820469921, -72.95432780317257, -180.03979981727724, -106.66433874684405, -114.78897107214178, -44.131711132365695, -92.00187482861922, -80.21001317521537, -169.68781155534458, -92.91908922362933, -63.9088931418059, -170.99866432763517, -137.7248329669305, -113.1327724318259, -63.76289737421357, -71.5843393734837, -64.82810892010609, -46.18493030456102, -77.34127682225544, -140.73009472032612, -157.433813823156, -72.86841563298921, -135.15043818902646, -54.28110692915294, -90.34704927497506, -131.405714388976, -48.97645319640299, -72.88520921822855, -90.64992814351457, -109.67516511543239, -72.11539076883658, -83.41885637355587, -86.58414911190894, -56.45854042471383, -79.71238061431082, -116.25321274000355, -90.79468940497121, -128.76194733841558, -75.17301640343948, -102.1360739915461, -78.82001692507296, -69.6412203983211, -56.55891472605132, -214.33942665866434, -126.21635177190409, -79.19127178168226, -113.02618433643858, -52.550634645213066, -169.85474770777682, -148.6339255339407, -90.70613370907658, -127.31616032875178, -49.210841607759825, -80.14398998932649, -110.80259606377125, -109.01889529192681, -125.20876328803043, -55.63162422357053, -74.9457000090834, -69.83402250888241, -57.237113120105, -100.65269771020625, -73.61268287006087, -67.54358739578, -87.63444662173694, -90.11059963575343, -141.3690673011639, -67.66504309086136, -52.659051510291995, -48.52177380794827, -58.858887008093525, -140.0317982881726, -76.0887395783668, -64.33812659332557, -70.01330629202639, -57.84296331512136, -57.1409416471575, -167.31634390531502, -138.1224262277833], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6098872400051427, "mean_inference_ms": 5.302121374431838, "mean_action_processing_ms": 0.19713661416265274, "mean_env_wait_ms": 1.3783299127723294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2044000, "num_agent_steps_trained": 2044000, "num_env_steps_sampled": 2044000, "num_env_steps_trained": 2044000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2044000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2044000, "timers": {"training_iteration_time_ms": 76808.909, "load_time_ms": 29.045, "load_throughput": 482015.262, "learn_time_ms": 68059.886, "learn_throughput": 205.701, "synch_weights_time_ms": 7.915}, "counters": {"num_env_steps_sampled": 2044000, "num_env_steps_trained": 2044000, "num_agent_steps_sampled": 2044000, "num_agent_steps_trained": 2044000}, "done": false, "episodes_total": 2044, "training_iteration": 146, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_15-59-50", "timestamp": 1693061990, "time_this_iter_s": 77.85351848602295, "time_total_s": 11139.692595005035, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015360CA0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270153094F0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 11139.692595005035, "timesteps_since_restore": 0, "iterations_since_restore": 146, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 22.80636363636364, "ram_util_percent": 50.968181818181826}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -295.3292678759247, "episode_L1_reward_sum_min": -590.6295767426491, "episode_L1_reward_sum_max": -165.65553538501263, "episode_L2_reward_sum_mean": -150.85995864726604, "episode_L2_reward_sum_min": -223.13590919971466, "episode_L2_reward_sum_max": -118.26956620812416}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.10897016041977292, "policy_loss": 0.07537662043761263, "vf_loss": 0.3359354046000818, "vf_explained_var": 0.7293994052358616, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2058000, "num_env_steps_trained": 2058000, "num_agent_steps_sampled": 2058000, "num_agent_steps_trained": 2058000}, "sampler_results": {"episode_reward_max": -44.131711132365695, "episode_reward_min": -214.33942665866434, "episode_reward_mean": -97.21561412615476, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -295.3292678759247, "episode_L1_reward_sum_min": -590.6295767426491, "episode_L1_reward_sum_max": -165.65553538501263, "episode_L2_reward_sum_mean": -150.85995864726604, "episode_L2_reward_sum_min": -223.13590919971466, "episode_L2_reward_sum_max": -118.26956620812416}, "hist_stats": {"episode_reward": [-154.73243043568934, -86.66641675238226, -109.08284892950658, -66.07991277440082, -56.57537166398017, -100.26319436977583, -71.22741670144964, -104.01486820469921, -72.95432780317257, -180.03979981727724, -106.66433874684405, -114.78897107214178, -44.131711132365695, -92.00187482861922, -80.21001317521537, -169.68781155534458, -92.91908922362933, -63.9088931418059, -170.99866432763517, -137.7248329669305, -113.1327724318259, -63.76289737421357, -71.5843393734837, -64.82810892010609, -46.18493030456102, -77.34127682225544, -140.73009472032612, -157.433813823156, -72.86841563298921, -135.15043818902646, -54.28110692915294, -90.34704927497506, -131.405714388976, -48.97645319640299, -72.88520921822855, -90.64992814351457, -109.67516511543239, -72.11539076883658, -83.41885637355587, -86.58414911190894, -56.45854042471383, -79.71238061431082, -116.25321274000355, -90.79468940497121, -128.76194733841558, -75.17301640343948, -102.1360739915461, -78.82001692507296, -69.6412203983211, -56.55891472605132, -214.33942665866434, -126.21635177190409, -79.19127178168226, -113.02618433643858, -52.550634645213066, -169.85474770777682, -148.6339255339407, -90.70613370907658, -127.31616032875178, -49.210841607759825, -80.14398998932649, -110.80259606377125, -109.01889529192681, -125.20876328803043, -55.63162422357053, -74.9457000090834, -69.83402250888241, -57.237113120105, -100.65269771020625, -73.61268287006087, -67.54358739578, -87.63444662173694, -90.11059963575343, -141.3690673011639, -67.66504309086136, -52.659051510291995, -48.52177380794827, -58.858887008093525, -140.0317982881726, -76.0887395783668, -64.33812659332557, -70.01330629202639, -57.84296331512136, -57.1409416471575, -167.31634390531502, -138.1224262277833, -110.7584741501544, -76.55385299272184, -78.27459157040762, -145.06633870544673, -55.773670866126494, -134.25669811162604, -155.39890104215613, -59.1021463065351, -120.10094798424319, -146.121909511532, -156.88134958277286, -118.2608331863756, -166.7142336493275, -72.56768887834414], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6102444658511371, "mean_inference_ms": 5.308827822935818, "mean_action_processing_ms": 0.19736361149581697, "mean_env_wait_ms": 1.3801384733609234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -44.131711132365695, "episode_reward_min": -214.33942665866434, "episode_reward_mean": -97.21561412615476, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154.73243043568934, -86.66641675238226, -109.08284892950658, -66.07991277440082, -56.57537166398017, -100.26319436977583, -71.22741670144964, -104.01486820469921, -72.95432780317257, -180.03979981727724, -106.66433874684405, -114.78897107214178, -44.131711132365695, -92.00187482861922, -80.21001317521537, -169.68781155534458, -92.91908922362933, -63.9088931418059, -170.99866432763517, -137.7248329669305, -113.1327724318259, -63.76289737421357, -71.5843393734837, -64.82810892010609, -46.18493030456102, -77.34127682225544, -140.73009472032612, -157.433813823156, -72.86841563298921, -135.15043818902646, -54.28110692915294, -90.34704927497506, -131.405714388976, -48.97645319640299, -72.88520921822855, -90.64992814351457, -109.67516511543239, -72.11539076883658, -83.41885637355587, -86.58414911190894, -56.45854042471383, -79.71238061431082, -116.25321274000355, -90.79468940497121, -128.76194733841558, -75.17301640343948, -102.1360739915461, -78.82001692507296, -69.6412203983211, -56.55891472605132, -214.33942665866434, -126.21635177190409, -79.19127178168226, -113.02618433643858, -52.550634645213066, -169.85474770777682, -148.6339255339407, -90.70613370907658, -127.31616032875178, -49.210841607759825, -80.14398998932649, -110.80259606377125, -109.01889529192681, -125.20876328803043, -55.63162422357053, -74.9457000090834, -69.83402250888241, -57.237113120105, -100.65269771020625, -73.61268287006087, -67.54358739578, -87.63444662173694, -90.11059963575343, -141.3690673011639, -67.66504309086136, -52.659051510291995, -48.52177380794827, -58.858887008093525, -140.0317982881726, -76.0887395783668, -64.33812659332557, -70.01330629202639, -57.84296331512136, -57.1409416471575, -167.31634390531502, -138.1224262277833, -110.7584741501544, -76.55385299272184, -78.27459157040762, -145.06633870544673, -55.773670866126494, -134.25669811162604, -155.39890104215613, -59.1021463065351, -120.10094798424319, -146.121909511532, -156.88134958277286, -118.2608331863756, -166.7142336493275, -72.56768887834414], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6102444658511371, "mean_inference_ms": 5.308827822935818, "mean_action_processing_ms": 0.19736361149581697, "mean_env_wait_ms": 1.3801384733609234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2058000, "num_agent_steps_trained": 2058000, "num_env_steps_sampled": 2058000, "num_env_steps_trained": 2058000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2058000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2058000, "timers": {"training_iteration_time_ms": 77013.552, "load_time_ms": 28.815, "load_throughput": 485861.155, "learn_time_ms": 68149.216, "learn_throughput": 205.432, "synch_weights_time_ms": 7.605}, "counters": {"num_env_steps_sampled": 2058000, "num_env_steps_trained": 2058000, "num_agent_steps_sampled": 2058000, "num_agent_steps_trained": 2058000}, "done": false, "episodes_total": 2058, "training_iteration": 147, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-01-09", "timestamp": 1693062069, "time_this_iter_s": 78.07910323143005, "time_total_s": 11217.771698236465, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150EF280>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701545EB80>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 11217.771698236465, "timesteps_since_restore": 0, "iterations_since_restore": 147, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 22.95363636363636, "ram_util_percent": 51.01818181818184}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -291.3437519776076, "episode_L1_reward_sum_min": -636.3106356263161, "episode_L1_reward_sum_max": -165.65553538501263, "episode_L2_reward_sum_mean": -149.79138317868114, "episode_L2_reward_sum_min": -232.59413377940655, "episode_L2_reward_sum_max": -118.26956620812416}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.09225827612801084, "policy_loss": 0.0704824244548421, "vf_loss": 0.21775850384802692, "vf_explained_var": 0.43862716222005615, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2072000, "num_env_steps_trained": 2072000, "num_agent_steps_sampled": 2072000, "num_agent_steps_trained": 2072000}, "sampler_results": {"episode_reward_max": -43.09889100113284, "episode_reward_min": -226.3786145604081, "episode_reward_mean": -95.15387247841254, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -291.3437519776076, "episode_L1_reward_sum_min": -636.3106356263161, "episode_L1_reward_sum_max": -165.65553538501263, "episode_L2_reward_sum_mean": -149.79138317868114, "episode_L2_reward_sum_min": -232.59413377940655, "episode_L2_reward_sum_max": -118.26956620812416}, "hist_stats": {"episode_reward": [-80.21001317521537, -169.68781155534458, -92.91908922362933, -63.9088931418059, -170.99866432763517, -137.7248329669305, -113.1327724318259, -63.76289737421357, -71.5843393734837, -64.82810892010609, -46.18493030456102, -77.34127682225544, -140.73009472032612, -157.433813823156, -72.86841563298921, -135.15043818902646, -54.28110692915294, -90.34704927497506, -131.405714388976, -48.97645319640299, -72.88520921822855, -90.64992814351457, -109.67516511543239, -72.11539076883658, -83.41885637355587, -86.58414911190894, -56.45854042471383, -79.71238061431082, -116.25321274000355, -90.79468940497121, -128.76194733841558, -75.17301640343948, -102.1360739915461, -78.82001692507296, -69.6412203983211, -56.55891472605132, -214.33942665866434, -126.21635177190409, -79.19127178168226, -113.02618433643858, -52.550634645213066, -169.85474770777682, -148.6339255339407, -90.70613370907658, -127.31616032875178, -49.210841607759825, -80.14398998932649, -110.80259606377125, -109.01889529192681, -125.20876328803043, -55.63162422357053, -74.9457000090834, -69.83402250888241, -57.237113120105, -100.65269771020625, -73.61268287006087, -67.54358739578, -87.63444662173694, -90.11059963575343, -141.3690673011639, -67.66504309086136, -52.659051510291995, -48.52177380794827, -58.858887008093525, -140.0317982881726, -76.0887395783668, -64.33812659332557, -70.01330629202639, -57.84296331512136, -57.1409416471575, -167.31634390531502, -138.1224262277833, -110.7584741501544, -76.55385299272184, -78.27459157040762, -145.06633870544673, -55.773670866126494, -134.25669811162604, -155.39890104215613, -59.1021463065351, -120.10094798424319, -146.121909511532, -156.88134958277286, -118.2608331863756, -166.7142336493275, -72.56768887834414, -64.31821908775085, -96.73670797235597, -82.33629785870875, -63.00215084506437, -68.99610146055512, -88.77446498407139, -57.98148365155396, -60.61435098224391, -43.09889100113284, -91.67795083925863, -76.50968329513356, -226.3786145604081, -55.65008118112543, -76.9743207387179], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6106239228664907, "mean_inference_ms": 5.316094741756558, "mean_action_processing_ms": 0.1976096802826181, "mean_env_wait_ms": 1.3821069877389078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -43.09889100113284, "episode_reward_min": -226.3786145604081, "episode_reward_mean": -95.15387247841254, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-80.21001317521537, -169.68781155534458, -92.91908922362933, -63.9088931418059, -170.99866432763517, -137.7248329669305, -113.1327724318259, -63.76289737421357, -71.5843393734837, -64.82810892010609, -46.18493030456102, -77.34127682225544, -140.73009472032612, -157.433813823156, -72.86841563298921, -135.15043818902646, -54.28110692915294, -90.34704927497506, -131.405714388976, -48.97645319640299, -72.88520921822855, -90.64992814351457, -109.67516511543239, -72.11539076883658, -83.41885637355587, -86.58414911190894, -56.45854042471383, -79.71238061431082, -116.25321274000355, -90.79468940497121, -128.76194733841558, -75.17301640343948, -102.1360739915461, -78.82001692507296, -69.6412203983211, -56.55891472605132, -214.33942665866434, -126.21635177190409, -79.19127178168226, -113.02618433643858, -52.550634645213066, -169.85474770777682, -148.6339255339407, -90.70613370907658, -127.31616032875178, -49.210841607759825, -80.14398998932649, -110.80259606377125, -109.01889529192681, -125.20876328803043, -55.63162422357053, -74.9457000090834, -69.83402250888241, -57.237113120105, -100.65269771020625, -73.61268287006087, -67.54358739578, -87.63444662173694, -90.11059963575343, -141.3690673011639, -67.66504309086136, -52.659051510291995, -48.52177380794827, -58.858887008093525, -140.0317982881726, -76.0887395783668, -64.33812659332557, -70.01330629202639, -57.84296331512136, -57.1409416471575, -167.31634390531502, -138.1224262277833, -110.7584741501544, -76.55385299272184, -78.27459157040762, -145.06633870544673, -55.773670866126494, -134.25669811162604, -155.39890104215613, -59.1021463065351, -120.10094798424319, -146.121909511532, -156.88134958277286, -118.2608331863756, -166.7142336493275, -72.56768887834414, -64.31821908775085, -96.73670797235597, -82.33629785870875, -63.00215084506437, -68.99610146055512, -88.77446498407139, -57.98148365155396, -60.61435098224391, -43.09889100113284, -91.67795083925863, -76.50968329513356, -226.3786145604081, -55.65008118112543, -76.9743207387179], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6106239228664907, "mean_inference_ms": 5.316094741756558, "mean_action_processing_ms": 0.1976096802826181, "mean_env_wait_ms": 1.3821069877389078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2072000, "num_agent_steps_trained": 2072000, "num_env_steps_sampled": 2072000, "num_env_steps_trained": 2072000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2072000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2072000, "timers": {"training_iteration_time_ms": 77209.512, "load_time_ms": 28.809, "load_throughput": 485956.047, "learn_time_ms": 68216.962, "learn_throughput": 205.228, "synch_weights_time_ms": 7.711}, "counters": {"num_env_steps_sampled": 2072000, "num_env_steps_trained": 2072000, "num_agent_steps_sampled": 2072000, "num_agent_steps_trained": 2072000}, "done": false, "episodes_total": 2072, "training_iteration": 148, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-02-27", "timestamp": 1693062147, "time_this_iter_s": 78.11363387107849, "time_total_s": 11295.885332107544, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015360EE0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270152CF340>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 11295.885332107544, "timesteps_since_restore": 0, "iterations_since_restore": 148, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 23.213513513513515, "ram_util_percent": 51.020720720720746}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -284.4809187808633, "episode_L1_reward_sum_min": -636.3106356263161, "episode_L1_reward_sum_max": -165.65553538501263, "episode_L2_reward_sum_mean": -148.10458579495548, "episode_L2_reward_sum_min": -232.59413377940655, "episode_L2_reward_sum_max": -118.26956620812416}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.09784495707844679, "policy_loss": 0.07347609148929811, "vf_loss": 0.24368865563235848, "vf_explained_var": 0.6355108379581829, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2086000, "num_env_steps_trained": 2086000, "num_agent_steps_sampled": 2086000, "num_agent_steps_trained": 2086000}, "sampler_results": {"episode_reward_max": -43.09889100113284, "episode_reward_min": -226.3786145604081, "episode_reward_mean": -92.82940975174088, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -284.4809187808633, "episode_L1_reward_sum_min": -636.3106356263161, "episode_L1_reward_sum_max": -165.65553538501263, "episode_L2_reward_sum_mean": -148.10458579495548, "episode_L2_reward_sum_min": -232.59413377940655, "episode_L2_reward_sum_max": -118.26956620812416}, "hist_stats": {"episode_reward": [-72.86841563298921, -135.15043818902646, -54.28110692915294, -90.34704927497506, -131.405714388976, -48.97645319640299, -72.88520921822855, -90.64992814351457, -109.67516511543239, -72.11539076883658, -83.41885637355587, -86.58414911190894, -56.45854042471383, -79.71238061431082, -116.25321274000355, -90.79468940497121, -128.76194733841558, -75.17301640343948, -102.1360739915461, -78.82001692507296, -69.6412203983211, -56.55891472605132, -214.33942665866434, -126.21635177190409, -79.19127178168226, -113.02618433643858, -52.550634645213066, -169.85474770777682, -148.6339255339407, -90.70613370907658, -127.31616032875178, -49.210841607759825, -80.14398998932649, -110.80259606377125, -109.01889529192681, -125.20876328803043, -55.63162422357053, -74.9457000090834, -69.83402250888241, -57.237113120105, -100.65269771020625, -73.61268287006087, -67.54358739578, -87.63444662173694, -90.11059963575343, -141.3690673011639, -67.66504309086136, -52.659051510291995, -48.52177380794827, -58.858887008093525, -140.0317982881726, -76.0887395783668, -64.33812659332557, -70.01330629202639, -57.84296331512136, -57.1409416471575, -167.31634390531502, -138.1224262277833, -110.7584741501544, -76.55385299272184, -78.27459157040762, -145.06633870544673, -55.773670866126494, -134.25669811162604, -155.39890104215613, -59.1021463065351, -120.10094798424319, -146.121909511532, -156.88134958277286, -118.2608331863756, -166.7142336493275, -72.56768887834414, -64.31821908775085, -96.73670797235597, -82.33629785870875, -63.00215084506437, -68.99610146055512, -88.77446498407139, -57.98148365155396, -60.61435098224391, -43.09889100113284, -91.67795083925863, -76.50968329513356, -226.3786145604081, -55.65008118112543, -76.9743207387179, -58.252088486689615, -100.13542195452449, -55.61503663181175, -161.66460631907913, -112.71924229340138, -44.147763249483376, -101.90447694351883, -94.57337578450961, -68.26971171996858, -86.56090183349674, -143.73633316928294, -62.767983121645024, -59.66792237775005, -67.98640160816024], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6110844983921148, "mean_inference_ms": 5.324118949226566, "mean_action_processing_ms": 0.19787637687665047, "mean_env_wait_ms": 1.3842782537648515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -43.09889100113284, "episode_reward_min": -226.3786145604081, "episode_reward_mean": -92.82940975174088, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-72.86841563298921, -135.15043818902646, -54.28110692915294, -90.34704927497506, -131.405714388976, -48.97645319640299, -72.88520921822855, -90.64992814351457, -109.67516511543239, -72.11539076883658, -83.41885637355587, -86.58414911190894, -56.45854042471383, -79.71238061431082, -116.25321274000355, -90.79468940497121, -128.76194733841558, -75.17301640343948, -102.1360739915461, -78.82001692507296, -69.6412203983211, -56.55891472605132, -214.33942665866434, -126.21635177190409, -79.19127178168226, -113.02618433643858, -52.550634645213066, -169.85474770777682, -148.6339255339407, -90.70613370907658, -127.31616032875178, -49.210841607759825, -80.14398998932649, -110.80259606377125, -109.01889529192681, -125.20876328803043, -55.63162422357053, -74.9457000090834, -69.83402250888241, -57.237113120105, -100.65269771020625, -73.61268287006087, -67.54358739578, -87.63444662173694, -90.11059963575343, -141.3690673011639, -67.66504309086136, -52.659051510291995, -48.52177380794827, -58.858887008093525, -140.0317982881726, -76.0887395783668, -64.33812659332557, -70.01330629202639, -57.84296331512136, -57.1409416471575, -167.31634390531502, -138.1224262277833, -110.7584741501544, -76.55385299272184, -78.27459157040762, -145.06633870544673, -55.773670866126494, -134.25669811162604, -155.39890104215613, -59.1021463065351, -120.10094798424319, -146.121909511532, -156.88134958277286, -118.2608331863756, -166.7142336493275, -72.56768887834414, -64.31821908775085, -96.73670797235597, -82.33629785870875, -63.00215084506437, -68.99610146055512, -88.77446498407139, -57.98148365155396, -60.61435098224391, -43.09889100113284, -91.67795083925863, -76.50968329513356, -226.3786145604081, -55.65008118112543, -76.9743207387179, -58.252088486689615, -100.13542195452449, -55.61503663181175, -161.66460631907913, -112.71924229340138, -44.147763249483376, -101.90447694351883, -94.57337578450961, -68.26971171996858, -86.56090183349674, -143.73633316928294, -62.767983121645024, -59.66792237775005, -67.98640160816024], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6110844983921148, "mean_inference_ms": 5.324118949226566, "mean_action_processing_ms": 0.19787637687665047, "mean_env_wait_ms": 1.3842782537648515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2086000, "num_agent_steps_trained": 2086000, "num_env_steps_sampled": 2086000, "num_env_steps_trained": 2086000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2086000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2086000, "timers": {"training_iteration_time_ms": 77455.825, "load_time_ms": 28.882, "load_throughput": 484738.129, "learn_time_ms": 68305.473, "learn_throughput": 204.962, "synch_weights_time_ms": 7.896}, "counters": {"num_env_steps_sampled": 2086000, "num_env_steps_trained": 2086000, "num_agent_steps_sampled": 2086000, "num_agent_steps_trained": 2086000}, "done": false, "episodes_total": 2086, "training_iteration": 149, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-03-46", "timestamp": 1693062226, "time_this_iter_s": 78.59373259544373, "time_total_s": 11374.479064702988, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014F11700>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701545E7F0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 11374.479064702988, "timesteps_since_restore": 0, "iterations_since_restore": 149, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 23.915315315315315, "ram_util_percent": 51.66576576576576}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -275.79542247012256, "episode_L1_reward_sum_min": -636.3106356263161, "episode_L1_reward_sum_max": -157.79837699234486, "episode_L2_reward_sum_mean": -145.91920321449638, "episode_L2_reward_sum_min": -232.59413377940655, "episode_L2_reward_sum_max": -115.73878490924835}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.09139745751752254, "policy_loss": 0.07671296476422897, "vf_loss": 0.14684492038751967, "vf_explained_var": 0.43927064274318917, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2100000, "num_env_steps_trained": 2100000, "num_agent_steps_sampled": 2100000, "num_agent_steps_trained": 2100000}, "sampler_results": {"episode_reward_max": -26.7841767490662, "episode_reward_min": -226.3786145604081, "episode_reward_mean": -89.7863413796946, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -275.79542247012256, "episode_L1_reward_sum_min": -636.3106356263161, "episode_L1_reward_sum_max": -157.79837699234486, "episode_L2_reward_sum_mean": -145.91920321449638, "episode_L2_reward_sum_min": -232.59413377940655, "episode_L2_reward_sum_max": -115.73878490924835}, "hist_stats": {"episode_reward": [-116.25321274000355, -90.79468940497121, -128.76194733841558, -75.17301640343948, -102.1360739915461, -78.82001692507296, -69.6412203983211, -56.55891472605132, -214.33942665866434, -126.21635177190409, -79.19127178168226, -113.02618433643858, -52.550634645213066, -169.85474770777682, -148.6339255339407, -90.70613370907658, -127.31616032875178, -49.210841607759825, -80.14398998932649, -110.80259606377125, -109.01889529192681, -125.20876328803043, -55.63162422357053, -74.9457000090834, -69.83402250888241, -57.237113120105, -100.65269771020625, -73.61268287006087, -67.54358739578, -87.63444662173694, -90.11059963575343, -141.3690673011639, -67.66504309086136, -52.659051510291995, -48.52177380794827, -58.858887008093525, -140.0317982881726, -76.0887395783668, -64.33812659332557, -70.01330629202639, -57.84296331512136, -57.1409416471575, -167.31634390531502, -138.1224262277833, -110.7584741501544, -76.55385299272184, -78.27459157040762, -145.06633870544673, -55.773670866126494, -134.25669811162604, -155.39890104215613, -59.1021463065351, -120.10094798424319, -146.121909511532, -156.88134958277286, -118.2608331863756, -166.7142336493275, -72.56768887834414, -64.31821908775085, -96.73670797235597, -82.33629785870875, -63.00215084506437, -68.99610146055512, -88.77446498407139, -57.98148365155396, -60.61435098224391, -43.09889100113284, -91.67795083925863, -76.50968329513356, -226.3786145604081, -55.65008118112543, -76.9743207387179, -58.252088486689615, -100.13542195452449, -55.61503663181175, -161.66460631907913, -112.71924229340138, -44.147763249483376, -101.90447694351883, -94.57337578450961, -68.26971171996858, -86.56090183349674, -143.73633316928294, -62.767983121645024, -59.66792237775005, -67.98640160816024, -40.0252992536906, -58.59124442755079, -26.7841767490662, -63.2674711547999, -98.18640241836314, -55.50839454166538, -75.62946483999093, -87.89062710930905, -27.206575477213956, -42.59980326386349, -50.07342122882469, -68.3468516732209, -92.8490211560081, -93.2632068838299], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.611580861606845, "mean_inference_ms": 5.33289923085977, "mean_action_processing_ms": 0.198172860298892, "mean_env_wait_ms": 1.3866699862881324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -26.7841767490662, "episode_reward_min": -226.3786145604081, "episode_reward_mean": -89.7863413796946, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-116.25321274000355, -90.79468940497121, -128.76194733841558, -75.17301640343948, -102.1360739915461, -78.82001692507296, -69.6412203983211, -56.55891472605132, -214.33942665866434, -126.21635177190409, -79.19127178168226, -113.02618433643858, -52.550634645213066, -169.85474770777682, -148.6339255339407, -90.70613370907658, -127.31616032875178, -49.210841607759825, -80.14398998932649, -110.80259606377125, -109.01889529192681, -125.20876328803043, -55.63162422357053, -74.9457000090834, -69.83402250888241, -57.237113120105, -100.65269771020625, -73.61268287006087, -67.54358739578, -87.63444662173694, -90.11059963575343, -141.3690673011639, -67.66504309086136, -52.659051510291995, -48.52177380794827, -58.858887008093525, -140.0317982881726, -76.0887395783668, -64.33812659332557, -70.01330629202639, -57.84296331512136, -57.1409416471575, -167.31634390531502, -138.1224262277833, -110.7584741501544, -76.55385299272184, -78.27459157040762, -145.06633870544673, -55.773670866126494, -134.25669811162604, -155.39890104215613, -59.1021463065351, -120.10094798424319, -146.121909511532, -156.88134958277286, -118.2608331863756, -166.7142336493275, -72.56768887834414, -64.31821908775085, -96.73670797235597, -82.33629785870875, -63.00215084506437, -68.99610146055512, -88.77446498407139, -57.98148365155396, -60.61435098224391, -43.09889100113284, -91.67795083925863, -76.50968329513356, -226.3786145604081, -55.65008118112543, -76.9743207387179, -58.252088486689615, -100.13542195452449, -55.61503663181175, -161.66460631907913, -112.71924229340138, -44.147763249483376, -101.90447694351883, -94.57337578450961, -68.26971171996858, -86.56090183349674, -143.73633316928294, -62.767983121645024, -59.66792237775005, -67.98640160816024, -40.0252992536906, -58.59124442755079, -26.7841767490662, -63.2674711547999, -98.18640241836314, -55.50839454166538, -75.62946483999093, -87.89062710930905, -27.206575477213956, -42.59980326386349, -50.07342122882469, -68.3468516732209, -92.8490211560081, -93.2632068838299], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.611580861606845, "mean_inference_ms": 5.33289923085977, "mean_action_processing_ms": 0.198172860298892, "mean_env_wait_ms": 1.3866699862881324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2100000, "num_agent_steps_trained": 2100000, "num_env_steps_sampled": 2100000, "num_env_steps_trained": 2100000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2100000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2100000, "timers": {"training_iteration_time_ms": 77704.543, "load_time_ms": 29.271, "load_throughput": 478285.478, "learn_time_ms": 68386.323, "learn_throughput": 204.719, "synch_weights_time_ms": 7.796}, "counters": {"num_env_steps_sampled": 2100000, "num_env_steps_trained": 2100000, "num_agent_steps_sampled": 2100000, "num_agent_steps_trained": 2100000}, "done": false, "episodes_total": 2100, "training_iteration": 150, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-05-05", "timestamp": 1693062305, "time_this_iter_s": 78.88659572601318, "time_total_s": 11453.365660429, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701555F220>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270151C0FA0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 11453.365660429, "timesteps_since_restore": 0, "iterations_since_restore": 150, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 23.514285714285716, "ram_util_percent": 51.683928571428574}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -266.94722547359765, "episode_L1_reward_sum_min": -636.3106356263161, "episode_L1_reward_sum_max": -157.79837699234486, "episode_L2_reward_sum_mean": -143.69751352690162, "episode_L2_reward_sum_min": -232.59413377940655, "episode_L2_reward_sum_max": -115.73878490924835}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.11587194024289119, "policy_loss": 0.09439892026355276, "vf_loss": 0.21473019592187745, "vf_explained_var": 0.5585944940769133, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2114000, "num_env_steps_trained": 2114000, "num_agent_steps_sampled": 2114000, "num_agent_steps_trained": 2114000}, "sampler_results": {"episode_reward_max": -26.7841767490662, "episode_reward_min": -226.3786145604081, "episode_reward_mean": -86.06078323159915, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -266.94722547359765, "episode_L1_reward_sum_min": -636.3106356263161, "episode_L1_reward_sum_max": -157.79837699234486, "episode_L2_reward_sum_mean": -143.69751352690162, "episode_L2_reward_sum_min": -232.59413377940655, "episode_L2_reward_sum_max": -115.73878490924835}, "hist_stats": {"episode_reward": [-148.6339255339407, -90.70613370907658, -127.31616032875178, -49.210841607759825, -80.14398998932649, -110.80259606377125, -109.01889529192681, -125.20876328803043, -55.63162422357053, -74.9457000090834, -69.83402250888241, -57.237113120105, -100.65269771020625, -73.61268287006087, -67.54358739578, -87.63444662173694, -90.11059963575343, -141.3690673011639, -67.66504309086136, -52.659051510291995, -48.52177380794827, -58.858887008093525, -140.0317982881726, -76.0887395783668, -64.33812659332557, -70.01330629202639, -57.84296331512136, -57.1409416471575, -167.31634390531502, -138.1224262277833, -110.7584741501544, -76.55385299272184, -78.27459157040762, -145.06633870544673, -55.773670866126494, -134.25669811162604, -155.39890104215613, -59.1021463065351, -120.10094798424319, -146.121909511532, -156.88134958277286, -118.2608331863756, -166.7142336493275, -72.56768887834414, -64.31821908775085, -96.73670797235597, -82.33629785870875, -63.00215084506437, -68.99610146055512, -88.77446498407139, -57.98148365155396, -60.61435098224391, -43.09889100113284, -91.67795083925863, -76.50968329513356, -226.3786145604081, -55.65008118112543, -76.9743207387179, -58.252088486689615, -100.13542195452449, -55.61503663181175, -161.66460631907913, -112.71924229340138, -44.147763249483376, -101.90447694351883, -94.57337578450961, -68.26971171996858, -86.56090183349674, -143.73633316928294, -62.767983121645024, -59.66792237775005, -67.98640160816024, -40.0252992536906, -58.59124442755079, -26.7841767490662, -63.2674711547999, -98.18640241836314, -55.50839454166538, -75.62946483999093, -87.89062710930905, -27.206575477213956, -42.59980326386349, -50.07342122882469, -68.3468516732209, -92.8490211560081, -93.2632068838299, -126.98997564177947, -73.97092904444203, -87.15226128491975, -71.89949424391041, -61.40745990933676, -60.27640152743444, -96.23031047037958, -70.0919706666556, -54.63552893967845, -77.05339264413792, -56.56865874171816, -55.469977462322426, -163.55935557146705, -45.45617787177299], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6121177189226081, "mean_inference_ms": 5.342282097181287, "mean_action_processing_ms": 0.1984844490381164, "mean_env_wait_ms": 1.3892295214430288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -26.7841767490662, "episode_reward_min": -226.3786145604081, "episode_reward_mean": -86.06078323159915, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-148.6339255339407, -90.70613370907658, -127.31616032875178, -49.210841607759825, -80.14398998932649, -110.80259606377125, -109.01889529192681, -125.20876328803043, -55.63162422357053, -74.9457000090834, -69.83402250888241, -57.237113120105, -100.65269771020625, -73.61268287006087, -67.54358739578, -87.63444662173694, -90.11059963575343, -141.3690673011639, -67.66504309086136, -52.659051510291995, -48.52177380794827, -58.858887008093525, -140.0317982881726, -76.0887395783668, -64.33812659332557, -70.01330629202639, -57.84296331512136, -57.1409416471575, -167.31634390531502, -138.1224262277833, -110.7584741501544, -76.55385299272184, -78.27459157040762, -145.06633870544673, -55.773670866126494, -134.25669811162604, -155.39890104215613, -59.1021463065351, -120.10094798424319, -146.121909511532, -156.88134958277286, -118.2608331863756, -166.7142336493275, -72.56768887834414, -64.31821908775085, -96.73670797235597, -82.33629785870875, -63.00215084506437, -68.99610146055512, -88.77446498407139, -57.98148365155396, -60.61435098224391, -43.09889100113284, -91.67795083925863, -76.50968329513356, -226.3786145604081, -55.65008118112543, -76.9743207387179, -58.252088486689615, -100.13542195452449, -55.61503663181175, -161.66460631907913, -112.71924229340138, -44.147763249483376, -101.90447694351883, -94.57337578450961, -68.26971171996858, -86.56090183349674, -143.73633316928294, -62.767983121645024, -59.66792237775005, -67.98640160816024, -40.0252992536906, -58.59124442755079, -26.7841767490662, -63.2674711547999, -98.18640241836314, -55.50839454166538, -75.62946483999093, -87.89062710930905, -27.206575477213956, -42.59980326386349, -50.07342122882469, -68.3468516732209, -92.8490211560081, -93.2632068838299, -126.98997564177947, -73.97092904444203, -87.15226128491975, -71.89949424391041, -61.40745990933676, -60.27640152743444, -96.23031047037958, -70.0919706666556, -54.63552893967845, -77.05339264413792, -56.56865874171816, -55.469977462322426, -163.55935557146705, -45.45617787177299], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6121177189226081, "mean_inference_ms": 5.342282097181287, "mean_action_processing_ms": 0.1984844490381164, "mean_env_wait_ms": 1.3892295214430288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2114000, "num_agent_steps_trained": 2114000, "num_env_steps_sampled": 2114000, "num_env_steps_trained": 2114000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2114000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2114000, "timers": {"training_iteration_time_ms": 77919.129, "load_time_ms": 29.675, "load_throughput": 471774.449, "learn_time_ms": 68464.647, "learn_throughput": 204.485, "synch_weights_time_ms": 7.703}, "counters": {"num_env_steps_sampled": 2114000, "num_env_steps_trained": 2114000, "num_agent_steps_sampled": 2114000, "num_agent_steps_trained": 2114000}, "done": false, "episodes_total": 2114, "training_iteration": 151, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-06-23", "timestamp": 1693062383, "time_this_iter_s": 78.83585715293884, "time_total_s": 11532.20151758194, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270153A5580>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270153599D0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 11532.20151758194, "timesteps_since_restore": 0, "iterations_since_restore": 151, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 23.91339285714286, "ram_util_percent": 51.76249999999999}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -264.40740622408686, "episode_L1_reward_sum_min": -636.3106356263161, "episode_L1_reward_sum_max": -157.79837699234486, "episode_L2_reward_sum_mean": -143.03290069423616, "episode_L2_reward_sum_min": -232.59413377940655, "episode_L2_reward_sum_max": -115.73878490924835}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.12581804536067193, "policy_loss": 0.10295183141284657, "vf_loss": 0.22866212591224158, "vf_explained_var": 0.5173463081565414, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2128000, "num_env_steps_trained": 2128000, "num_agent_steps_sampled": 2128000, "num_agent_steps_trained": 2128000}, "sampler_results": {"episode_reward_max": -26.7841767490662, "episode_reward_min": -226.3786145604081, "episode_reward_mean": -84.08051851831469, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -264.40740622408686, "episode_L1_reward_sum_min": -636.3106356263161, "episode_L1_reward_sum_max": -157.79837699234486, "episode_L2_reward_sum_mean": -143.03290069423616, "episode_L2_reward_sum_min": -232.59413377940655, "episode_L2_reward_sum_max": -115.73878490924835}, "hist_stats": {"episode_reward": [-67.54358739578, -87.63444662173694, -90.11059963575343, -141.3690673011639, -67.66504309086136, -52.659051510291995, -48.52177380794827, -58.858887008093525, -140.0317982881726, -76.0887395783668, -64.33812659332557, -70.01330629202639, -57.84296331512136, -57.1409416471575, -167.31634390531502, -138.1224262277833, -110.7584741501544, -76.55385299272184, -78.27459157040762, -145.06633870544673, -55.773670866126494, -134.25669811162604, -155.39890104215613, -59.1021463065351, -120.10094798424319, -146.121909511532, -156.88134958277286, -118.2608331863756, -166.7142336493275, -72.56768887834414, -64.31821908775085, -96.73670797235597, -82.33629785870875, -63.00215084506437, -68.99610146055512, -88.77446498407139, -57.98148365155396, -60.61435098224391, -43.09889100113284, -91.67795083925863, -76.50968329513356, -226.3786145604081, -55.65008118112543, -76.9743207387179, -58.252088486689615, -100.13542195452449, -55.61503663181175, -161.66460631907913, -112.71924229340138, -44.147763249483376, -101.90447694351883, -94.57337578450961, -68.26971171996858, -86.56090183349674, -143.73633316928294, -62.767983121645024, -59.66792237775005, -67.98640160816024, -40.0252992536906, -58.59124442755079, -26.7841767490662, -63.2674711547999, -98.18640241836314, -55.50839454166538, -75.62946483999093, -87.89062710930905, -27.206575477213956, -42.59980326386349, -50.07342122882469, -68.3468516732209, -92.8490211560081, -93.2632068838299, -126.98997564177947, -73.97092904444203, -87.15226128491975, -71.89949424391041, -61.40745990933676, -60.27640152743444, -96.23031047037958, -70.0919706666556, -54.63552893967845, -77.05339264413792, -56.56865874171816, -55.469977462322426, -163.55935557146705, -45.45617787177299, -43.84983611561585, -60.44487287865137, -80.15459456340541, -60.9318184642031, -51.24968454803764, -73.10748159393444, -44.891233430591214, -157.94629472085194, -63.20194917274677, -58.498840731378046, -79.26123428595243, -83.40517601929113, -159.18576368191853, -58.79989471947018], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6126840839685527, "mean_inference_ms": 5.352120023831196, "mean_action_processing_ms": 0.19881994283232124, "mean_env_wait_ms": 1.391899087775469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -26.7841767490662, "episode_reward_min": -226.3786145604081, "episode_reward_mean": -84.08051851831469, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-67.54358739578, -87.63444662173694, -90.11059963575343, -141.3690673011639, -67.66504309086136, -52.659051510291995, -48.52177380794827, -58.858887008093525, -140.0317982881726, -76.0887395783668, -64.33812659332557, -70.01330629202639, -57.84296331512136, -57.1409416471575, -167.31634390531502, -138.1224262277833, -110.7584741501544, -76.55385299272184, -78.27459157040762, -145.06633870544673, -55.773670866126494, -134.25669811162604, -155.39890104215613, -59.1021463065351, -120.10094798424319, -146.121909511532, -156.88134958277286, -118.2608331863756, -166.7142336493275, -72.56768887834414, -64.31821908775085, -96.73670797235597, -82.33629785870875, -63.00215084506437, -68.99610146055512, -88.77446498407139, -57.98148365155396, -60.61435098224391, -43.09889100113284, -91.67795083925863, -76.50968329513356, -226.3786145604081, -55.65008118112543, -76.9743207387179, -58.252088486689615, -100.13542195452449, -55.61503663181175, -161.66460631907913, -112.71924229340138, -44.147763249483376, -101.90447694351883, -94.57337578450961, -68.26971171996858, -86.56090183349674, -143.73633316928294, -62.767983121645024, -59.66792237775005, -67.98640160816024, -40.0252992536906, -58.59124442755079, -26.7841767490662, -63.2674711547999, -98.18640241836314, -55.50839454166538, -75.62946483999093, -87.89062710930905, -27.206575477213956, -42.59980326386349, -50.07342122882469, -68.3468516732209, -92.8490211560081, -93.2632068838299, -126.98997564177947, -73.97092904444203, -87.15226128491975, -71.89949424391041, -61.40745990933676, -60.27640152743444, -96.23031047037958, -70.0919706666556, -54.63552893967845, -77.05339264413792, -56.56865874171816, -55.469977462322426, -163.55935557146705, -45.45617787177299, -43.84983611561585, -60.44487287865137, -80.15459456340541, -60.9318184642031, -51.24968454803764, -73.10748159393444, -44.891233430591214, -157.94629472085194, -63.20194917274677, -58.498840731378046, -79.26123428595243, -83.40517601929113, -159.18576368191853, -58.79989471947018], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6126840839685527, "mean_inference_ms": 5.352120023831196, "mean_action_processing_ms": 0.19881994283232124, "mean_env_wait_ms": 1.391899087775469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2128000, "num_agent_steps_trained": 2128000, "num_env_steps_sampled": 2128000, "num_env_steps_trained": 2128000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2128000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2128000, "timers": {"training_iteration_time_ms": 78114.393, "load_time_ms": 29.174, "load_throughput": 479879.834, "learn_time_ms": 68527.467, "learn_throughput": 204.298, "synch_weights_time_ms": 7.711}, "counters": {"num_env_steps_sampled": 2128000, "num_env_steps_trained": 2128000, "num_agent_steps_sampled": 2128000, "num_agent_steps_trained": 2128000}, "done": false, "episodes_total": 2128, "training_iteration": 152, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-07-42", "timestamp": 1693062462, "time_this_iter_s": 78.88262414932251, "time_total_s": 11611.084141731262, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701555F730>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015311A30>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 11611.084141731262, "timesteps_since_restore": 0, "iterations_since_restore": 152, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 23.336936936936933, "ram_util_percent": 51.506306306306314}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -268.4662420988828, "episode_L1_reward_sum_min": -636.3106356263161, "episode_L1_reward_sum_max": -157.79837699234486, "episode_L2_reward_sum_mean": -144.0475228963047, "episode_L2_reward_sum_min": -232.59413377940655, "episode_L2_reward_sum_max": -115.73878490924835}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.1328753948555646, "policy_loss": 0.10409054457719741, "vf_loss": 0.28784852741844563, "vf_explained_var": 0.5960293903088374, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2142000, "num_env_steps_trained": 2142000, "num_agent_steps_sampled": 2142000, "num_agent_steps_trained": 2142000}, "sampler_results": {"episode_reward_max": -26.7841767490662, "episode_reward_min": -226.3786145604081, "episode_reward_mean": -86.3730802164148, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -268.4662420988828, "episode_L1_reward_sum_min": -636.3106356263161, "episode_L1_reward_sum_max": -157.79837699234486, "episode_L2_reward_sum_mean": -144.0475228963047, "episode_L2_reward_sum_min": -232.59413377940655, "episode_L2_reward_sum_max": -115.73878490924835}, "hist_stats": {"episode_reward": [-167.31634390531502, -138.1224262277833, -110.7584741501544, -76.55385299272184, -78.27459157040762, -145.06633870544673, -55.773670866126494, -134.25669811162604, -155.39890104215613, -59.1021463065351, -120.10094798424319, -146.121909511532, -156.88134958277286, -118.2608331863756, -166.7142336493275, -72.56768887834414, -64.31821908775085, -96.73670797235597, -82.33629785870875, -63.00215084506437, -68.99610146055512, -88.77446498407139, -57.98148365155396, -60.61435098224391, -43.09889100113284, -91.67795083925863, -76.50968329513356, -226.3786145604081, -55.65008118112543, -76.9743207387179, -58.252088486689615, -100.13542195452449, -55.61503663181175, -161.66460631907913, -112.71924229340138, -44.147763249483376, -101.90447694351883, -94.57337578450961, -68.26971171996858, -86.56090183349674, -143.73633316928294, -62.767983121645024, -59.66792237775005, -67.98640160816024, -40.0252992536906, -58.59124442755079, -26.7841767490662, -63.2674711547999, -98.18640241836314, -55.50839454166538, -75.62946483999093, -87.89062710930905, -27.206575477213956, -42.59980326386349, -50.07342122882469, -68.3468516732209, -92.8490211560081, -93.2632068838299, -126.98997564177947, -73.97092904444203, -87.15226128491975, -71.89949424391041, -61.40745990933676, -60.27640152743444, -96.23031047037958, -70.0919706666556, -54.63552893967845, -77.05339264413792, -56.56865874171816, -55.469977462322426, -163.55935557146705, -45.45617787177299, -43.84983611561585, -60.44487287865137, -80.15459456340541, -60.9318184642031, -51.24968454803764, -73.10748159393444, -44.891233430591214, -157.94629472085194, -63.20194917274677, -58.498840731378046, -79.26123428595243, -83.40517601929113, -159.18576368191853, -58.79989471947018, -69.58615190744686, -69.10875014758096, -64.13264575963962, -76.82646463986559, -77.45892451660366, -71.62269277027198, -83.60359347674287, -117.85648880791466, -100.3016723640309, -108.69685235135324, -222.653461191646, -81.95341870831379, -63.256398170904006, -102.01698708349484], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6132593146652995, "mean_inference_ms": 5.362316846397566, "mean_action_processing_ms": 0.1991762081200674, "mean_env_wait_ms": 1.394667093183081, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -26.7841767490662, "episode_reward_min": -226.3786145604081, "episode_reward_mean": -86.3730802164148, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-167.31634390531502, -138.1224262277833, -110.7584741501544, -76.55385299272184, -78.27459157040762, -145.06633870544673, -55.773670866126494, -134.25669811162604, -155.39890104215613, -59.1021463065351, -120.10094798424319, -146.121909511532, -156.88134958277286, -118.2608331863756, -166.7142336493275, -72.56768887834414, -64.31821908775085, -96.73670797235597, -82.33629785870875, -63.00215084506437, -68.99610146055512, -88.77446498407139, -57.98148365155396, -60.61435098224391, -43.09889100113284, -91.67795083925863, -76.50968329513356, -226.3786145604081, -55.65008118112543, -76.9743207387179, -58.252088486689615, -100.13542195452449, -55.61503663181175, -161.66460631907913, -112.71924229340138, -44.147763249483376, -101.90447694351883, -94.57337578450961, -68.26971171996858, -86.56090183349674, -143.73633316928294, -62.767983121645024, -59.66792237775005, -67.98640160816024, -40.0252992536906, -58.59124442755079, -26.7841767490662, -63.2674711547999, -98.18640241836314, -55.50839454166538, -75.62946483999093, -87.89062710930905, -27.206575477213956, -42.59980326386349, -50.07342122882469, -68.3468516732209, -92.8490211560081, -93.2632068838299, -126.98997564177947, -73.97092904444203, -87.15226128491975, -71.89949424391041, -61.40745990933676, -60.27640152743444, -96.23031047037958, -70.0919706666556, -54.63552893967845, -77.05339264413792, -56.56865874171816, -55.469977462322426, -163.55935557146705, -45.45617787177299, -43.84983611561585, -60.44487287865137, -80.15459456340541, -60.9318184642031, -51.24968454803764, -73.10748159393444, -44.891233430591214, -157.94629472085194, -63.20194917274677, -58.498840731378046, -79.26123428595243, -83.40517601929113, -159.18576368191853, -58.79989471947018, -69.58615190744686, -69.10875014758096, -64.13264575963962, -76.82646463986559, -77.45892451660366, -71.62269277027198, -83.60359347674287, -117.85648880791466, -100.3016723640309, -108.69685235135324, -222.653461191646, -81.95341870831379, -63.256398170904006, -102.01698708349484], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6132593146652995, "mean_inference_ms": 5.362316846397566, "mean_action_processing_ms": 0.1991762081200674, "mean_env_wait_ms": 1.394667093183081, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2142000, "num_agent_steps_trained": 2142000, "num_env_steps_sampled": 2142000, "num_env_steps_trained": 2142000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2142000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2142000, "timers": {"training_iteration_time_ms": 78287.731, "load_time_ms": 29.174, "load_throughput": 479879.05, "learn_time_ms": 68589.253, "learn_throughput": 204.114, "synch_weights_time_ms": 8.015}, "counters": {"num_env_steps_sampled": 2142000, "num_env_steps_trained": 2142000, "num_agent_steps_sampled": 2142000, "num_agent_steps_trained": 2142000}, "done": false, "episodes_total": 2142, "training_iteration": 153, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-09-01", "timestamp": 1693062541, "time_this_iter_s": 78.9458794593811, "time_total_s": 11690.030021190643, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701522CF10>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701542AF40>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 11690.030021190643, "timesteps_since_restore": 0, "iterations_since_restore": 153, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 23.735714285714284, "ram_util_percent": 51.42857142857143}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -257.0961970006675, "episode_L1_reward_sum_min": -636.3106356263161, "episode_L1_reward_sum_max": -157.79837699234486, "episode_L2_reward_sum_mean": -141.2167260055989, "episode_L2_reward_sum_min": -232.59413377940655, "episode_L2_reward_sum_max": -115.73878490924835}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.11238155541931942, "policy_loss": 0.08687361441610128, "vf_loss": 0.25507941529418904, "vf_explained_var": 0.7186709061081027, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2156000, "num_env_steps_trained": 2156000, "num_agent_steps_sampled": 2156000, "num_agent_steps_trained": 2156000}, "sampler_results": {"episode_reward_max": -26.7841767490662, "episode_reward_min": -226.3786145604081, "episode_reward_mean": -82.23265519245628, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -257.0961970006675, "episode_L1_reward_sum_min": -636.3106356263161, "episode_L1_reward_sum_max": -157.79837699234486, "episode_L2_reward_sum_mean": -141.2167260055989, "episode_L2_reward_sum_min": -232.59413377940655, "episode_L2_reward_sum_max": -115.73878490924835}, "hist_stats": {"episode_reward": [-166.7142336493275, -72.56768887834414, -64.31821908775085, -96.73670797235597, -82.33629785870875, -63.00215084506437, -68.99610146055512, -88.77446498407139, -57.98148365155396, -60.61435098224391, -43.09889100113284, -91.67795083925863, -76.50968329513356, -226.3786145604081, -55.65008118112543, -76.9743207387179, -58.252088486689615, -100.13542195452449, -55.61503663181175, -161.66460631907913, -112.71924229340138, -44.147763249483376, -101.90447694351883, -94.57337578450961, -68.26971171996858, -86.56090183349674, -143.73633316928294, -62.767983121645024, -59.66792237775005, -67.98640160816024, -40.0252992536906, -58.59124442755079, -26.7841767490662, -63.2674711547999, -98.18640241836314, -55.50839454166538, -75.62946483999093, -87.89062710930905, -27.206575477213956, -42.59980326386349, -50.07342122882469, -68.3468516732209, -92.8490211560081, -93.2632068838299, -126.98997564177947, -73.97092904444203, -87.15226128491975, -71.89949424391041, -61.40745990933676, -60.27640152743444, -96.23031047037958, -70.0919706666556, -54.63552893967845, -77.05339264413792, -56.56865874171816, -55.469977462322426, -163.55935557146705, -45.45617787177299, -43.84983611561585, -60.44487287865137, -80.15459456340541, -60.9318184642031, -51.24968454803764, -73.10748159393444, -44.891233430591214, -157.94629472085194, -63.20194917274677, -58.498840731378046, -79.26123428595243, -83.40517601929113, -159.18576368191853, -58.79989471947018, -69.58615190744686, -69.10875014758096, -64.13264575963962, -76.82646463986559, -77.45892451660366, -71.62269277027198, -83.60359347674287, -117.85648880791466, -100.3016723640309, -108.69685235135324, -222.653461191646, -81.95341870831379, -63.256398170904006, -102.01698708349484, -75.45041824879377, -49.897955310892314, -77.97929721592499, -186.19305877757571, -71.87422538673242, -88.04363402964339, -179.70770690804258, -89.06602451664536, -48.38833780620844, -67.4009685144576, -42.364393835809565, -90.81607917184033, -64.58157728978614, -116.18230473499221], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6138587458870396, "mean_inference_ms": 5.372904650904546, "mean_action_processing_ms": 0.1995443652849143, "mean_env_wait_ms": 1.3975320917595007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -26.7841767490662, "episode_reward_min": -226.3786145604081, "episode_reward_mean": -82.23265519245628, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-166.7142336493275, -72.56768887834414, -64.31821908775085, -96.73670797235597, -82.33629785870875, -63.00215084506437, -68.99610146055512, -88.77446498407139, -57.98148365155396, -60.61435098224391, -43.09889100113284, -91.67795083925863, -76.50968329513356, -226.3786145604081, -55.65008118112543, -76.9743207387179, -58.252088486689615, -100.13542195452449, -55.61503663181175, -161.66460631907913, -112.71924229340138, -44.147763249483376, -101.90447694351883, -94.57337578450961, -68.26971171996858, -86.56090183349674, -143.73633316928294, -62.767983121645024, -59.66792237775005, -67.98640160816024, -40.0252992536906, -58.59124442755079, -26.7841767490662, -63.2674711547999, -98.18640241836314, -55.50839454166538, -75.62946483999093, -87.89062710930905, -27.206575477213956, -42.59980326386349, -50.07342122882469, -68.3468516732209, -92.8490211560081, -93.2632068838299, -126.98997564177947, -73.97092904444203, -87.15226128491975, -71.89949424391041, -61.40745990933676, -60.27640152743444, -96.23031047037958, -70.0919706666556, -54.63552893967845, -77.05339264413792, -56.56865874171816, -55.469977462322426, -163.55935557146705, -45.45617787177299, -43.84983611561585, -60.44487287865137, -80.15459456340541, -60.9318184642031, -51.24968454803764, -73.10748159393444, -44.891233430591214, -157.94629472085194, -63.20194917274677, -58.498840731378046, -79.26123428595243, -83.40517601929113, -159.18576368191853, -58.79989471947018, -69.58615190744686, -69.10875014758096, -64.13264575963962, -76.82646463986559, -77.45892451660366, -71.62269277027198, -83.60359347674287, -117.85648880791466, -100.3016723640309, -108.69685235135324, -222.653461191646, -81.95341870831379, -63.256398170904006, -102.01698708349484, -75.45041824879377, -49.897955310892314, -77.97929721592499, -186.19305877757571, -71.87422538673242, -88.04363402964339, -179.70770690804258, -89.06602451664536, -48.38833780620844, -67.4009685144576, -42.364393835809565, -90.81607917184033, -64.58157728978614, -116.18230473499221], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6138587458870396, "mean_inference_ms": 5.372904650904546, "mean_action_processing_ms": 0.1995443652849143, "mean_env_wait_ms": 1.3975320917595007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2156000, "num_agent_steps_trained": 2156000, "num_env_steps_sampled": 2156000, "num_env_steps_trained": 2156000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2156000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2156000, "timers": {"training_iteration_time_ms": 78513.747, "load_time_ms": 29.155, "load_throughput": 480188.28, "learn_time_ms": 68680.06, "learn_throughput": 203.844, "synch_weights_time_ms": 8.02}, "counters": {"num_env_steps_sampled": 2156000, "num_env_steps_trained": 2156000, "num_agent_steps_sampled": 2156000, "num_agent_steps_trained": 2156000}, "done": false, "episodes_total": 2156, "training_iteration": 154, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-10-21", "timestamp": 1693062621, "time_this_iter_s": 79.43062353134155, "time_total_s": 11769.460644721985, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270153116A0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015078490>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 11769.460644721985, "timesteps_since_restore": 0, "iterations_since_restore": 154, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 23.966371681415932, "ram_util_percent": 51.15132743362833}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -261.17609810106455, "episode_L1_reward_sum_min": -621.869440883398, "episode_L1_reward_sum_max": -157.79837699234486, "episode_L2_reward_sum_mean": -142.2975657426566, "episode_L2_reward_sum_min": -229.52370657026768, "episode_L2_reward_sum_max": -115.73878490924835}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.08295757403365363, "policy_loss": 0.05976340890509448, "vf_loss": 0.23194163419745922, "vf_explained_var": 0.7245184441898095, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2170000, "num_env_steps_trained": 2170000, "num_agent_steps_sampled": 2170000, "num_agent_steps_trained": 2170000}, "sampler_results": {"episode_reward_max": -26.7841767490662, "episode_reward_min": -222.653461191646, "episode_reward_mean": -83.44076521965991, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -261.17609810106455, "episode_L1_reward_sum_min": -621.869440883398, "episode_L1_reward_sum_max": -157.79837699234486, "episode_L2_reward_sum_mean": -142.2975657426566, "episode_L2_reward_sum_min": -229.52370657026768, "episode_L2_reward_sum_max": -115.73878490924835}, "hist_stats": {"episode_reward": [-55.65008118112543, -76.9743207387179, -58.252088486689615, -100.13542195452449, -55.61503663181175, -161.66460631907913, -112.71924229340138, -44.147763249483376, -101.90447694351883, -94.57337578450961, -68.26971171996858, -86.56090183349674, -143.73633316928294, -62.767983121645024, -59.66792237775005, -67.98640160816024, -40.0252992536906, -58.59124442755079, -26.7841767490662, -63.2674711547999, -98.18640241836314, -55.50839454166538, -75.62946483999093, -87.89062710930905, -27.206575477213956, -42.59980326386349, -50.07342122882469, -68.3468516732209, -92.8490211560081, -93.2632068838299, -126.98997564177947, -73.97092904444203, -87.15226128491975, -71.89949424391041, -61.40745990933676, -60.27640152743444, -96.23031047037958, -70.0919706666556, -54.63552893967845, -77.05339264413792, -56.56865874171816, -55.469977462322426, -163.55935557146705, -45.45617787177299, -43.84983611561585, -60.44487287865137, -80.15459456340541, -60.9318184642031, -51.24968454803764, -73.10748159393444, -44.891233430591214, -157.94629472085194, -63.20194917274677, -58.498840731378046, -79.26123428595243, -83.40517601929113, -159.18576368191853, -58.79989471947018, -69.58615190744686, -69.10875014758096, -64.13264575963962, -76.82646463986559, -77.45892451660366, -71.62269277027198, -83.60359347674287, -117.85648880791466, -100.3016723640309, -108.69685235135324, -222.653461191646, -81.95341870831379, -63.256398170904006, -102.01698708349484, -75.45041824879377, -49.897955310892314, -77.97929721592499, -186.19305877757571, -71.87422538673242, -88.04363402964339, -179.70770690804258, -89.06602451664536, -48.38833780620844, -67.4009685144576, -42.364393835809565, -90.81607917184033, -64.58157728978614, -116.18230473499221, -98.57662867431382, -57.515379443291536, -81.4086149630509, -100.24552488972542, -45.87172635163497, -56.03398557420167, -118.48234810399748, -149.70570181812582, -129.05922186316786, -77.75443004365562, -78.15870743322294, -72.79154205329435, -161.24528692835125, -153.66874364623746], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6145278254970857, "mean_inference_ms": 5.383754446368598, "mean_action_processing_ms": 0.19993292780080554, "mean_env_wait_ms": 1.4004545618732487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -26.7841767490662, "episode_reward_min": -222.653461191646, "episode_reward_mean": -83.44076521965991, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-55.65008118112543, -76.9743207387179, -58.252088486689615, -100.13542195452449, -55.61503663181175, -161.66460631907913, -112.71924229340138, -44.147763249483376, -101.90447694351883, -94.57337578450961, -68.26971171996858, -86.56090183349674, -143.73633316928294, -62.767983121645024, -59.66792237775005, -67.98640160816024, -40.0252992536906, -58.59124442755079, -26.7841767490662, -63.2674711547999, -98.18640241836314, -55.50839454166538, -75.62946483999093, -87.89062710930905, -27.206575477213956, -42.59980326386349, -50.07342122882469, -68.3468516732209, -92.8490211560081, -93.2632068838299, -126.98997564177947, -73.97092904444203, -87.15226128491975, -71.89949424391041, -61.40745990933676, -60.27640152743444, -96.23031047037958, -70.0919706666556, -54.63552893967845, -77.05339264413792, -56.56865874171816, -55.469977462322426, -163.55935557146705, -45.45617787177299, -43.84983611561585, -60.44487287865137, -80.15459456340541, -60.9318184642031, -51.24968454803764, -73.10748159393444, -44.891233430591214, -157.94629472085194, -63.20194917274677, -58.498840731378046, -79.26123428595243, -83.40517601929113, -159.18576368191853, -58.79989471947018, -69.58615190744686, -69.10875014758096, -64.13264575963962, -76.82646463986559, -77.45892451660366, -71.62269277027198, -83.60359347674287, -117.85648880791466, -100.3016723640309, -108.69685235135324, -222.653461191646, -81.95341870831379, -63.256398170904006, -102.01698708349484, -75.45041824879377, -49.897955310892314, -77.97929721592499, -186.19305877757571, -71.87422538673242, -88.04363402964339, -179.70770690804258, -89.06602451664536, -48.38833780620844, -67.4009685144576, -42.364393835809565, -90.81607917184033, -64.58157728978614, -116.18230473499221, -98.57662867431382, -57.515379443291536, -81.4086149630509, -100.24552488972542, -45.87172635163497, -56.03398557420167, -118.48234810399748, -149.70570181812582, -129.05922186316786, -77.75443004365562, -78.15870743322294, -72.79154205329435, -161.24528692835125, -153.66874364623746], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6145278254970857, "mean_inference_ms": 5.383754446368598, "mean_action_processing_ms": 0.19993292780080554, "mean_env_wait_ms": 1.4004545618732487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2170000, "num_agent_steps_trained": 2170000, "num_env_steps_sampled": 2170000, "num_env_steps_trained": 2170000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2170000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2170000, "timers": {"training_iteration_time_ms": 78715.932, "load_time_ms": 32.446, "load_throughput": 431479.781, "learn_time_ms": 68784.004, "learn_throughput": 203.536, "synch_weights_time_ms": 7.912}, "counters": {"num_env_steps_sampled": 2170000, "num_env_steps_trained": 2170000, "num_agent_steps_sampled": 2170000, "num_agent_steps_trained": 2170000}, "done": false, "episodes_total": 2170, "training_iteration": 155, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-11-41", "timestamp": 1693062701, "time_this_iter_s": 79.58380103111267, "time_total_s": 11849.044445753098, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270151E6700>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015359790>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 11849.044445753098, "timesteps_since_restore": 0, "iterations_since_restore": 155, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 23.764285714285716, "ram_util_percent": 50.74553571428571}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -258.4693718320131, "episode_L1_reward_sum_min": -621.869440883398, "episode_L1_reward_sum_max": -157.79837699234486, "episode_L2_reward_sum_mean": -141.58925010710954, "episode_L2_reward_sum_min": -229.52370657026768, "episode_L2_reward_sum_max": -115.73878490924835}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.11585149181502011, "policy_loss": 0.0966910549322775, "vf_loss": 0.19160437010197912, "vf_explained_var": 0.6564881761439543, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2184000, "num_env_steps_trained": 2184000, "num_agent_steps_sampled": 2184000, "num_agent_steps_trained": 2184000}, "sampler_results": {"episode_reward_max": -26.7841767490662, "episode_reward_min": -222.653461191646, "episode_reward_mean": -82.33876093511799, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -258.4693718320131, "episode_L1_reward_sum_min": -621.869440883398, "episode_L1_reward_sum_max": -157.79837699234486, "episode_L2_reward_sum_mean": -141.58925010710954, "episode_L2_reward_sum_min": -229.52370657026768, "episode_L2_reward_sum_max": -115.73878490924835}, "hist_stats": {"episode_reward": [-59.66792237775005, -67.98640160816024, -40.0252992536906, -58.59124442755079, -26.7841767490662, -63.2674711547999, -98.18640241836314, -55.50839454166538, -75.62946483999093, -87.89062710930905, -27.206575477213956, -42.59980326386349, -50.07342122882469, -68.3468516732209, -92.8490211560081, -93.2632068838299, -126.98997564177947, -73.97092904444203, -87.15226128491975, -71.89949424391041, -61.40745990933676, -60.27640152743444, -96.23031047037958, -70.0919706666556, -54.63552893967845, -77.05339264413792, -56.56865874171816, -55.469977462322426, -163.55935557146705, -45.45617787177299, -43.84983611561585, -60.44487287865137, -80.15459456340541, -60.9318184642031, -51.24968454803764, -73.10748159393444, -44.891233430591214, -157.94629472085194, -63.20194917274677, -58.498840731378046, -79.26123428595243, -83.40517601929113, -159.18576368191853, -58.79989471947018, -69.58615190744686, -69.10875014758096, -64.13264575963962, -76.82646463986559, -77.45892451660366, -71.62269277027198, -83.60359347674287, -117.85648880791466, -100.3016723640309, -108.69685235135324, -222.653461191646, -81.95341870831379, -63.256398170904006, -102.01698708349484, -75.45041824879377, -49.897955310892314, -77.97929721592499, -186.19305877757571, -71.87422538673242, -88.04363402964339, -179.70770690804258, -89.06602451664536, -48.38833780620844, -67.4009685144576, -42.364393835809565, -90.81607917184033, -64.58157728978614, -116.18230473499221, -98.57662867431382, -57.515379443291536, -81.4086149630509, -100.24552488972542, -45.87172635163497, -56.03398557420167, -118.48234810399748, -149.70570181812582, -129.05922186316786, -77.75443004365562, -78.15870743322294, -72.79154205329435, -161.24528692835125, -153.66874364623746, -39.69268678523458, -127.01983220631968, -66.9500873789837, -67.50134531763238, -93.43375666074927, -66.72471196120334, -51.751572511229625, -105.4625891387972, -104.49597814331757, -92.07201251729795, -64.38887590240932, -57.65012985881156, -47.34053325909789, -128.2868033319785], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6153748383796951, "mean_inference_ms": 5.394748342580427, "mean_action_processing_ms": 0.20032587587033843, "mean_env_wait_ms": 1.403418983293131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -26.7841767490662, "episode_reward_min": -222.653461191646, "episode_reward_mean": -82.33876093511799, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-59.66792237775005, -67.98640160816024, -40.0252992536906, -58.59124442755079, -26.7841767490662, -63.2674711547999, -98.18640241836314, -55.50839454166538, -75.62946483999093, -87.89062710930905, -27.206575477213956, -42.59980326386349, -50.07342122882469, -68.3468516732209, -92.8490211560081, -93.2632068838299, -126.98997564177947, -73.97092904444203, -87.15226128491975, -71.89949424391041, -61.40745990933676, -60.27640152743444, -96.23031047037958, -70.0919706666556, -54.63552893967845, -77.05339264413792, -56.56865874171816, -55.469977462322426, -163.55935557146705, -45.45617787177299, -43.84983611561585, -60.44487287865137, -80.15459456340541, -60.9318184642031, -51.24968454803764, -73.10748159393444, -44.891233430591214, -157.94629472085194, -63.20194917274677, -58.498840731378046, -79.26123428595243, -83.40517601929113, -159.18576368191853, -58.79989471947018, -69.58615190744686, -69.10875014758096, -64.13264575963962, -76.82646463986559, -77.45892451660366, -71.62269277027198, -83.60359347674287, -117.85648880791466, -100.3016723640309, -108.69685235135324, -222.653461191646, -81.95341870831379, -63.256398170904006, -102.01698708349484, -75.45041824879377, -49.897955310892314, -77.97929721592499, -186.19305877757571, -71.87422538673242, -88.04363402964339, -179.70770690804258, -89.06602451664536, -48.38833780620844, -67.4009685144576, -42.364393835809565, -90.81607917184033, -64.58157728978614, -116.18230473499221, -98.57662867431382, -57.515379443291536, -81.4086149630509, -100.24552488972542, -45.87172635163497, -56.03398557420167, -118.48234810399748, -149.70570181812582, -129.05922186316786, -77.75443004365562, -78.15870743322294, -72.79154205329435, -161.24528692835125, -153.66874364623746, -39.69268678523458, -127.01983220631968, -66.9500873789837, -67.50134531763238, -93.43375666074927, -66.72471196120334, -51.751572511229625, -105.4625891387972, -104.49597814331757, -92.07201251729795, -64.38887590240932, -57.65012985881156, -47.34053325909789, -128.2868033319785], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6153748383796951, "mean_inference_ms": 5.394748342580427, "mean_action_processing_ms": 0.20032587587033843, "mean_env_wait_ms": 1.403418983293131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2184000, "num_agent_steps_trained": 2184000, "num_env_steps_sampled": 2184000, "num_env_steps_trained": 2184000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2184000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2184000, "timers": {"training_iteration_time_ms": 78922.623, "load_time_ms": 33.183, "load_throughput": 421905.478, "learn_time_ms": 68871.389, "learn_throughput": 203.277, "synch_weights_time_ms": 7.813}, "counters": {"num_env_steps_sampled": 2184000, "num_env_steps_trained": 2184000, "num_agent_steps_sampled": 2184000, "num_agent_steps_trained": 2184000}, "done": false, "episodes_total": 2184, "training_iteration": 156, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-13-01", "timestamp": 1693062781, "time_this_iter_s": 79.92153930664062, "time_total_s": 11928.965985059738, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701543E640>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015359130>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 11928.965985059738, "timesteps_since_restore": 0, "iterations_since_restore": 156, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 24.179646017699113, "ram_util_percent": 50.90796460176991}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -268.02776945881544, "episode_L1_reward_sum_min": -621.869440883398, "episode_L1_reward_sum_max": -161.8030005171895, "episode_L2_reward_sum_mean": -144.05087795503437, "episode_L2_reward_sum_min": -229.52370657026768, "episode_L2_reward_sum_max": -117.07285680621862}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.12374806858951695, "policy_loss": 0.0969202289512403, "vf_loss": 0.268278384691642, "vf_explained_var": 0.6085810530700801, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2198000, "num_env_steps_trained": 2198000, "num_agent_steps_sampled": 2198000, "num_agent_steps_trained": 2198000}, "sampler_results": {"episode_reward_max": -39.69268678523458, "episode_reward_min": -222.653461191646, "episode_reward_mean": -86.50772704912829, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -268.02776945881544, "episode_L1_reward_sum_min": -621.869440883398, "episode_L1_reward_sum_max": -161.8030005171895, "episode_L2_reward_sum_mean": -144.05087795503437, "episode_L2_reward_sum_min": -229.52370657026768, "episode_L2_reward_sum_max": -117.07285680621862}, "hist_stats": {"episode_reward": [-92.8490211560081, -93.2632068838299, -126.98997564177947, -73.97092904444203, -87.15226128491975, -71.89949424391041, -61.40745990933676, -60.27640152743444, -96.23031047037958, -70.0919706666556, -54.63552893967845, -77.05339264413792, -56.56865874171816, -55.469977462322426, -163.55935557146705, -45.45617787177299, -43.84983611561585, -60.44487287865137, -80.15459456340541, -60.9318184642031, -51.24968454803764, -73.10748159393444, -44.891233430591214, -157.94629472085194, -63.20194917274677, -58.498840731378046, -79.26123428595243, -83.40517601929113, -159.18576368191853, -58.79989471947018, -69.58615190744686, -69.10875014758096, -64.13264575963962, -76.82646463986559, -77.45892451660366, -71.62269277027198, -83.60359347674287, -117.85648880791466, -100.3016723640309, -108.69685235135324, -222.653461191646, -81.95341870831379, -63.256398170904006, -102.01698708349484, -75.45041824879377, -49.897955310892314, -77.97929721592499, -186.19305877757571, -71.87422538673242, -88.04363402964339, -179.70770690804258, -89.06602451664536, -48.38833780620844, -67.4009685144576, -42.364393835809565, -90.81607917184033, -64.58157728978614, -116.18230473499221, -98.57662867431382, -57.515379443291536, -81.4086149630509, -100.24552488972542, -45.87172635163497, -56.03398557420167, -118.48234810399748, -149.70570181812582, -129.05922186316786, -77.75443004365562, -78.15870743322294, -72.79154205329435, -161.24528692835125, -153.66874364623746, -39.69268678523458, -127.01983220631968, -66.9500873789837, -67.50134531763238, -93.43375666074927, -66.72471196120334, -51.751572511229625, -105.4625891387972, -104.49597814331757, -92.07201251729795, -64.38887590240932, -57.65012985881156, -47.34053325909789, -128.2868033319785, -107.82545409806909, -90.35034171863158, -68.49646223920064, -92.50067625281484, -69.50995764472594, -61.062785105935184, -88.03834215458748, -85.80455384372132, -125.86039915820008, -60.37013303973678, -59.21694949129377, -109.89706030538733, -87.55754270267705, -132.17000976951684], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6164433401846573, "mean_inference_ms": 5.4056658025336946, "mean_action_processing_ms": 0.2007210062723407, "mean_env_wait_ms": 1.4063219887645915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -39.69268678523458, "episode_reward_min": -222.653461191646, "episode_reward_mean": -86.50772704912829, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-92.8490211560081, -93.2632068838299, -126.98997564177947, -73.97092904444203, -87.15226128491975, -71.89949424391041, -61.40745990933676, -60.27640152743444, -96.23031047037958, -70.0919706666556, -54.63552893967845, -77.05339264413792, -56.56865874171816, -55.469977462322426, -163.55935557146705, -45.45617787177299, -43.84983611561585, -60.44487287865137, -80.15459456340541, -60.9318184642031, -51.24968454803764, -73.10748159393444, -44.891233430591214, -157.94629472085194, -63.20194917274677, -58.498840731378046, -79.26123428595243, -83.40517601929113, -159.18576368191853, -58.79989471947018, -69.58615190744686, -69.10875014758096, -64.13264575963962, -76.82646463986559, -77.45892451660366, -71.62269277027198, -83.60359347674287, -117.85648880791466, -100.3016723640309, -108.69685235135324, -222.653461191646, -81.95341870831379, -63.256398170904006, -102.01698708349484, -75.45041824879377, -49.897955310892314, -77.97929721592499, -186.19305877757571, -71.87422538673242, -88.04363402964339, -179.70770690804258, -89.06602451664536, -48.38833780620844, -67.4009685144576, -42.364393835809565, -90.81607917184033, -64.58157728978614, -116.18230473499221, -98.57662867431382, -57.515379443291536, -81.4086149630509, -100.24552488972542, -45.87172635163497, -56.03398557420167, -118.48234810399748, -149.70570181812582, -129.05922186316786, -77.75443004365562, -78.15870743322294, -72.79154205329435, -161.24528692835125, -153.66874364623746, -39.69268678523458, -127.01983220631968, -66.9500873789837, -67.50134531763238, -93.43375666074927, -66.72471196120334, -51.751572511229625, -105.4625891387972, -104.49597814331757, -92.07201251729795, -64.38887590240932, -57.65012985881156, -47.34053325909789, -128.2868033319785, -107.82545409806909, -90.35034171863158, -68.49646223920064, -92.50067625281484, -69.50995764472594, -61.062785105935184, -88.03834215458748, -85.80455384372132, -125.86039915820008, -60.37013303973678, -59.21694949129377, -109.89706030538733, -87.55754270267705, -132.17000976951684], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6164433401846573, "mean_inference_ms": 5.4056658025336946, "mean_action_processing_ms": 0.2007210062723407, "mean_env_wait_ms": 1.4063219887645915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2198000, "num_agent_steps_trained": 2198000, "num_env_steps_sampled": 2198000, "num_env_steps_trained": 2198000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2198000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2198000, "timers": {"training_iteration_time_ms": 79134.368, "load_time_ms": 34.7, "load_throughput": 403456.131, "learn_time_ms": 68981.314, "learn_throughput": 202.954, "synch_weights_time_ms": 8.708}, "counters": {"num_env_steps_sampled": 2198000, "num_env_steps_trained": 2198000, "num_agent_steps_sampled": 2198000, "num_agent_steps_trained": 2198000}, "done": false, "episodes_total": 2198, "training_iteration": 157, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-14-21", "timestamp": 1693062861, "time_this_iter_s": 80.19655871391296, "time_total_s": 12009.162543773651, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014F64A30>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014F64EB0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 12009.162543773651, "timesteps_since_restore": 0, "iterations_since_restore": 157, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 24.593859649122805, "ram_util_percent": 50.94298245614035}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -275.564213495031, "episode_L1_reward_sum_min": -621.869440883398, "episode_L1_reward_sum_max": -161.8030005171895, "episode_L2_reward_sum_mean": -145.96573296450077, "episode_L2_reward_sum_min": -229.52370657026768, "episode_L2_reward_sum_max": -117.10460609197617}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.09684207659873943, "policy_loss": 0.07166071185112045, "vf_loss": 0.25181364887230895, "vf_explained_var": 0.760153135491742, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2212000, "num_env_steps_trained": 2212000, "num_agent_steps_sampled": 2212000, "num_agent_steps_trained": 2212000}, "sampler_results": {"episode_reward_max": -39.69268678523458, "episode_reward_min": -222.653461191646, "episode_reward_mean": -89.63848385086, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -275.564213495031, "episode_L1_reward_sum_min": -621.869440883398, "episode_L1_reward_sum_max": -161.8030005171895, "episode_L2_reward_sum_mean": -145.96573296450077, "episode_L2_reward_sum_min": -229.52370657026768, "episode_L2_reward_sum_max": -117.10460609197617}, "hist_stats": {"episode_reward": [-163.55935557146705, -45.45617787177299, -43.84983611561585, -60.44487287865137, -80.15459456340541, -60.9318184642031, -51.24968454803764, -73.10748159393444, -44.891233430591214, -157.94629472085194, -63.20194917274677, -58.498840731378046, -79.26123428595243, -83.40517601929113, -159.18576368191853, -58.79989471947018, -69.58615190744686, -69.10875014758096, -64.13264575963962, -76.82646463986559, -77.45892451660366, -71.62269277027198, -83.60359347674287, -117.85648880791466, -100.3016723640309, -108.69685235135324, -222.653461191646, -81.95341870831379, -63.256398170904006, -102.01698708349484, -75.45041824879377, -49.897955310892314, -77.97929721592499, -186.19305877757571, -71.87422538673242, -88.04363402964339, -179.70770690804258, -89.06602451664536, -48.38833780620844, -67.4009685144576, -42.364393835809565, -90.81607917184033, -64.58157728978614, -116.18230473499221, -98.57662867431382, -57.515379443291536, -81.4086149630509, -100.24552488972542, -45.87172635163497, -56.03398557420167, -118.48234810399748, -149.70570181812582, -129.05922186316786, -77.75443004365562, -78.15870743322294, -72.79154205329435, -161.24528692835125, -153.66874364623746, -39.69268678523458, -127.01983220631968, -66.9500873789837, -67.50134531763238, -93.43375666074927, -66.72471196120334, -51.751572511229625, -105.4625891387972, -104.49597814331757, -92.07201251729795, -64.38887590240932, -57.65012985881156, -47.34053325909789, -128.2868033319785, -107.82545409806909, -90.35034171863158, -68.49646223920064, -92.50067625281484, -69.50995764472594, -61.062785105935184, -88.03834215458748, -85.80455384372132, -125.86039915820008, -60.37013303973678, -59.21694949129377, -109.89706030538733, -87.55754270267705, -132.17000976951684, -64.58576070700956, -73.59962187391804, -55.53674277328401, -171.73666185858065, -78.03881260116412, -176.95399698732658, -74.74938044645758, -108.72836492954431, -91.27867661029254, -121.79543506073732, -88.74748611066897, -92.55841744993032, -126.15084734305397, -66.47406403775724], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.617694487962357, "mean_inference_ms": 5.416510080232602, "mean_action_processing_ms": 0.20112058267170643, "mean_env_wait_ms": 1.4092037851412922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -39.69268678523458, "episode_reward_min": -222.653461191646, "episode_reward_mean": -89.63848385086, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-163.55935557146705, -45.45617787177299, -43.84983611561585, -60.44487287865137, -80.15459456340541, -60.9318184642031, -51.24968454803764, -73.10748159393444, -44.891233430591214, -157.94629472085194, -63.20194917274677, -58.498840731378046, -79.26123428595243, -83.40517601929113, -159.18576368191853, -58.79989471947018, -69.58615190744686, -69.10875014758096, -64.13264575963962, -76.82646463986559, -77.45892451660366, -71.62269277027198, -83.60359347674287, -117.85648880791466, -100.3016723640309, -108.69685235135324, -222.653461191646, -81.95341870831379, -63.256398170904006, -102.01698708349484, -75.45041824879377, -49.897955310892314, -77.97929721592499, -186.19305877757571, -71.87422538673242, -88.04363402964339, -179.70770690804258, -89.06602451664536, -48.38833780620844, -67.4009685144576, -42.364393835809565, -90.81607917184033, -64.58157728978614, -116.18230473499221, -98.57662867431382, -57.515379443291536, -81.4086149630509, -100.24552488972542, -45.87172635163497, -56.03398557420167, -118.48234810399748, -149.70570181812582, -129.05922186316786, -77.75443004365562, -78.15870743322294, -72.79154205329435, -161.24528692835125, -153.66874364623746, -39.69268678523458, -127.01983220631968, -66.9500873789837, -67.50134531763238, -93.43375666074927, -66.72471196120334, -51.751572511229625, -105.4625891387972, -104.49597814331757, -92.07201251729795, -64.38887590240932, -57.65012985881156, -47.34053325909789, -128.2868033319785, -107.82545409806909, -90.35034171863158, -68.49646223920064, -92.50067625281484, -69.50995764472594, -61.062785105935184, -88.03834215458748, -85.80455384372132, -125.86039915820008, -60.37013303973678, -59.21694949129377, -109.89706030538733, -87.55754270267705, -132.17000976951684, -64.58576070700956, -73.59962187391804, -55.53674277328401, -171.73666185858065, -78.03881260116412, -176.95399698732658, -74.74938044645758, -108.72836492954431, -91.27867661029254, -121.79543506073732, -88.74748611066897, -92.55841744993032, -126.15084734305397, -66.47406403775724], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.617694487962357, "mean_inference_ms": 5.416510080232602, "mean_action_processing_ms": 0.20112058267170643, "mean_env_wait_ms": 1.4092037851412922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2212000, "num_agent_steps_trained": 2212000, "num_env_steps_sampled": 2212000, "num_env_steps_trained": 2212000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2212000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2212000, "timers": {"training_iteration_time_ms": 79317.479, "load_time_ms": 35.581, "load_throughput": 393469.823, "learn_time_ms": 69090.298, "learn_throughput": 202.633, "synch_weights_time_ms": 8.408}, "counters": {"num_env_steps_sampled": 2212000, "num_env_steps_trained": 2212000, "num_agent_steps_sampled": 2212000, "num_agent_steps_trained": 2212000}, "done": false, "episodes_total": 2212, "training_iteration": 158, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-15-41", "timestamp": 1693062941, "time_this_iter_s": 79.9436891078949, "time_total_s": 12089.106232881546, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015360A60>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015360CA0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 12089.106232881546, "timesteps_since_restore": 0, "iterations_since_restore": 158, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 24.148672566371683, "ram_util_percent": 50.94070796460177}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -277.59815998598935, "episode_L1_reward_sum_min": -621.869440883398, "episode_L1_reward_sum_max": -161.8030005171895, "episode_L2_reward_sum_mean": -146.47147725000977, "episode_L2_reward_sum_min": -229.52370657026768, "episode_L2_reward_sum_max": -117.10460609197617}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.13420814040946724, "policy_loss": 0.10386576361277758, "vf_loss": 0.3034237594166216, "vf_explained_var": 0.6337273746054359, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2226000, "num_env_steps_trained": 2226000, "num_agent_steps_sampled": 2226000, "num_agent_steps_trained": 2226000}, "sampler_results": {"episode_reward_max": -39.69268678523458, "episode_reward_min": -222.653461191646, "episode_reward_mean": -91.30072307441597, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -277.59815998598935, "episode_L1_reward_sum_min": -621.869440883398, "episode_L1_reward_sum_max": -161.8030005171895, "episode_L2_reward_sum_mean": -146.47147725000977, "episode_L2_reward_sum_min": -229.52370657026768, "episode_L2_reward_sum_max": -117.10460609197617}, "hist_stats": {"episode_reward": [-159.18576368191853, -58.79989471947018, -69.58615190744686, -69.10875014758096, -64.13264575963962, -76.82646463986559, -77.45892451660366, -71.62269277027198, -83.60359347674287, -117.85648880791466, -100.3016723640309, -108.69685235135324, -222.653461191646, -81.95341870831379, -63.256398170904006, -102.01698708349484, -75.45041824879377, -49.897955310892314, -77.97929721592499, -186.19305877757571, -71.87422538673242, -88.04363402964339, -179.70770690804258, -89.06602451664536, -48.38833780620844, -67.4009685144576, -42.364393835809565, -90.81607917184033, -64.58157728978614, -116.18230473499221, -98.57662867431382, -57.515379443291536, -81.4086149630509, -100.24552488972542, -45.87172635163497, -56.03398557420167, -118.48234810399748, -149.70570181812582, -129.05922186316786, -77.75443004365562, -78.15870743322294, -72.79154205329435, -161.24528692835125, -153.66874364623746, -39.69268678523458, -127.01983220631968, -66.9500873789837, -67.50134531763238, -93.43375666074927, -66.72471196120334, -51.751572511229625, -105.4625891387972, -104.49597814331757, -92.07201251729795, -64.38887590240932, -57.65012985881156, -47.34053325909789, -128.2868033319785, -107.82545409806909, -90.35034171863158, -68.49646223920064, -92.50067625281484, -69.50995764472594, -61.062785105935184, -88.03834215458748, -85.80455384372132, -125.86039915820008, -60.37013303973678, -59.21694949129377, -109.89706030538733, -87.55754270267705, -132.17000976951684, -64.58576070700956, -73.59962187391804, -55.53674277328401, -171.73666185858065, -78.03881260116412, -176.95399698732658, -74.74938044645758, -108.72836492954431, -91.27867661029254, -121.79543506073732, -88.74748611066897, -92.55841744993032, -126.15084734305397, -66.47406403775724, -115.99824983273221, -57.9858862929164, -112.65302511842087, -42.680047118290474, -88.04109734729305, -75.713989937407, -73.70637297587722, -95.27763932558176, -98.73903806289769, -60.57134472185461, -59.33925358674602, -165.40791969492005, -98.60327143440061, -87.46533687415915], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6191587006554854, "mean_inference_ms": 5.427382846676121, "mean_action_processing_ms": 0.20152178283836, "mean_env_wait_ms": 1.4120902768934287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -39.69268678523458, "episode_reward_min": -222.653461191646, "episode_reward_mean": -91.30072307441597, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-159.18576368191853, -58.79989471947018, -69.58615190744686, -69.10875014758096, -64.13264575963962, -76.82646463986559, -77.45892451660366, -71.62269277027198, -83.60359347674287, -117.85648880791466, -100.3016723640309, -108.69685235135324, -222.653461191646, -81.95341870831379, -63.256398170904006, -102.01698708349484, -75.45041824879377, -49.897955310892314, -77.97929721592499, -186.19305877757571, -71.87422538673242, -88.04363402964339, -179.70770690804258, -89.06602451664536, -48.38833780620844, -67.4009685144576, -42.364393835809565, -90.81607917184033, -64.58157728978614, -116.18230473499221, -98.57662867431382, -57.515379443291536, -81.4086149630509, -100.24552488972542, -45.87172635163497, -56.03398557420167, -118.48234810399748, -149.70570181812582, -129.05922186316786, -77.75443004365562, -78.15870743322294, -72.79154205329435, -161.24528692835125, -153.66874364623746, -39.69268678523458, -127.01983220631968, -66.9500873789837, -67.50134531763238, -93.43375666074927, -66.72471196120334, -51.751572511229625, -105.4625891387972, -104.49597814331757, -92.07201251729795, -64.38887590240932, -57.65012985881156, -47.34053325909789, -128.2868033319785, -107.82545409806909, -90.35034171863158, -68.49646223920064, -92.50067625281484, -69.50995764472594, -61.062785105935184, -88.03834215458748, -85.80455384372132, -125.86039915820008, -60.37013303973678, -59.21694949129377, -109.89706030538733, -87.55754270267705, -132.17000976951684, -64.58576070700956, -73.59962187391804, -55.53674277328401, -171.73666185858065, -78.03881260116412, -176.95399698732658, -74.74938044645758, -108.72836492954431, -91.27867661029254, -121.79543506073732, -88.74748611066897, -92.55841744993032, -126.15084734305397, -66.47406403775724, -115.99824983273221, -57.9858862929164, -112.65302511842087, -42.680047118290474, -88.04109734729305, -75.713989937407, -73.70637297587722, -95.27763932558176, -98.73903806289769, -60.57134472185461, -59.33925358674602, -165.40791969492005, -98.60327143440061, -87.46533687415915], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6191587006554854, "mean_inference_ms": 5.427382846676121, "mean_action_processing_ms": 0.20152178283836, "mean_env_wait_ms": 1.4120902768934287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2226000, "num_agent_steps_trained": 2226000, "num_env_steps_sampled": 2226000, "num_env_steps_trained": 2226000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2226000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2226000, "timers": {"training_iteration_time_ms": 79450.812, "load_time_ms": 36.478, "load_throughput": 383787.757, "learn_time_ms": 69171.866, "learn_throughput": 202.394, "synch_weights_time_ms": 8.217}, "counters": {"num_env_steps_sampled": 2226000, "num_env_steps_trained": 2226000, "num_agent_steps_sampled": 2226000, "num_agent_steps_trained": 2226000}, "done": false, "episodes_total": 2226, "training_iteration": 159, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-17-01", "timestamp": 1693063021, "time_this_iter_s": 79.92614030838013, "time_total_s": 12169.032373189926, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270152CF6A0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270152CFA90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 12169.032373189926, "timesteps_since_restore": 0, "iterations_since_restore": 159, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 24.230357142857144, "ram_util_percent": 50.947321428571435}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -275.24720674633977, "episode_L1_reward_sum_min": -547.9508818238974, "episode_L1_reward_sum_max": -161.8030005171895, "episode_L2_reward_sum_mean": -145.8536630511284, "episode_L2_reward_sum_min": -215.5584524422884, "episode_L2_reward_sum_max": -117.10460609197617}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.14510810090307483, "policy_loss": 0.12050709635163744, "vf_loss": 0.24601003811800223, "vf_explained_var": 0.5571630361026206, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2240000, "num_env_steps_trained": 2240000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "sampler_results": {"episode_reward_max": -39.69268678523458, "episode_reward_min": -186.19305877757571, "episode_reward_mean": -90.96455953877653, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -275.24720674633977, "episode_L1_reward_sum_min": -547.9508818238974, "episode_L1_reward_sum_max": -161.8030005171895, "episode_L2_reward_sum_mean": -145.8536630511284, "episode_L2_reward_sum_min": -215.5584524422884, "episode_L2_reward_sum_max": -117.10460609197617}, "hist_stats": {"episode_reward": [-63.256398170904006, -102.01698708349484, -75.45041824879377, -49.897955310892314, -77.97929721592499, -186.19305877757571, -71.87422538673242, -88.04363402964339, -179.70770690804258, -89.06602451664536, -48.38833780620844, -67.4009685144576, -42.364393835809565, -90.81607917184033, -64.58157728978614, -116.18230473499221, -98.57662867431382, -57.515379443291536, -81.4086149630509, -100.24552488972542, -45.87172635163497, -56.03398557420167, -118.48234810399748, -149.70570181812582, -129.05922186316786, -77.75443004365562, -78.15870743322294, -72.79154205329435, -161.24528692835125, -153.66874364623746, -39.69268678523458, -127.01983220631968, -66.9500873789837, -67.50134531763238, -93.43375666074927, -66.72471196120334, -51.751572511229625, -105.4625891387972, -104.49597814331757, -92.07201251729795, -64.38887590240932, -57.65012985881156, -47.34053325909789, -128.2868033319785, -107.82545409806909, -90.35034171863158, -68.49646223920064, -92.50067625281484, -69.50995764472594, -61.062785105935184, -88.03834215458748, -85.80455384372132, -125.86039915820008, -60.37013303973678, -59.21694949129377, -109.89706030538733, -87.55754270267705, -132.17000976951684, -64.58576070700956, -73.59962187391804, -55.53674277328401, -171.73666185858065, -78.03881260116412, -176.95399698732658, -74.74938044645758, -108.72836492954431, -91.27867661029254, -121.79543506073732, -88.74748611066897, -92.55841744993032, -126.15084734305397, -66.47406403775724, -115.99824983273221, -57.9858862929164, -112.65302511842087, -42.680047118290474, -88.04109734729305, -75.713989937407, -73.70637297587722, -95.27763932558176, -98.73903806289769, -60.57134472185461, -59.33925358674602, -165.40791969492005, -98.60327143440061, -87.46533687415915, -66.9650879737315, -57.30674703694659, -67.44246599936876, -83.67908921860234, -67.9519057659042, -157.99412023429963, -89.5187878024923, -134.95560791431592, -71.4066025740558, -93.34067453510626, -75.50262967454256, -113.34430413796557, -135.39316333460104, -113.36923527692346], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6208211823049637, "mean_inference_ms": 5.438234113923365, "mean_action_processing_ms": 0.2019170111975528, "mean_env_wait_ms": 1.414966415999291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -39.69268678523458, "episode_reward_min": -186.19305877757571, "episode_reward_mean": -90.96455953877653, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-63.256398170904006, -102.01698708349484, -75.45041824879377, -49.897955310892314, -77.97929721592499, -186.19305877757571, -71.87422538673242, -88.04363402964339, -179.70770690804258, -89.06602451664536, -48.38833780620844, -67.4009685144576, -42.364393835809565, -90.81607917184033, -64.58157728978614, -116.18230473499221, -98.57662867431382, -57.515379443291536, -81.4086149630509, -100.24552488972542, -45.87172635163497, -56.03398557420167, -118.48234810399748, -149.70570181812582, -129.05922186316786, -77.75443004365562, -78.15870743322294, -72.79154205329435, -161.24528692835125, -153.66874364623746, -39.69268678523458, -127.01983220631968, -66.9500873789837, -67.50134531763238, -93.43375666074927, -66.72471196120334, -51.751572511229625, -105.4625891387972, -104.49597814331757, -92.07201251729795, -64.38887590240932, -57.65012985881156, -47.34053325909789, -128.2868033319785, -107.82545409806909, -90.35034171863158, -68.49646223920064, -92.50067625281484, -69.50995764472594, -61.062785105935184, -88.03834215458748, -85.80455384372132, -125.86039915820008, -60.37013303973678, -59.21694949129377, -109.89706030538733, -87.55754270267705, -132.17000976951684, -64.58576070700956, -73.59962187391804, -55.53674277328401, -171.73666185858065, -78.03881260116412, -176.95399698732658, -74.74938044645758, -108.72836492954431, -91.27867661029254, -121.79543506073732, -88.74748611066897, -92.55841744993032, -126.15084734305397, -66.47406403775724, -115.99824983273221, -57.9858862929164, -112.65302511842087, -42.680047118290474, -88.04109734729305, -75.713989937407, -73.70637297587722, -95.27763932558176, -98.73903806289769, -60.57134472185461, -59.33925358674602, -165.40791969492005, -98.60327143440061, -87.46533687415915, -66.9650879737315, -57.30674703694659, -67.44246599936876, -83.67908921860234, -67.9519057659042, -157.99412023429963, -89.5187878024923, -134.95560791431592, -71.4066025740558, -93.34067453510626, -75.50262967454256, -113.34430413796557, -135.39316333460104, -113.36923527692346], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6208211823049637, "mean_inference_ms": 5.438234113923365, "mean_action_processing_ms": 0.2019170111975528, "mean_env_wait_ms": 1.414966415999291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000, "num_env_steps_sampled": 2240000, "num_env_steps_trained": 2240000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2240000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2240000, "timers": {"training_iteration_time_ms": 79554.487, "load_time_ms": 38.064, "load_throughput": 367804.333, "learn_time_ms": 69235.815, "learn_throughput": 202.207, "synch_weights_time_ms": 8.129}, "counters": {"num_env_steps_sampled": 2240000, "num_env_steps_trained": 2240000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "done": false, "episodes_total": 2240, "training_iteration": 160, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-18-21", "timestamp": 1693063101, "time_this_iter_s": 79.92242527008057, "time_total_s": 12248.954798460007, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701539CA90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015350D30>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 12248.954798460007, "timesteps_since_restore": 0, "iterations_since_restore": 160, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 24.109734513274333, "ram_util_percent": 50.941592920353976}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -271.28055120281874, "episode_L1_reward_sum_min": -539.9423525929451, "episode_L1_reward_sum_max": -161.8030005171895, "episode_L2_reward_sum_mean": -144.91920160531998, "episode_L2_reward_sum_min": -212.38666707277298, "episode_L2_reward_sum_max": -117.10460609197617}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.11131804176163572, "policy_loss": 0.09130804496122631, "vf_loss": 0.20009996710189565, "vf_explained_var": 0.6496273677474187, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2254000, "num_env_steps_trained": 2254000, "num_agent_steps_sampled": 2254000, "num_agent_steps_trained": 2254000}, "sampler_results": {"episode_reward_max": -39.69268678523458, "episode_reward_min": -176.95399698732658, "episode_reward_mean": -89.81557545772895, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -271.28055120281874, "episode_L1_reward_sum_min": -539.9423525929451, "episode_L1_reward_sum_max": -161.8030005171895, "episode_L2_reward_sum_mean": -144.91920160531998, "episode_L2_reward_sum_min": -212.38666707277298, "episode_L2_reward_sum_max": -117.10460609197617}, "hist_stats": {"episode_reward": [-64.58157728978614, -116.18230473499221, -98.57662867431382, -57.515379443291536, -81.4086149630509, -100.24552488972542, -45.87172635163497, -56.03398557420167, -118.48234810399748, -149.70570181812582, -129.05922186316786, -77.75443004365562, -78.15870743322294, -72.79154205329435, -161.24528692835125, -153.66874364623746, -39.69268678523458, -127.01983220631968, -66.9500873789837, -67.50134531763238, -93.43375666074927, -66.72471196120334, -51.751572511229625, -105.4625891387972, -104.49597814331757, -92.07201251729795, -64.38887590240932, -57.65012985881156, -47.34053325909789, -128.2868033319785, -107.82545409806909, -90.35034171863158, -68.49646223920064, -92.50067625281484, -69.50995764472594, -61.062785105935184, -88.03834215458748, -85.80455384372132, -125.86039915820008, -60.37013303973678, -59.21694949129377, -109.89706030538733, -87.55754270267705, -132.17000976951684, -64.58576070700956, -73.59962187391804, -55.53674277328401, -171.73666185858065, -78.03881260116412, -176.95399698732658, -74.74938044645758, -108.72836492954431, -91.27867661029254, -121.79543506073732, -88.74748611066897, -92.55841744993032, -126.15084734305397, -66.47406403775724, -115.99824983273221, -57.9858862929164, -112.65302511842087, -42.680047118290474, -88.04109734729305, -75.713989937407, -73.70637297587722, -95.27763932558176, -98.73903806289769, -60.57134472185461, -59.33925358674602, -165.40791969492005, -98.60327143440061, -87.46533687415915, -66.9650879737315, -57.30674703694659, -67.44246599936876, -83.67908921860234, -67.9519057659042, -157.99412023429963, -89.5187878024923, -134.95560791431592, -71.4066025740558, -93.34067453510626, -75.50262967454256, -113.34430413796557, -135.39316333460104, -113.36923527692346, -64.31943844424693, -72.09579837034117, -78.89676853988506, -93.38203745164692, -103.73724863632835, -55.31343925945148, -124.50374699178639, -88.97447338323263, -55.02202528076444, -83.31496285740339, -65.87979211869605, -106.50426452106771, -58.69178423649917, -66.92129678086012], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.622659534909358, "mean_inference_ms": 5.448986453691821, "mean_action_processing_ms": 0.20230965587770708, "mean_env_wait_ms": 1.4178196453895646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -39.69268678523458, "episode_reward_min": -176.95399698732658, "episode_reward_mean": -89.81557545772895, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.58157728978614, -116.18230473499221, -98.57662867431382, -57.515379443291536, -81.4086149630509, -100.24552488972542, -45.87172635163497, -56.03398557420167, -118.48234810399748, -149.70570181812582, -129.05922186316786, -77.75443004365562, -78.15870743322294, -72.79154205329435, -161.24528692835125, -153.66874364623746, -39.69268678523458, -127.01983220631968, -66.9500873789837, -67.50134531763238, -93.43375666074927, -66.72471196120334, -51.751572511229625, -105.4625891387972, -104.49597814331757, -92.07201251729795, -64.38887590240932, -57.65012985881156, -47.34053325909789, -128.2868033319785, -107.82545409806909, -90.35034171863158, -68.49646223920064, -92.50067625281484, -69.50995764472594, -61.062785105935184, -88.03834215458748, -85.80455384372132, -125.86039915820008, -60.37013303973678, -59.21694949129377, -109.89706030538733, -87.55754270267705, -132.17000976951684, -64.58576070700956, -73.59962187391804, -55.53674277328401, -171.73666185858065, -78.03881260116412, -176.95399698732658, -74.74938044645758, -108.72836492954431, -91.27867661029254, -121.79543506073732, -88.74748611066897, -92.55841744993032, -126.15084734305397, -66.47406403775724, -115.99824983273221, -57.9858862929164, -112.65302511842087, -42.680047118290474, -88.04109734729305, -75.713989937407, -73.70637297587722, -95.27763932558176, -98.73903806289769, -60.57134472185461, -59.33925358674602, -165.40791969492005, -98.60327143440061, -87.46533687415915, -66.9650879737315, -57.30674703694659, -67.44246599936876, -83.67908921860234, -67.9519057659042, -157.99412023429963, -89.5187878024923, -134.95560791431592, -71.4066025740558, -93.34067453510626, -75.50262967454256, -113.34430413796557, -135.39316333460104, -113.36923527692346, -64.31943844424693, -72.09579837034117, -78.89676853988506, -93.38203745164692, -103.73724863632835, -55.31343925945148, -124.50374699178639, -88.97447338323263, -55.02202528076444, -83.31496285740339, -65.87979211869605, -106.50426452106771, -58.69178423649917, -66.92129678086012], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.622659534909358, "mean_inference_ms": 5.448986453691821, "mean_action_processing_ms": 0.20230965587770708, "mean_env_wait_ms": 1.4178196453895646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2254000, "num_agent_steps_trained": 2254000, "num_env_steps_sampled": 2254000, "num_env_steps_trained": 2254000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2254000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2254000, "timers": {"training_iteration_time_ms": 79685.88, "load_time_ms": 38.888, "load_throughput": 360006.891, "learn_time_ms": 69317.227, "learn_throughput": 201.97, "synch_weights_time_ms": 8.328}, "counters": {"num_env_steps_sampled": 2254000, "num_env_steps_trained": 2254000, "num_agent_steps_sampled": 2254000, "num_agent_steps_trained": 2254000}, "done": false, "episodes_total": 2254, "training_iteration": 161, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-19-41", "timestamp": 1693063181, "time_this_iter_s": 80.14878630638123, "time_total_s": 12329.103584766388, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014EF5C40>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270154640D0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 12329.103584766388, "timesteps_since_restore": 0, "iterations_since_restore": 161, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 24.26315789473684, "ram_util_percent": 50.93508771929825}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -275.730563371107, "episode_L1_reward_sum_min": -539.9423525929451, "episode_L1_reward_sum_max": -161.8030005171895, "episode_L2_reward_sum_mean": -146.04237301565706, "episode_L2_reward_sum_min": -212.38666707277298, "episode_L2_reward_sum_max": -117.10460609197617}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.07698491127388322, "policy_loss": 0.04516722034823931, "vf_loss": 0.3181769079734521, "vf_explained_var": 0.7450554049861284, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2268000, "num_env_steps_trained": 2268000, "num_agent_steps_sampled": 2268000, "num_agent_steps_trained": 2268000}, "sampler_results": {"episode_reward_max": -39.69268678523458, "episode_reward_min": -176.95399698732658, "episode_reward_mean": -90.36402969057286, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -275.730563371107, "episode_L1_reward_sum_min": -539.9423525929451, "episode_L1_reward_sum_max": -161.8030005171895, "episode_L2_reward_sum_mean": -146.04237301565706, "episode_L2_reward_sum_min": -212.38666707277298, "episode_L2_reward_sum_max": -117.10460609197617}, "hist_stats": {"episode_reward": [-161.24528692835125, -153.66874364623746, -39.69268678523458, -127.01983220631968, -66.9500873789837, -67.50134531763238, -93.43375666074927, -66.72471196120334, -51.751572511229625, -105.4625891387972, -104.49597814331757, -92.07201251729795, -64.38887590240932, -57.65012985881156, -47.34053325909789, -128.2868033319785, -107.82545409806909, -90.35034171863158, -68.49646223920064, -92.50067625281484, -69.50995764472594, -61.062785105935184, -88.03834215458748, -85.80455384372132, -125.86039915820008, -60.37013303973678, -59.21694949129377, -109.89706030538733, -87.55754270267705, -132.17000976951684, -64.58576070700956, -73.59962187391804, -55.53674277328401, -171.73666185858065, -78.03881260116412, -176.95399698732658, -74.74938044645758, -108.72836492954431, -91.27867661029254, -121.79543506073732, -88.74748611066897, -92.55841744993032, -126.15084734305397, -66.47406403775724, -115.99824983273221, -57.9858862929164, -112.65302511842087, -42.680047118290474, -88.04109734729305, -75.713989937407, -73.70637297587722, -95.27763932558176, -98.73903806289769, -60.57134472185461, -59.33925358674602, -165.40791969492005, -98.60327143440061, -87.46533687415915, -66.9650879737315, -57.30674703694659, -67.44246599936876, -83.67908921860234, -67.9519057659042, -157.99412023429963, -89.5187878024923, -134.95560791431592, -71.4066025740558, -93.34067453510626, -75.50262967454256, -113.34430413796557, -135.39316333460104, -113.36923527692346, -64.31943844424693, -72.09579837034117, -78.89676853988506, -93.38203745164692, -103.73724863632835, -55.31343925945148, -124.50374699178639, -88.97447338323263, -55.02202528076444, -83.31496285740339, -65.87979211869605, -106.50426452106771, -58.69178423649917, -66.92129678086012, -127.48624777346656, -137.0908740090718, -73.98198418422443, -100.41731721716988, -114.26624198321244, -71.9729418561271, -90.03547476981518, -145.2453935820194, -65.85125581403489, -66.33312974390145, -58.52613429337643, -110.05361668022248, -73.51455504319924, -66.43794957100607], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.624607941733185, "mean_inference_ms": 5.459625155265887, "mean_action_processing_ms": 0.20269419068938008, "mean_env_wait_ms": 1.420644526171734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -39.69268678523458, "episode_reward_min": -176.95399698732658, "episode_reward_mean": -90.36402969057286, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-161.24528692835125, -153.66874364623746, -39.69268678523458, -127.01983220631968, -66.9500873789837, -67.50134531763238, -93.43375666074927, -66.72471196120334, -51.751572511229625, -105.4625891387972, -104.49597814331757, -92.07201251729795, -64.38887590240932, -57.65012985881156, -47.34053325909789, -128.2868033319785, -107.82545409806909, -90.35034171863158, -68.49646223920064, -92.50067625281484, -69.50995764472594, -61.062785105935184, -88.03834215458748, -85.80455384372132, -125.86039915820008, -60.37013303973678, -59.21694949129377, -109.89706030538733, -87.55754270267705, -132.17000976951684, -64.58576070700956, -73.59962187391804, -55.53674277328401, -171.73666185858065, -78.03881260116412, -176.95399698732658, -74.74938044645758, -108.72836492954431, -91.27867661029254, -121.79543506073732, -88.74748611066897, -92.55841744993032, -126.15084734305397, -66.47406403775724, -115.99824983273221, -57.9858862929164, -112.65302511842087, -42.680047118290474, -88.04109734729305, -75.713989937407, -73.70637297587722, -95.27763932558176, -98.73903806289769, -60.57134472185461, -59.33925358674602, -165.40791969492005, -98.60327143440061, -87.46533687415915, -66.9650879737315, -57.30674703694659, -67.44246599936876, -83.67908921860234, -67.9519057659042, -157.99412023429963, -89.5187878024923, -134.95560791431592, -71.4066025740558, -93.34067453510626, -75.50262967454256, -113.34430413796557, -135.39316333460104, -113.36923527692346, -64.31943844424693, -72.09579837034117, -78.89676853988506, -93.38203745164692, -103.73724863632835, -55.31343925945148, -124.50374699178639, -88.97447338323263, -55.02202528076444, -83.31496285740339, -65.87979211869605, -106.50426452106771, -58.69178423649917, -66.92129678086012, -127.48624777346656, -137.0908740090718, -73.98198418422443, -100.41731721716988, -114.26624198321244, -71.9729418561271, -90.03547476981518, -145.2453935820194, -65.85125581403489, -66.33312974390145, -58.52613429337643, -110.05361668022248, -73.51455504319924, -66.43794957100607], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.624607941733185, "mean_inference_ms": 5.459625155265887, "mean_action_processing_ms": 0.20269419068938008, "mean_env_wait_ms": 1.420644526171734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2268000, "num_agent_steps_trained": 2268000, "num_env_steps_sampled": 2268000, "num_env_steps_trained": 2268000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2268000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2268000, "timers": {"training_iteration_time_ms": 79782.204, "load_time_ms": 40.683, "load_throughput": 344121.6, "learn_time_ms": 69365.897, "learn_throughput": 201.828, "synch_weights_time_ms": 8.32}, "counters": {"num_env_steps_sampled": 2268000, "num_env_steps_trained": 2268000, "num_agent_steps_sampled": 2268000, "num_agent_steps_trained": 2268000}, "done": false, "episodes_total": 2268, "training_iteration": 162, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-21-01", "timestamp": 1693063261, "time_this_iter_s": 79.84582543373108, "time_total_s": 12408.949410200119, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150788B0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270157F7760>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 12408.949410200119, "timesteps_since_restore": 0, "iterations_since_restore": 162, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 24.14017857142857, "ram_util_percent": 50.97500000000001}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -280.3862470645457, "episode_L1_reward_sum_min": -539.9423525929451, "episode_L1_reward_sum_max": -161.8030005171895, "episode_L2_reward_sum_mean": -147.214595618397, "episode_L2_reward_sum_min": -212.38666707277298, "episode_L2_reward_sum_max": -117.10460609197617}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.10664369503094588, "policy_loss": 0.08089546273762376, "vf_loss": 0.25748232095395623, "vf_explained_var": 0.6557598104815424, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2282000, "num_env_steps_trained": 2282000, "num_agent_steps_sampled": 2282000, "num_agent_steps_trained": 2282000}, "sampler_results": {"episode_reward_max": -42.680047118290474, "episode_reward_min": -176.95399698732658, "episode_reward_mean": -92.07533387350624, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -280.3862470645457, "episode_L1_reward_sum_min": -539.9423525929451, "episode_L1_reward_sum_max": -161.8030005171895, "episode_L2_reward_sum_mean": -147.214595618397, "episode_L2_reward_sum_min": -212.38666707277298, "episode_L2_reward_sum_max": -117.10460609197617}, "hist_stats": {"episode_reward": [-47.34053325909789, -128.2868033319785, -107.82545409806909, -90.35034171863158, -68.49646223920064, -92.50067625281484, -69.50995764472594, -61.062785105935184, -88.03834215458748, -85.80455384372132, -125.86039915820008, -60.37013303973678, -59.21694949129377, -109.89706030538733, -87.55754270267705, -132.17000976951684, -64.58576070700956, -73.59962187391804, -55.53674277328401, -171.73666185858065, -78.03881260116412, -176.95399698732658, -74.74938044645758, -108.72836492954431, -91.27867661029254, -121.79543506073732, -88.74748611066897, -92.55841744993032, -126.15084734305397, -66.47406403775724, -115.99824983273221, -57.9858862929164, -112.65302511842087, -42.680047118290474, -88.04109734729305, -75.713989937407, -73.70637297587722, -95.27763932558176, -98.73903806289769, -60.57134472185461, -59.33925358674602, -165.40791969492005, -98.60327143440061, -87.46533687415915, -66.9650879737315, -57.30674703694659, -67.44246599936876, -83.67908921860234, -67.9519057659042, -157.99412023429963, -89.5187878024923, -134.95560791431592, -71.4066025740558, -93.34067453510626, -75.50262967454256, -113.34430413796557, -135.39316333460104, -113.36923527692346, -64.31943844424693, -72.09579837034117, -78.89676853988506, -93.38203745164692, -103.73724863632835, -55.31343925945148, -124.50374699178639, -88.97447338323263, -55.02202528076444, -83.31496285740339, -65.87979211869605, -106.50426452106771, -58.69178423649917, -66.92129678086012, -127.48624777346656, -137.0908740090718, -73.98198418422443, -100.41731721716988, -114.26624198321244, -71.9729418561271, -90.03547476981518, -145.2453935820194, -65.85125581403489, -66.33312974390145, -58.52613429337643, -110.05361668022248, -73.51455504319924, -66.43794957100607, -72.73051755755789, -153.1354493117812, -65.1670233586508, -84.5243861558027, -104.68124364210293, -81.81983428637024, -83.3372183734325, -124.24950356814762, -113.27291731251655, -107.47066310949837, -91.26416597316538, -147.07193433717094, -127.84478098912558, -66.618389274593], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6265654895192185, "mean_inference_ms": 5.470066103451985, "mean_action_processing_ms": 0.20307626874557236, "mean_env_wait_ms": 1.4234119684934132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -42.680047118290474, "episode_reward_min": -176.95399698732658, "episode_reward_mean": -92.07533387350624, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-47.34053325909789, -128.2868033319785, -107.82545409806909, -90.35034171863158, -68.49646223920064, -92.50067625281484, -69.50995764472594, -61.062785105935184, -88.03834215458748, -85.80455384372132, -125.86039915820008, -60.37013303973678, -59.21694949129377, -109.89706030538733, -87.55754270267705, -132.17000976951684, -64.58576070700956, -73.59962187391804, -55.53674277328401, -171.73666185858065, -78.03881260116412, -176.95399698732658, -74.74938044645758, -108.72836492954431, -91.27867661029254, -121.79543506073732, -88.74748611066897, -92.55841744993032, -126.15084734305397, -66.47406403775724, -115.99824983273221, -57.9858862929164, -112.65302511842087, -42.680047118290474, -88.04109734729305, -75.713989937407, -73.70637297587722, -95.27763932558176, -98.73903806289769, -60.57134472185461, -59.33925358674602, -165.40791969492005, -98.60327143440061, -87.46533687415915, -66.9650879737315, -57.30674703694659, -67.44246599936876, -83.67908921860234, -67.9519057659042, -157.99412023429963, -89.5187878024923, -134.95560791431592, -71.4066025740558, -93.34067453510626, -75.50262967454256, -113.34430413796557, -135.39316333460104, -113.36923527692346, -64.31943844424693, -72.09579837034117, -78.89676853988506, -93.38203745164692, -103.73724863632835, -55.31343925945148, -124.50374699178639, -88.97447338323263, -55.02202528076444, -83.31496285740339, -65.87979211869605, -106.50426452106771, -58.69178423649917, -66.92129678086012, -127.48624777346656, -137.0908740090718, -73.98198418422443, -100.41731721716988, -114.26624198321244, -71.9729418561271, -90.03547476981518, -145.2453935820194, -65.85125581403489, -66.33312974390145, -58.52613429337643, -110.05361668022248, -73.51455504319924, -66.43794957100607, -72.73051755755789, -153.1354493117812, -65.1670233586508, -84.5243861558027, -104.68124364210293, -81.81983428637024, -83.3372183734325, -124.24950356814762, -113.27291731251655, -107.47066310949837, -91.26416597316538, -147.07193433717094, -127.84478098912558, -66.618389274593], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6265654895192185, "mean_inference_ms": 5.470066103451985, "mean_action_processing_ms": 0.20307626874557236, "mean_env_wait_ms": 1.4234119684934132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2282000, "num_agent_steps_trained": 2282000, "num_env_steps_sampled": 2282000, "num_env_steps_trained": 2282000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2282000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2282000, "timers": {"training_iteration_time_ms": 79887.614, "load_time_ms": 41.381, "load_throughput": 338317.947, "learn_time_ms": 69425.372, "learn_throughput": 201.655, "synch_weights_time_ms": 7.923}, "counters": {"num_env_steps_sampled": 2282000, "num_env_steps_trained": 2282000, "num_agent_steps_sampled": 2282000, "num_agent_steps_trained": 2282000}, "done": false, "episodes_total": 2282, "training_iteration": 163, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-22-21", "timestamp": 1693063341, "time_this_iter_s": 80.00101327896118, "time_total_s": 12488.95042347908, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015078580>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027013E9FF40>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 12488.95042347908, "timesteps_since_restore": 0, "iterations_since_restore": 163, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 24.081578947368417, "ram_util_percent": 51.03859649122809}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -286.31199207767844, "episode_L1_reward_sum_min": -539.9423525929451, "episode_L1_reward_sum_max": -163.3451821655035, "episode_L2_reward_sum_mean": -148.65129667729138, "episode_L2_reward_sum_min": -212.38666707277298, "episode_L2_reward_sum_max": -117.49537389725447}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.0809376974630365, "policy_loss": 0.05585532488278401, "vf_loss": 0.2508237216389387, "vf_explained_var": 0.6613472914744797, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2296000, "num_env_steps_trained": 2296000, "num_agent_steps_sampled": 2296000, "num_agent_steps_trained": 2296000}, "sampler_results": {"episode_reward_max": -42.680047118290474, "episode_reward_min": -176.95399698732658, "episode_reward_mean": -93.64724993359332, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -286.31199207767844, "episode_L1_reward_sum_min": -539.9423525929451, "episode_L1_reward_sum_max": -163.3451821655035, "episode_L2_reward_sum_mean": -148.65129667729138, "episode_L2_reward_sum_min": -212.38666707277298, "episode_L2_reward_sum_max": -117.49537389725447}, "hist_stats": {"episode_reward": [-87.55754270267705, -132.17000976951684, -64.58576070700956, -73.59962187391804, -55.53674277328401, -171.73666185858065, -78.03881260116412, -176.95399698732658, -74.74938044645758, -108.72836492954431, -91.27867661029254, -121.79543506073732, -88.74748611066897, -92.55841744993032, -126.15084734305397, -66.47406403775724, -115.99824983273221, -57.9858862929164, -112.65302511842087, -42.680047118290474, -88.04109734729305, -75.713989937407, -73.70637297587722, -95.27763932558176, -98.73903806289769, -60.57134472185461, -59.33925358674602, -165.40791969492005, -98.60327143440061, -87.46533687415915, -66.9650879737315, -57.30674703694659, -67.44246599936876, -83.67908921860234, -67.9519057659042, -157.99412023429963, -89.5187878024923, -134.95560791431592, -71.4066025740558, -93.34067453510626, -75.50262967454256, -113.34430413796557, -135.39316333460104, -113.36923527692346, -64.31943844424693, -72.09579837034117, -78.89676853988506, -93.38203745164692, -103.73724863632835, -55.31343925945148, -124.50374699178639, -88.97447338323263, -55.02202528076444, -83.31496285740339, -65.87979211869605, -106.50426452106771, -58.69178423649917, -66.92129678086012, -127.48624777346656, -137.0908740090718, -73.98198418422443, -100.41731721716988, -114.26624198321244, -71.9729418561271, -90.03547476981518, -145.2453935820194, -65.85125581403489, -66.33312974390145, -58.52613429337643, -110.05361668022248, -73.51455504319924, -66.43794957100607, -72.73051755755789, -153.1354493117812, -65.1670233586508, -84.5243861558027, -104.68124364210293, -81.81983428637024, -83.3372183734325, -124.24950356814762, -113.27291731251655, -107.47066310949837, -91.26416597316538, -147.07193433717094, -127.84478098912558, -66.618389274593, -101.82746702588462, -70.23093177518776, -43.14372266366465, -142.01981324495935, -143.97805374408492, -102.85759449805005, -99.06405047652362, -101.66350031894979, -104.40557789671841, -164.65112622148564, -67.0912530650452, -54.08350433355318, -81.2573810763442, -75.47808131163458], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6284758812004774, "mean_inference_ms": 5.480358200684193, "mean_action_processing_ms": 0.2034551256748221, "mean_env_wait_ms": 1.426133123886069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -42.680047118290474, "episode_reward_min": -176.95399698732658, "episode_reward_mean": -93.64724993359332, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-87.55754270267705, -132.17000976951684, -64.58576070700956, -73.59962187391804, -55.53674277328401, -171.73666185858065, -78.03881260116412, -176.95399698732658, -74.74938044645758, -108.72836492954431, -91.27867661029254, -121.79543506073732, -88.74748611066897, -92.55841744993032, -126.15084734305397, -66.47406403775724, -115.99824983273221, -57.9858862929164, -112.65302511842087, -42.680047118290474, -88.04109734729305, -75.713989937407, -73.70637297587722, -95.27763932558176, -98.73903806289769, -60.57134472185461, -59.33925358674602, -165.40791969492005, -98.60327143440061, -87.46533687415915, -66.9650879737315, -57.30674703694659, -67.44246599936876, -83.67908921860234, -67.9519057659042, -157.99412023429963, -89.5187878024923, -134.95560791431592, -71.4066025740558, -93.34067453510626, -75.50262967454256, -113.34430413796557, -135.39316333460104, -113.36923527692346, -64.31943844424693, -72.09579837034117, -78.89676853988506, -93.38203745164692, -103.73724863632835, -55.31343925945148, -124.50374699178639, -88.97447338323263, -55.02202528076444, -83.31496285740339, -65.87979211869605, -106.50426452106771, -58.69178423649917, -66.92129678086012, -127.48624777346656, -137.0908740090718, -73.98198418422443, -100.41731721716988, -114.26624198321244, -71.9729418561271, -90.03547476981518, -145.2453935820194, -65.85125581403489, -66.33312974390145, -58.52613429337643, -110.05361668022248, -73.51455504319924, -66.43794957100607, -72.73051755755789, -153.1354493117812, -65.1670233586508, -84.5243861558027, -104.68124364210293, -81.81983428637024, -83.3372183734325, -124.24950356814762, -113.27291731251655, -107.47066310949837, -91.26416597316538, -147.07193433717094, -127.84478098912558, -66.618389274593, -101.82746702588462, -70.23093177518776, -43.14372266366465, -142.01981324495935, -143.97805374408492, -102.85759449805005, -99.06405047652362, -101.66350031894979, -104.40557789671841, -164.65112622148564, -67.0912530650452, -54.08350433355318, -81.2573810763442, -75.47808131163458], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6284758812004774, "mean_inference_ms": 5.480358200684193, "mean_action_processing_ms": 0.2034551256748221, "mean_env_wait_ms": 1.426133123886069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2296000, "num_agent_steps_trained": 2296000, "num_env_steps_sampled": 2296000, "num_env_steps_trained": 2296000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2296000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2296000, "timers": {"training_iteration_time_ms": 79942.221, "load_time_ms": 42.478, "load_throughput": 329580.791, "learn_time_ms": 69460.769, "learn_throughput": 201.553, "synch_weights_time_ms": 7.819}, "counters": {"num_env_steps_sampled": 2296000, "num_env_steps_trained": 2296000, "num_agent_steps_sampled": 2296000, "num_agent_steps_trained": 2296000}, "done": false, "episodes_total": 2296, "training_iteration": 164, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-23-41", "timestamp": 1693063421, "time_this_iter_s": 79.97564649581909, "time_total_s": 12568.9260699749, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270157F7250>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270157F70A0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 12568.9260699749, "timesteps_since_restore": 0, "iterations_since_restore": 164, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 24.160714285714285, "ram_util_percent": 51.0607142857143}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -279.3364923361689, "episode_L1_reward_sum_min": -527.6210639029741, "episode_L1_reward_sum_max": -162.80253087729216, "episode_L2_reward_sum_mean": -146.85011834040284, "episode_L2_reward_sum_min": -208.27196580916643, "episode_L2_reward_sum_max": -117.15049320459366}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.07530025536301757, "policy_loss": 0.05546181920892847, "vf_loss": 0.19838435782396205, "vf_explained_var": 0.6386284095085697, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2310000, "num_env_steps_trained": 2310000, "num_agent_steps_sampled": 2310000, "num_agent_steps_trained": 2310000}, "sampler_results": {"episode_reward_max": -42.680047118290474, "episode_reward_min": -165.40791969492005, "episode_reward_mean": -91.0463225519456, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -279.3364923361689, "episode_L1_reward_sum_min": -527.6210639029741, "episode_L1_reward_sum_max": -162.80253087729216, "episode_L2_reward_sum_mean": -146.85011834040284, "episode_L2_reward_sum_min": -208.27196580916643, "episode_L2_reward_sum_max": -117.15049320459366}, "hist_stats": {"episode_reward": [-126.15084734305397, -66.47406403775724, -115.99824983273221, -57.9858862929164, -112.65302511842087, -42.680047118290474, -88.04109734729305, -75.713989937407, -73.70637297587722, -95.27763932558176, -98.73903806289769, -60.57134472185461, -59.33925358674602, -165.40791969492005, -98.60327143440061, -87.46533687415915, -66.9650879737315, -57.30674703694659, -67.44246599936876, -83.67908921860234, -67.9519057659042, -157.99412023429963, -89.5187878024923, -134.95560791431592, -71.4066025740558, -93.34067453510626, -75.50262967454256, -113.34430413796557, -135.39316333460104, -113.36923527692346, -64.31943844424693, -72.09579837034117, -78.89676853988506, -93.38203745164692, -103.73724863632835, -55.31343925945148, -124.50374699178639, -88.97447338323263, -55.02202528076444, -83.31496285740339, -65.87979211869605, -106.50426452106771, -58.69178423649917, -66.92129678086012, -127.48624777346656, -137.0908740090718, -73.98198418422443, -100.41731721716988, -114.26624198321244, -71.9729418561271, -90.03547476981518, -145.2453935820194, -65.85125581403489, -66.33312974390145, -58.52613429337643, -110.05361668022248, -73.51455504319924, -66.43794957100607, -72.73051755755789, -153.1354493117812, -65.1670233586508, -84.5243861558027, -104.68124364210293, -81.81983428637024, -83.3372183734325, -124.24950356814762, -113.27291731251655, -107.47066310949837, -91.26416597316538, -147.07193433717094, -127.84478098912558, -66.618389274593, -101.82746702588462, -70.23093177518776, -43.14372266366465, -142.01981324495935, -143.97805374408492, -102.85759449805005, -99.06405047652362, -101.66350031894979, -104.40557789671841, -164.65112622148564, -67.0912530650452, -54.08350433355318, -81.2573810763442, -75.47808131163458, -97.63317147728088, -104.42924886982847, -57.10773483846053, -94.25375376149559, -159.08554190086923, -60.79202096242932, -73.81012117659256, -47.43401917881757, -74.66207042947292, -105.68473921562492, -86.49658161373104, -69.19163964813319, -61.310531587182744, -66.05299705641644], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6303271422054124, "mean_inference_ms": 5.490684901896104, "mean_action_processing_ms": 0.20382047716659432, "mean_env_wait_ms": 1.4288946155695652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -42.680047118290474, "episode_reward_min": -165.40791969492005, "episode_reward_mean": -91.0463225519456, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-126.15084734305397, -66.47406403775724, -115.99824983273221, -57.9858862929164, -112.65302511842087, -42.680047118290474, -88.04109734729305, -75.713989937407, -73.70637297587722, -95.27763932558176, -98.73903806289769, -60.57134472185461, -59.33925358674602, -165.40791969492005, -98.60327143440061, -87.46533687415915, -66.9650879737315, -57.30674703694659, -67.44246599936876, -83.67908921860234, -67.9519057659042, -157.99412023429963, -89.5187878024923, -134.95560791431592, -71.4066025740558, -93.34067453510626, -75.50262967454256, -113.34430413796557, -135.39316333460104, -113.36923527692346, -64.31943844424693, -72.09579837034117, -78.89676853988506, -93.38203745164692, -103.73724863632835, -55.31343925945148, -124.50374699178639, -88.97447338323263, -55.02202528076444, -83.31496285740339, -65.87979211869605, -106.50426452106771, -58.69178423649917, -66.92129678086012, -127.48624777346656, -137.0908740090718, -73.98198418422443, -100.41731721716988, -114.26624198321244, -71.9729418561271, -90.03547476981518, -145.2453935820194, -65.85125581403489, -66.33312974390145, -58.52613429337643, -110.05361668022248, -73.51455504319924, -66.43794957100607, -72.73051755755789, -153.1354493117812, -65.1670233586508, -84.5243861558027, -104.68124364210293, -81.81983428637024, -83.3372183734325, -124.24950356814762, -113.27291731251655, -107.47066310949837, -91.26416597316538, -147.07193433717094, -127.84478098912558, -66.618389274593, -101.82746702588462, -70.23093177518776, -43.14372266366465, -142.01981324495935, -143.97805374408492, -102.85759449805005, -99.06405047652362, -101.66350031894979, -104.40557789671841, -164.65112622148564, -67.0912530650452, -54.08350433355318, -81.2573810763442, -75.47808131163458, -97.63317147728088, -104.42924886982847, -57.10773483846053, -94.25375376149559, -159.08554190086923, -60.79202096242932, -73.81012117659256, -47.43401917881757, -74.66207042947292, -105.68473921562492, -86.49658161373104, -69.19163964813319, -61.310531587182744, -66.05299705641644], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6303271422054124, "mean_inference_ms": 5.490684901896104, "mean_action_processing_ms": 0.20382047716659432, "mean_env_wait_ms": 1.4288946155695652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2310000, "num_agent_steps_trained": 2310000, "num_env_steps_sampled": 2310000, "num_env_steps_trained": 2310000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2310000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2310000, "timers": {"training_iteration_time_ms": 80007.489, "load_time_ms": 39.785, "load_throughput": 351889.275, "learn_time_ms": 69485.0, "learn_throughput": 201.482, "synch_weights_time_ms": 7.932}, "counters": {"num_env_steps_sampled": 2310000, "num_env_steps_trained": 2310000, "num_agent_steps_sampled": 2310000, "num_agent_steps_trained": 2310000}, "done": false, "episodes_total": 2310, "training_iteration": 165, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-25-02", "timestamp": 1693063502, "time_this_iter_s": 80.23747372627258, "time_total_s": 12649.163543701172, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150A2400>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701542AAF0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 12649.163543701172, "timesteps_since_restore": 0, "iterations_since_restore": 165, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 24.006140350877192, "ram_util_percent": 51.13508771929825}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -270.9750972944498, "episode_L1_reward_sum_min": -527.6210639029741, "episode_L1_reward_sum_max": -162.80253087729216, "episode_L2_reward_sum_mean": -144.7216934131086, "episode_L2_reward_sum_min": -208.27196580916643, "episode_L2_reward_sum_max": -117.15049320459366}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.1194348428177996, "policy_loss": 0.10001048409483498, "vf_loss": 0.1942435874931873, "vf_explained_var": 0.48578063515110764, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2324000, "num_env_steps_trained": 2324000, "num_agent_steps_sampled": 2324000, "num_agent_steps_trained": 2324000}, "sampler_results": {"episode_reward_max": -40.85536526555164, "episode_reward_min": -164.65112622148564, "episode_reward_mean": -88.09374560577601, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -270.9750972944498, "episode_L1_reward_sum_min": -527.6210639029741, "episode_L1_reward_sum_max": -162.80253087729216, "episode_L2_reward_sum_mean": -144.7216934131086, "episode_L2_reward_sum_min": -208.27196580916643, "episode_L2_reward_sum_max": -117.15049320459366}, "hist_stats": {"episode_reward": [-98.60327143440061, -87.46533687415915, -66.9650879737315, -57.30674703694659, -67.44246599936876, -83.67908921860234, -67.9519057659042, -157.99412023429963, -89.5187878024923, -134.95560791431592, -71.4066025740558, -93.34067453510626, -75.50262967454256, -113.34430413796557, -135.39316333460104, -113.36923527692346, -64.31943844424693, -72.09579837034117, -78.89676853988506, -93.38203745164692, -103.73724863632835, -55.31343925945148, -124.50374699178639, -88.97447338323263, -55.02202528076444, -83.31496285740339, -65.87979211869605, -106.50426452106771, -58.69178423649917, -66.92129678086012, -127.48624777346656, -137.0908740090718, -73.98198418422443, -100.41731721716988, -114.26624198321244, -71.9729418561271, -90.03547476981518, -145.2453935820194, -65.85125581403489, -66.33312974390145, -58.52613429337643, -110.05361668022248, -73.51455504319924, -66.43794957100607, -72.73051755755789, -153.1354493117812, -65.1670233586508, -84.5243861558027, -104.68124364210293, -81.81983428637024, -83.3372183734325, -124.24950356814762, -113.27291731251655, -107.47066310949837, -91.26416597316538, -147.07193433717094, -127.84478098912558, -66.618389274593, -101.82746702588462, -70.23093177518776, -43.14372266366465, -142.01981324495935, -143.97805374408492, -102.85759449805005, -99.06405047652362, -101.66350031894979, -104.40557789671841, -164.65112622148564, -67.0912530650452, -54.08350433355318, -81.2573810763442, -75.47808131163458, -97.63317147728088, -104.42924886982847, -57.10773483846053, -94.25375376149559, -159.08554190086923, -60.79202096242932, -73.81012117659256, -47.43401917881757, -74.66207042947292, -105.68473921562492, -86.49658161373104, -69.19163964813319, -61.310531587182744, -66.05299705641644, -67.0295381445946, -41.852113911597776, -80.89568088868887, -40.85536526555164, -56.93817007062127, -51.440372362824355, -147.27899116521172, -60.82291815647359, -78.9192555608834, -49.430525947488896, -80.2028455156626, -58.06183574244197, -68.28247175225478, -61.47099629449456], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6321643951386112, "mean_inference_ms": 5.50090819952499, "mean_action_processing_ms": 0.20418228359208535, "mean_env_wait_ms": 1.4316240197994403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -40.85536526555164, "episode_reward_min": -164.65112622148564, "episode_reward_mean": -88.09374560577601, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-98.60327143440061, -87.46533687415915, -66.9650879737315, -57.30674703694659, -67.44246599936876, -83.67908921860234, -67.9519057659042, -157.99412023429963, -89.5187878024923, -134.95560791431592, -71.4066025740558, -93.34067453510626, -75.50262967454256, -113.34430413796557, -135.39316333460104, -113.36923527692346, -64.31943844424693, -72.09579837034117, -78.89676853988506, -93.38203745164692, -103.73724863632835, -55.31343925945148, -124.50374699178639, -88.97447338323263, -55.02202528076444, -83.31496285740339, -65.87979211869605, -106.50426452106771, -58.69178423649917, -66.92129678086012, -127.48624777346656, -137.0908740090718, -73.98198418422443, -100.41731721716988, -114.26624198321244, -71.9729418561271, -90.03547476981518, -145.2453935820194, -65.85125581403489, -66.33312974390145, -58.52613429337643, -110.05361668022248, -73.51455504319924, -66.43794957100607, -72.73051755755789, -153.1354493117812, -65.1670233586508, -84.5243861558027, -104.68124364210293, -81.81983428637024, -83.3372183734325, -124.24950356814762, -113.27291731251655, -107.47066310949837, -91.26416597316538, -147.07193433717094, -127.84478098912558, -66.618389274593, -101.82746702588462, -70.23093177518776, -43.14372266366465, -142.01981324495935, -143.97805374408492, -102.85759449805005, -99.06405047652362, -101.66350031894979, -104.40557789671841, -164.65112622148564, -67.0912530650452, -54.08350433355318, -81.2573810763442, -75.47808131163458, -97.63317147728088, -104.42924886982847, -57.10773483846053, -94.25375376149559, -159.08554190086923, -60.79202096242932, -73.81012117659256, -47.43401917881757, -74.66207042947292, -105.68473921562492, -86.49658161373104, -69.19163964813319, -61.310531587182744, -66.05299705641644, -67.0295381445946, -41.852113911597776, -80.89568088868887, -40.85536526555164, -56.93817007062127, -51.440372362824355, -147.27899116521172, -60.82291815647359, -78.9192555608834, -49.430525947488896, -80.2028455156626, -58.06183574244197, -68.28247175225478, -61.47099629449456], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6321643951386112, "mean_inference_ms": 5.50090819952499, "mean_action_processing_ms": 0.20418228359208535, "mean_env_wait_ms": 1.4316240197994403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2324000, "num_agent_steps_trained": 2324000, "num_env_steps_sampled": 2324000, "num_env_steps_trained": 2324000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2324000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2324000, "timers": {"training_iteration_time_ms": 80029.094, "load_time_ms": 41.343, "load_throughput": 338632.064, "learn_time_ms": 69489.745, "learn_throughput": 201.469, "synch_weights_time_ms": 8.826}, "counters": {"num_env_steps_sampled": 2324000, "num_env_steps_trained": 2324000, "num_agent_steps_sampled": 2324000, "num_agent_steps_trained": 2324000}, "done": false, "episodes_total": 2324, "training_iteration": 166, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-26-22", "timestamp": 1693063582, "time_this_iter_s": 80.1364414691925, "time_total_s": 12729.299985170364, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015657F40>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701542A6A0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 12729.299985170364, "timesteps_since_restore": 0, "iterations_since_restore": 166, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 24.158407079646018, "ram_util_percent": 51.12300884955753}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -268.948452931121, "episode_L1_reward_sum_min": -549.688737899065, "episode_L1_reward_sum_max": -162.80253087729216, "episode_L2_reward_sum_mean": -144.25774970002473, "episode_L2_reward_sum_min": -214.67491817474365, "episode_L2_reward_sum_max": -117.15049320459366}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.09952816941870658, "policy_loss": 0.0749521781006838, "vf_loss": 0.24575990987911797, "vf_explained_var": 0.5465502255431418, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2338000, "num_env_steps_trained": 2338000, "num_agent_steps_sampled": 2338000, "num_agent_steps_trained": 2338000}, "sampler_results": {"episode_reward_max": -37.87669173878198, "episode_reward_min": -164.65112622148564, "episode_reward_mean": -86.13069120799587, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -268.948452931121, "episode_L1_reward_sum_min": -549.688737899065, "episode_L1_reward_sum_max": -162.80253087729216, "episode_L2_reward_sum_mean": -144.25774970002473, "episode_L2_reward_sum_min": -214.67491817474365, "episode_L2_reward_sum_max": -117.15049320459366}, "hist_stats": {"episode_reward": [-135.39316333460104, -113.36923527692346, -64.31943844424693, -72.09579837034117, -78.89676853988506, -93.38203745164692, -103.73724863632835, -55.31343925945148, -124.50374699178639, -88.97447338323263, -55.02202528076444, -83.31496285740339, -65.87979211869605, -106.50426452106771, -58.69178423649917, -66.92129678086012, -127.48624777346656, -137.0908740090718, -73.98198418422443, -100.41731721716988, -114.26624198321244, -71.9729418561271, -90.03547476981518, -145.2453935820194, -65.85125581403489, -66.33312974390145, -58.52613429337643, -110.05361668022248, -73.51455504319924, -66.43794957100607, -72.73051755755789, -153.1354493117812, -65.1670233586508, -84.5243861558027, -104.68124364210293, -81.81983428637024, -83.3372183734325, -124.24950356814762, -113.27291731251655, -107.47066310949837, -91.26416597316538, -147.07193433717094, -127.84478098912558, -66.618389274593, -101.82746702588462, -70.23093177518776, -43.14372266366465, -142.01981324495935, -143.97805374408492, -102.85759449805005, -99.06405047652362, -101.66350031894979, -104.40557789671841, -164.65112622148564, -67.0912530650452, -54.08350433355318, -81.2573810763442, -75.47808131163458, -97.63317147728088, -104.42924886982847, -57.10773483846053, -94.25375376149559, -159.08554190086923, -60.79202096242932, -73.81012117659256, -47.43401917881757, -74.66207042947292, -105.68473921562492, -86.49658161373104, -69.19163964813319, -61.310531587182744, -66.05299705641644, -67.0295381445946, -41.852113911597776, -80.89568088868887, -40.85536526555164, -56.93817007062127, -51.440372362824355, -147.27899116521172, -60.82291815647359, -78.9192555608834, -49.430525947488896, -80.2028455156626, -58.06183574244197, -68.28247175225478, -61.47099629449456, -53.13682786226144, -75.06789942501062, -50.355830008588846, -122.23470193895396, -99.7830361841814, -65.86153328755981, -63.73830796271856, -90.11251474587293, -157.43066662404902, -65.34584228200757, -37.87669173878198, -62.053478587577615, -59.05559593752501, -67.11826481278838], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6339660650589377, "mean_inference_ms": 5.510865230231839, "mean_action_processing_ms": 0.20453207095559434, "mean_env_wait_ms": 1.4342769062419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -37.87669173878198, "episode_reward_min": -164.65112622148564, "episode_reward_mean": -86.13069120799587, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-135.39316333460104, -113.36923527692346, -64.31943844424693, -72.09579837034117, -78.89676853988506, -93.38203745164692, -103.73724863632835, -55.31343925945148, -124.50374699178639, -88.97447338323263, -55.02202528076444, -83.31496285740339, -65.87979211869605, -106.50426452106771, -58.69178423649917, -66.92129678086012, -127.48624777346656, -137.0908740090718, -73.98198418422443, -100.41731721716988, -114.26624198321244, -71.9729418561271, -90.03547476981518, -145.2453935820194, -65.85125581403489, -66.33312974390145, -58.52613429337643, -110.05361668022248, -73.51455504319924, -66.43794957100607, -72.73051755755789, -153.1354493117812, -65.1670233586508, -84.5243861558027, -104.68124364210293, -81.81983428637024, -83.3372183734325, -124.24950356814762, -113.27291731251655, -107.47066310949837, -91.26416597316538, -147.07193433717094, -127.84478098912558, -66.618389274593, -101.82746702588462, -70.23093177518776, -43.14372266366465, -142.01981324495935, -143.97805374408492, -102.85759449805005, -99.06405047652362, -101.66350031894979, -104.40557789671841, -164.65112622148564, -67.0912530650452, -54.08350433355318, -81.2573810763442, -75.47808131163458, -97.63317147728088, -104.42924886982847, -57.10773483846053, -94.25375376149559, -159.08554190086923, -60.79202096242932, -73.81012117659256, -47.43401917881757, -74.66207042947292, -105.68473921562492, -86.49658161373104, -69.19163964813319, -61.310531587182744, -66.05299705641644, -67.0295381445946, -41.852113911597776, -80.89568088868887, -40.85536526555164, -56.93817007062127, -51.440372362824355, -147.27899116521172, -60.82291815647359, -78.9192555608834, -49.430525947488896, -80.2028455156626, -58.06183574244197, -68.28247175225478, -61.47099629449456, -53.13682786226144, -75.06789942501062, -50.355830008588846, -122.23470193895396, -99.7830361841814, -65.86153328755981, -63.73830796271856, -90.11251474587293, -157.43066662404902, -65.34584228200757, -37.87669173878198, -62.053478587577615, -59.05559593752501, -67.11826481278838], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6339660650589377, "mean_inference_ms": 5.510865230231839, "mean_action_processing_ms": 0.20453207095559434, "mean_env_wait_ms": 1.4342769062419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2338000, "num_agent_steps_trained": 2338000, "num_env_steps_sampled": 2338000, "num_env_steps_trained": 2338000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2338000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2338000, "timers": {"training_iteration_time_ms": 79986.609, "load_time_ms": 41.146, "load_throughput": 340248.696, "learn_time_ms": 69469.394, "learn_throughput": 201.528, "synch_weights_time_ms": 7.931}, "counters": {"num_env_steps_sampled": 2338000, "num_env_steps_trained": 2338000, "num_agent_steps_sampled": 2338000, "num_agent_steps_trained": 2338000}, "done": false, "episodes_total": 2338, "training_iteration": 167, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-27-42", "timestamp": 1693063662, "time_this_iter_s": 79.77077627182007, "time_total_s": 12809.070761442184, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270151C0430>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014F641F0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 12809.070761442184, "timesteps_since_restore": 0, "iterations_since_restore": 167, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 24.23482142857143, "ram_util_percent": 51.179464285714275}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -268.1217163340002, "episode_L1_reward_sum_min": -549.688737899065, "episode_L1_reward_sum_max": -162.1279963850975, "episode_L2_reward_sum_mean": -144.01170987203716, "episode_L2_reward_sum_min": -214.67491817474365, "episode_L2_reward_sum_max": -116.35717732459307}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.08936992747283946, "policy_loss": 0.06626350988557189, "vf_loss": 0.23106417041915037, "vf_explained_var": 0.6308607818413173, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2352000, "num_env_steps_trained": 2352000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "sampler_results": {"episode_reward_max": -29.433158127755004, "episode_reward_min": -164.65112622148564, "episode_reward_mean": -85.45535005388358, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -268.1217163340002, "episode_L1_reward_sum_min": -549.688737899065, "episode_L1_reward_sum_max": -162.1279963850975, "episode_L2_reward_sum_mean": -144.01170987203716, "episode_L2_reward_sum_min": -214.67491817474365, "episode_L2_reward_sum_max": -116.35717732459307}, "hist_stats": {"episode_reward": [-58.69178423649917, -66.92129678086012, -127.48624777346656, -137.0908740090718, -73.98198418422443, -100.41731721716988, -114.26624198321244, -71.9729418561271, -90.03547476981518, -145.2453935820194, -65.85125581403489, -66.33312974390145, -58.52613429337643, -110.05361668022248, -73.51455504319924, -66.43794957100607, -72.73051755755789, -153.1354493117812, -65.1670233586508, -84.5243861558027, -104.68124364210293, -81.81983428637024, -83.3372183734325, -124.24950356814762, -113.27291731251655, -107.47066310949837, -91.26416597316538, -147.07193433717094, -127.84478098912558, -66.618389274593, -101.82746702588462, -70.23093177518776, -43.14372266366465, -142.01981324495935, -143.97805374408492, -102.85759449805005, -99.06405047652362, -101.66350031894979, -104.40557789671841, -164.65112622148564, -67.0912530650452, -54.08350433355318, -81.2573810763442, -75.47808131163458, -97.63317147728088, -104.42924886982847, -57.10773483846053, -94.25375376149559, -159.08554190086923, -60.79202096242932, -73.81012117659256, -47.43401917881757, -74.66207042947292, -105.68473921562492, -86.49658161373104, -69.19163964813319, -61.310531587182744, -66.05299705641644, -67.0295381445946, -41.852113911597776, -80.89568088868887, -40.85536526555164, -56.93817007062127, -51.440372362824355, -147.27899116521172, -60.82291815647359, -78.9192555608834, -49.430525947488896, -80.2028455156626, -58.06183574244197, -68.28247175225478, -61.47099629449456, -53.13682786226144, -75.06789942501062, -50.355830008588846, -122.23470193895396, -99.7830361841814, -65.86153328755981, -63.73830796271856, -90.11251474587293, -157.43066662404902, -65.34584228200757, -37.87669173878198, -62.053478587577615, -59.05559593752501, -67.11826481278838, -70.0778549099735, -149.8302539409117, -69.12533381915397, -83.13955987690306, -129.44336127731034, -45.3778288699242, -50.29819685924846, -93.05386012958287, -29.433158127755004, -96.72182075654919, -112.8982972427879, -63.63831473412691, -117.69604356945645, -62.438394941462164], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6357597418646407, "mean_inference_ms": 5.520707265271609, "mean_action_processing_ms": 0.2048794432137801, "mean_env_wait_ms": 1.4368990860715092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -29.433158127755004, "episode_reward_min": -164.65112622148564, "episode_reward_mean": -85.45535005388358, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-58.69178423649917, -66.92129678086012, -127.48624777346656, -137.0908740090718, -73.98198418422443, -100.41731721716988, -114.26624198321244, -71.9729418561271, -90.03547476981518, -145.2453935820194, -65.85125581403489, -66.33312974390145, -58.52613429337643, -110.05361668022248, -73.51455504319924, -66.43794957100607, -72.73051755755789, -153.1354493117812, -65.1670233586508, -84.5243861558027, -104.68124364210293, -81.81983428637024, -83.3372183734325, -124.24950356814762, -113.27291731251655, -107.47066310949837, -91.26416597316538, -147.07193433717094, -127.84478098912558, -66.618389274593, -101.82746702588462, -70.23093177518776, -43.14372266366465, -142.01981324495935, -143.97805374408492, -102.85759449805005, -99.06405047652362, -101.66350031894979, -104.40557789671841, -164.65112622148564, -67.0912530650452, -54.08350433355318, -81.2573810763442, -75.47808131163458, -97.63317147728088, -104.42924886982847, -57.10773483846053, -94.25375376149559, -159.08554190086923, -60.79202096242932, -73.81012117659256, -47.43401917881757, -74.66207042947292, -105.68473921562492, -86.49658161373104, -69.19163964813319, -61.310531587182744, -66.05299705641644, -67.0295381445946, -41.852113911597776, -80.89568088868887, -40.85536526555164, -56.93817007062127, -51.440372362824355, -147.27899116521172, -60.82291815647359, -78.9192555608834, -49.430525947488896, -80.2028455156626, -58.06183574244197, -68.28247175225478, -61.47099629449456, -53.13682786226144, -75.06789942501062, -50.355830008588846, -122.23470193895396, -99.7830361841814, -65.86153328755981, -63.73830796271856, -90.11251474587293, -157.43066662404902, -65.34584228200757, -37.87669173878198, -62.053478587577615, -59.05559593752501, -67.11826481278838, -70.0778549099735, -149.8302539409117, -69.12533381915397, -83.13955987690306, -129.44336127731034, -45.3778288699242, -50.29819685924846, -93.05386012958287, -29.433158127755004, -96.72182075654919, -112.8982972427879, -63.63831473412691, -117.69604356945645, -62.438394941462164], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6357597418646407, "mean_inference_ms": 5.520707265271609, "mean_action_processing_ms": 0.2048794432137801, "mean_env_wait_ms": 1.4368990860715092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000, "num_env_steps_sampled": 2352000, "num_env_steps_trained": 2352000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2352000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2352000, "timers": {"training_iteration_time_ms": 79998.642, "load_time_ms": 41.047, "load_throughput": 341075.79, "learn_time_ms": 69457.633, "learn_throughput": 201.562, "synch_weights_time_ms": 7.936}, "counters": {"num_env_steps_sampled": 2352000, "num_env_steps_trained": 2352000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "done": false, "episodes_total": 2352, "training_iteration": 168, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-29-02", "timestamp": 1693063742, "time_this_iter_s": 80.06401467323303, "time_total_s": 12889.134776115417, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015238F10>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270154223D0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 12889.134776115417, "timesteps_since_restore": 0, "iterations_since_restore": 168, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 24.345132743362832, "ram_util_percent": 51.37345132743362}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -273.5245532668382, "episode_L1_reward_sum_min": -587.8290059268475, "episode_L1_reward_sum_max": -162.1279963850975, "episode_L2_reward_sum_mean": -145.33660159394145, "episode_L2_reward_sum_min": -222.6142479777336, "episode_L2_reward_sum_max": -116.35717732459307}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.07078681101183189, "policy_loss": 0.03522729020903017, "vf_loss": 0.3555952064551421, "vf_explained_var": 0.7876551657485864, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2366000, "num_env_steps_trained": 2366000, "num_agent_steps_sampled": 2366000, "num_agent_steps_trained": 2366000}, "sampler_results": {"episode_reward_max": -29.433158127755004, "episode_reward_min": -207.10130308820885, "episode_reward_mean": -86.7724337589104, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -273.5245532668382, "episode_L1_reward_sum_min": -587.8290059268475, "episode_L1_reward_sum_max": -162.1279963850975, "episode_L2_reward_sum_mean": -145.33660159394145, "episode_L2_reward_sum_min": -222.6142479777336, "episode_L2_reward_sum_max": -116.35717732459307}, "hist_stats": {"episode_reward": [-73.51455504319924, -66.43794957100607, -72.73051755755789, -153.1354493117812, -65.1670233586508, -84.5243861558027, -104.68124364210293, -81.81983428637024, -83.3372183734325, -124.24950356814762, -113.27291731251655, -107.47066310949837, -91.26416597316538, -147.07193433717094, -127.84478098912558, -66.618389274593, -101.82746702588462, -70.23093177518776, -43.14372266366465, -142.01981324495935, -143.97805374408492, -102.85759449805005, -99.06405047652362, -101.66350031894979, -104.40557789671841, -164.65112622148564, -67.0912530650452, -54.08350433355318, -81.2573810763442, -75.47808131163458, -97.63317147728088, -104.42924886982847, -57.10773483846053, -94.25375376149559, -159.08554190086923, -60.79202096242932, -73.81012117659256, -47.43401917881757, -74.66207042947292, -105.68473921562492, -86.49658161373104, -69.19163964813319, -61.310531587182744, -66.05299705641644, -67.0295381445946, -41.852113911597776, -80.89568088868887, -40.85536526555164, -56.93817007062127, -51.440372362824355, -147.27899116521172, -60.82291815647359, -78.9192555608834, -49.430525947488896, -80.2028455156626, -58.06183574244197, -68.28247175225478, -61.47099629449456, -53.13682786226144, -75.06789942501062, -50.355830008588846, -122.23470193895396, -99.7830361841814, -65.86153328755981, -63.73830796271856, -90.11251474587293, -157.43066662404902, -65.34584228200757, -37.87669173878198, -62.053478587577615, -59.05559593752501, -67.11826481278838, -70.0778549099735, -149.8302539409117, -69.12533381915397, -83.13955987690306, -129.44336127731034, -45.3778288699242, -50.29819685924846, -93.05386012958287, -29.433158127755004, -96.72182075654919, -112.8982972427879, -63.63831473412691, -117.69604356945645, -62.438394941462164, -89.79901245218704, -97.65661261488891, -68.61376605090516, -106.83681768141184, -54.87725475176903, -38.88196859038014, -129.11436255952535, -108.69082923469662, -89.32445512513983, -73.28357368618468, -131.02129662675878, -113.03978357674457, -207.10130308820885, -110.34102738788098], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6375688667420891, "mean_inference_ms": 5.5307265997947805, "mean_action_processing_ms": 0.20523277676179766, "mean_env_wait_ms": 1.4395719915461591, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -29.433158127755004, "episode_reward_min": -207.10130308820885, "episode_reward_mean": -86.7724337589104, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-73.51455504319924, -66.43794957100607, -72.73051755755789, -153.1354493117812, -65.1670233586508, -84.5243861558027, -104.68124364210293, -81.81983428637024, -83.3372183734325, -124.24950356814762, -113.27291731251655, -107.47066310949837, -91.26416597316538, -147.07193433717094, -127.84478098912558, -66.618389274593, -101.82746702588462, -70.23093177518776, -43.14372266366465, -142.01981324495935, -143.97805374408492, -102.85759449805005, -99.06405047652362, -101.66350031894979, -104.40557789671841, -164.65112622148564, -67.0912530650452, -54.08350433355318, -81.2573810763442, -75.47808131163458, -97.63317147728088, -104.42924886982847, -57.10773483846053, -94.25375376149559, -159.08554190086923, -60.79202096242932, -73.81012117659256, -47.43401917881757, -74.66207042947292, -105.68473921562492, -86.49658161373104, -69.19163964813319, -61.310531587182744, -66.05299705641644, -67.0295381445946, -41.852113911597776, -80.89568088868887, -40.85536526555164, -56.93817007062127, -51.440372362824355, -147.27899116521172, -60.82291815647359, -78.9192555608834, -49.430525947488896, -80.2028455156626, -58.06183574244197, -68.28247175225478, -61.47099629449456, -53.13682786226144, -75.06789942501062, -50.355830008588846, -122.23470193895396, -99.7830361841814, -65.86153328755981, -63.73830796271856, -90.11251474587293, -157.43066662404902, -65.34584228200757, -37.87669173878198, -62.053478587577615, -59.05559593752501, -67.11826481278838, -70.0778549099735, -149.8302539409117, -69.12533381915397, -83.13955987690306, -129.44336127731034, -45.3778288699242, -50.29819685924846, -93.05386012958287, -29.433158127755004, -96.72182075654919, -112.8982972427879, -63.63831473412691, -117.69604356945645, -62.438394941462164, -89.79901245218704, -97.65661261488891, -68.61376605090516, -106.83681768141184, -54.87725475176903, -38.88196859038014, -129.11436255952535, -108.69082923469662, -89.32445512513983, -73.28357368618468, -131.02129662675878, -113.03978357674457, -207.10130308820885, -110.34102738788098], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6375688667420891, "mean_inference_ms": 5.5307265997947805, "mean_action_processing_ms": 0.20523277676179766, "mean_env_wait_ms": 1.4395719915461591, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2366000, "num_agent_steps_trained": 2366000, "num_env_steps_sampled": 2366000, "num_env_steps_trained": 2366000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2366000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2366000, "timers": {"training_iteration_time_ms": 80069.765, "load_time_ms": 40.747, "load_throughput": 343580.973, "learn_time_ms": 69470.263, "learn_throughput": 201.525, "synch_weights_time_ms": 7.928}, "counters": {"num_env_steps_sampled": 2366000, "num_env_steps_trained": 2366000, "num_agent_steps_sampled": 2366000, "num_agent_steps_trained": 2366000}, "done": false, "episodes_total": 2366, "training_iteration": 169, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-30-22", "timestamp": 1693063822, "time_this_iter_s": 80.63729643821716, "time_total_s": 12969.772072553635, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701534DFD0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014F64B80>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 12969.772072553635, "timesteps_since_restore": 0, "iterations_since_restore": 169, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 25.257017543859646, "ram_util_percent": 51.65701754385964}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -281.5318188206106, "episode_L1_reward_sum_min": -587.8290059268475, "episode_L1_reward_sum_max": -162.1279963850975, "episode_L2_reward_sum_mean": -147.3467557708174, "episode_L2_reward_sum_min": -222.6142479777336, "episode_L2_reward_sum_max": -116.35717732459307}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.10867413313227701, "policy_loss": 0.07473472936784105, "vf_loss": 0.33939403076885216, "vf_explained_var": 0.7804859857929587, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2380000, "num_env_steps_trained": 2380000, "num_agent_steps_sampled": 2380000, "num_agent_steps_trained": 2380000}, "sampler_results": {"episode_reward_max": -29.433158127755004, "episode_reward_min": -207.10130308820885, "episode_reward_mean": -88.00121528585764, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -281.5318188206106, "episode_L1_reward_sum_min": -587.8290059268475, "episode_L1_reward_sum_max": -162.1279963850975, "episode_L2_reward_sum_mean": -147.3467557708174, "episode_L2_reward_sum_min": -222.6142479777336, "episode_L2_reward_sum_max": -116.35717732459307}, "hist_stats": {"episode_reward": [-127.84478098912558, -66.618389274593, -101.82746702588462, -70.23093177518776, -43.14372266366465, -142.01981324495935, -143.97805374408492, -102.85759449805005, -99.06405047652362, -101.66350031894979, -104.40557789671841, -164.65112622148564, -67.0912530650452, -54.08350433355318, -81.2573810763442, -75.47808131163458, -97.63317147728088, -104.42924886982847, -57.10773483846053, -94.25375376149559, -159.08554190086923, -60.79202096242932, -73.81012117659256, -47.43401917881757, -74.66207042947292, -105.68473921562492, -86.49658161373104, -69.19163964813319, -61.310531587182744, -66.05299705641644, -67.0295381445946, -41.852113911597776, -80.89568088868887, -40.85536526555164, -56.93817007062127, -51.440372362824355, -147.27899116521172, -60.82291815647359, -78.9192555608834, -49.430525947488896, -80.2028455156626, -58.06183574244197, -68.28247175225478, -61.47099629449456, -53.13682786226144, -75.06789942501062, -50.355830008588846, -122.23470193895396, -99.7830361841814, -65.86153328755981, -63.73830796271856, -90.11251474587293, -157.43066662404902, -65.34584228200757, -37.87669173878198, -62.053478587577615, -59.05559593752501, -67.11826481278838, -70.0778549099735, -149.8302539409117, -69.12533381915397, -83.13955987690306, -129.44336127731034, -45.3778288699242, -50.29819685924846, -93.05386012958287, -29.433158127755004, -96.72182075654919, -112.8982972427879, -63.63831473412691, -117.69604356945645, -62.438394941462164, -89.79901245218704, -97.65661261488891, -68.61376605090516, -106.83681768141184, -54.87725475176903, -38.88196859038014, -129.11436255952535, -108.69082923469662, -89.32445512513983, -73.28357368618468, -131.02129662675878, -113.03978357674457, -207.10130308820885, -110.34102738788098, -168.09701027258475, -163.63172459772278, -57.16015093601758, -106.49988087848108, -75.20177642627573, -66.96727492382361, -78.63212158795062, -67.56420297450374, -128.5478635904751, -92.0083499964575, -107.9190913336918, -143.31139160451792, -141.30949490081426, -94.7051802718143], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6393748060584755, "mean_inference_ms": 5.5406947479121955, "mean_action_processing_ms": 0.2055821799373181, "mean_env_wait_ms": 1.4422292869826754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -29.433158127755004, "episode_reward_min": -207.10130308820885, "episode_reward_mean": -88.00121528585764, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-127.84478098912558, -66.618389274593, -101.82746702588462, -70.23093177518776, -43.14372266366465, -142.01981324495935, -143.97805374408492, -102.85759449805005, -99.06405047652362, -101.66350031894979, -104.40557789671841, -164.65112622148564, -67.0912530650452, -54.08350433355318, -81.2573810763442, -75.47808131163458, -97.63317147728088, -104.42924886982847, -57.10773483846053, -94.25375376149559, -159.08554190086923, -60.79202096242932, -73.81012117659256, -47.43401917881757, -74.66207042947292, -105.68473921562492, -86.49658161373104, -69.19163964813319, -61.310531587182744, -66.05299705641644, -67.0295381445946, -41.852113911597776, -80.89568088868887, -40.85536526555164, -56.93817007062127, -51.440372362824355, -147.27899116521172, -60.82291815647359, -78.9192555608834, -49.430525947488896, -80.2028455156626, -58.06183574244197, -68.28247175225478, -61.47099629449456, -53.13682786226144, -75.06789942501062, -50.355830008588846, -122.23470193895396, -99.7830361841814, -65.86153328755981, -63.73830796271856, -90.11251474587293, -157.43066662404902, -65.34584228200757, -37.87669173878198, -62.053478587577615, -59.05559593752501, -67.11826481278838, -70.0778549099735, -149.8302539409117, -69.12533381915397, -83.13955987690306, -129.44336127731034, -45.3778288699242, -50.29819685924846, -93.05386012958287, -29.433158127755004, -96.72182075654919, -112.8982972427879, -63.63831473412691, -117.69604356945645, -62.438394941462164, -89.79901245218704, -97.65661261488891, -68.61376605090516, -106.83681768141184, -54.87725475176903, -38.88196859038014, -129.11436255952535, -108.69082923469662, -89.32445512513983, -73.28357368618468, -131.02129662675878, -113.03978357674457, -207.10130308820885, -110.34102738788098, -168.09701027258475, -163.63172459772278, -57.16015093601758, -106.49988087848108, -75.20177642627573, -66.96727492382361, -78.63212158795062, -67.56420297450374, -128.5478635904751, -92.0083499964575, -107.9190913336918, -143.31139160451792, -141.30949490081426, -94.7051802718143], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6393748060584755, "mean_inference_ms": 5.5406947479121955, "mean_action_processing_ms": 0.2055821799373181, "mean_env_wait_ms": 1.4422292869826754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2380000, "num_agent_steps_trained": 2380000, "num_env_steps_sampled": 2380000, "num_env_steps_trained": 2380000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2380000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2380000, "timers": {"training_iteration_time_ms": 80089.931, "load_time_ms": 40.348, "load_throughput": 346977.937, "learn_time_ms": 69491.79, "learn_throughput": 201.463, "synch_weights_time_ms": 7.914}, "counters": {"num_env_steps_sampled": 2380000, "num_env_steps_trained": 2380000, "num_agent_steps_sampled": 2380000, "num_agent_steps_trained": 2380000}, "done": false, "episodes_total": 2380, "training_iteration": 170, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-31-43", "timestamp": 1693063903, "time_this_iter_s": 80.12401556968689, "time_total_s": 13049.896088123322, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150EFD00>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270154645B0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 13049.896088123322, "timesteps_since_restore": 0, "iterations_since_restore": 170, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 24.344247787610616, "ram_util_percent": 51.63274336283187}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -278.4276555415243, "episode_L1_reward_sum_min": -587.8290059268475, "episode_L1_reward_sum_max": -162.1279963850975, "episode_L2_reward_sum_mean": -146.55829862274229, "episode_L2_reward_sum_min": -222.6142479777336, "episode_L2_reward_sum_max": -116.35717732459307}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.10171352905736769, "policy_loss": 0.07535061585346099, "vf_loss": 0.263629128949299, "vf_explained_var": 0.6250809614121178, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2394000, "num_env_steps_trained": 2394000, "num_agent_steps_sampled": 2394000, "num_agent_steps_trained": 2394000}, "sampler_results": {"episode_reward_max": -29.433158127755004, "episode_reward_min": -207.10130308820885, "episode_reward_mean": -86.95168260227976, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -278.4276555415243, "episode_L1_reward_sum_min": -587.8290059268475, "episode_L1_reward_sum_max": -162.1279963850975, "episode_L2_reward_sum_mean": -146.55829862274229, "episode_L2_reward_sum_min": -222.6142479777336, "episode_L2_reward_sum_max": -116.35717732459307}, "hist_stats": {"episode_reward": [-81.2573810763442, -75.47808131163458, -97.63317147728088, -104.42924886982847, -57.10773483846053, -94.25375376149559, -159.08554190086923, -60.79202096242932, -73.81012117659256, -47.43401917881757, -74.66207042947292, -105.68473921562492, -86.49658161373104, -69.19163964813319, -61.310531587182744, -66.05299705641644, -67.0295381445946, -41.852113911597776, -80.89568088868887, -40.85536526555164, -56.93817007062127, -51.440372362824355, -147.27899116521172, -60.82291815647359, -78.9192555608834, -49.430525947488896, -80.2028455156626, -58.06183574244197, -68.28247175225478, -61.47099629449456, -53.13682786226144, -75.06789942501062, -50.355830008588846, -122.23470193895396, -99.7830361841814, -65.86153328755981, -63.73830796271856, -90.11251474587293, -157.43066662404902, -65.34584228200757, -37.87669173878198, -62.053478587577615, -59.05559593752501, -67.11826481278838, -70.0778549099735, -149.8302539409117, -69.12533381915397, -83.13955987690306, -129.44336127731034, -45.3778288699242, -50.29819685924846, -93.05386012958287, -29.433158127755004, -96.72182075654919, -112.8982972427879, -63.63831473412691, -117.69604356945645, -62.438394941462164, -89.79901245218704, -97.65661261488891, -68.61376605090516, -106.83681768141184, -54.87725475176903, -38.88196859038014, -129.11436255952535, -108.69082923469662, -89.32445512513983, -73.28357368618468, -131.02129662675878, -113.03978357674457, -207.10130308820885, -110.34102738788098, -168.09701027258475, -163.63172459772278, -57.16015093601758, -106.49988087848108, -75.20177642627573, -66.96727492382361, -78.63212158795062, -67.56420297450374, -128.5478635904751, -92.0083499964575, -107.9190913336918, -143.31139160451792, -141.30949490081426, -94.7051802718143, -106.84155558655338, -77.49697643829808, -92.12791900488124, -71.78545551805927, -58.47840601349902, -138.94797023583666, -57.576898547521694, -72.72139539261961, -105.98333396585723, -107.29103261897913, -144.79839034671065, -133.98997073579923, -65.47177797522855, -51.01541479019341], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6411684365850269, "mean_inference_ms": 5.550574019500898, "mean_action_processing_ms": 0.20592678583928603, "mean_env_wait_ms": 1.4448565835340863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -29.433158127755004, "episode_reward_min": -207.10130308820885, "episode_reward_mean": -86.95168260227976, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-81.2573810763442, -75.47808131163458, -97.63317147728088, -104.42924886982847, -57.10773483846053, -94.25375376149559, -159.08554190086923, -60.79202096242932, -73.81012117659256, -47.43401917881757, -74.66207042947292, -105.68473921562492, -86.49658161373104, -69.19163964813319, -61.310531587182744, -66.05299705641644, -67.0295381445946, -41.852113911597776, -80.89568088868887, -40.85536526555164, -56.93817007062127, -51.440372362824355, -147.27899116521172, -60.82291815647359, -78.9192555608834, -49.430525947488896, -80.2028455156626, -58.06183574244197, -68.28247175225478, -61.47099629449456, -53.13682786226144, -75.06789942501062, -50.355830008588846, -122.23470193895396, -99.7830361841814, -65.86153328755981, -63.73830796271856, -90.11251474587293, -157.43066662404902, -65.34584228200757, -37.87669173878198, -62.053478587577615, -59.05559593752501, -67.11826481278838, -70.0778549099735, -149.8302539409117, -69.12533381915397, -83.13955987690306, -129.44336127731034, -45.3778288699242, -50.29819685924846, -93.05386012958287, -29.433158127755004, -96.72182075654919, -112.8982972427879, -63.63831473412691, -117.69604356945645, -62.438394941462164, -89.79901245218704, -97.65661261488891, -68.61376605090516, -106.83681768141184, -54.87725475176903, -38.88196859038014, -129.11436255952535, -108.69082923469662, -89.32445512513983, -73.28357368618468, -131.02129662675878, -113.03978357674457, -207.10130308820885, -110.34102738788098, -168.09701027258475, -163.63172459772278, -57.16015093601758, -106.49988087848108, -75.20177642627573, -66.96727492382361, -78.63212158795062, -67.56420297450374, -128.5478635904751, -92.0083499964575, -107.9190913336918, -143.31139160451792, -141.30949490081426, -94.7051802718143, -106.84155558655338, -77.49697643829808, -92.12791900488124, -71.78545551805927, -58.47840601349902, -138.94797023583666, -57.576898547521694, -72.72139539261961, -105.98333396585723, -107.29103261897913, -144.79839034671065, -133.98997073579923, -65.47177797522855, -51.01541479019341], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6411684365850269, "mean_inference_ms": 5.550574019500898, "mean_action_processing_ms": 0.20592678583928603, "mean_env_wait_ms": 1.4448565835340863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2394000, "num_agent_steps_trained": 2394000, "num_env_steps_sampled": 2394000, "num_env_steps_trained": 2394000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2394000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2394000, "timers": {"training_iteration_time_ms": 80083.816, "load_time_ms": 40.417, "load_throughput": 346392.747, "learn_time_ms": 69493.942, "learn_throughput": 201.456, "synch_weights_time_ms": 7.718}, "counters": {"num_env_steps_sampled": 2394000, "num_env_steps_trained": 2394000, "num_agent_steps_sampled": 2394000, "num_agent_steps_trained": 2394000}, "done": false, "episodes_total": 2394, "training_iteration": 171, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-33-03", "timestamp": 1693063983, "time_this_iter_s": 80.08760786056519, "time_total_s": 13129.983695983887, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014F11A30>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014F64700>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 13129.983695983887, "timesteps_since_restore": 0, "iterations_since_restore": 171, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 24.399115044247786, "ram_util_percent": 51.760176991150445}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -283.144288636297, "episode_L1_reward_sum_min": -587.8290059268475, "episode_L1_reward_sum_max": -162.1279963850975, "episode_L2_reward_sum_mean": -147.79890964224936, "episode_L2_reward_sum_min": -222.6142479777336, "episode_L2_reward_sum_max": -116.35717732459307}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.049154723301211775, "policy_loss": 0.018815369448248957, "vf_loss": 0.3033935170905464, "vf_explained_var": 0.6409313003590078, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2408000, "num_env_steps_trained": 2408000, "num_agent_steps_sampled": 2408000, "num_agent_steps_trained": 2408000}, "sampler_results": {"episode_reward_max": -29.433158127755004, "episode_reward_min": -207.10130308820885, "episode_reward_mean": -88.40967337073785, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -283.144288636297, "episode_L1_reward_sum_min": -587.8290059268475, "episode_L1_reward_sum_max": -162.1279963850975, "episode_L2_reward_sum_mean": -147.79890964224936, "episode_L2_reward_sum_min": -222.6142479777336, "episode_L2_reward_sum_max": -116.35717732459307}, "hist_stats": {"episode_reward": [-61.310531587182744, -66.05299705641644, -67.0295381445946, -41.852113911597776, -80.89568088868887, -40.85536526555164, -56.93817007062127, -51.440372362824355, -147.27899116521172, -60.82291815647359, -78.9192555608834, -49.430525947488896, -80.2028455156626, -58.06183574244197, -68.28247175225478, -61.47099629449456, -53.13682786226144, -75.06789942501062, -50.355830008588846, -122.23470193895396, -99.7830361841814, -65.86153328755981, -63.73830796271856, -90.11251474587293, -157.43066662404902, -65.34584228200757, -37.87669173878198, -62.053478587577615, -59.05559593752501, -67.11826481278838, -70.0778549099735, -149.8302539409117, -69.12533381915397, -83.13955987690306, -129.44336127731034, -45.3778288699242, -50.29819685924846, -93.05386012958287, -29.433158127755004, -96.72182075654919, -112.8982972427879, -63.63831473412691, -117.69604356945645, -62.438394941462164, -89.79901245218704, -97.65661261488891, -68.61376605090516, -106.83681768141184, -54.87725475176903, -38.88196859038014, -129.11436255952535, -108.69082923469662, -89.32445512513983, -73.28357368618468, -131.02129662675878, -113.03978357674457, -207.10130308820885, -110.34102738788098, -168.09701027258475, -163.63172459772278, -57.16015093601758, -106.49988087848108, -75.20177642627573, -66.96727492382361, -78.63212158795062, -67.56420297450374, -128.5478635904751, -92.0083499964575, -107.9190913336918, -143.31139160451792, -141.30949490081426, -94.7051802718143, -106.84155558655338, -77.49697643829808, -92.12791900488124, -71.78545551805927, -58.47840601349902, -138.94797023583666, -57.576898547521694, -72.72139539261961, -105.98333396585723, -107.29103261897913, -144.79839034671065, -133.98997073579923, -65.47177797522855, -51.01541479019341, -102.91645127551031, -131.67547863177725, -49.36151660971523, -82.70577513318798, -64.71656121345393, -85.4894356501881, -63.306283842702186, -118.36154399369289, -72.24721148007197, -48.28361637216396, -158.02821187236952, -138.77431113231805, -156.23044143410723, -61.018343665266855], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6429663133902761, "mean_inference_ms": 5.560246578871499, "mean_action_processing_ms": 0.20627250153265547, "mean_env_wait_ms": 1.4473926205010677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -29.433158127755004, "episode_reward_min": -207.10130308820885, "episode_reward_mean": -88.40967337073785, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-61.310531587182744, -66.05299705641644, -67.0295381445946, -41.852113911597776, -80.89568088868887, -40.85536526555164, -56.93817007062127, -51.440372362824355, -147.27899116521172, -60.82291815647359, -78.9192555608834, -49.430525947488896, -80.2028455156626, -58.06183574244197, -68.28247175225478, -61.47099629449456, -53.13682786226144, -75.06789942501062, -50.355830008588846, -122.23470193895396, -99.7830361841814, -65.86153328755981, -63.73830796271856, -90.11251474587293, -157.43066662404902, -65.34584228200757, -37.87669173878198, -62.053478587577615, -59.05559593752501, -67.11826481278838, -70.0778549099735, -149.8302539409117, -69.12533381915397, -83.13955987690306, -129.44336127731034, -45.3778288699242, -50.29819685924846, -93.05386012958287, -29.433158127755004, -96.72182075654919, -112.8982972427879, -63.63831473412691, -117.69604356945645, -62.438394941462164, -89.79901245218704, -97.65661261488891, -68.61376605090516, -106.83681768141184, -54.87725475176903, -38.88196859038014, -129.11436255952535, -108.69082923469662, -89.32445512513983, -73.28357368618468, -131.02129662675878, -113.03978357674457, -207.10130308820885, -110.34102738788098, -168.09701027258475, -163.63172459772278, -57.16015093601758, -106.49988087848108, -75.20177642627573, -66.96727492382361, -78.63212158795062, -67.56420297450374, -128.5478635904751, -92.0083499964575, -107.9190913336918, -143.31139160451792, -141.30949490081426, -94.7051802718143, -106.84155558655338, -77.49697643829808, -92.12791900488124, -71.78545551805927, -58.47840601349902, -138.94797023583666, -57.576898547521694, -72.72139539261961, -105.98333396585723, -107.29103261897913, -144.79839034671065, -133.98997073579923, -65.47177797522855, -51.01541479019341, -102.91645127551031, -131.67547863177725, -49.36151660971523, -82.70577513318798, -64.71656121345393, -85.4894356501881, -63.306283842702186, -118.36154399369289, -72.24721148007197, -48.28361637216396, -158.02821187236952, -138.77431113231805, -156.23044143410723, -61.018343665266855], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6429663133902761, "mean_inference_ms": 5.560246578871499, "mean_action_processing_ms": 0.20627250153265547, "mean_env_wait_ms": 1.4473926205010677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2408000, "num_agent_steps_trained": 2408000, "num_env_steps_sampled": 2408000, "num_env_steps_trained": 2408000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2408000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2408000, "timers": {"training_iteration_time_ms": 80106.466, "load_time_ms": 40.417, "load_throughput": 346392.747, "learn_time_ms": 69522.449, "learn_throughput": 201.374, "synch_weights_time_ms": 7.815}, "counters": {"num_env_steps_sampled": 2408000, "num_env_steps_trained": 2408000, "num_agent_steps_sampled": 2408000, "num_agent_steps_trained": 2408000}, "done": false, "episodes_total": 2408, "training_iteration": 172, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-34-23", "timestamp": 1693064063, "time_this_iter_s": 80.07244610786438, "time_total_s": 13210.056142091751, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701535EA60>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150E8370>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 13210.056142091751, "timesteps_since_restore": 0, "iterations_since_restore": 172, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 24.51327433628318, "ram_util_percent": 51.96548672566372}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -294.51638151794674, "episode_L1_reward_sum_min": -587.8290059268475, "episode_L1_reward_sum_max": -162.1279963850975, "episode_L2_reward_sum_mean": -150.67206223204732, "episode_L2_reward_sum_min": -222.6142479777336, "episode_L2_reward_sum_max": -116.35717732459307}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.06464435293774193, "policy_loss": 0.035738190991991804, "vf_loss": 0.28906162030469573, "vf_explained_var": 0.6114145951506532, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2422000, "num_env_steps_trained": 2422000, "num_agent_steps_sampled": 2422000, "num_agent_steps_trained": 2422000}, "sampler_results": {"episode_reward_max": -29.433158127755004, "episode_reward_min": -207.10130308820885, "episode_reward_mean": -91.28844187058229, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -294.51638151794674, "episode_L1_reward_sum_min": -587.8290059268475, "episode_L1_reward_sum_max": -162.1279963850975, "episode_L2_reward_sum_mean": -150.67206223204732, "episode_L2_reward_sum_min": -222.6142479777336, "episode_L2_reward_sum_max": -116.35717732459307}, "hist_stats": {"episode_reward": [-68.28247175225478, -61.47099629449456, -53.13682786226144, -75.06789942501062, -50.355830008588846, -122.23470193895396, -99.7830361841814, -65.86153328755981, -63.73830796271856, -90.11251474587293, -157.43066662404902, -65.34584228200757, -37.87669173878198, -62.053478587577615, -59.05559593752501, -67.11826481278838, -70.0778549099735, -149.8302539409117, -69.12533381915397, -83.13955987690306, -129.44336127731034, -45.3778288699242, -50.29819685924846, -93.05386012958287, -29.433158127755004, -96.72182075654919, -112.8982972427879, -63.63831473412691, -117.69604356945645, -62.438394941462164, -89.79901245218704, -97.65661261488891, -68.61376605090516, -106.83681768141184, -54.87725475176903, -38.88196859038014, -129.11436255952535, -108.69082923469662, -89.32445512513983, -73.28357368618468, -131.02129662675878, -113.03978357674457, -207.10130308820885, -110.34102738788098, -168.09701027258475, -163.63172459772278, -57.16015093601758, -106.49988087848108, -75.20177642627573, -66.96727492382361, -78.63212158795062, -67.56420297450374, -128.5478635904751, -92.0083499964575, -107.9190913336918, -143.31139160451792, -141.30949490081426, -94.7051802718143, -106.84155558655338, -77.49697643829808, -92.12791900488124, -71.78545551805927, -58.47840601349902, -138.94797023583666, -57.576898547521694, -72.72139539261961, -105.98333396585723, -107.29103261897913, -144.79839034671065, -133.98997073579923, -65.47177797522855, -51.01541479019341, -102.91645127551031, -131.67547863177725, -49.36151660971523, -82.70577513318798, -64.71656121345393, -85.4894356501881, -63.306283842702186, -118.36154399369289, -72.24721148007197, -48.28361637216396, -158.02821187236952, -138.77431113231805, -156.23044143410723, -61.018343665266855, -60.980425644575895, -116.86009026514145, -58.15685478625205, -69.74091922954779, -43.07880867912783, -101.33279970314673, -91.21102072085648, -162.55694935808907, -119.52469651913717, -125.91397868101525, -94.05482254412671, -90.51039839290867, -49.30557041810512, -45.740656418051515], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6447677947903494, "mean_inference_ms": 5.569839407487964, "mean_action_processing_ms": 0.20661599882025858, "mean_env_wait_ms": 1.449924244810054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -29.433158127755004, "episode_reward_min": -207.10130308820885, "episode_reward_mean": -91.28844187058229, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-68.28247175225478, -61.47099629449456, -53.13682786226144, -75.06789942501062, -50.355830008588846, -122.23470193895396, -99.7830361841814, -65.86153328755981, -63.73830796271856, -90.11251474587293, -157.43066662404902, -65.34584228200757, -37.87669173878198, -62.053478587577615, -59.05559593752501, -67.11826481278838, -70.0778549099735, -149.8302539409117, -69.12533381915397, -83.13955987690306, -129.44336127731034, -45.3778288699242, -50.29819685924846, -93.05386012958287, -29.433158127755004, -96.72182075654919, -112.8982972427879, -63.63831473412691, -117.69604356945645, -62.438394941462164, -89.79901245218704, -97.65661261488891, -68.61376605090516, -106.83681768141184, -54.87725475176903, -38.88196859038014, -129.11436255952535, -108.69082923469662, -89.32445512513983, -73.28357368618468, -131.02129662675878, -113.03978357674457, -207.10130308820885, -110.34102738788098, -168.09701027258475, -163.63172459772278, -57.16015093601758, -106.49988087848108, -75.20177642627573, -66.96727492382361, -78.63212158795062, -67.56420297450374, -128.5478635904751, -92.0083499964575, -107.9190913336918, -143.31139160451792, -141.30949490081426, -94.7051802718143, -106.84155558655338, -77.49697643829808, -92.12791900488124, -71.78545551805927, -58.47840601349902, -138.94797023583666, -57.576898547521694, -72.72139539261961, -105.98333396585723, -107.29103261897913, -144.79839034671065, -133.98997073579923, -65.47177797522855, -51.01541479019341, -102.91645127551031, -131.67547863177725, -49.36151660971523, -82.70577513318798, -64.71656121345393, -85.4894356501881, -63.306283842702186, -118.36154399369289, -72.24721148007197, -48.28361637216396, -158.02821187236952, -138.77431113231805, -156.23044143410723, -61.018343665266855, -60.980425644575895, -116.86009026514145, -58.15685478625205, -69.74091922954779, -43.07880867912783, -101.33279970314673, -91.21102072085648, -162.55694935808907, -119.52469651913717, -125.91397868101525, -94.05482254412671, -90.51039839290867, -49.30557041810512, -45.740656418051515], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6447677947903494, "mean_inference_ms": 5.569839407487964, "mean_action_processing_ms": 0.20661599882025858, "mean_env_wait_ms": 1.449924244810054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2422000, "num_agent_steps_trained": 2422000, "num_env_steps_sampled": 2422000, "num_env_steps_trained": 2422000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2422000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2422000, "timers": {"training_iteration_time_ms": 80134.242, "load_time_ms": 41.115, "load_throughput": 340510.52, "learn_time_ms": 69539.084, "learn_throughput": 201.326, "synch_weights_time_ms": 7.911}, "counters": {"num_env_steps_sampled": 2422000, "num_env_steps_trained": 2422000, "num_agent_steps_sampled": 2422000, "num_agent_steps_trained": 2422000}, "done": false, "episodes_total": 2422, "training_iteration": 173, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-35-43", "timestamp": 1693064143, "time_this_iter_s": 80.27767872810364, "time_total_s": 13290.333820819855, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015657B50>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270157291F0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 13290.333820819855, "timesteps_since_restore": 0, "iterations_since_restore": 173, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 24.091228070175436, "ram_util_percent": 51.92982456140351}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -303.3436525417864, "episode_L1_reward_sum_min": -589.8623537123203, "episode_L1_reward_sum_max": -162.1279963850975, "episode_L2_reward_sum_mean": -152.8218156415969, "episode_L2_reward_sum_min": -222.6142479777336, "episode_L2_reward_sum_max": -116.35717732459307}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.06246266499403174, "policy_loss": 0.029413295432603286, "vf_loss": 0.33049369605726464, "vf_explained_var": 0.7129477727008454, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2436000, "num_env_steps_trained": 2436000, "num_agent_steps_sampled": 2436000, "num_agent_steps_trained": 2436000}, "sampler_results": {"episode_reward_max": -29.433158127755004, "episode_reward_min": -207.10130308820885, "episode_reward_mean": -95.40344244586265, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -303.3436525417864, "episode_L1_reward_sum_min": -589.8623537123203, "episode_L1_reward_sum_max": -162.1279963850975, "episode_L2_reward_sum_mean": -152.8218156415969, "episode_L2_reward_sum_min": -222.6142479777336, "episode_L2_reward_sum_max": -116.35717732459307}, "hist_stats": {"episode_reward": [-59.05559593752501, -67.11826481278838, -70.0778549099735, -149.8302539409117, -69.12533381915397, -83.13955987690306, -129.44336127731034, -45.3778288699242, -50.29819685924846, -93.05386012958287, -29.433158127755004, -96.72182075654919, -112.8982972427879, -63.63831473412691, -117.69604356945645, -62.438394941462164, -89.79901245218704, -97.65661261488891, -68.61376605090516, -106.83681768141184, -54.87725475176903, -38.88196859038014, -129.11436255952535, -108.69082923469662, -89.32445512513983, -73.28357368618468, -131.02129662675878, -113.03978357674457, -207.10130308820885, -110.34102738788098, -168.09701027258475, -163.63172459772278, -57.16015093601758, -106.49988087848108, -75.20177642627573, -66.96727492382361, -78.63212158795062, -67.56420297450374, -128.5478635904751, -92.0083499964575, -107.9190913336918, -143.31139160451792, -141.30949490081426, -94.7051802718143, -106.84155558655338, -77.49697643829808, -92.12791900488124, -71.78545551805927, -58.47840601349902, -138.94797023583666, -57.576898547521694, -72.72139539261961, -105.98333396585723, -107.29103261897913, -144.79839034671065, -133.98997073579923, -65.47177797522855, -51.01541479019341, -102.91645127551031, -131.67547863177725, -49.36151660971523, -82.70577513318798, -64.71656121345393, -85.4894356501881, -63.306283842702186, -118.36154399369289, -72.24721148007197, -48.28361637216396, -158.02821187236952, -138.77431113231805, -156.23044143410723, -61.018343665266855, -60.980425644575895, -116.86009026514145, -58.15685478625205, -69.74091922954779, -43.07880867912783, -101.33279970314673, -91.21102072085648, -162.55694935808907, -119.52469651913717, -125.91397868101525, -94.05482254412671, -90.51039839290867, -49.30557041810512, -45.740656418051515, -65.30752041999422, -58.09971412913871, -94.84214493055677, -79.83363940174382, -191.26711288865818, -63.136198787062064, -122.38700038345235, -79.92822474994723, -199.95498614194986, -70.17240813505008, -111.33931249727782, -75.93211617665455, -159.1356044923925, -112.9148730884714], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6465625933655906, "mean_inference_ms": 5.579524213732234, "mean_action_processing_ms": 0.20695914883110583, "mean_env_wait_ms": 1.452487924538844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -29.433158127755004, "episode_reward_min": -207.10130308820885, "episode_reward_mean": -95.40344244586265, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-59.05559593752501, -67.11826481278838, -70.0778549099735, -149.8302539409117, -69.12533381915397, -83.13955987690306, -129.44336127731034, -45.3778288699242, -50.29819685924846, -93.05386012958287, -29.433158127755004, -96.72182075654919, -112.8982972427879, -63.63831473412691, -117.69604356945645, -62.438394941462164, -89.79901245218704, -97.65661261488891, -68.61376605090516, -106.83681768141184, -54.87725475176903, -38.88196859038014, -129.11436255952535, -108.69082923469662, -89.32445512513983, -73.28357368618468, -131.02129662675878, -113.03978357674457, -207.10130308820885, -110.34102738788098, -168.09701027258475, -163.63172459772278, -57.16015093601758, -106.49988087848108, -75.20177642627573, -66.96727492382361, -78.63212158795062, -67.56420297450374, -128.5478635904751, -92.0083499964575, -107.9190913336918, -143.31139160451792, -141.30949490081426, -94.7051802718143, -106.84155558655338, -77.49697643829808, -92.12791900488124, -71.78545551805927, -58.47840601349902, -138.94797023583666, -57.576898547521694, -72.72139539261961, -105.98333396585723, -107.29103261897913, -144.79839034671065, -133.98997073579923, -65.47177797522855, -51.01541479019341, -102.91645127551031, -131.67547863177725, -49.36151660971523, -82.70577513318798, -64.71656121345393, -85.4894356501881, -63.306283842702186, -118.36154399369289, -72.24721148007197, -48.28361637216396, -158.02821187236952, -138.77431113231805, -156.23044143410723, -61.018343665266855, -60.980425644575895, -116.86009026514145, -58.15685478625205, -69.74091922954779, -43.07880867912783, -101.33279970314673, -91.21102072085648, -162.55694935808907, -119.52469651913717, -125.91397868101525, -94.05482254412671, -90.51039839290867, -49.30557041810512, -45.740656418051515, -65.30752041999422, -58.09971412913871, -94.84214493055677, -79.83363940174382, -191.26711288865818, -63.136198787062064, -122.38700038345235, -79.92822474994723, -199.95498614194986, -70.17240813505008, -111.33931249727782, -75.93211617665455, -159.1356044923925, -112.9148730884714], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6465625933655906, "mean_inference_ms": 5.579524213732234, "mean_action_processing_ms": 0.20695914883110583, "mean_env_wait_ms": 1.452487924538844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2436000, "num_agent_steps_trained": 2436000, "num_env_steps_sampled": 2436000, "num_env_steps_trained": 2436000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2436000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2436000, "timers": {"training_iteration_time_ms": 80154.437, "load_time_ms": 42.511, "load_throughput": 329325.525, "learn_time_ms": 69537.231, "learn_throughput": 201.331, "synch_weights_time_ms": 8.017}, "counters": {"num_env_steps_sampled": 2436000, "num_env_steps_trained": 2436000, "num_agent_steps_sampled": 2436000, "num_agent_steps_trained": 2436000}, "done": false, "episodes_total": 2436, "training_iteration": 174, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-37-04", "timestamp": 1693064224, "time_this_iter_s": 80.17759704589844, "time_total_s": 13370.511417865753, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701516F370>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015311FA0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 13370.511417865753, "timesteps_since_restore": 0, "iterations_since_restore": 174, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 24.2929203539823, "ram_util_percent": 51.93451327433629}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -300.9376101435721, "episode_L1_reward_sum_min": -589.8623537123203, "episode_L1_reward_sum_max": -166.67305176705122, "episode_L2_reward_sum_mean": -152.2132600944489, "episode_L2_reward_sum_min": -222.6142479777336, "episode_L2_reward_sum_max": -118.79769169539213}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.06602366234907889, "policy_loss": 0.043687894653410116, "vf_loss": 0.22335767812291887, "vf_explained_var": 0.494382627952246, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2450000, "num_env_steps_trained": 2450000, "num_agent_steps_sampled": 2450000, "num_agent_steps_trained": 2450000}, "sampler_results": {"episode_reward_max": -38.88196859038014, "episode_reward_min": -207.10130308820885, "episode_reward_mean": -95.13767962199734, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -300.9376101435721, "episode_L1_reward_sum_min": -589.8623537123203, "episode_L1_reward_sum_max": -166.67305176705122, "episode_L2_reward_sum_mean": -152.2132600944489, "episode_L2_reward_sum_min": -222.6142479777336, "episode_L2_reward_sum_max": -118.79769169539213}, "hist_stats": {"episode_reward": [-117.69604356945645, -62.438394941462164, -89.79901245218704, -97.65661261488891, -68.61376605090516, -106.83681768141184, -54.87725475176903, -38.88196859038014, -129.11436255952535, -108.69082923469662, -89.32445512513983, -73.28357368618468, -131.02129662675878, -113.03978357674457, -207.10130308820885, -110.34102738788098, -168.09701027258475, -163.63172459772278, -57.16015093601758, -106.49988087848108, -75.20177642627573, -66.96727492382361, -78.63212158795062, -67.56420297450374, -128.5478635904751, -92.0083499964575, -107.9190913336918, -143.31139160451792, -141.30949490081426, -94.7051802718143, -106.84155558655338, -77.49697643829808, -92.12791900488124, -71.78545551805927, -58.47840601349902, -138.94797023583666, -57.576898547521694, -72.72139539261961, -105.98333396585723, -107.29103261897913, -144.79839034671065, -133.98997073579923, -65.47177797522855, -51.01541479019341, -102.91645127551031, -131.67547863177725, -49.36151660971523, -82.70577513318798, -64.71656121345393, -85.4894356501881, -63.306283842702186, -118.36154399369289, -72.24721148007197, -48.28361637216396, -158.02821187236952, -138.77431113231805, -156.23044143410723, -61.018343665266855, -60.980425644575895, -116.86009026514145, -58.15685478625205, -69.74091922954779, -43.07880867912783, -101.33279970314673, -91.21102072085648, -162.55694935808907, -119.52469651913717, -125.91397868101525, -94.05482254412671, -90.51039839290867, -49.30557041810512, -45.740656418051515, -65.30752041999422, -58.09971412913871, -94.84214493055677, -79.83363940174382, -191.26711288865818, -63.136198787062064, -122.38700038345235, -79.92822474994723, -199.95498614194986, -70.17240813505008, -111.33931249727782, -75.93211617665455, -159.1356044923925, -112.9148730884714, -48.82161105764804, -54.221878924862914, -119.12433979785361, -46.274465665471105, -70.57179882399785, -50.821993503068256, -84.15762424000799, -89.06312499711316, -97.17818796893621, -61.12910729052234, -105.2367638609704, -52.204647770212354, -110.05537017623318, -103.77450483111421], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6483168810790848, "mean_inference_ms": 5.589147202501042, "mean_action_processing_ms": 0.20730350697448202, "mean_env_wait_ms": 1.455034735712511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -38.88196859038014, "episode_reward_min": -207.10130308820885, "episode_reward_mean": -95.13767962199734, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-117.69604356945645, -62.438394941462164, -89.79901245218704, -97.65661261488891, -68.61376605090516, -106.83681768141184, -54.87725475176903, -38.88196859038014, -129.11436255952535, -108.69082923469662, -89.32445512513983, -73.28357368618468, -131.02129662675878, -113.03978357674457, -207.10130308820885, -110.34102738788098, -168.09701027258475, -163.63172459772278, -57.16015093601758, -106.49988087848108, -75.20177642627573, -66.96727492382361, -78.63212158795062, -67.56420297450374, -128.5478635904751, -92.0083499964575, -107.9190913336918, -143.31139160451792, -141.30949490081426, -94.7051802718143, -106.84155558655338, -77.49697643829808, -92.12791900488124, -71.78545551805927, -58.47840601349902, -138.94797023583666, -57.576898547521694, -72.72139539261961, -105.98333396585723, -107.29103261897913, -144.79839034671065, -133.98997073579923, -65.47177797522855, -51.01541479019341, -102.91645127551031, -131.67547863177725, -49.36151660971523, -82.70577513318798, -64.71656121345393, -85.4894356501881, -63.306283842702186, -118.36154399369289, -72.24721148007197, -48.28361637216396, -158.02821187236952, -138.77431113231805, -156.23044143410723, -61.018343665266855, -60.980425644575895, -116.86009026514145, -58.15685478625205, -69.74091922954779, -43.07880867912783, -101.33279970314673, -91.21102072085648, -162.55694935808907, -119.52469651913717, -125.91397868101525, -94.05482254412671, -90.51039839290867, -49.30557041810512, -45.740656418051515, -65.30752041999422, -58.09971412913871, -94.84214493055677, -79.83363940174382, -191.26711288865818, -63.136198787062064, -122.38700038345235, -79.92822474994723, -199.95498614194986, -70.17240813505008, -111.33931249727782, -75.93211617665455, -159.1356044923925, -112.9148730884714, -48.82161105764804, -54.221878924862914, -119.12433979785361, -46.274465665471105, -70.57179882399785, -50.821993503068256, -84.15762424000799, -89.06312499711316, -97.17818796893621, -61.12910729052234, -105.2367638609704, -52.204647770212354, -110.05537017623318, -103.77450483111421], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6483168810790848, "mean_inference_ms": 5.589147202501042, "mean_action_processing_ms": 0.20730350697448202, "mean_env_wait_ms": 1.455034735712511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2450000, "num_agent_steps_trained": 2450000, "num_env_steps_sampled": 2450000, "num_env_steps_trained": 2450000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2450000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2450000, "timers": {"training_iteration_time_ms": 80165.025, "load_time_ms": 42.713, "load_throughput": 327765.599, "learn_time_ms": 69539.849, "learn_throughput": 201.323, "synch_weights_time_ms": 7.914}, "counters": {"num_env_steps_sampled": 2450000, "num_env_steps_trained": 2450000, "num_agent_steps_sampled": 2450000, "num_agent_steps_trained": 2450000}, "done": false, "episodes_total": 2450, "training_iteration": 175, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-38-24", "timestamp": 1693064304, "time_this_iter_s": 80.34247612953186, "time_total_s": 13450.853893995285, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701539C190>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270151C0430>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 13450.853893995285, "timesteps_since_restore": 0, "iterations_since_restore": 175, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 25.808771929824562, "ram_util_percent": 52.275438596491206}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -302.9577426140755, "episode_L1_reward_sum_min": -599.2290505170822, "episode_L1_reward_sum_max": -165.91908431053162, "episode_L2_reward_sum_mean": -152.68318651363253, "episode_L2_reward_sum_min": -224.26919478178024, "episode_L2_reward_sum_max": -117.88138159364462}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.04500608407478365, "policy_loss": 0.014908379496653936, "vf_loss": 0.30097704118912605, "vf_explained_var": 0.7217484172663571, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2464000, "num_env_steps_trained": 2464000, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 2464000}, "sampler_results": {"episode_reward_max": -42.80026834535122, "episode_reward_min": -207.10130308820885, "episode_reward_mean": -96.34625863988335, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -302.9577426140755, "episode_L1_reward_sum_min": -599.2290505170822, "episode_L1_reward_sum_max": -165.91908431053162, "episode_L2_reward_sum_mean": -152.68318651363253, "episode_L2_reward_sum_min": -224.26919478178024, "episode_L2_reward_sum_max": -117.88138159364462}, "hist_stats": {"episode_reward": [-207.10130308820885, -110.34102738788098, -168.09701027258475, -163.63172459772278, -57.16015093601758, -106.49988087848108, -75.20177642627573, -66.96727492382361, -78.63212158795062, -67.56420297450374, -128.5478635904751, -92.0083499964575, -107.9190913336918, -143.31139160451792, -141.30949490081426, -94.7051802718143, -106.84155558655338, -77.49697643829808, -92.12791900488124, -71.78545551805927, -58.47840601349902, -138.94797023583666, -57.576898547521694, -72.72139539261961, -105.98333396585723, -107.29103261897913, -144.79839034671065, -133.98997073579923, -65.47177797522855, -51.01541479019341, -102.91645127551031, -131.67547863177725, -49.36151660971523, -82.70577513318798, -64.71656121345393, -85.4894356501881, -63.306283842702186, -118.36154399369289, -72.24721148007197, -48.28361637216396, -158.02821187236952, -138.77431113231805, -156.23044143410723, -61.018343665266855, -60.980425644575895, -116.86009026514145, -58.15685478625205, -69.74091922954779, -43.07880867912783, -101.33279970314673, -91.21102072085648, -162.55694935808907, -119.52469651913717, -125.91397868101525, -94.05482254412671, -90.51039839290867, -49.30557041810512, -45.740656418051515, -65.30752041999422, -58.09971412913871, -94.84214493055677, -79.83363940174382, -191.26711288865818, -63.136198787062064, -122.38700038345235, -79.92822474994723, -199.95498614194986, -70.17240813505008, -111.33931249727782, -75.93211617665455, -159.1356044923925, -112.9148730884714, -48.82161105764804, -54.221878924862914, -119.12433979785361, -46.274465665471105, -70.57179882399785, -50.821993503068256, -84.15762424000799, -89.06312499711316, -97.17818796893621, -61.12910729052234, -105.2367638609704, -52.204647770212354, -110.05537017623318, -103.77450483111421, -61.936536616182394, -105.18689400581005, -95.7382294993329, -91.24692930176639, -72.8783288930499, -203.0468303233862, -42.80026834535122, -104.36064191162494, -76.33573818116324, -61.791266765052725, -170.6475339132279, -64.30197663029115, -115.65086653450683, -136.21003232936127], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6500867578444453, "mean_inference_ms": 5.598514120970167, "mean_action_processing_ms": 0.20763998999812208, "mean_env_wait_ms": 1.4575150936206256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -42.80026834535122, "episode_reward_min": -207.10130308820885, "episode_reward_mean": -96.34625863988335, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-207.10130308820885, -110.34102738788098, -168.09701027258475, -163.63172459772278, -57.16015093601758, -106.49988087848108, -75.20177642627573, -66.96727492382361, -78.63212158795062, -67.56420297450374, -128.5478635904751, -92.0083499964575, -107.9190913336918, -143.31139160451792, -141.30949490081426, -94.7051802718143, -106.84155558655338, -77.49697643829808, -92.12791900488124, -71.78545551805927, -58.47840601349902, -138.94797023583666, -57.576898547521694, -72.72139539261961, -105.98333396585723, -107.29103261897913, -144.79839034671065, -133.98997073579923, -65.47177797522855, -51.01541479019341, -102.91645127551031, -131.67547863177725, -49.36151660971523, -82.70577513318798, -64.71656121345393, -85.4894356501881, -63.306283842702186, -118.36154399369289, -72.24721148007197, -48.28361637216396, -158.02821187236952, -138.77431113231805, -156.23044143410723, -61.018343665266855, -60.980425644575895, -116.86009026514145, -58.15685478625205, -69.74091922954779, -43.07880867912783, -101.33279970314673, -91.21102072085648, -162.55694935808907, -119.52469651913717, -125.91397868101525, -94.05482254412671, -90.51039839290867, -49.30557041810512, -45.740656418051515, -65.30752041999422, -58.09971412913871, -94.84214493055677, -79.83363940174382, -191.26711288865818, -63.136198787062064, -122.38700038345235, -79.92822474994723, -199.95498614194986, -70.17240813505008, -111.33931249727782, -75.93211617665455, -159.1356044923925, -112.9148730884714, -48.82161105764804, -54.221878924862914, -119.12433979785361, -46.274465665471105, -70.57179882399785, -50.821993503068256, -84.15762424000799, -89.06312499711316, -97.17818796893621, -61.12910729052234, -105.2367638609704, -52.204647770212354, -110.05537017623318, -103.77450483111421, -61.936536616182394, -105.18689400581005, -95.7382294993329, -91.24692930176639, -72.8783288930499, -203.0468303233862, -42.80026834535122, -104.36064191162494, -76.33573818116324, -61.791266765052725, -170.6475339132279, -64.30197663029115, -115.65086653450683, -136.21003232936127], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6500867578444453, "mean_inference_ms": 5.598514120970167, "mean_action_processing_ms": 0.20763998999812208, "mean_env_wait_ms": 1.4575150936206256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 2464000, "num_env_steps_sampled": 2464000, "num_env_steps_trained": 2464000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2464000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2464000, "timers": {"training_iteration_time_ms": 80199.376, "load_time_ms": 43.412, "load_throughput": 322492.762, "learn_time_ms": 69568.164, "learn_throughput": 201.241, "synch_weights_time_ms": 7.127}, "counters": {"num_env_steps_sampled": 2464000, "num_env_steps_trained": 2464000, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 2464000}, "done": false, "episodes_total": 2464, "training_iteration": 176, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-39-45", "timestamp": 1693064385, "time_this_iter_s": 80.47998332977295, "time_total_s": 13531.333877325058, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701534D160>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270154350D0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 13531.333877325058, "timesteps_since_restore": 0, "iterations_since_restore": 176, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 24.529824561403505, "ram_util_percent": 51.74298245614034}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -290.15346717447045, "episode_L1_reward_sum_min": -599.2290505170822, "episode_L1_reward_sum_max": -165.91908431053162, "episode_L2_reward_sum_mean": -149.52087832704186, "episode_L2_reward_sum_min": -224.26919478178024, "episode_L2_reward_sum_max": -117.88138159364462}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.05954121507427981, "policy_loss": 0.03424387670448397, "vf_loss": 0.2529733659407611, "vf_explained_var": 0.5592586714237806, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2478000, "num_env_steps_trained": 2478000, "num_agent_steps_sampled": 2478000, "num_agent_steps_trained": 2478000}, "sampler_results": {"episode_reward_max": -36.87879732144168, "episode_reward_min": -203.0468303233862, "episode_reward_mean": -92.2424642279454, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -290.15346717447045, "episode_L1_reward_sum_min": -599.2290505170822, "episode_L1_reward_sum_max": -165.91908431053162, "episode_L2_reward_sum_mean": -149.52087832704186, "episode_L2_reward_sum_min": -224.26919478178024, "episode_L2_reward_sum_max": -117.88138159364462}, "hist_stats": {"episode_reward": [-141.30949490081426, -94.7051802718143, -106.84155558655338, -77.49697643829808, -92.12791900488124, -71.78545551805927, -58.47840601349902, -138.94797023583666, -57.576898547521694, -72.72139539261961, -105.98333396585723, -107.29103261897913, -144.79839034671065, -133.98997073579923, -65.47177797522855, -51.01541479019341, -102.91645127551031, -131.67547863177725, -49.36151660971523, -82.70577513318798, -64.71656121345393, -85.4894356501881, -63.306283842702186, -118.36154399369289, -72.24721148007197, -48.28361637216396, -158.02821187236952, -138.77431113231805, -156.23044143410723, -61.018343665266855, -60.980425644575895, -116.86009026514145, -58.15685478625205, -69.74091922954779, -43.07880867912783, -101.33279970314673, -91.21102072085648, -162.55694935808907, -119.52469651913717, -125.91397868101525, -94.05482254412671, -90.51039839290867, -49.30557041810512, -45.740656418051515, -65.30752041999422, -58.09971412913871, -94.84214493055677, -79.83363940174382, -191.26711288865818, -63.136198787062064, -122.38700038345235, -79.92822474994723, -199.95498614194986, -70.17240813505008, -111.33931249727782, -75.93211617665455, -159.1356044923925, -112.9148730884714, -48.82161105764804, -54.221878924862914, -119.12433979785361, -46.274465665471105, -70.57179882399785, -50.821993503068256, -84.15762424000799, -89.06312499711316, -97.17818796893621, -61.12910729052234, -105.2367638609704, -52.204647770212354, -110.05537017623318, -103.77450483111421, -61.936536616182394, -105.18689400581005, -95.7382294993329, -91.24692930176639, -72.8783288930499, -203.0468303233862, -42.80026834535122, -104.36064191162494, -76.33573818116324, -61.791266765052725, -170.6475339132279, -64.30197663029115, -115.65086653450683, -136.21003232936127, -72.0046140485975, -133.2234453998838, -112.32552947768002, -133.09538519164968, -50.278149406521045, -36.87879732144168, -94.78476977568596, -114.52600649690993, -111.87805507322888, -56.342627350702166, -48.42110945443303, -69.47443353289634, -81.99839674426887, -47.372409130899754], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6518192654477482, "mean_inference_ms": 5.607754003352467, "mean_action_processing_ms": 0.2079704751367175, "mean_env_wait_ms": 1.459978756529451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -36.87879732144168, "episode_reward_min": -203.0468303233862, "episode_reward_mean": -92.2424642279454, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-141.30949490081426, -94.7051802718143, -106.84155558655338, -77.49697643829808, -92.12791900488124, -71.78545551805927, -58.47840601349902, -138.94797023583666, -57.576898547521694, -72.72139539261961, -105.98333396585723, -107.29103261897913, -144.79839034671065, -133.98997073579923, -65.47177797522855, -51.01541479019341, -102.91645127551031, -131.67547863177725, -49.36151660971523, -82.70577513318798, -64.71656121345393, -85.4894356501881, -63.306283842702186, -118.36154399369289, -72.24721148007197, -48.28361637216396, -158.02821187236952, -138.77431113231805, -156.23044143410723, -61.018343665266855, -60.980425644575895, -116.86009026514145, -58.15685478625205, -69.74091922954779, -43.07880867912783, -101.33279970314673, -91.21102072085648, -162.55694935808907, -119.52469651913717, -125.91397868101525, -94.05482254412671, -90.51039839290867, -49.30557041810512, -45.740656418051515, -65.30752041999422, -58.09971412913871, -94.84214493055677, -79.83363940174382, -191.26711288865818, -63.136198787062064, -122.38700038345235, -79.92822474994723, -199.95498614194986, -70.17240813505008, -111.33931249727782, -75.93211617665455, -159.1356044923925, -112.9148730884714, -48.82161105764804, -54.221878924862914, -119.12433979785361, -46.274465665471105, -70.57179882399785, -50.821993503068256, -84.15762424000799, -89.06312499711316, -97.17818796893621, -61.12910729052234, -105.2367638609704, -52.204647770212354, -110.05537017623318, -103.77450483111421, -61.936536616182394, -105.18689400581005, -95.7382294993329, -91.24692930176639, -72.8783288930499, -203.0468303233862, -42.80026834535122, -104.36064191162494, -76.33573818116324, -61.791266765052725, -170.6475339132279, -64.30197663029115, -115.65086653450683, -136.21003232936127, -72.0046140485975, -133.2234453998838, -112.32552947768002, -133.09538519164968, -50.278149406521045, -36.87879732144168, -94.78476977568596, -114.52600649690993, -111.87805507322888, -56.342627350702166, -48.42110945443303, -69.47443353289634, -81.99839674426887, -47.372409130899754], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6518192654477482, "mean_inference_ms": 5.607754003352467, "mean_action_processing_ms": 0.2079704751367175, "mean_env_wait_ms": 1.459978756529451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2478000, "num_agent_steps_trained": 2478000, "num_env_steps_sampled": 2478000, "num_env_steps_trained": 2478000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2478000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2478000, "timers": {"training_iteration_time_ms": 80226.329, "load_time_ms": 45.183, "load_throughput": 309854.382, "learn_time_ms": 69559.969, "learn_throughput": 201.265, "synch_weights_time_ms": 7.141}, "counters": {"num_env_steps_sampled": 2478000, "num_env_steps_trained": 2478000, "num_agent_steps_sampled": 2478000, "num_agent_steps_trained": 2478000}, "done": false, "episodes_total": 2478, "training_iteration": 177, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-41-05", "timestamp": 1693064465, "time_this_iter_s": 80.04024624824524, "time_total_s": 13611.374123573303, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701535E2E0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015078E20>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 13611.374123573303, "timesteps_since_restore": 0, "iterations_since_restore": 177, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 24.243362831858406, "ram_util_percent": 51.76460176991149}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -284.6223496374488, "episode_L1_reward_sum_min": -599.2290505170822, "episode_L1_reward_sum_max": -165.91908431053162, "episode_L2_reward_sum_mean": -148.1240612541884, "episode_L2_reward_sum_min": -224.26919478178024, "episode_L2_reward_sum_max": -117.88138159364462}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.023348773037487787, "policy_loss": -0.00040919512511257834, "vf_loss": 0.23757967265665345, "vf_explained_var": 0.49754496292812833, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2492000, "num_env_steps_trained": 2492000, "num_agent_steps_sampled": 2492000, "num_agent_steps_trained": 2492000}, "sampler_results": {"episode_reward_max": -36.87879732144168, "episode_reward_min": -203.0468303233862, "episode_reward_mean": -90.54015147739865, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -284.6223496374488, "episode_L1_reward_sum_min": -599.2290505170822, "episode_L1_reward_sum_max": -165.91908431053162, "episode_L2_reward_sum_mean": -148.1240612541884, "episode_L2_reward_sum_min": -224.26919478178024, "episode_L2_reward_sum_max": -117.88138159364462}, "hist_stats": {"episode_reward": [-65.47177797522855, -51.01541479019341, -102.91645127551031, -131.67547863177725, -49.36151660971523, -82.70577513318798, -64.71656121345393, -85.4894356501881, -63.306283842702186, -118.36154399369289, -72.24721148007197, -48.28361637216396, -158.02821187236952, -138.77431113231805, -156.23044143410723, -61.018343665266855, -60.980425644575895, -116.86009026514145, -58.15685478625205, -69.74091922954779, -43.07880867912783, -101.33279970314673, -91.21102072085648, -162.55694935808907, -119.52469651913717, -125.91397868101525, -94.05482254412671, -90.51039839290867, -49.30557041810512, -45.740656418051515, -65.30752041999422, -58.09971412913871, -94.84214493055677, -79.83363940174382, -191.26711288865818, -63.136198787062064, -122.38700038345235, -79.92822474994723, -199.95498614194986, -70.17240813505008, -111.33931249727782, -75.93211617665455, -159.1356044923925, -112.9148730884714, -48.82161105764804, -54.221878924862914, -119.12433979785361, -46.274465665471105, -70.57179882399785, -50.821993503068256, -84.15762424000799, -89.06312499711316, -97.17818796893621, -61.12910729052234, -105.2367638609704, -52.204647770212354, -110.05537017623318, -103.77450483111421, -61.936536616182394, -105.18689400581005, -95.7382294993329, -91.24692930176639, -72.8783288930499, -203.0468303233862, -42.80026834535122, -104.36064191162494, -76.33573818116324, -61.791266765052725, -170.6475339132279, -64.30197663029115, -115.65086653450683, -136.21003232936127, -72.0046140485975, -133.2234453998838, -112.32552947768002, -133.09538519164968, -50.278149406521045, -36.87879732144168, -94.78476977568596, -114.52600649690993, -111.87805507322888, -56.342627350702166, -48.42110945443303, -69.47443353289634, -81.99839674426887, -47.372409130899754, -96.05391414736123, -99.87811923896749, -98.64077681687219, -72.88222606116241, -94.74563094190971, -93.85840162033834, -70.96084862113311, -60.53820529114224, -72.41780839423035, -59.91625953044377, -92.97828459784768, -113.53820372191257, -66.85760226755055, -140.55642327169807], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6535623499635799, "mean_inference_ms": 5.616918278143319, "mean_action_processing_ms": 0.20829387076652048, "mean_env_wait_ms": 1.4624304994866997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -36.87879732144168, "episode_reward_min": -203.0468303233862, "episode_reward_mean": -90.54015147739865, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-65.47177797522855, -51.01541479019341, -102.91645127551031, -131.67547863177725, -49.36151660971523, -82.70577513318798, -64.71656121345393, -85.4894356501881, -63.306283842702186, -118.36154399369289, -72.24721148007197, -48.28361637216396, -158.02821187236952, -138.77431113231805, -156.23044143410723, -61.018343665266855, -60.980425644575895, -116.86009026514145, -58.15685478625205, -69.74091922954779, -43.07880867912783, -101.33279970314673, -91.21102072085648, -162.55694935808907, -119.52469651913717, -125.91397868101525, -94.05482254412671, -90.51039839290867, -49.30557041810512, -45.740656418051515, -65.30752041999422, -58.09971412913871, -94.84214493055677, -79.83363940174382, -191.26711288865818, -63.136198787062064, -122.38700038345235, -79.92822474994723, -199.95498614194986, -70.17240813505008, -111.33931249727782, -75.93211617665455, -159.1356044923925, -112.9148730884714, -48.82161105764804, -54.221878924862914, -119.12433979785361, -46.274465665471105, -70.57179882399785, -50.821993503068256, -84.15762424000799, -89.06312499711316, -97.17818796893621, -61.12910729052234, -105.2367638609704, -52.204647770212354, -110.05537017623318, -103.77450483111421, -61.936536616182394, -105.18689400581005, -95.7382294993329, -91.24692930176639, -72.8783288930499, -203.0468303233862, -42.80026834535122, -104.36064191162494, -76.33573818116324, -61.791266765052725, -170.6475339132279, -64.30197663029115, -115.65086653450683, -136.21003232936127, -72.0046140485975, -133.2234453998838, -112.32552947768002, -133.09538519164968, -50.278149406521045, -36.87879732144168, -94.78476977568596, -114.52600649690993, -111.87805507322888, -56.342627350702166, -48.42110945443303, -69.47443353289634, -81.99839674426887, -47.372409130899754, -96.05391414736123, -99.87811923896749, -98.64077681687219, -72.88222606116241, -94.74563094190971, -93.85840162033834, -70.96084862113311, -60.53820529114224, -72.41780839423035, -59.91625953044377, -92.97828459784768, -113.53820372191257, -66.85760226755055, -140.55642327169807], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6535623499635799, "mean_inference_ms": 5.616918278143319, "mean_action_processing_ms": 0.20829387076652048, "mean_env_wait_ms": 1.4624304994866997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2492000, "num_agent_steps_trained": 2492000, "num_env_steps_sampled": 2492000, "num_env_steps_trained": 2492000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2492000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2492000, "timers": {"training_iteration_time_ms": 80242.766, "load_time_ms": 46.875, "load_throughput": 298665.148, "learn_time_ms": 69567.303, "learn_throughput": 201.244, "synch_weights_time_ms": 7.133}, "counters": {"num_env_steps_sampled": 2492000, "num_env_steps_trained": 2492000, "num_agent_steps_sampled": 2492000, "num_agent_steps_trained": 2492000}, "done": false, "episodes_total": 2492, "training_iteration": 178, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-42-25", "timestamp": 1693064545, "time_this_iter_s": 80.2293758392334, "time_total_s": 13691.603499412537, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701517A400>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015359370>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 13691.603499412537, "timesteps_since_restore": 0, "iterations_since_restore": 178, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 24.22368421052631, "ram_util_percent": 51.742982456140346}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -287.15383464358746, "episode_L1_reward_sum_min": -607.9426639080048, "episode_L1_reward_sum_max": -165.91908431053162, "episode_L2_reward_sum_mean": -148.68643300250173, "episode_L2_reward_sum_min": -227.2373769581318, "episode_L2_reward_sum_max": -117.88138159364462}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.05829953933671239, "policy_loss": 0.022632597579616946, "vf_loss": 0.3566694138891175, "vf_explained_var": 0.6477401645647155, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2506000, "num_env_steps_trained": 2506000, "num_agent_steps_sampled": 2506000, "num_agent_steps_trained": 2506000}, "sampler_results": {"episode_reward_max": -36.87879732144168, "episode_reward_min": -241.06948558104995, "episode_reward_mean": -91.79784222243619, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -287.15383464358746, "episode_L1_reward_sum_min": -607.9426639080048, "episode_L1_reward_sum_max": -165.91908431053162, "episode_L2_reward_sum_mean": -148.68643300250173, "episode_L2_reward_sum_min": -227.2373769581318, "episode_L2_reward_sum_max": -117.88138159364462}, "hist_stats": {"episode_reward": [-156.23044143410723, -61.018343665266855, -60.980425644575895, -116.86009026514145, -58.15685478625205, -69.74091922954779, -43.07880867912783, -101.33279970314673, -91.21102072085648, -162.55694935808907, -119.52469651913717, -125.91397868101525, -94.05482254412671, -90.51039839290867, -49.30557041810512, -45.740656418051515, -65.30752041999422, -58.09971412913871, -94.84214493055677, -79.83363940174382, -191.26711288865818, -63.136198787062064, -122.38700038345235, -79.92822474994723, -199.95498614194986, -70.17240813505008, -111.33931249727782, -75.93211617665455, -159.1356044923925, -112.9148730884714, -48.82161105764804, -54.221878924862914, -119.12433979785361, -46.274465665471105, -70.57179882399785, -50.821993503068256, -84.15762424000799, -89.06312499711316, -97.17818796893621, -61.12910729052234, -105.2367638609704, -52.204647770212354, -110.05537017623318, -103.77450483111421, -61.936536616182394, -105.18689400581005, -95.7382294993329, -91.24692930176639, -72.8783288930499, -203.0468303233862, -42.80026834535122, -104.36064191162494, -76.33573818116324, -61.791266765052725, -170.6475339132279, -64.30197663029115, -115.65086653450683, -136.21003232936127, -72.0046140485975, -133.2234453998838, -112.32552947768002, -133.09538519164968, -50.278149406521045, -36.87879732144168, -94.78476977568596, -114.52600649690993, -111.87805507322888, -56.342627350702166, -48.42110945443303, -69.47443353289634, -81.99839674426887, -47.372409130899754, -96.05391414736123, -99.87811923896749, -98.64077681687219, -72.88222606116241, -94.74563094190971, -93.85840162033834, -70.96084862113311, -60.53820529114224, -72.41780839423035, -59.91625953044377, -92.97828459784768, -113.53820372191257, -66.85760226755055, -140.55642327169807, -200.91141162684158, -86.860531396984, -86.65722953178879, -48.591433131638404, -44.409561893588354, -241.06948558104995, -70.67972171880074, -76.33163298916827, -132.80172378138735, -76.43270706419747, -95.16346050688477, -99.49086603953029, -50.60258282064101, -48.12031639382566], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6552934262416522, "mean_inference_ms": 5.626113717758606, "mean_action_processing_ms": 0.20861204322891042, "mean_env_wait_ms": 1.4648897038913526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -36.87879732144168, "episode_reward_min": -241.06948558104995, "episode_reward_mean": -91.79784222243619, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-156.23044143410723, -61.018343665266855, -60.980425644575895, -116.86009026514145, -58.15685478625205, -69.74091922954779, -43.07880867912783, -101.33279970314673, -91.21102072085648, -162.55694935808907, -119.52469651913717, -125.91397868101525, -94.05482254412671, -90.51039839290867, -49.30557041810512, -45.740656418051515, -65.30752041999422, -58.09971412913871, -94.84214493055677, -79.83363940174382, -191.26711288865818, -63.136198787062064, -122.38700038345235, -79.92822474994723, -199.95498614194986, -70.17240813505008, -111.33931249727782, -75.93211617665455, -159.1356044923925, -112.9148730884714, -48.82161105764804, -54.221878924862914, -119.12433979785361, -46.274465665471105, -70.57179882399785, -50.821993503068256, -84.15762424000799, -89.06312499711316, -97.17818796893621, -61.12910729052234, -105.2367638609704, -52.204647770212354, -110.05537017623318, -103.77450483111421, -61.936536616182394, -105.18689400581005, -95.7382294993329, -91.24692930176639, -72.8783288930499, -203.0468303233862, -42.80026834535122, -104.36064191162494, -76.33573818116324, -61.791266765052725, -170.6475339132279, -64.30197663029115, -115.65086653450683, -136.21003232936127, -72.0046140485975, -133.2234453998838, -112.32552947768002, -133.09538519164968, -50.278149406521045, -36.87879732144168, -94.78476977568596, -114.52600649690993, -111.87805507322888, -56.342627350702166, -48.42110945443303, -69.47443353289634, -81.99839674426887, -47.372409130899754, -96.05391414736123, -99.87811923896749, -98.64077681687219, -72.88222606116241, -94.74563094190971, -93.85840162033834, -70.96084862113311, -60.53820529114224, -72.41780839423035, -59.91625953044377, -92.97828459784768, -113.53820372191257, -66.85760226755055, -140.55642327169807, -200.91141162684158, -86.860531396984, -86.65722953178879, -48.591433131638404, -44.409561893588354, -241.06948558104995, -70.67972171880074, -76.33163298916827, -132.80172378138735, -76.43270706419747, -95.16346050688477, -99.49086603953029, -50.60258282064101, -48.12031639382566], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6552934262416522, "mean_inference_ms": 5.626113717758606, "mean_action_processing_ms": 0.20861204322891042, "mean_env_wait_ms": 1.4648897038913526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2506000, "num_agent_steps_trained": 2506000, "num_env_steps_sampled": 2506000, "num_env_steps_trained": 2506000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2506000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2506000, "timers": {"training_iteration_time_ms": 80180.323, "load_time_ms": 47.075, "load_throughput": 297398.614, "learn_time_ms": 69552.682, "learn_throughput": 201.286, "synch_weights_time_ms": 7.143}, "counters": {"num_env_steps_sampled": 2506000, "num_env_steps_trained": 2506000, "num_agent_steps_sampled": 2506000, "num_agent_steps_trained": 2506000}, "done": false, "episodes_total": 2506, "training_iteration": 179, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-43-45", "timestamp": 1693064625, "time_this_iter_s": 80.0138669013977, "time_total_s": 13771.617366313934, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270153097F0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701516FA90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 13771.617366313934, "timesteps_since_restore": 0, "iterations_since_restore": 179, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 24.305309734513273, "ram_util_percent": 51.84336283185839}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -283.4929411928356, "episode_L1_reward_sum_min": -635.0666286051273, "episode_L1_reward_sum_max": -165.91908431053162, "episode_L2_reward_sum_mean": -147.685033704713, "episode_L2_reward_sum_min": -232.10215286910534, "episode_L2_reward_sum_max": -117.88138159364462}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.06547948108519401, "policy_loss": 0.0373573799029763, "vf_loss": 0.2812210096833019, "vf_explained_var": 0.5825623734375086, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2520000, "num_env_steps_trained": 2520000, "num_agent_steps_sampled": 2520000, "num_agent_steps_trained": 2520000}, "sampler_results": {"episode_reward_max": -36.87879732144168, "episode_reward_min": -241.06948558104995, "episode_reward_mean": -90.87933455959214, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -283.4929411928356, "episode_L1_reward_sum_min": -635.0666286051273, "episode_L1_reward_sum_max": -165.91908431053162, "episode_L2_reward_sum_mean": -147.685033704713, "episode_L2_reward_sum_min": -232.10215286910534, "episode_L2_reward_sum_max": -117.88138159364462}, "hist_stats": {"episode_reward": [-49.30557041810512, -45.740656418051515, -65.30752041999422, -58.09971412913871, -94.84214493055677, -79.83363940174382, -191.26711288865818, -63.136198787062064, -122.38700038345235, -79.92822474994723, -199.95498614194986, -70.17240813505008, -111.33931249727782, -75.93211617665455, -159.1356044923925, -112.9148730884714, -48.82161105764804, -54.221878924862914, -119.12433979785361, -46.274465665471105, -70.57179882399785, -50.821993503068256, -84.15762424000799, -89.06312499711316, -97.17818796893621, -61.12910729052234, -105.2367638609704, -52.204647770212354, -110.05537017623318, -103.77450483111421, -61.936536616182394, -105.18689400581005, -95.7382294993329, -91.24692930176639, -72.8783288930499, -203.0468303233862, -42.80026834535122, -104.36064191162494, -76.33573818116324, -61.791266765052725, -170.6475339132279, -64.30197663029115, -115.65086653450683, -136.21003232936127, -72.0046140485975, -133.2234453998838, -112.32552947768002, -133.09538519164968, -50.278149406521045, -36.87879732144168, -94.78476977568596, -114.52600649690993, -111.87805507322888, -56.342627350702166, -48.42110945443303, -69.47443353289634, -81.99839674426887, -47.372409130899754, -96.05391414736123, -99.87811923896749, -98.64077681687219, -72.88222606116241, -94.74563094190971, -93.85840162033834, -70.96084862113311, -60.53820529114224, -72.41780839423035, -59.91625953044377, -92.97828459784768, -113.53820372191257, -66.85760226755055, -140.55642327169807, -200.91141162684158, -86.860531396984, -86.65722953178879, -48.591433131638404, -44.409561893588354, -241.06948558104995, -70.67972171880074, -76.33163298916827, -132.80172378138735, -76.43270706419747, -95.16346050688477, -99.49086603953029, -50.60258282064101, -48.12031639382566, -48.43107128367033, -74.18606160120453, -219.8664682459989, -57.937581639112906, -119.70802438356367, -105.9791436068017, -100.38463663753814, -158.3120865749268, -58.70586530161726, -61.572247314393195, -78.36318434171106, -54.82158681471922, -68.40511894700344, -52.646706646631465], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6570056665204068, "mean_inference_ms": 5.635442100343587, "mean_action_processing_ms": 0.2089320714957973, "mean_env_wait_ms": 1.4673556721810217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -36.87879732144168, "episode_reward_min": -241.06948558104995, "episode_reward_mean": -90.87933455959214, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-49.30557041810512, -45.740656418051515, -65.30752041999422, -58.09971412913871, -94.84214493055677, -79.83363940174382, -191.26711288865818, -63.136198787062064, -122.38700038345235, -79.92822474994723, -199.95498614194986, -70.17240813505008, -111.33931249727782, -75.93211617665455, -159.1356044923925, -112.9148730884714, -48.82161105764804, -54.221878924862914, -119.12433979785361, -46.274465665471105, -70.57179882399785, -50.821993503068256, -84.15762424000799, -89.06312499711316, -97.17818796893621, -61.12910729052234, -105.2367638609704, -52.204647770212354, -110.05537017623318, -103.77450483111421, -61.936536616182394, -105.18689400581005, -95.7382294993329, -91.24692930176639, -72.8783288930499, -203.0468303233862, -42.80026834535122, -104.36064191162494, -76.33573818116324, -61.791266765052725, -170.6475339132279, -64.30197663029115, -115.65086653450683, -136.21003232936127, -72.0046140485975, -133.2234453998838, -112.32552947768002, -133.09538519164968, -50.278149406521045, -36.87879732144168, -94.78476977568596, -114.52600649690993, -111.87805507322888, -56.342627350702166, -48.42110945443303, -69.47443353289634, -81.99839674426887, -47.372409130899754, -96.05391414736123, -99.87811923896749, -98.64077681687219, -72.88222606116241, -94.74563094190971, -93.85840162033834, -70.96084862113311, -60.53820529114224, -72.41780839423035, -59.91625953044377, -92.97828459784768, -113.53820372191257, -66.85760226755055, -140.55642327169807, -200.91141162684158, -86.860531396984, -86.65722953178879, -48.591433131638404, -44.409561893588354, -241.06948558104995, -70.67972171880074, -76.33163298916827, -132.80172378138735, -76.43270706419747, -95.16346050688477, -99.49086603953029, -50.60258282064101, -48.12031639382566, -48.43107128367033, -74.18606160120453, -219.8664682459989, -57.937581639112906, -119.70802438356367, -105.9791436068017, -100.38463663753814, -158.3120865749268, -58.70586530161726, -61.572247314393195, -78.36318434171106, -54.82158681471922, -68.40511894700344, -52.646706646631465], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6570056665204068, "mean_inference_ms": 5.635442100343587, "mean_action_processing_ms": 0.2089320714957973, "mean_env_wait_ms": 1.4673556721810217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2520000, "num_agent_steps_trained": 2520000, "num_env_steps_sampled": 2520000, "num_env_steps_trained": 2520000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2520000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2520000, "timers": {"training_iteration_time_ms": 80212.668, "load_time_ms": 47.078, "load_throughput": 297380.39, "learn_time_ms": 69542.075, "learn_throughput": 201.317, "synch_weights_time_ms": 7.345}, "counters": {"num_env_steps_sampled": 2520000, "num_env_steps_trained": 2520000, "num_agent_steps_sampled": 2520000, "num_agent_steps_trained": 2520000}, "done": false, "episodes_total": 2520, "training_iteration": 180, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-45-06", "timestamp": 1693064706, "time_this_iter_s": 80.44754934310913, "time_total_s": 13852.064915657043, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015309D00>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015443580>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 13852.064915657043, "timesteps_since_restore": 0, "iterations_since_restore": 180, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 24.457522123893803, "ram_util_percent": 51.84867256637166}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -282.5412632626295, "episode_L1_reward_sum_min": -635.0666286051273, "episode_L1_reward_sum_max": -162.25224059075117, "episode_L2_reward_sum_mean": -147.53143510572613, "episode_L2_reward_sum_min": -232.10215286910534, "episode_L2_reward_sum_max": -116.78948438167572}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.030343520061741486, "policy_loss": 0.0024189466156387405, "vf_loss": 0.279245745672887, "vf_explained_var": 0.7022546624818456, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2534000, "num_env_steps_trained": 2534000, "num_agent_steps_sampled": 2534000, "num_agent_steps_trained": 2534000}, "sampler_results": {"episode_reward_max": -36.87879732144168, "episode_reward_min": -241.06948558104995, "episode_reward_mean": -90.21634458074058, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -282.5412632626295, "episode_L1_reward_sum_min": -635.0666286051273, "episode_L1_reward_sum_max": -162.25224059075117, "episode_L2_reward_sum_mean": -147.53143510572613, "episode_L2_reward_sum_min": -232.10215286910534, "episode_L2_reward_sum_max": -116.78948438167572}, "hist_stats": {"episode_reward": [-159.1356044923925, -112.9148730884714, -48.82161105764804, -54.221878924862914, -119.12433979785361, -46.274465665471105, -70.57179882399785, -50.821993503068256, -84.15762424000799, -89.06312499711316, -97.17818796893621, -61.12910729052234, -105.2367638609704, -52.204647770212354, -110.05537017623318, -103.77450483111421, -61.936536616182394, -105.18689400581005, -95.7382294993329, -91.24692930176639, -72.8783288930499, -203.0468303233862, -42.80026834535122, -104.36064191162494, -76.33573818116324, -61.791266765052725, -170.6475339132279, -64.30197663029115, -115.65086653450683, -136.21003232936127, -72.0046140485975, -133.2234453998838, -112.32552947768002, -133.09538519164968, -50.278149406521045, -36.87879732144168, -94.78476977568596, -114.52600649690993, -111.87805507322888, -56.342627350702166, -48.42110945443303, -69.47443353289634, -81.99839674426887, -47.372409130899754, -96.05391414736123, -99.87811923896749, -98.64077681687219, -72.88222606116241, -94.74563094190971, -93.85840162033834, -70.96084862113311, -60.53820529114224, -72.41780839423035, -59.91625953044377, -92.97828459784768, -113.53820372191257, -66.85760226755055, -140.55642327169807, -200.91141162684158, -86.860531396984, -86.65722953178879, -48.591433131638404, -44.409561893588354, -241.06948558104995, -70.67972171880074, -76.33163298916827, -132.80172378138735, -76.43270706419747, -95.16346050688477, -99.49086603953029, -50.60258282064101, -48.12031639382566, -48.43107128367033, -74.18606160120453, -219.8664682459989, -57.937581639112906, -119.70802438356367, -105.9791436068017, -100.38463663753814, -158.3120865749268, -58.70586530161726, -61.572247314393195, -78.36318434171106, -54.82158681471922, -68.40511894700344, -52.646706646631465, -36.91482918905599, -60.949034406985284, -122.405314960155, -55.050895667750936, -112.3879225113192, -50.59497560669929, -60.600405424209725, -124.25884241346827, -97.679650188522, -195.9731064725982, -73.65091424665763, -107.44257984168271, -70.48353242259704, -72.55560424078594], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6586760590943114, "mean_inference_ms": 5.6446920782134296, "mean_action_processing_ms": 0.2092523702117731, "mean_env_wait_ms": 1.4698008946456647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -36.87879732144168, "episode_reward_min": -241.06948558104995, "episode_reward_mean": -90.21634458074058, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-159.1356044923925, -112.9148730884714, -48.82161105764804, -54.221878924862914, -119.12433979785361, -46.274465665471105, -70.57179882399785, -50.821993503068256, -84.15762424000799, -89.06312499711316, -97.17818796893621, -61.12910729052234, -105.2367638609704, -52.204647770212354, -110.05537017623318, -103.77450483111421, -61.936536616182394, -105.18689400581005, -95.7382294993329, -91.24692930176639, -72.8783288930499, -203.0468303233862, -42.80026834535122, -104.36064191162494, -76.33573818116324, -61.791266765052725, -170.6475339132279, -64.30197663029115, -115.65086653450683, -136.21003232936127, -72.0046140485975, -133.2234453998838, -112.32552947768002, -133.09538519164968, -50.278149406521045, -36.87879732144168, -94.78476977568596, -114.52600649690993, -111.87805507322888, -56.342627350702166, -48.42110945443303, -69.47443353289634, -81.99839674426887, -47.372409130899754, -96.05391414736123, -99.87811923896749, -98.64077681687219, -72.88222606116241, -94.74563094190971, -93.85840162033834, -70.96084862113311, -60.53820529114224, -72.41780839423035, -59.91625953044377, -92.97828459784768, -113.53820372191257, -66.85760226755055, -140.55642327169807, -200.91141162684158, -86.860531396984, -86.65722953178879, -48.591433131638404, -44.409561893588354, -241.06948558104995, -70.67972171880074, -76.33163298916827, -132.80172378138735, -76.43270706419747, -95.16346050688477, -99.49086603953029, -50.60258282064101, -48.12031639382566, -48.43107128367033, -74.18606160120453, -219.8664682459989, -57.937581639112906, -119.70802438356367, -105.9791436068017, -100.38463663753814, -158.3120865749268, -58.70586530161726, -61.572247314393195, -78.36318434171106, -54.82158681471922, -68.40511894700344, -52.646706646631465, -36.91482918905599, -60.949034406985284, -122.405314960155, -55.050895667750936, -112.3879225113192, -50.59497560669929, -60.600405424209725, -124.25884241346827, -97.679650188522, -195.9731064725982, -73.65091424665763, -107.44257984168271, -70.48353242259704, -72.55560424078594], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6586760590943114, "mean_inference_ms": 5.6446920782134296, "mean_action_processing_ms": 0.2092523702117731, "mean_env_wait_ms": 1.4698008946456647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2534000, "num_agent_steps_trained": 2534000, "num_env_steps_sampled": 2534000, "num_env_steps_trained": 2534000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2534000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2534000, "timers": {"training_iteration_time_ms": 80239.858, "load_time_ms": 46.878, "load_throughput": 298645.856, "learn_time_ms": 69534.316, "learn_throughput": 201.339, "synch_weights_time_ms": 7.336}, "counters": {"num_env_steps_sampled": 2534000, "num_env_steps_trained": 2534000, "num_agent_steps_sampled": 2534000, "num_agent_steps_trained": 2534000}, "done": false, "episodes_total": 2534, "training_iteration": 181, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-46-26", "timestamp": 1693064786, "time_this_iter_s": 80.36053466796875, "time_total_s": 13932.425450325012, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701539C880>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270152045B0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 13932.425450325012, "timesteps_since_restore": 0, "iterations_since_restore": 181, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 24.237719298245608, "ram_util_percent": 51.87192982456139}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -290.6473786638677, "episode_L1_reward_sum_min": -635.0666286051273, "episode_L1_reward_sum_max": -159.82650849968195, "episode_L2_reward_sum_mean": -149.5181117554754, "episode_L2_reward_sum_min": -232.10215286910534, "episode_L2_reward_sum_max": -116.42113415896893}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.0429312605612026, "policy_loss": 0.015961586157580525, "vf_loss": 0.26969674225209955, "vf_explained_var": 0.6916124067985963, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2548000, "num_env_steps_trained": 2548000, "num_agent_steps_sampled": 2548000, "num_agent_steps_trained": 2548000}, "sampler_results": {"episode_reward_max": -36.87879732144168, "episode_reward_min": -241.06948558104995, "episode_reward_mean": -92.20242812424958, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -290.6473786638677, "episode_L1_reward_sum_min": -635.0666286051273, "episode_L1_reward_sum_max": -159.82650849968195, "episode_L2_reward_sum_mean": -149.5181117554754, "episode_L2_reward_sum_min": -232.10215286910534, "episode_L2_reward_sum_max": -116.42113415896893}, "hist_stats": {"episode_reward": [-110.05537017623318, -103.77450483111421, -61.936536616182394, -105.18689400581005, -95.7382294993329, -91.24692930176639, -72.8783288930499, -203.0468303233862, -42.80026834535122, -104.36064191162494, -76.33573818116324, -61.791266765052725, -170.6475339132279, -64.30197663029115, -115.65086653450683, -136.21003232936127, -72.0046140485975, -133.2234453998838, -112.32552947768002, -133.09538519164968, -50.278149406521045, -36.87879732144168, -94.78476977568596, -114.52600649690993, -111.87805507322888, -56.342627350702166, -48.42110945443303, -69.47443353289634, -81.99839674426887, -47.372409130899754, -96.05391414736123, -99.87811923896749, -98.64077681687219, -72.88222606116241, -94.74563094190971, -93.85840162033834, -70.96084862113311, -60.53820529114224, -72.41780839423035, -59.91625953044377, -92.97828459784768, -113.53820372191257, -66.85760226755055, -140.55642327169807, -200.91141162684158, -86.860531396984, -86.65722953178879, -48.591433131638404, -44.409561893588354, -241.06948558104995, -70.67972171880074, -76.33163298916827, -132.80172378138735, -76.43270706419747, -95.16346050688477, -99.49086603953029, -50.60258282064101, -48.12031639382566, -48.43107128367033, -74.18606160120453, -219.8664682459989, -57.937581639112906, -119.70802438356367, -105.9791436068017, -100.38463663753814, -158.3120865749268, -58.70586530161726, -61.572247314393195, -78.36318434171106, -54.82158681471922, -68.40511894700344, -52.646706646631465, -36.91482918905599, -60.949034406985284, -122.405314960155, -55.050895667750936, -112.3879225113192, -50.59497560669929, -60.600405424209725, -124.25884241346827, -97.679650188522, -195.9731064725982, -73.65091424665763, -107.44257984168271, -70.48353242259704, -72.55560424078594, -53.63469827087927, -102.6816642104933, -151.49646291820235, -50.10127858139648, -174.03183798678646, -138.2557466858847, -95.93995645966253, -48.36629810483635, -63.96975601421235, -52.550786069137615, -134.21389567983604, -123.25433689605248, -40.939502902531785, -120.02815505251995], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6603595171678984, "mean_inference_ms": 5.653774706057664, "mean_action_processing_ms": 0.20956947726267977, "mean_env_wait_ms": 1.472198845406429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -36.87879732144168, "episode_reward_min": -241.06948558104995, "episode_reward_mean": -92.20242812424958, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-110.05537017623318, -103.77450483111421, -61.936536616182394, -105.18689400581005, -95.7382294993329, -91.24692930176639, -72.8783288930499, -203.0468303233862, -42.80026834535122, -104.36064191162494, -76.33573818116324, -61.791266765052725, -170.6475339132279, -64.30197663029115, -115.65086653450683, -136.21003232936127, -72.0046140485975, -133.2234453998838, -112.32552947768002, -133.09538519164968, -50.278149406521045, -36.87879732144168, -94.78476977568596, -114.52600649690993, -111.87805507322888, -56.342627350702166, -48.42110945443303, -69.47443353289634, -81.99839674426887, -47.372409130899754, -96.05391414736123, -99.87811923896749, -98.64077681687219, -72.88222606116241, -94.74563094190971, -93.85840162033834, -70.96084862113311, -60.53820529114224, -72.41780839423035, -59.91625953044377, -92.97828459784768, -113.53820372191257, -66.85760226755055, -140.55642327169807, -200.91141162684158, -86.860531396984, -86.65722953178879, -48.591433131638404, -44.409561893588354, -241.06948558104995, -70.67972171880074, -76.33163298916827, -132.80172378138735, -76.43270706419747, -95.16346050688477, -99.49086603953029, -50.60258282064101, -48.12031639382566, -48.43107128367033, -74.18606160120453, -219.8664682459989, -57.937581639112906, -119.70802438356367, -105.9791436068017, -100.38463663753814, -158.3120865749268, -58.70586530161726, -61.572247314393195, -78.36318434171106, -54.82158681471922, -68.40511894700344, -52.646706646631465, -36.91482918905599, -60.949034406985284, -122.405314960155, -55.050895667750936, -112.3879225113192, -50.59497560669929, -60.600405424209725, -124.25884241346827, -97.679650188522, -195.9731064725982, -73.65091424665763, -107.44257984168271, -70.48353242259704, -72.55560424078594, -53.63469827087927, -102.6816642104933, -151.49646291820235, -50.10127858139648, -174.03183798678646, -138.2557466858847, -95.93995645966253, -48.36629810483635, -63.96975601421235, -52.550786069137615, -134.21389567983604, -123.25433689605248, -40.939502902531785, -120.02815505251995], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6603595171678984, "mean_inference_ms": 5.653774706057664, "mean_action_processing_ms": 0.20956947726267977, "mean_env_wait_ms": 1.472198845406429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2548000, "num_agent_steps_trained": 2548000, "num_env_steps_sampled": 2548000, "num_env_steps_trained": 2548000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2548000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2548000, "timers": {"training_iteration_time_ms": 80247.822, "load_time_ms": 47.477, "load_throughput": 294881.212, "learn_time_ms": 69526.968, "learn_throughput": 201.361, "synch_weights_time_ms": 7.13}, "counters": {"num_env_steps_sampled": 2548000, "num_env_steps_trained": 2548000, "num_agent_steps_sampled": 2548000, "num_agent_steps_trained": 2548000}, "done": false, "episodes_total": 2548, "training_iteration": 182, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-47-46", "timestamp": 1693064866, "time_this_iter_s": 80.15205502510071, "time_total_s": 14012.577505350113, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270150EF250>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027014EA7400>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 14012.577505350113, "timesteps_since_restore": 0, "iterations_since_restore": 182, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 24.204424778761066, "ram_util_percent": 51.84336283185839}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -287.955366942659, "episode_L1_reward_sum_min": -635.0666286051273, "episode_L1_reward_sum_max": -159.82650849968195, "episode_L2_reward_sum_mean": -148.81328488215803, "episode_L2_reward_sum_min": -232.10215286910534, "episode_L2_reward_sum_max": -116.42113415896893}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.05151969686458596, "policy_loss": 0.02818604522086958, "vf_loss": 0.23333652707184221, "vf_explained_var": 0.6414617295434446, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2562000, "num_env_steps_trained": 2562000, "num_agent_steps_sampled": 2562000, "num_agent_steps_trained": 2562000}, "sampler_results": {"episode_reward_max": -36.87879732144168, "episode_reward_min": -241.06948558104995, "episode_reward_mean": -91.79655211397665, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -287.955366942659, "episode_L1_reward_sum_min": -635.0666286051273, "episode_L1_reward_sum_max": -159.82650849968195, "episode_L2_reward_sum_mean": -148.81328488215803, "episode_L2_reward_sum_min": -232.10215286910534, "episode_L2_reward_sum_max": -116.42113415896893}, "hist_stats": {"episode_reward": [-115.65086653450683, -136.21003232936127, -72.0046140485975, -133.2234453998838, -112.32552947768002, -133.09538519164968, -50.278149406521045, -36.87879732144168, -94.78476977568596, -114.52600649690993, -111.87805507322888, -56.342627350702166, -48.42110945443303, -69.47443353289634, -81.99839674426887, -47.372409130899754, -96.05391414736123, -99.87811923896749, -98.64077681687219, -72.88222606116241, -94.74563094190971, -93.85840162033834, -70.96084862113311, -60.53820529114224, -72.41780839423035, -59.91625953044377, -92.97828459784768, -113.53820372191257, -66.85760226755055, -140.55642327169807, -200.91141162684158, -86.860531396984, -86.65722953178879, -48.591433131638404, -44.409561893588354, -241.06948558104995, -70.67972171880074, -76.33163298916827, -132.80172378138735, -76.43270706419747, -95.16346050688477, -99.49086603953029, -50.60258282064101, -48.12031639382566, -48.43107128367033, -74.18606160120453, -219.8664682459989, -57.937581639112906, -119.70802438356367, -105.9791436068017, -100.38463663753814, -158.3120865749268, -58.70586530161726, -61.572247314393195, -78.36318434171106, -54.82158681471922, -68.40511894700344, -52.646706646631465, -36.91482918905599, -60.949034406985284, -122.405314960155, -55.050895667750936, -112.3879225113192, -50.59497560669929, -60.600405424209725, -124.25884241346827, -97.679650188522, -195.9731064725982, -73.65091424665763, -107.44257984168271, -70.48353242259704, -72.55560424078594, -53.63469827087927, -102.6816642104933, -151.49646291820235, -50.10127858139648, -174.03183798678646, -138.2557466858847, -95.93995645966253, -48.36629810483635, -63.96975601421235, -52.550786069137615, -134.21389567983604, -123.25433689605248, -40.939502902531785, -120.02815505251995, -184.91782174822347, -100.80772788828202, -61.65300433251717, -118.86331780791234, -74.52545008080118, -89.8349396473539, -109.15887708701224, -153.59281513933243, -121.33490738450367, -64.15576440171114, -56.87155087950813, -58.12230901570115, -81.75078104421762, -47.92418190921043], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6619729447244144, "mean_inference_ms": 5.662748033009121, "mean_action_processing_ms": 0.2098786850490778, "mean_env_wait_ms": 1.4745754362289545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -36.87879732144168, "episode_reward_min": -241.06948558104995, "episode_reward_mean": -91.79655211397665, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115.65086653450683, -136.21003232936127, -72.0046140485975, -133.2234453998838, -112.32552947768002, -133.09538519164968, -50.278149406521045, -36.87879732144168, -94.78476977568596, -114.52600649690993, -111.87805507322888, -56.342627350702166, -48.42110945443303, -69.47443353289634, -81.99839674426887, -47.372409130899754, -96.05391414736123, -99.87811923896749, -98.64077681687219, -72.88222606116241, -94.74563094190971, -93.85840162033834, -70.96084862113311, -60.53820529114224, -72.41780839423035, -59.91625953044377, -92.97828459784768, -113.53820372191257, -66.85760226755055, -140.55642327169807, -200.91141162684158, -86.860531396984, -86.65722953178879, -48.591433131638404, -44.409561893588354, -241.06948558104995, -70.67972171880074, -76.33163298916827, -132.80172378138735, -76.43270706419747, -95.16346050688477, -99.49086603953029, -50.60258282064101, -48.12031639382566, -48.43107128367033, -74.18606160120453, -219.8664682459989, -57.937581639112906, -119.70802438356367, -105.9791436068017, -100.38463663753814, -158.3120865749268, -58.70586530161726, -61.572247314393195, -78.36318434171106, -54.82158681471922, -68.40511894700344, -52.646706646631465, -36.91482918905599, -60.949034406985284, -122.405314960155, -55.050895667750936, -112.3879225113192, -50.59497560669929, -60.600405424209725, -124.25884241346827, -97.679650188522, -195.9731064725982, -73.65091424665763, -107.44257984168271, -70.48353242259704, -72.55560424078594, -53.63469827087927, -102.6816642104933, -151.49646291820235, -50.10127858139648, -174.03183798678646, -138.2557466858847, -95.93995645966253, -48.36629810483635, -63.96975601421235, -52.550786069137615, -134.21389567983604, -123.25433689605248, -40.939502902531785, -120.02815505251995, -184.91782174822347, -100.80772788828202, -61.65300433251717, -118.86331780791234, -74.52545008080118, -89.8349396473539, -109.15887708701224, -153.59281513933243, -121.33490738450367, -64.15576440171114, -56.87155087950813, -58.12230901570115, -81.75078104421762, -47.92418190921043], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6619729447244144, "mean_inference_ms": 5.662748033009121, "mean_action_processing_ms": 0.2098786850490778, "mean_env_wait_ms": 1.4745754362289545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2562000, "num_agent_steps_trained": 2562000, "num_env_steps_sampled": 2562000, "num_env_steps_trained": 2562000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2562000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2562000, "timers": {"training_iteration_time_ms": 80228.254, "load_time_ms": 48.674, "load_throughput": 287629.939, "learn_time_ms": 69504.479, "learn_throughput": 201.426, "synch_weights_time_ms": 7.228}, "counters": {"num_env_steps_sampled": 2562000, "num_env_steps_trained": 2562000, "num_agent_steps_sampled": 2562000, "num_agent_steps_trained": 2562000}, "done": false, "episodes_total": 2562, "training_iteration": 183, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-49-06", "timestamp": 1693064946, "time_this_iter_s": 80.08305501937866, "time_total_s": 14092.660560369492, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002701535ED60>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015309460>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 14092.660560369492, "timesteps_since_restore": 0, "iterations_since_restore": 183, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 24.23274336283186, "ram_util_percent": 51.73451327433627}}
{"custom_metrics": {"episode_L1_reward_sum_mean": -286.4092422606051, "episode_L1_reward_sum_min": -635.0666286051273, "episode_L1_reward_sum_max": -159.82650849968195, "episode_L2_reward_sum_mean": -148.4251719159633, "episode_L2_reward_sum_min": -232.10215286910534, "episode_L2_reward_sum_max": -116.42113415896893}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 3.0000000000000008e-05, "total_loss": 0.04716397110232233, "policy_loss": 0.021142015014578675, "vf_loss": 0.26021955040936523, "vf_explained_var": 0.6898224618086599, "kl": 0.0, "entropy": -171.6212158203125, "entropy_coeff": 0.0}, "model": {}}}, "num_env_steps_sampled": 2576000, "num_env_steps_trained": 2576000, "num_agent_steps_sampled": 2576000, "num_agent_steps_trained": 2576000}, "sampler_results": {"episode_reward_max": -36.91482918905599, "episode_reward_min": -241.06948558104995, "episode_reward_mean": -91.79551543363667, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_L1_reward_sum_mean": -286.4092422606051, "episode_L1_reward_sum_min": -635.0666286051273, "episode_L1_reward_sum_max": -159.82650849968195, "episode_L2_reward_sum_mean": -148.4251719159633, "episode_L2_reward_sum_min": -232.10215286910534, "episode_L2_reward_sum_max": -116.42113415896893}, "hist_stats": {"episode_reward": [-81.99839674426887, -47.372409130899754, -96.05391414736123, -99.87811923896749, -98.64077681687219, -72.88222606116241, -94.74563094190971, -93.85840162033834, -70.96084862113311, -60.53820529114224, -72.41780839423035, -59.91625953044377, -92.97828459784768, -113.53820372191257, -66.85760226755055, -140.55642327169807, -200.91141162684158, -86.860531396984, -86.65722953178879, -48.591433131638404, -44.409561893588354, -241.06948558104995, -70.67972171880074, -76.33163298916827, -132.80172378138735, -76.43270706419747, -95.16346050688477, -99.49086603953029, -50.60258282064101, -48.12031639382566, -48.43107128367033, -74.18606160120453, -219.8664682459989, -57.937581639112906, -119.70802438356367, -105.9791436068017, -100.38463663753814, -158.3120865749268, -58.70586530161726, -61.572247314393195, -78.36318434171106, -54.82158681471922, -68.40511894700344, -52.646706646631465, -36.91482918905599, -60.949034406985284, -122.405314960155, -55.050895667750936, -112.3879225113192, -50.59497560669929, -60.600405424209725, -124.25884241346827, -97.679650188522, -195.9731064725982, -73.65091424665763, -107.44257984168271, -70.48353242259704, -72.55560424078594, -53.63469827087927, -102.6816642104933, -151.49646291820235, -50.10127858139648, -174.03183798678646, -138.2557466858847, -95.93995645966253, -48.36629810483635, -63.96975601421235, -52.550786069137615, -134.21389567983604, -123.25433689605248, -40.939502902531785, -120.02815505251995, -184.91782174822347, -100.80772788828202, -61.65300433251717, -118.86331780791234, -74.52545008080118, -89.8349396473539, -109.15887708701224, -153.59281513933243, -121.33490738450367, -64.15576440171114, -56.87155087950813, -58.12230901570115, -81.75078104421762, -47.92418190921043, -67.04145683427264, -83.29278646096262, -90.81815648476221, -66.90125179163677, -69.79534359547159, -93.61495538194247, -155.68379090055322, -96.37682179101914, -96.69489342364302, -56.30714045110276, -109.6445796679768, -144.21907610236275, -82.31433022062174, -72.2855702531768], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6635674763425335, "mean_inference_ms": 5.671589621315018, "mean_action_processing_ms": 0.21018785364724552, "mean_env_wait_ms": 1.4769001754251039, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -36.91482918905599, "episode_reward_min": -241.06948558104995, "episode_reward_mean": -91.79551543363667, "episode_len_mean": 1000.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-81.99839674426887, -47.372409130899754, -96.05391414736123, -99.87811923896749, -98.64077681687219, -72.88222606116241, -94.74563094190971, -93.85840162033834, -70.96084862113311, -60.53820529114224, -72.41780839423035, -59.91625953044377, -92.97828459784768, -113.53820372191257, -66.85760226755055, -140.55642327169807, -200.91141162684158, -86.860531396984, -86.65722953178879, -48.591433131638404, -44.409561893588354, -241.06948558104995, -70.67972171880074, -76.33163298916827, -132.80172378138735, -76.43270706419747, -95.16346050688477, -99.49086603953029, -50.60258282064101, -48.12031639382566, -48.43107128367033, -74.18606160120453, -219.8664682459989, -57.937581639112906, -119.70802438356367, -105.9791436068017, -100.38463663753814, -158.3120865749268, -58.70586530161726, -61.572247314393195, -78.36318434171106, -54.82158681471922, -68.40511894700344, -52.646706646631465, -36.91482918905599, -60.949034406985284, -122.405314960155, -55.050895667750936, -112.3879225113192, -50.59497560669929, -60.600405424209725, -124.25884241346827, -97.679650188522, -195.9731064725982, -73.65091424665763, -107.44257984168271, -70.48353242259704, -72.55560424078594, -53.63469827087927, -102.6816642104933, -151.49646291820235, -50.10127858139648, -174.03183798678646, -138.2557466858847, -95.93995645966253, -48.36629810483635, -63.96975601421235, -52.550786069137615, -134.21389567983604, -123.25433689605248, -40.939502902531785, -120.02815505251995, -184.91782174822347, -100.80772788828202, -61.65300433251717, -118.86331780791234, -74.52545008080118, -89.8349396473539, -109.15887708701224, -153.59281513933243, -121.33490738450367, -64.15576440171114, -56.87155087950813, -58.12230901570115, -81.75078104421762, -47.92418190921043, -67.04145683427264, -83.29278646096262, -90.81815648476221, -66.90125179163677, -69.79534359547159, -93.61495538194247, -155.68379090055322, -96.37682179101914, -96.69489342364302, -56.30714045110276, -109.6445796679768, -144.21907610236275, -82.31433022062174, -72.2855702531768], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6635674763425335, "mean_inference_ms": 5.671589621315018, "mean_action_processing_ms": 0.21018785364724552, "mean_env_wait_ms": 1.4769001754251039, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 7, "num_agent_steps_sampled": 2576000, "num_agent_steps_trained": 2576000, "num_env_steps_sampled": 2576000, "num_env_steps_trained": 2576000, "num_env_steps_sampled_this_iter": 14000, "num_env_steps_trained_this_iter": 14000, "timesteps_total": 2576000, "num_steps_trained_this_iter": 14000, "agent_timesteps_total": 2576000, "timers": {"training_iteration_time_ms": 80559.174, "load_time_ms": 49.375, "load_throughput": 283545.344, "learn_time_ms": 69840.677, "learn_throughput": 200.456, "synch_weights_time_ms": 7.221}, "counters": {"num_env_steps_sampled": 2576000, "num_env_steps_trained": 2576000, "num_agent_steps_sampled": 2576000, "num_agent_steps_trained": 2576000}, "done": false, "episodes_total": 2576, "training_iteration": 184, "trial_id": "36f5d_00000", "experiment_id": "864a9f3e7db849ea9dd201d850b32762", "date": "2023-08-26_16-50-30", "timestamp": 1693065030, "time_this_iter_s": 83.48979091644287, "time_total_s": 14176.150351285934, "pid": 16992, "hostname": "DPC000659", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "lazy_env", "env_config": {"num_agents_max": 20, "num_agents_min": 20, "speed": 15, "predefined_distance": 60, "std_pos_converged": 45, "std_vel_converged": 0.1, "std_pos_rate_converged": 0.1, "std_vel_rate_converged": 0.2, "max_time_step": 1000, "incomplete_episode_penalty": 0, "normalize_obs": true, "use_fixed_horizon": true, "use_L2_norm": true, "auto_step": false, "use_custom_ray": false, "use_preprocessed_obs": true, "use_mlp_settings": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 7, "num_envs_per_worker": 2, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1000, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.992, "lr": 3e-05, "train_batch_size": 14000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_model", "custom_model_config": {"d_subobs": 5, "d_embed_input": 128, "d_embed_context": 128, "d_model": 128, "d_model_decoder": 128, "n_layers_encoder": 3, "n_layers_decoder": 1, "num_heads": 8, "d_ff": 512, "d_ff_decoder": 512, "clip_action_mean": 1.1, "clip_action_log_std": 10.0, "dr_rate": 0, "norm_eps": 1e-05, "is_bias": false, "share_layers": true, "use_residual_in_decoder": true, "use_FNN_in_decoder": true, "use_deterministic_action_dist": true}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000027015422310>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "replay_mode": -1, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0, "sgd_minibatch_size": 256, "num_sgd_iter": 36, "shuffle_sequences": true, "vf_loss_coeff": 0.1, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.25, "vf_clip_param": 20, "grad_clip": 40.0, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 0.96, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x00000270151E63A0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "count_steps_by": "env_steps"}, "callbacks": "<class '__main__.MyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 14176.150351285934, "timesteps_since_restore": 0, "iterations_since_restore": 184, "warmup_time": 6.694256544113159, "perf": {"cpu_util_percent": 27.741176470588236, "ram_util_percent": 52.557142857142836}}
